function DM(n,e){for(var t=0;t<e.length;t++){const s=e[t];if(typeof s!="string"&&!Array.isArray(s)){for(const r in s)if(r!=="default"&&!(r in n)){const a=Object.getOwnPropertyDescriptor(s,r);a&&Object.defineProperty(n,r,a.get?a:{enumerable:!0,get:()=>s[r]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function t(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(r){if(r.ep)return;r.ep=!0;const a=t(r);fetch(r.href,a)}})();var J0e=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function c_(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function OM(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var e=n.default;if(typeof e=="function"){var t=function s(){var r=!1;try{r=this instanceof s}catch{}return r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(s){var r=Object.getOwnPropertyDescriptor(n,s);Object.defineProperty(t,s,r.get?r:{enumerable:!0,get:function(){return n[s]}})}),t}var w5={exports:{}},Yg={};var UA;function LM(){if(UA)return Yg;UA=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(s,r,a){var i=null;if(a!==void 0&&(i=""+a),r.key!==void 0&&(i=""+r.key),"key"in r){a={};for(var o in r)o!=="key"&&(a[o]=r[o])}else a=r;return r=a.ref,{$$typeof:n,type:s,key:i,ref:r!==void 0?r:null,props:a}}return Yg.Fragment=e,Yg.jsx=t,Yg.jsxs=t,Yg}var VA;function FM(){return VA||(VA=1,w5.exports=LM()),w5.exports}var $e=FM(),S5={exports:{}},hn={};var jA;function MM(){if(jA)return hn;jA=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),i=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),d=Symbol.for("react.activity"),m=Symbol.iterator;function g(G){return G===null||typeof G!="object"?null:(G=m&&G[m]||G["@@iterator"],typeof G=="function"?G:null)}var b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x=Object.assign,v={};function w(G,O,j){this.props=G,this.context=O,this.refs=v,this.updater=j||b}w.prototype.isReactComponent={},w.prototype.setState=function(G,O){if(typeof G!="object"&&typeof G!="function"&&G!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,G,O,"setState")},w.prototype.forceUpdate=function(G){this.updater.enqueueForceUpdate(this,G,"forceUpdate")};function k(){}k.prototype=w.prototype;function I(G,O,j){this.props=G,this.context=O,this.refs=v,this.updater=j||b}var A=I.prototype=new k;A.constructor=I,x(A,w.prototype),A.isPureReactComponent=!0;var R=Array.isArray;function U(){}var V={H:null,A:null,T:null,S:null},P=Object.prototype.hasOwnProperty;function D(G,O,j){var Y=j.ref;return{$$typeof:n,type:G,key:O,ref:Y!==void 0?Y:null,props:j}}function B(G,O){return D(G.type,O,G.props)}function E(G){return typeof G=="object"&&G!==null&&G.$$typeof===n}function M(G){var O={"=":"=0",":":"=2"};return"$"+G.replace(/[=:]/g,function(j){return O[j]})}var K=/\/+/g;function X(G,O){return typeof G=="object"&&G!==null&&G.key!=null?M(""+G.key):O.toString(36)}function ae(G){switch(G.status){case"fulfilled":return G.value;case"rejected":throw G.reason;default:switch(typeof G.status=="string"?G.then(U,U):(G.status="pending",G.then(function(O){G.status==="pending"&&(G.status="fulfilled",G.value=O)},function(O){G.status==="pending"&&(G.status="rejected",G.reason=O)})),G.status){case"fulfilled":return G.value;case"rejected":throw G.reason}}throw G}function W(G,O,j,Y,ie){var ue=typeof G;(ue==="undefined"||ue==="boolean")&&(G=null);var pe=!1;if(G===null)pe=!0;else switch(ue){case"bigint":case"string":case"number":pe=!0;break;case"object":switch(G.$$typeof){case n:case e:pe=!0;break;case f:return pe=G._init,W(pe(G._payload),O,j,Y,ie)}}if(pe)return ie=ie(G),pe=Y===""?"."+X(G,0):Y,R(ie)?(j="",pe!=null&&(j=pe.replace(K,"$&/")+"/"),W(ie,O,j,"",function(Le){return Le})):ie!=null&&(E(ie)&&(ie=B(ie,j+(ie.key==null||G&&G.key===ie.key?"":(""+ie.key).replace(K,"$&/")+"/")+pe)),O.push(ie)),1;pe=0;var Ce=Y===""?".":Y+":";if(R(G))for(var Ne=0;Ne<G.length;Ne++)Y=G[Ne],ue=Ce+X(Y,Ne),pe+=W(Y,O,j,ue,ie);else if(Ne=g(G),typeof Ne=="function")for(G=Ne.call(G),Ne=0;!(Y=G.next()).done;)Y=Y.value,ue=Ce+X(Y,Ne++),pe+=W(Y,O,j,ue,ie);else if(ue==="object"){if(typeof G.then=="function")return W(ae(G),O,j,Y,ie);throw O=String(G),Error("Objects are not valid as a React child (found: "+(O==="[object Object]"?"object with keys {"+Object.keys(G).join(", ")+"}":O)+"). If you meant to render a collection of children, use an array instead.")}return pe}function se(G,O,j){if(G==null)return G;var Y=[],ie=0;return W(G,Y,"","",function(ue){return O.call(j,ue,ie++)}),Y}function ee(G){if(G._status===-1){var O=G._result;O=O(),O.then(function(j){(G._status===0||G._status===-1)&&(G._status=1,G._result=j)},function(j){(G._status===0||G._status===-1)&&(G._status=2,G._result=j)}),G._status===-1&&(G._status=0,G._result=O)}if(G._status===1)return G._result.default;throw G._result}var ce=typeof reportError=="function"?reportError:function(G){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var O=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof G=="object"&&G!==null&&typeof G.message=="string"?String(G.message):String(G),error:G});if(!window.dispatchEvent(O))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",G);return}console.error(G)},ye={map:se,forEach:function(G,O,j){se(G,function(){O.apply(this,arguments)},j)},count:function(G){var O=0;return se(G,function(){O++}),O},toArray:function(G){return se(G,function(O){return O})||[]},only:function(G){if(!E(G))throw Error("React.Children.only expected to receive a single React element child.");return G}};return hn.Activity=d,hn.Children=ye,hn.Component=w,hn.Fragment=t,hn.Profiler=r,hn.PureComponent=I,hn.StrictMode=s,hn.Suspense=l,hn.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=V,hn.__COMPILER_RUNTIME={__proto__:null,c:function(G){return V.H.useMemoCache(G)}},hn.cache=function(G){return function(){return G.apply(null,arguments)}},hn.cacheSignal=function(){return null},hn.cloneElement=function(G,O,j){if(G==null)throw Error("The argument must be a React element, but you passed "+G+".");var Y=x({},G.props),ie=G.key;if(O!=null)for(ue in O.key!==void 0&&(ie=""+O.key),O)!P.call(O,ue)||ue==="key"||ue==="__self"||ue==="__source"||ue==="ref"&&O.ref===void 0||(Y[ue]=O[ue]);var ue=arguments.length-2;if(ue===1)Y.children=j;else if(1<ue){for(var pe=Array(ue),Ce=0;Ce<ue;Ce++)pe[Ce]=arguments[Ce+2];Y.children=pe}return D(G.type,ie,Y)},hn.createContext=function(G){return G={$$typeof:i,_currentValue:G,_currentValue2:G,_threadCount:0,Provider:null,Consumer:null},G.Provider=G,G.Consumer={$$typeof:a,_context:G},G},hn.createElement=function(G,O,j){var Y,ie={},ue=null;if(O!=null)for(Y in O.key!==void 0&&(ue=""+O.key),O)P.call(O,Y)&&Y!=="key"&&Y!=="__self"&&Y!=="__source"&&(ie[Y]=O[Y]);var pe=arguments.length-2;if(pe===1)ie.children=j;else if(1<pe){for(var Ce=Array(pe),Ne=0;Ne<pe;Ne++)Ce[Ne]=arguments[Ne+2];ie.children=Ce}if(G&&G.defaultProps)for(Y in pe=G.defaultProps,pe)ie[Y]===void 0&&(ie[Y]=pe[Y]);return D(G,ue,ie)},hn.createRef=function(){return{current:null}},hn.forwardRef=function(G){return{$$typeof:o,render:G}},hn.isValidElement=E,hn.lazy=function(G){return{$$typeof:f,_payload:{_status:-1,_result:G},_init:ee}},hn.memo=function(G,O){return{$$typeof:c,type:G,compare:O===void 0?null:O}},hn.startTransition=function(G){var O=V.T,j={};V.T=j;try{var Y=G(),ie=V.S;ie!==null&&ie(j,Y),typeof Y=="object"&&Y!==null&&typeof Y.then=="function"&&Y.then(U,ce)}catch(ue){ce(ue)}finally{O!==null&&j.types!==null&&(O.types=j.types),V.T=O}},hn.unstable_useCacheRefresh=function(){return V.H.useCacheRefresh()},hn.use=function(G){return V.H.use(G)},hn.useActionState=function(G,O,j){return V.H.useActionState(G,O,j)},hn.useCallback=function(G,O){return V.H.useCallback(G,O)},hn.useContext=function(G){return V.H.useContext(G)},hn.useDebugValue=function(){},hn.useDeferredValue=function(G,O){return V.H.useDeferredValue(G,O)},hn.useEffect=function(G,O){return V.H.useEffect(G,O)},hn.useEffectEvent=function(G){return V.H.useEffectEvent(G)},hn.useId=function(){return V.H.useId()},hn.useImperativeHandle=function(G,O,j){return V.H.useImperativeHandle(G,O,j)},hn.useInsertionEffect=function(G,O){return V.H.useInsertionEffect(G,O)},hn.useLayoutEffect=function(G,O){return V.H.useLayoutEffect(G,O)},hn.useMemo=function(G,O){return V.H.useMemo(G,O)},hn.useOptimistic=function(G,O){return V.H.useOptimistic(G,O)},hn.useReducer=function(G,O,j){return V.H.useReducer(G,O,j)},hn.useRef=function(G){return V.H.useRef(G)},hn.useState=function(G){return V.H.useState(G)},hn.useSyncExternalStore=function(G,O,j){return V.H.useSyncExternalStore(G,O,j)},hn.useTransition=function(){return V.H.useTransition()},hn.version="19.2.0",hn}var WA;function AN(){return WA||(WA=1,S5.exports=MM()),S5.exports}var We=AN();const Vf=c_(We);var N5={exports:{}},Zg={},k5={exports:{}},C5={};var GA;function zM(){return GA||(GA=1,(function(n){function e(W,se){var ee=W.length;W.push(se);e:for(;0<ee;){var ce=ee-1>>>1,ye=W[ce];if(0<r(ye,se))W[ce]=se,W[ee]=ye,ee=ce;else break e}}function t(W){return W.length===0?null:W[0]}function s(W){if(W.length===0)return null;var se=W[0],ee=W.pop();if(ee!==se){W[0]=ee;e:for(var ce=0,ye=W.length,G=ye>>>1;ce<G;){var O=2*(ce+1)-1,j=W[O],Y=O+1,ie=W[Y];if(0>r(j,ee))Y<ye&&0>r(ie,j)?(W[ce]=ie,W[Y]=ee,ce=Y):(W[ce]=j,W[O]=ee,ce=O);else if(Y<ye&&0>r(ie,ee))W[ce]=ie,W[Y]=ee,ce=Y;else break e}}return se}function r(W,se){var ee=W.sortIndex-se.sortIndex;return ee!==0?ee:W.id-se.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var i=Date,o=i.now();n.unstable_now=function(){return i.now()-o}}var l=[],c=[],f=1,d=null,m=3,g=!1,b=!1,x=!1,v=!1,w=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;function A(W){for(var se=t(c);se!==null;){if(se.callback===null)s(c);else if(se.startTime<=W)s(c),se.sortIndex=se.expirationTime,e(l,se);else break;se=t(c)}}function R(W){if(x=!1,A(W),!b)if(t(l)!==null)b=!0,U||(U=!0,M());else{var se=t(c);se!==null&&ae(R,se.startTime-W)}}var U=!1,V=-1,P=5,D=-1;function B(){return v?!0:!(n.unstable_now()-D<P)}function E(){if(v=!1,U){var W=n.unstable_now();D=W;var se=!0;try{e:{b=!1,x&&(x=!1,k(V),V=-1),g=!0;var ee=m;try{t:{for(A(W),d=t(l);d!==null&&!(d.expirationTime>W&&B());){var ce=d.callback;if(typeof ce=="function"){d.callback=null,m=d.priorityLevel;var ye=ce(d.expirationTime<=W);if(W=n.unstable_now(),typeof ye=="function"){d.callback=ye,A(W),se=!0;break t}d===t(l)&&s(l),A(W)}else s(l);d=t(l)}if(d!==null)se=!0;else{var G=t(c);G!==null&&ae(R,G.startTime-W),se=!1}}break e}finally{d=null,m=ee,g=!1}se=void 0}}finally{se?M():U=!1}}}var M;if(typeof I=="function")M=function(){I(E)};else if(typeof MessageChannel<"u"){var K=new MessageChannel,X=K.port2;K.port1.onmessage=E,M=function(){X.postMessage(null)}}else M=function(){w(E,0)};function ae(W,se){V=w(function(){W(n.unstable_now())},se)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(W){W.callback=null},n.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<W?Math.floor(1e3/W):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_next=function(W){switch(m){case 1:case 2:case 3:var se=3;break;default:se=m}var ee=m;m=se;try{return W()}finally{m=ee}},n.unstable_requestPaint=function(){v=!0},n.unstable_runWithPriority=function(W,se){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var ee=m;m=W;try{return se()}finally{m=ee}},n.unstable_scheduleCallback=function(W,se,ee){var ce=n.unstable_now();switch(typeof ee=="object"&&ee!==null?(ee=ee.delay,ee=typeof ee=="number"&&0<ee?ce+ee:ce):ee=ce,W){case 1:var ye=-1;break;case 2:ye=250;break;case 5:ye=1073741823;break;case 4:ye=1e4;break;default:ye=5e3}return ye=ee+ye,W={id:f++,callback:se,priorityLevel:W,startTime:ee,expirationTime:ye,sortIndex:-1},ee>ce?(W.sortIndex=ee,e(c,W),t(l)===null&&W===t(c)&&(x?(k(V),V=-1):x=!0,ae(R,ee-ce))):(W.sortIndex=ye,e(l,W),b||g||(b=!0,U||(U=!0,M()))),W},n.unstable_shouldYield=B,n.unstable_wrapCallback=function(W){var se=m;return function(){var ee=m;m=se;try{return W.apply(this,arguments)}finally{m=ee}}}})(C5)),C5}var qA;function PM(){return qA||(qA=1,k5.exports=zM()),k5.exports}var T5={exports:{}},Ra={};var HA;function BM(){if(HA)return Ra;HA=1;var n=AN();function e(l){var c="https://react.dev/errors/"+l;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)c+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+l+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var s={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},r=Symbol.for("react.portal");function a(l,c,f){var d=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:d==null?null:""+d,children:l,containerInfo:c,implementation:f}}var i=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function o(l,c){if(l==="font")return"";if(typeof c=="string")return c==="use-credentials"?c:""}return Ra.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,Ra.createPortal=function(l,c){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)throw Error(e(299));return a(l,c,null,f)},Ra.flushSync=function(l){var c=i.T,f=s.p;try{if(i.T=null,s.p=2,l)return l()}finally{i.T=c,s.p=f,s.d.f()}},Ra.preconnect=function(l,c){typeof l=="string"&&(c?(c=c.crossOrigin,c=typeof c=="string"?c==="use-credentials"?c:"":void 0):c=null,s.d.C(l,c))},Ra.prefetchDNS=function(l){typeof l=="string"&&s.d.D(l)},Ra.preinit=function(l,c){if(typeof l=="string"&&c&&typeof c.as=="string"){var f=c.as,d=o(f,c.crossOrigin),m=typeof c.integrity=="string"?c.integrity:void 0,g=typeof c.fetchPriority=="string"?c.fetchPriority:void 0;f==="style"?s.d.S(l,typeof c.precedence=="string"?c.precedence:void 0,{crossOrigin:d,integrity:m,fetchPriority:g}):f==="script"&&s.d.X(l,{crossOrigin:d,integrity:m,fetchPriority:g,nonce:typeof c.nonce=="string"?c.nonce:void 0})}},Ra.preinitModule=function(l,c){if(typeof l=="string")if(typeof c=="object"&&c!==null){if(c.as==null||c.as==="script"){var f=o(c.as,c.crossOrigin);s.d.M(l,{crossOrigin:f,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0})}}else c==null&&s.d.M(l)},Ra.preload=function(l,c){if(typeof l=="string"&&typeof c=="object"&&c!==null&&typeof c.as=="string"){var f=c.as,d=o(f,c.crossOrigin);s.d.L(l,f,{crossOrigin:d,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0,type:typeof c.type=="string"?c.type:void 0,fetchPriority:typeof c.fetchPriority=="string"?c.fetchPriority:void 0,referrerPolicy:typeof c.referrerPolicy=="string"?c.referrerPolicy:void 0,imageSrcSet:typeof c.imageSrcSet=="string"?c.imageSrcSet:void 0,imageSizes:typeof c.imageSizes=="string"?c.imageSizes:void 0,media:typeof c.media=="string"?c.media:void 0})}},Ra.preloadModule=function(l,c){if(typeof l=="string")if(c){var f=o(c.as,c.crossOrigin);s.d.m(l,{as:typeof c.as=="string"&&c.as!=="script"?c.as:void 0,crossOrigin:f,integrity:typeof c.integrity=="string"?c.integrity:void 0})}else s.d.m(l)},Ra.requestFormReset=function(l){s.d.r(l)},Ra.unstable_batchedUpdates=function(l,c){return l(c)},Ra.useFormState=function(l,c,f){return i.H.useFormState(l,c,f)},Ra.useFormStatus=function(){return i.H.useHostTransitionStatus()},Ra.version="19.2.0",Ra}var KA;function UM(){if(KA)return T5.exports;KA=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),T5.exports=BM(),T5.exports}var XA;function VM(){if(XA)return Zg;XA=1;var n=PM(),e=AN(),t=UM();function s(u){var h="https://react.dev/errors/"+u;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)h+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+u+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(u){return!(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)}function a(u){var h=u,p=u;if(u.alternate)for(;h.return;)h=h.return;else{u=h;do h=u,(h.flags&4098)!==0&&(p=h.return),u=h.return;while(u)}return h.tag===3?p:null}function i(u){if(u.tag===13){var h=u.memoizedState;if(h===null&&(u=u.alternate,u!==null&&(h=u.memoizedState)),h!==null)return h.dehydrated}return null}function o(u){if(u.tag===31){var h=u.memoizedState;if(h===null&&(u=u.alternate,u!==null&&(h=u.memoizedState)),h!==null)return h.dehydrated}return null}function l(u){if(a(u)!==u)throw Error(s(188))}function c(u){var h=u.alternate;if(!h){if(h=a(u),h===null)throw Error(s(188));return h!==u?null:u}for(var p=u,y=h;;){var N=p.return;if(N===null)break;var T=N.alternate;if(T===null){if(y=N.return,y!==null){p=y;continue}break}if(N.child===T.child){for(T=N.child;T;){if(T===p)return l(N),u;if(T===y)return l(N),h;T=T.sibling}throw Error(s(188))}if(p.return!==y.return)p=N,y=T;else{for(var z=!1,ne=N.child;ne;){if(ne===p){z=!0,p=N,y=T;break}if(ne===y){z=!0,y=N,p=T;break}ne=ne.sibling}if(!z){for(ne=T.child;ne;){if(ne===p){z=!0,p=T,y=N;break}if(ne===y){z=!0,y=T,p=N;break}ne=ne.sibling}if(!z)throw Error(s(189))}}if(p.alternate!==y)throw Error(s(190))}if(p.tag!==3)throw Error(s(188));return p.stateNode.current===p?u:h}function f(u){var h=u.tag;if(h===5||h===26||h===27||h===6)return u;for(u=u.child;u!==null;){if(h=f(u),h!==null)return h;u=u.sibling}return null}var d=Object.assign,m=Symbol.for("react.element"),g=Symbol.for("react.transitional.element"),b=Symbol.for("react.portal"),x=Symbol.for("react.fragment"),v=Symbol.for("react.strict_mode"),w=Symbol.for("react.profiler"),k=Symbol.for("react.consumer"),I=Symbol.for("react.context"),A=Symbol.for("react.forward_ref"),R=Symbol.for("react.suspense"),U=Symbol.for("react.suspense_list"),V=Symbol.for("react.memo"),P=Symbol.for("react.lazy"),D=Symbol.for("react.activity"),B=Symbol.for("react.memo_cache_sentinel"),E=Symbol.iterator;function M(u){return u===null||typeof u!="object"?null:(u=E&&u[E]||u["@@iterator"],typeof u=="function"?u:null)}var K=Symbol.for("react.client.reference");function X(u){if(u==null)return null;if(typeof u=="function")return u.$$typeof===K?null:u.displayName||u.name||null;if(typeof u=="string")return u;switch(u){case x:return"Fragment";case w:return"Profiler";case v:return"StrictMode";case R:return"Suspense";case U:return"SuspenseList";case D:return"Activity"}if(typeof u=="object")switch(u.$$typeof){case b:return"Portal";case I:return u.displayName||"Context";case k:return(u._context.displayName||"Context")+".Consumer";case A:var h=u.render;return u=u.displayName,u||(u=h.displayName||h.name||"",u=u!==""?"ForwardRef("+u+")":"ForwardRef"),u;case V:return h=u.displayName||null,h!==null?h:X(u.type)||"Memo";case P:h=u._payload,u=u._init;try{return X(u(h))}catch{}}return null}var ae=Array.isArray,W=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,se=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ee={pending:!1,data:null,method:null,action:null},ce=[],ye=-1;function G(u){return{current:u}}function O(u){0>ye||(u.current=ce[ye],ce[ye]=null,ye--)}function j(u,h){ye++,ce[ye]=u.current,u.current=h}var Y=G(null),ie=G(null),ue=G(null),pe=G(null);function Ce(u,h){switch(j(ue,h),j(ie,u),j(Y,null),h.nodeType){case 9:case 11:u=(u=h.documentElement)&&(u=u.namespaceURI)?cA(u):0;break;default:if(u=h.tagName,h=h.namespaceURI)h=cA(h),u=hA(h,u);else switch(u){case"svg":u=1;break;case"math":u=2;break;default:u=0}}O(Y),j(Y,u)}function Ne(){O(Y),O(ie),O(ue)}function Le(u){u.memoizedState!==null&&j(pe,u);var h=Y.current,p=hA(h,u.type);h!==p&&(j(ie,u),j(Y,p))}function Ve(u){ie.current===u&&(O(Y),O(ie)),pe.current===u&&(O(pe),qg._currentValue=ee)}var rt,at;function ot(u){if(rt===void 0)try{throw Error()}catch(p){var h=p.stack.trim().match(/\n( *(at )?)/);rt=h&&h[1]||"",at=-1<p.stack.indexOf(`
    at`)?" (<anonymous>)":-1<p.stack.indexOf("@")?"@unknown:0:0":""}return`
`+rt+u+at}var oe=!1;function tt(u,h){if(!u||oe)return"";oe=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var y={DetermineComponentFrameRoot:function(){try{if(h){var Ze=function(){throw Error()};if(Object.defineProperty(Ze.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ze,[])}catch(Ue){var Pe=Ue}Reflect.construct(u,[],Ze)}else{try{Ze.call()}catch(Ue){Pe=Ue}u.call(Ze.prototype)}}else{try{throw Error()}catch(Ue){Pe=Ue}(Ze=u())&&typeof Ze.catch=="function"&&Ze.catch(function(){})}}catch(Ue){if(Ue&&Pe&&typeof Ue.stack=="string")return[Ue.stack,Pe.stack]}return[null,null]}};y.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var N=Object.getOwnPropertyDescriptor(y.DetermineComponentFrameRoot,"name");N&&N.configurable&&Object.defineProperty(y.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var T=y.DetermineComponentFrameRoot(),z=T[0],ne=T[1];if(z&&ne){var be=z.split(`
`),ze=ne.split(`
`);for(N=y=0;y<be.length&&!be[y].includes("DetermineComponentFrameRoot");)y++;for(;N<ze.length&&!ze[N].includes("DetermineComponentFrameRoot");)N++;if(y===be.length||N===ze.length)for(y=be.length-1,N=ze.length-1;1<=y&&0<=N&&be[y]!==ze[N];)N--;for(;1<=y&&0<=N;y--,N--)if(be[y]!==ze[N]){if(y!==1||N!==1)do if(y--,N--,0>N||be[y]!==ze[N]){var He=`
`+be[y].replace(" at new "," at ");return u.displayName&&He.includes("<anonymous>")&&(He=He.replace("<anonymous>",u.displayName)),He}while(1<=y&&0<=N);break}}}finally{oe=!1,Error.prepareStackTrace=p}return(p=u?u.displayName||u.name:"")?ot(p):""}function xt(u,h){switch(u.tag){case 26:case 27:case 5:return ot(u.type);case 16:return ot("Lazy");case 13:return u.child!==h&&h!==null?ot("Suspense Fallback"):ot("Suspense");case 19:return ot("SuspenseList");case 0:case 15:return tt(u.type,!1);case 11:return tt(u.type.render,!1);case 1:return tt(u.type,!0);case 31:return ot("Activity");default:return""}}function ht(u){try{var h="",p=null;do h+=xt(u,p),p=u,u=u.return;while(u);return h}catch(y){return`
Error generating stack: `+y.message+`
`+y.stack}}var Je=Object.prototype.hasOwnProperty,dt=n.unstable_scheduleCallback,ft=n.unstable_cancelCallback,bt=n.unstable_shouldYield,Tt=n.unstable_requestPaint,zt=n.unstable_now,tn=n.unstable_getCurrentPriorityLevel,Ut=n.unstable_ImmediatePriority,sn=n.unstable_UserBlockingPriority,Yt=n.unstable_NormalPriority,vt=n.unstable_LowPriority,en=n.unstable_IdlePriority,_t=n.log,ks=n.unstable_setDisableYieldValue,ln=null,Vt=null;function Zt(u){if(typeof _t=="function"&&ks(u),Vt&&typeof Vt.setStrictMode=="function")try{Vt.setStrictMode(ln,u)}catch{}}var kn=Math.clz32?Math.clz32:Kt,jt=Math.log,ls=Math.LN2;function Kt(u){return u>>>=0,u===0?32:31-(jt(u)/ls|0)|0}var nn=256,es=262144,dn=4194304;function Lt(u){var h=u&42;if(h!==0)return h;switch(u&-u){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return u&261888;case 262144:case 524288:case 1048576:case 2097152:return u&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return u&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return u}}function On(u,h,p){var y=u.pendingLanes;if(y===0)return 0;var N=0,T=u.suspendedLanes,z=u.pingedLanes;u=u.warmLanes;var ne=y&134217727;return ne!==0?(y=ne&~T,y!==0?N=Lt(y):(z&=ne,z!==0?N=Lt(z):p||(p=ne&~u,p!==0&&(N=Lt(p))))):(ne=y&~T,ne!==0?N=Lt(ne):z!==0?N=Lt(z):p||(p=y&~u,p!==0&&(N=Lt(p)))),N===0?0:h!==0&&h!==N&&(h&T)===0&&(T=N&-N,p=h&-h,T>=p||T===32&&(p&4194048)!==0)?h:N}function Ui(u,h){return(u.pendingLanes&~(u.suspendedLanes&~u.pingedLanes)&h)===0}function Jr(u,h){switch(u){case 1:case 2:case 4:case 8:case 64:return h+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function yo(){var u=dn;return dn<<=1,(dn&62914560)===0&&(dn=4194304),u}function fi(u){for(var h=[],p=0;31>p;p++)h.push(u);return h}function Pt(u,h){u.pendingLanes|=h,h!==268435456&&(u.suspendedLanes=0,u.pingedLanes=0,u.warmLanes=0)}function Xo(u,h,p,y,N,T){var z=u.pendingLanes;u.pendingLanes=p,u.suspendedLanes=0,u.pingedLanes=0,u.warmLanes=0,u.expiredLanes&=p,u.entangledLanes&=p,u.errorRecoveryDisabledLanes&=p,u.shellSuspendCounter=0;var ne=u.entanglements,be=u.expirationTimes,ze=u.hiddenUpdates;for(p=z&~p;0<p;){var He=31-kn(p),Ze=1<<He;ne[He]=0,be[He]=-1;var Pe=ze[He];if(Pe!==null)for(ze[He]=null,He=0;He<Pe.length;He++){var Ue=Pe[He];Ue!==null&&(Ue.lane&=-536870913)}p&=~Ze}y!==0&&bo(u,y,0),T!==0&&N===0&&u.tag!==0&&(u.suspendedLanes|=T&~(z&~h))}function bo(u,h,p){u.pendingLanes|=h,u.suspendedLanes&=~h;var y=31-kn(h);u.entangledLanes|=h,u.entanglements[y]=u.entanglements[y]|1073741824|p&261930}function Ga(u,h){var p=u.entangledLanes|=h;for(u=u.entanglements;p;){var y=31-kn(p),N=1<<y;N&h|u[y]&h&&(u[y]|=h),p&=~N}}function qa(u,h){var p=h&-h;return p=(p&42)!==0?1:Ns(p),(p&(u.suspendedLanes|h))!==0?0:p}function Ns(u){switch(u){case 2:u=1;break;case 8:u=4;break;case 32:u=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:u=128;break;case 268435456:u=134217728;break;default:u=0}return u}function Js(u){return u&=-u,2<u?8<u?(u&134217727)!==0?32:268435456:8:2}function kr(){var u=se.p;return u!==0?u:(u=window.event,u===void 0?32:OA(u.type))}function Wl(u,h){var p=se.p;try{return se.p=u,h()}finally{se.p=p}}var ga=Math.random().toString(36).slice(2),ts="__reactFiber$"+ga,Cs="__reactProps$"+ga,Qr="__reactContainer$"+ga,Ha="__reactEvents$"+ga,di="__reactListeners$"+ga,Du="__reactHandles$"+ga,Vi="__reactResources$"+ga,ji="__reactMarker$"+ga;function Gl(u){delete u[ts],delete u[Cs],delete u[Ha],delete u[di],delete u[Du]}function Wi(u){var h=u[ts];if(h)return h;for(var p=u.parentNode;p;){if(h=p[Qr]||p[ts]){if(p=h.alternate,h.child!==null||p!==null&&p.child!==null)for(u=bA(u);u!==null;){if(p=u[ts])return p;u=bA(u)}return h}u=p,p=u.parentNode}return null}function Gi(u){if(u=u[ts]||u[Qr]){var h=u.tag;if(h===5||h===6||h===13||h===31||h===26||h===27||h===3)return u}return null}function Ou(u){var h=u.tag;if(h===5||h===26||h===27||h===6)return u.stateNode;throw Error(s(33))}function xo(u){var h=u[Vi];return h||(h=u[Vi]={hoistableStyles:new Map,hoistableScripts:new Map}),h}function Ws(u){u[ji]=!0}var Xh=new Set,Ka={};function qi(u,h){Yo(u,h),Yo(u+"Capture",h)}function Yo(u,h){for(Ka[u]=h,u=0;u<h.length;u++)Xh.add(h[u])}var Yh=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Zh={},Jh={};function Ed(u){return Je.call(Jh,u)?!0:Je.call(Zh,u)?!1:Yh.test(u)?Jh[u]=!0:(Zh[u]=!0,!1)}function Xa(u,h,p){if(Ed(h))if(p===null)u.removeAttribute(h);else{switch(typeof p){case"undefined":case"function":case"symbol":u.removeAttribute(h);return;case"boolean":var y=h.toLowerCase().slice(0,5);if(y!=="data-"&&y!=="aria-"){u.removeAttribute(h);return}}u.setAttribute(h,""+p)}}function Zo(u,h,p){if(p===null)u.removeAttribute(h);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":u.removeAttribute(h);return}u.setAttribute(h,""+p)}}function Hi(u,h,p,y){if(y===null)u.removeAttribute(p);else{switch(typeof y){case"undefined":case"function":case"symbol":case"boolean":u.removeAttribute(p);return}u.setAttributeNS(h,p,""+y)}}function jn(u){switch(typeof u){case"bigint":case"boolean":case"number":case"string":case"undefined":return u;case"object":return u;default:return""}}function Qh(u){var h=u.type;return(u=u.nodeName)&&u.toLowerCase()==="input"&&(h==="checkbox"||h==="radio")}function vo(u,h,p){var y=Object.getOwnPropertyDescriptor(u.constructor.prototype,h);if(!u.hasOwnProperty(h)&&typeof y<"u"&&typeof y.get=="function"&&typeof y.set=="function"){var N=y.get,T=y.set;return Object.defineProperty(u,h,{configurable:!0,get:function(){return N.call(this)},set:function(z){p=""+z,T.call(this,z)}}),Object.defineProperty(u,h,{enumerable:y.enumerable}),{getValue:function(){return p},setValue:function(z){p=""+z},stopTracking:function(){u._valueTracker=null,delete u[h]}}}}function ql(u){if(!u._valueTracker){var h=Qh(u)?"checked":"value";u._valueTracker=vo(u,h,""+u[h])}}function ef(u){if(!u)return!1;var h=u._valueTracker;if(!h)return!0;var p=h.getValue(),y="";return u&&(y=Qh(u)?u.checked?"true":"false":u.value),u=y,u!==p?(h.setValue(u),!0):!1}function ya(u){if(u=u||(typeof document<"u"?document:void 0),typeof u>"u")return null;try{return u.activeElement||u.body}catch{return u.body}}var pr=/[\n"\\]/g;function Qs(u){return u.replace(pr,function(h){return"\\"+h.charCodeAt(0).toString(16)+" "})}function Dc(u,h,p,y,N,T,z,ne){u.name="",z!=null&&typeof z!="function"&&typeof z!="symbol"&&typeof z!="boolean"?u.type=z:u.removeAttribute("type"),h!=null?z==="number"?(h===0&&u.value===""||u.value!=h)&&(u.value=""+jn(h)):u.value!==""+jn(h)&&(u.value=""+jn(h)):z!=="submit"&&z!=="reset"||u.removeAttribute("value"),h!=null?tf(u,z,jn(h)):p!=null?tf(u,z,jn(p)):y!=null&&u.removeAttribute("value"),N==null&&T!=null&&(u.defaultChecked=!!T),N!=null&&(u.checked=N&&typeof N!="function"&&typeof N!="symbol"),ne!=null&&typeof ne!="function"&&typeof ne!="symbol"&&typeof ne!="boolean"?u.name=""+jn(ne):u.removeAttribute("name")}function _d(u,h,p,y,N,T,z,ne){if(T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(u.type=T),h!=null||p!=null){if(!(T!=="submit"&&T!=="reset"||h!=null)){ql(u);return}p=p!=null?""+jn(p):"",h=h!=null?""+jn(h):p,ne||h===u.value||(u.value=h),u.defaultValue=h}y=y??N,y=typeof y!="function"&&typeof y!="symbol"&&!!y,u.checked=ne?u.checked:!!y,u.defaultChecked=!!y,z!=null&&typeof z!="function"&&typeof z!="symbol"&&typeof z!="boolean"&&(u.name=z),ql(u)}function tf(u,h,p){h==="number"&&ya(u.ownerDocument)===u||u.defaultValue===""+p||(u.defaultValue=""+p)}function ba(u,h,p,y){if(u=u.options,h){h={};for(var N=0;N<p.length;N++)h["$"+p[N]]=!0;for(p=0;p<u.length;p++)N=h.hasOwnProperty("$"+u[p].value),u[p].selected!==N&&(u[p].selected=N),N&&y&&(u[p].defaultSelected=!0)}else{for(p=""+jn(p),h=null,N=0;N<u.length;N++){if(u[N].value===p){u[N].selected=!0,y&&(u[N].defaultSelected=!0);return}h!==null||u[N].disabled||(h=u[N])}h!==null&&(h.selected=!0)}}function nf(u,h,p){if(h!=null&&(h=""+jn(h),h!==u.value&&(u.value=h),p==null)){u.defaultValue!==h&&(u.defaultValue=h);return}u.defaultValue=p!=null?""+jn(p):""}function sf(u,h,p,y){if(h==null){if(y!=null){if(p!=null)throw Error(s(92));if(ae(y)){if(1<y.length)throw Error(s(93));y=y[0]}p=y}p==null&&(p=""),h=p}p=jn(h),u.defaultValue=p,y=u.textContent,y===p&&y!==""&&y!==null&&(u.value=y),ql(u)}function Ki(u,h){if(h){var p=u.firstChild;if(p&&p===u.lastChild&&p.nodeType===3){p.nodeValue=h;return}}u.textContent=h}var Lu=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function $d(u,h,p){var y=h.indexOf("--")===0;p==null||typeof p=="boolean"||p===""?y?u.setProperty(h,""):h==="float"?u.cssFloat="":u[h]="":y?u.setProperty(h,p):typeof p!="number"||p===0||Lu.has(h)?h==="float"?u.cssFloat=p:u[h]=(""+p).trim():u[h]=p+"px"}function Rd(u,h,p){if(h!=null&&typeof h!="object")throw Error(s(62));if(u=u.style,p!=null){for(var y in p)!p.hasOwnProperty(y)||h!=null&&h.hasOwnProperty(y)||(y.indexOf("--")===0?u.setProperty(y,""):y==="float"?u.cssFloat="":u[y]="");for(var N in h)y=h[N],h.hasOwnProperty(N)&&p[N]!==y&&$d(u,N,y)}else for(var T in h)h.hasOwnProperty(T)&&$d(u,T,h[T])}function rf(u){if(u.indexOf("-")===-1)return!1;switch(u){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var af=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Dd=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ea(u){return Dd.test(""+u)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":u}function Xi(){}var Jo=null;function Fu(u){return u=u.target||u.srcElement||window,u.correspondingUseElement&&(u=u.correspondingUseElement),u.nodeType===3?u.parentNode:u}var Hl=null,qt=null;function Od(u){var h=Gi(u);if(h&&(u=h.stateNode)){var p=u[Cs]||null;e:switch(u=h.stateNode,h.type){case"input":if(Dc(u,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name),h=p.name,p.type==="radio"&&h!=null){for(p=u;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll('input[name="'+Qs(""+h)+'"][type="radio"]'),h=0;h<p.length;h++){var y=p[h];if(y!==u&&y.form===u.form){var N=y[Cs]||null;if(!N)throw Error(s(90));Dc(y,N.value,N.defaultValue,N.defaultValue,N.checked,N.defaultChecked,N.type,N.name)}}for(h=0;h<p.length;h++)y=p[h],y.form===u.form&&ef(y)}break e;case"textarea":nf(u,p.value,p.defaultValue);break e;case"select":h=p.value,h!=null&&ba(u,!!p.multiple,h,!1)}}}var of=!1;function Ld(u,h,p){if(of)return u(h,p);of=!0;try{var y=u(h);return y}finally{if(of=!1,(Hl!==null||qt!==null)&&(Yy(),Hl&&(h=Hl,u=qt,qt=Hl=null,Od(h),u)))for(h=0;h<u.length;h++)Od(u[h])}}function Ya(u,h){var p=u.stateNode;if(p===null)return null;var y=p[Cs]||null;if(y===null)return null;p=y[h];e:switch(h){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(y=!y.disabled)||(u=u.type,y=!(u==="button"||u==="input"||u==="select"||u==="textarea")),u=!y;break e;default:u=!1}if(u)return null;if(p&&typeof p!="function")throw Error(s(231,h,typeof p));return p}var Fr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),lf=!1;if(Fr)try{var Mu={};Object.defineProperty(Mu,"passive",{get:function(){lf=!0}}),window.addEventListener("test",Mu,Mu),window.removeEventListener("test",Mu,Mu)}catch{lf=!1}var Za=null,zu=null,wo=null;function Fd(){if(wo)return wo;var u,h=zu,p=h.length,y,N="value"in Za?Za.value:Za.textContent,T=N.length;for(u=0;u<p&&h[u]===N[u];u++);var z=p-u;for(y=1;y<=z&&h[p-y]===N[T-y];y++);return wo=N.slice(u,1<y?1-y:void 0)}function pi(u){var h=u.keyCode;return"charCode"in u?(u=u.charCode,u===0&&h===13&&(u=13)):u=h,u===10&&(u=13),32<=u||u===13?u:0}function Oc(){return!0}function Lc(){return!1}function Cr(u){function h(p,y,N,T,z){this._reactName=p,this._targetInst=N,this.type=y,this.nativeEvent=T,this.target=z,this.currentTarget=null;for(var ne in u)u.hasOwnProperty(ne)&&(p=u[ne],this[ne]=p?p(T):T[ne]);return this.isDefaultPrevented=(T.defaultPrevented!=null?T.defaultPrevented:T.returnValue===!1)?Oc:Lc,this.isPropagationStopped=Lc,this}return d(h.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=Oc)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=Oc)},persist:function(){},isPersistent:Oc}),h}var So={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(u){return u.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},mi=Cr(So),Qo=d({},So,{view:0,detail:0}),Fc=Cr(Qo),Pu,el,tl,Bu=d({},Qo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Jt,button:0,buttons:0,relatedTarget:function(u){return u.relatedTarget===void 0?u.fromElement===u.srcElement?u.toElement:u.fromElement:u.relatedTarget},movementX:function(u){return"movementX"in u?u.movementX:(u!==tl&&(tl&&u.type==="mousemove"?(Pu=u.screenX-tl.screenX,el=u.screenY-tl.screenY):el=Pu=0,tl=u),Pu)},movementY:function(u){return"movementY"in u?u.movementY:el}}),uf=Cr(Bu),nl=d({},Bu,{dataTransfer:0}),sl=Cr(nl),Md=d({},Qo,{relatedTarget:0}),rl=Cr(Md),zd=d({},So,{animationName:0,elapsedTime:0,pseudoElement:0}),_=Cr(zd),q=d({},So,{clipboardData:function(u){return"clipboardData"in u?u.clipboardData:window.clipboardData}}),de=Cr(q),ve=d({},So,{data:0}),Ie=Cr(ve),Ke={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},nt={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Nt={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Rt(u){var h=this.nativeEvent;return h.getModifierState?h.getModifierState(u):(u=Nt[u])?!!h[u]:!1}function Jt(){return Rt}var un=d({},Qo,{key:function(u){if(u.key){var h=Ke[u.key]||u.key;if(h!=="Unidentified")return h}return u.type==="keypress"?(u=pi(u),u===13?"Enter":String.fromCharCode(u)):u.type==="keydown"||u.type==="keyup"?nt[u.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Jt,charCode:function(u){return u.type==="keypress"?pi(u):0},keyCode:function(u){return u.type==="keydown"||u.type==="keyup"?u.keyCode:0},which:function(u){return u.type==="keypress"?pi(u):u.type==="keydown"||u.type==="keyup"?u.keyCode:0}}),Ln=Cr(un),Ts=d({},Bu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Gs=Cr(Ts),us=d({},Qo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Jt}),mr=Cr(us),er=d({},So,{propertyName:0,elapsedTime:0,pseudoElement:0}),Mr=Cr(er),al=d({},Bu,{deltaX:function(u){return"deltaX"in u?u.deltaX:"wheelDeltaX"in u?-u.wheelDeltaX:0},deltaY:function(u){return"deltaY"in u?u.deltaY:"wheelDeltaY"in u?-u.wheelDeltaY:"wheelDelta"in u?-u.wheelDelta:0},deltaZ:0,deltaMode:0}),Yi=Cr(al),il=d({},So,{newState:0,oldState:0}),cf=Cr(il),Mc=[9,13,27,32],No=Fr&&"CompositionEvent"in window,Zi=null;Fr&&"documentMode"in document&&(Zi=document.documentMode);var Uu=Fr&&"TextEvent"in window&&!Zi,ol=Fr&&(!No||Zi&&8<Zi&&11>=Zi),Tr=" ",Kl=!1;function Xl(u,h){switch(u){case"keyup":return Mc.indexOf(h.keyCode)!==-1;case"keydown":return h.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zc(u){return u=u.detail,typeof u=="object"&&"data"in u?u.data:null}var ko=!1;function xa(u,h){switch(u){case"compositionend":return zc(h);case"keypress":return h.which!==32?null:(Kl=!0,Tr);case"textInput":return u=h.data,u===Tr&&Kl?null:u;default:return null}}function ll(u,h){if(ko)return u==="compositionend"||!No&&Xl(u,h)?(u=Fd(),wo=zu=Za=null,ko=!1,u):null;switch(u){case"paste":return null;case"keypress":if(!(h.ctrlKey||h.altKey||h.metaKey)||h.ctrlKey&&h.altKey){if(h.char&&1<h.char.length)return h.char;if(h.which)return String.fromCharCode(h.which)}return null;case"compositionend":return ol&&h.locale!=="ko"?null:h.data;default:return null}}var Pc={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function hf(u){var h=u&&u.nodeName&&u.nodeName.toLowerCase();return h==="input"?!!Pc[u.type]:h==="textarea"}function Ja(u,h,p,y){Hl?qt?qt.push(y):qt=[y]:Hl=y,h=s2(h,"onChange"),0<h.length&&(p=new mi("onChange","change",null,p,y),u.push({event:p,listeners:h}))}var Ji=null,ul=null;function ff(u){rA(u,0)}function Qi(u){var h=Ou(u);if(ef(h))return u}function Yl(u,h){if(u==="change")return h}var _a=!1;if(Fr){var va;if(Fr){var Co="oninput"in document;if(!Co){var To=document.createElement("div");To.setAttribute("oninput","return;"),Co=typeof To.oninput=="function"}va=Co}else va=!1;_a=va&&(!document.documentMode||9<document.documentMode)}function cl(){Ji&&(Ji.detachEvent("onpropertychange",Bc),ul=Ji=null)}function Bc(u){if(u.propertyName==="value"&&Qi(ul)){var h=[];Ja(h,ul,u,Fu(u)),Ld(ff,h)}}function Uc(u,h,p){u==="focusin"?(cl(),Ji=h,ul=p,Ji.attachEvent("onpropertychange",Bc)):u==="focusout"&&cl()}function qs(u){if(u==="selectionchange"||u==="keyup"||u==="keydown")return Qi(ul)}function Pd(u,h){if(u==="click")return Qi(h)}function Ao(u,h){if(u==="input"||u==="change")return Qi(h)}function Io(u,h){return u===h&&(u!==0||1/u===1/h)||u!==u&&h!==h}var zr=typeof Object.is=="function"?Object.is:Io;function hl(u,h){if(zr(u,h))return!0;if(typeof u!="object"||u===null||typeof h!="object"||h===null)return!1;var p=Object.keys(u),y=Object.keys(h);if(p.length!==y.length)return!1;for(y=0;y<p.length;y++){var N=p[y];if(!Je.call(h,N)||!zr(u[N],h[N]))return!1}return!0}function Vc(u){for(;u&&u.firstChild;)u=u.firstChild;return u}function jc(u,h){var p=Vc(u);u=0;for(var y;p;){if(p.nodeType===3){if(y=u+p.textContent.length,u<=h&&y>=h)return{node:p,offset:h-u};u=y}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=Vc(p)}}function fl(u,h){return u&&h?u===h?!0:u&&u.nodeType===3?!1:h&&h.nodeType===3?fl(u,h.parentNode):"contains"in u?u.contains(h):u.compareDocumentPosition?!!(u.compareDocumentPosition(h)&16):!1:!1}function dl(u){u=u!=null&&u.ownerDocument!=null&&u.ownerDocument.defaultView!=null?u.ownerDocument.defaultView:window;for(var h=ya(u.document);h instanceof u.HTMLIFrameElement;){try{var p=typeof h.contentWindow.location.href=="string"}catch{p=!1}if(p)u=h.contentWindow;else break;h=ya(u.document)}return h}function Eo(u){var h=u&&u.nodeName&&u.nodeName.toLowerCase();return h&&(h==="input"&&(u.type==="text"||u.type==="search"||u.type==="tel"||u.type==="url"||u.type==="password")||h==="textarea"||u.contentEditable==="true")}var Vu=Fr&&"documentMode"in document&&11>=document.documentMode,Qa=null,pl=null,ea=null,gi=!1;function Wn(u,h,p){var y=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;gi||Qa==null||Qa!==ya(y)||(y=Qa,"selectionStart"in y&&Eo(y)?y={start:y.selectionStart,end:y.selectionEnd}:(y=(y.ownerDocument&&y.ownerDocument.defaultView||window).getSelection(),y={anchorNode:y.anchorNode,anchorOffset:y.anchorOffset,focusNode:y.focusNode,focusOffset:y.focusOffset}),ea&&hl(ea,y)||(ea=y,y=s2(pl,"onSelect"),0<y.length&&(h=new mi("onSelect","select",null,h,p),u.push({event:h,listeners:y}),h.target=Qa)))}function Fn(u,h){var p={};return p[u.toLowerCase()]=h.toLowerCase(),p["Webkit"+u]="webkit"+h,p["Moz"+u]="moz"+h,p}var cs={animationend:Fn("Animation","AnimationEnd"),animationiteration:Fn("Animation","AnimationIteration"),animationstart:Fn("Animation","AnimationStart"),transitionrun:Fn("Transition","TransitionRun"),transitionstart:Fn("Transition","TransitionStart"),transitioncancel:Fn("Transition","TransitionCancel"),transitionend:Fn("Transition","TransitionEnd")},Hs={},_o={};Fr&&(_o=document.createElement("div").style,"AnimationEvent"in window||(delete cs.animationend.animation,delete cs.animationiteration.animation,delete cs.animationstart.animation),"TransitionEvent"in window||delete cs.transitionend.transition);function eo(u){if(Hs[u])return Hs[u];if(!cs[u])return u;var h=cs[u],p;for(p in h)if(h.hasOwnProperty(p)&&p in _o)return Hs[u]=h[p];return u}var ju=eo("animationend"),df=eo("animationiteration"),mg=eo("animationstart"),Ty=eo("transitionrun"),Ay=eo("transitionstart"),Iy=eo("transitioncancel"),gg=eo("transitionend"),yg=new Map,Wu="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Wu.push("scrollEnd");function yi(u,h){yg.set(u,h),qi(h,[u])}var pf=typeof reportError=="function"?reportError:function(u){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var h=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof u=="object"&&u!==null&&typeof u.message=="string"?String(u.message):String(u),error:u});if(!window.dispatchEvent(h))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",u);return}console.error(u)},ei=[],Gu=0,Bd=0;function mf(){for(var u=Gu,h=Bd=Gu=0;h<u;){var p=ei[h];ei[h++]=null;var y=ei[h];ei[h++]=null;var N=ei[h];ei[h++]=null;var T=ei[h];if(ei[h++]=null,y!==null&&N!==null){var z=y.pending;z===null?N.next=N:(N.next=z.next,z.next=N),y.pending=N}T!==0&&yf(p,N,T)}}function gf(u,h,p,y){ei[Gu++]=u,ei[Gu++]=h,ei[Gu++]=p,ei[Gu++]=y,Bd|=y,u.lanes|=y,u=u.alternate,u!==null&&(u.lanes|=y)}function Ud(u,h,p,y){return gf(u,h,p,y),ta(u)}function ml(u,h){return gf(u,null,null,h),ta(u)}function yf(u,h,p){u.lanes|=p;var y=u.alternate;y!==null&&(y.lanes|=p);for(var N=!1,T=u.return;T!==null;)T.childLanes|=p,y=T.alternate,y!==null&&(y.childLanes|=p),T.tag===22&&(u=T.stateNode,u===null||u._visibility&1||(N=!0)),u=T,T=T.return;return u.tag===3?(T=u.stateNode,N&&h!==null&&(N=31-kn(p),u=T.hiddenUpdates,y=u[N],y===null?u[N]=[h]:y.push(h),h.lane=p|536870912),T):null}function ta(u){if(50<Pg)throw Pg=0,Gw=null,Error(s(185));for(var h=u.return;h!==null;)u=h,h=u.return;return u.tag===3?u.stateNode:null}var Pr={};function Vd(u,h,p,y){this.tag=u,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=h,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=y,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function na(u,h,p,y){return new Vd(u,h,p,y)}function jd(u){return u=u.prototype,!(!u||!u.isReactComponent)}function bi(u,h){var p=u.alternate;return p===null?(p=na(u.tag,h,u.key,u.mode),p.elementType=u.elementType,p.type=u.type,p.stateNode=u.stateNode,p.alternate=u,u.alternate=p):(p.pendingProps=h,p.type=u.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=u.flags&65011712,p.childLanes=u.childLanes,p.lanes=u.lanes,p.child=u.child,p.memoizedProps=u.memoizedProps,p.memoizedState=u.memoizedState,p.updateQueue=u.updateQueue,h=u.dependencies,p.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext},p.sibling=u.sibling,p.index=u.index,p.ref=u.ref,p.refCleanup=u.refCleanup,p}function bf(u,h){u.flags&=65011714;var p=u.alternate;return p===null?(u.childLanes=0,u.lanes=h,u.child=null,u.subtreeFlags=0,u.memoizedProps=null,u.memoizedState=null,u.updateQueue=null,u.dependencies=null,u.stateNode=null):(u.childLanes=p.childLanes,u.lanes=p.lanes,u.child=p.child,u.subtreeFlags=0,u.deletions=null,u.memoizedProps=p.memoizedProps,u.memoizedState=p.memoizedState,u.updateQueue=p.updateQueue,u.type=p.type,h=p.dependencies,u.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext}),u}function Wc(u,h,p,y,N,T){var z=0;if(y=u,typeof u=="function")jd(u)&&(z=1);else if(typeof u=="string")z=wM(u,p,Y.current)?26:u==="html"||u==="head"||u==="body"?27:5;else e:switch(u){case D:return u=na(31,p,h,N),u.elementType=D,u.lanes=T,u;case x:return Zl(p.children,N,T,h);case v:z=8,N|=24;break;case w:return u=na(12,p,h,N|2),u.elementType=w,u.lanes=T,u;case R:return u=na(13,p,h,N),u.elementType=R,u.lanes=T,u;case U:return u=na(19,p,h,N),u.elementType=U,u.lanes=T,u;default:if(typeof u=="object"&&u!==null)switch(u.$$typeof){case I:z=10;break e;case k:z=9;break e;case A:z=11;break e;case V:z=14;break e;case P:z=16,y=null;break e}z=29,p=Error(s(130,u===null?"null":typeof u,"")),y=null}return h=na(z,p,h,N),h.elementType=u,h.type=y,h.lanes=T,h}function Zl(u,h,p,y){return u=na(7,u,y,h),u.lanes=p,u}function xf(u,h,p){return u=na(6,u,null,h),u.lanes=p,u}function Wd(u){var h=na(18,null,null,0);return h.stateNode=u,h}function Gc(u,h,p){return h=na(4,u.children!==null?u.children:[],u.key,h),h.lanes=p,h.stateNode={containerInfo:u.containerInfo,pendingChildren:null,implementation:u.implementation},h}var Gd=new WeakMap;function xi(u,h){if(typeof u=="object"&&u!==null){var p=Gd.get(u);return p!==void 0?p:(h={value:u,source:h,stack:ht(h)},Gd.set(u,h),h)}return{value:u,source:h,stack:ht(h)}}var qc=[],qu=0,qd=null,vf=0,vi=[],wi=0,Jl=null,Si=1,Ni="";function ti(u,h){qc[qu++]=vf,qc[qu++]=qd,qd=u,vf=h}function Ey(u,h,p){vi[wi++]=Si,vi[wi++]=Ni,vi[wi++]=Jl,Jl=u;var y=Si;u=Ni;var N=32-kn(y)-1;y&=~(1<<N),p+=1;var T=32-kn(h)+N;if(30<T){var z=N-N%5;T=(y&(1<<z)-1).toString(32),y>>=z,N-=z,Si=1<<32-kn(h)+N|p<<N|y,Ni=T+u}else Si=1<<T|p<<N|y,Ni=u}function bg(u){u.return!==null&&(ti(u,1),Ey(u,1,0))}function Hd(u){for(;u===qd;)qd=qc[--qu],qc[qu]=null,vf=qc[--qu],qc[qu]=null;for(;u===Jl;)Jl=vi[--wi],vi[wi]=null,Ni=vi[--wi],vi[wi]=null,Si=vi[--wi],vi[wi]=null}function _y(u,h){vi[wi++]=Si,vi[wi++]=Ni,vi[wi++]=Jl,Si=h.id,Ni=h.overflow,Jl=u}var Br=null,gs=null,In=!1,wa=null,Os=!1,to=Error(s(519));function Ql(u){var h=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Hc(xi(h,u)),to}function xg(u){var h=u.stateNode,p=u.type,y=u.memoizedProps;switch(h[ts]=u,h[Cs]=y,p){case"dialog":_n("cancel",h),_n("close",h);break;case"iframe":case"object":case"embed":_n("load",h);break;case"video":case"audio":for(p=0;p<Ug.length;p++)_n(Ug[p],h);break;case"source":_n("error",h);break;case"img":case"image":case"link":_n("error",h),_n("load",h);break;case"details":_n("toggle",h);break;case"input":_n("invalid",h),_d(h,y.value,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name,!0);break;case"select":_n("invalid",h);break;case"textarea":_n("invalid",h),sf(h,y.value,y.defaultValue,y.children)}p=y.children,typeof p!="string"&&typeof p!="number"&&typeof p!="bigint"||h.textContent===""+p||y.suppressHydrationWarning===!0||lA(h.textContent,p)?(y.popover!=null&&(_n("beforetoggle",h),_n("toggle",h)),y.onScroll!=null&&_n("scroll",h),y.onScrollEnd!=null&&_n("scrollend",h),y.onClick!=null&&(h.onclick=Xi),h=!0):h=!1,h||Ql(u,!0)}function gl(u){for(Br=u.return;Br;)switch(Br.tag){case 5:case 31:case 13:Os=!1;return;case 27:case 3:Os=!0;return;default:Br=Br.return}}function Ur(u){if(u!==Br)return!1;if(!In)return gl(u),In=!0,!1;var h=u.tag,p;if((p=h!==3&&h!==27)&&((p=h===5)&&(p=u.type,p=!(p!=="form"&&p!=="button")||i5(u.type,u.memoizedProps)),p=!p),p&&gs&&Ql(u),gl(u),h===13){if(u=u.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(s(317));gs=yA(u)}else if(h===31){if(u=u.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(s(317));gs=yA(u)}else h===27?(h=gs,oh(u.type)?(u=h5,h5=null,gs=u):gs=h):gs=Br?Oo(u.stateNode.nextSibling):null;return!0}function Hu(){gs=Br=null,In=!1}function vg(){var u=wa;return u!==null&&(Ei===null?Ei=u:Ei.push.apply(Ei,u),wa=null),u}function Hc(u){wa===null?wa=[u]:wa.push(u)}var Kd=G(null),eu=null,$o=null;function tu(u,h,p){j(Kd,h._currentValue),h._currentValue=p}function ki(u){u._currentValue=Kd.current,O(Kd)}function Kc(u,h,p){for(;u!==null;){var y=u.alternate;if((u.childLanes&h)!==h?(u.childLanes|=h,y!==null&&(y.childLanes|=h)):y!==null&&(y.childLanes&h)!==h&&(y.childLanes|=h),u===p)break;u=u.return}}function Ku(u,h,p,y){var N=u.child;for(N!==null&&(N.return=u);N!==null;){var T=N.dependencies;if(T!==null){var z=N.child;T=T.firstContext;e:for(;T!==null;){var ne=T;T=N;for(var be=0;be<h.length;be++)if(ne.context===h[be]){T.lanes|=p,ne=T.alternate,ne!==null&&(ne.lanes|=p),Kc(T.return,p,u),y||(z=null);break e}T=ne.next}}else if(N.tag===18){if(z=N.return,z===null)throw Error(s(341));z.lanes|=p,T=z.alternate,T!==null&&(T.lanes|=p),Kc(z,p,u),z=null}else z=N.child;if(z!==null)z.return=N;else for(z=N;z!==null;){if(z===u){z=null;break}if(N=z.sibling,N!==null){N.return=z.return,z=N;break}z=z.return}N=z}}function nu(u,h,p,y){u=null;for(var N=h,T=!1;N!==null;){if(!T){if((N.flags&524288)!==0)T=!0;else if((N.flags&262144)!==0)break}if(N.tag===10){var z=N.alternate;if(z===null)throw Error(s(387));if(z=z.memoizedProps,z!==null){var ne=N.type;zr(N.pendingProps.value,z.value)||(u!==null?u.push(ne):u=[ne])}}else if(N===pe.current){if(z=N.alternate,z===null)throw Error(s(387));z.memoizedState.memoizedState!==N.memoizedState.memoizedState&&(u!==null?u.push(qg):u=[qg])}N=N.return}u!==null&&Ku(h,u,p,y),h.flags|=262144}function Xd(u){for(u=u.firstContext;u!==null;){if(!zr(u.context._currentValue,u.memoizedValue))return!0;u=u.next}return!1}function su(u){eu=u,$o=null,u=u.dependencies,u!==null&&(u.firstContext=null)}function Vr(u){return $y(eu,u)}function Yd(u,h){return eu===null&&su(u),$y(u,h)}function $y(u,h){var p=h._currentValue;if(h={context:h,memoizedValue:p,next:null},$o===null){if(u===null)throw Error(s(308));$o=h,u.dependencies={lanes:0,firstContext:h},u.flags|=524288}else $o=$o.next=h;return p}var cw=typeof AbortController<"u"?AbortController:function(){var u=[],h=this.signal={aborted:!1,addEventListener:function(p,y){u.push(y)}};this.abort=function(){h.aborted=!0,u.forEach(function(p){return p()})}},hw=n.unstable_scheduleCallback,fw=n.unstable_NormalPriority,Ks={$$typeof:I,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Xc(){return{controller:new cw,data:new Map,refCount:0}}function wf(u){u.refCount--,u.refCount===0&&hw(fw,function(){u.controller.abort()})}var Sf=null,Zd=0,S=0,C=null;function $(u,h){if(Sf===null){var p=Sf=[];Zd=0,S=Zw(),C={status:"pending",value:void 0,then:function(y){p.push(y)}}}return Zd++,h.then(F,F),h}function F(){if(--Zd===0&&Sf!==null){C!==null&&(C.status="fulfilled");var u=Sf;Sf=null,S=0,C=null;for(var h=0;h<u.length;h++)(0,u[h])()}}function H(u,h){var p=[],y={status:"pending",value:null,reason:null,then:function(N){p.push(N)}};return u.then(function(){y.status="fulfilled",y.value=h;for(var N=0;N<p.length;N++)(0,p[N])(h)},function(N){for(y.status="rejected",y.reason=N,N=0;N<p.length;N++)(0,p[N])(void 0)}),y}var J=W.S;W.S=function(u,h){RT=zt(),typeof h=="object"&&h!==null&&typeof h.then=="function"&&$(u,h),J!==null&&J(u,h)};var Q=G(null);function re(){var u=Q.current;return u!==null?u:bs.pooledCache}function le(u,h){h===null?j(Q,Q.current):j(Q,h.pool)}function fe(){var u=re();return u===null?null:{parent:Ks._currentValue,pool:u}}var Se=Error(s(460)),Fe=Error(s(474)),he=Error(s(542)),Ae={then:function(){}};function Re(u){return u=u.status,u==="fulfilled"||u==="rejected"}function qe(u,h,p){switch(p=u[p],p===void 0?u.push(h):p!==h&&(h.then(Xi,Xi),h=p),h.status){case"fulfilled":return h.value;case"rejected":throw u=h.reason,it(u),u;default:if(typeof h.status=="string")h.then(Xi,Xi);else{if(u=bs,u!==null&&100<u.shellSuspendCounter)throw Error(s(482));u=h,u.status="pending",u.then(function(y){if(h.status==="pending"){var N=h;N.status="fulfilled",N.value=y}},function(y){if(h.status==="pending"){var N=h;N.status="rejected",N.reason=y}})}switch(h.status){case"fulfilled":return h.value;case"rejected":throw u=h.reason,it(u),u}throw Ge=h,Se}}function Oe(u){try{var h=u._init;return h(u._payload)}catch(p){throw p!==null&&typeof p=="object"&&typeof p.then=="function"?(Ge=p,Se):p}}var Ge=null;function Xe(){if(Ge===null)throw Error(s(459));var u=Ge;return Ge=null,u}function it(u){if(u===Se||u===he)throw Error(s(483))}var Qe=null,At=0;function gt(u){var h=At;return At+=1,Qe===null&&(Qe=[]),qe(Qe,u,h)}function rn(u,h){h=h.props.ref,u.ref=h!==void 0?h:null}function wt(u,h){throw h.$$typeof===m?Error(s(525)):(u=Object.prototype.toString.call(h),Error(s(31,u==="[object Object]"?"object with keys {"+Object.keys(h).join(", ")+"}":u)))}function Cn(u){function h(Ee,Te){if(u){var Me=Ee.deletions;Me===null?(Ee.deletions=[Te],Ee.flags|=16):Me.push(Te)}}function p(Ee,Te){if(!u)return null;for(;Te!==null;)h(Ee,Te),Te=Te.sibling;return null}function y(Ee){for(var Te=new Map;Ee!==null;)Ee.key!==null?Te.set(Ee.key,Ee):Te.set(Ee.index,Ee),Ee=Ee.sibling;return Te}function N(Ee,Te){return Ee=bi(Ee,Te),Ee.index=0,Ee.sibling=null,Ee}function T(Ee,Te,Me){return Ee.index=Me,u?(Me=Ee.alternate,Me!==null?(Me=Me.index,Me<Te?(Ee.flags|=67108866,Te):Me):(Ee.flags|=67108866,Te)):(Ee.flags|=1048576,Te)}function z(Ee){return u&&Ee.alternate===null&&(Ee.flags|=67108866),Ee}function ne(Ee,Te,Me,Ye){return Te===null||Te.tag!==6?(Te=xf(Me,Ee.mode,Ye),Te.return=Ee,Te):(Te=N(Te,Me),Te.return=Ee,Te)}function be(Ee,Te,Me,Ye){var Gt=Me.type;return Gt===x?He(Ee,Te,Me.props.children,Ye,Me.key):Te!==null&&(Te.elementType===Gt||typeof Gt=="object"&&Gt!==null&&Gt.$$typeof===P&&Oe(Gt)===Te.type)?(Te=N(Te,Me.props),rn(Te,Me),Te.return=Ee,Te):(Te=Wc(Me.type,Me.key,Me.props,null,Ee.mode,Ye),rn(Te,Me),Te.return=Ee,Te)}function ze(Ee,Te,Me,Ye){return Te===null||Te.tag!==4||Te.stateNode.containerInfo!==Me.containerInfo||Te.stateNode.implementation!==Me.implementation?(Te=Gc(Me,Ee.mode,Ye),Te.return=Ee,Te):(Te=N(Te,Me.children||[]),Te.return=Ee,Te)}function He(Ee,Te,Me,Ye,Gt){return Te===null||Te.tag!==7?(Te=Zl(Me,Ee.mode,Ye,Gt),Te.return=Ee,Te):(Te=N(Te,Me),Te.return=Ee,Te)}function Ze(Ee,Te,Me){if(typeof Te=="string"&&Te!==""||typeof Te=="number"||typeof Te=="bigint")return Te=xf(""+Te,Ee.mode,Me),Te.return=Ee,Te;if(typeof Te=="object"&&Te!==null){switch(Te.$$typeof){case g:return Me=Wc(Te.type,Te.key,Te.props,null,Ee.mode,Me),rn(Me,Te),Me.return=Ee,Me;case b:return Te=Gc(Te,Ee.mode,Me),Te.return=Ee,Te;case P:return Te=Oe(Te),Ze(Ee,Te,Me)}if(ae(Te)||M(Te))return Te=Zl(Te,Ee.mode,Me,null),Te.return=Ee,Te;if(typeof Te.then=="function")return Ze(Ee,gt(Te),Me);if(Te.$$typeof===I)return Ze(Ee,Yd(Ee,Te),Me);wt(Ee,Te)}return null}function Pe(Ee,Te,Me,Ye){var Gt=Te!==null?Te.key:null;if(typeof Me=="string"&&Me!==""||typeof Me=="number"||typeof Me=="bigint")return Gt!==null?null:ne(Ee,Te,""+Me,Ye);if(typeof Me=="object"&&Me!==null){switch(Me.$$typeof){case g:return Me.key===Gt?be(Ee,Te,Me,Ye):null;case b:return Me.key===Gt?ze(Ee,Te,Me,Ye):null;case P:return Me=Oe(Me),Pe(Ee,Te,Me,Ye)}if(ae(Me)||M(Me))return Gt!==null?null:He(Ee,Te,Me,Ye,null);if(typeof Me.then=="function")return Pe(Ee,Te,gt(Me),Ye);if(Me.$$typeof===I)return Pe(Ee,Te,Yd(Ee,Me),Ye);wt(Ee,Me)}return null}function Ue(Ee,Te,Me,Ye,Gt){if(typeof Ye=="string"&&Ye!==""||typeof Ye=="number"||typeof Ye=="bigint")return Ee=Ee.get(Me)||null,ne(Te,Ee,""+Ye,Gt);if(typeof Ye=="object"&&Ye!==null){switch(Ye.$$typeof){case g:return Ee=Ee.get(Ye.key===null?Me:Ye.key)||null,be(Te,Ee,Ye,Gt);case b:return Ee=Ee.get(Ye.key===null?Me:Ye.key)||null,ze(Te,Ee,Ye,Gt);case P:return Ye=Oe(Ye),Ue(Ee,Te,Me,Ye,Gt)}if(ae(Ye)||M(Ye))return Ee=Ee.get(Me)||null,He(Te,Ee,Ye,Gt,null);if(typeof Ye.then=="function")return Ue(Ee,Te,Me,gt(Ye),Gt);if(Ye.$$typeof===I)return Ue(Ee,Te,Me,Yd(Te,Ye),Gt);wt(Te,Ye)}return null}function kt(Ee,Te,Me,Ye){for(var Gt=null,qn=null,Dt=Te,yn=Te=0,Dn=null;Dt!==null&&yn<Me.length;yn++){Dt.index>yn?(Dn=Dt,Dt=null):Dn=Dt.sibling;var Hn=Pe(Ee,Dt,Me[yn],Ye);if(Hn===null){Dt===null&&(Dt=Dn);break}u&&Dt&&Hn.alternate===null&&h(Ee,Dt),Te=T(Hn,Te,yn),qn===null?Gt=Hn:qn.sibling=Hn,qn=Hn,Dt=Dn}if(yn===Me.length)return p(Ee,Dt),In&&ti(Ee,yn),Gt;if(Dt===null){for(;yn<Me.length;yn++)Dt=Ze(Ee,Me[yn],Ye),Dt!==null&&(Te=T(Dt,Te,yn),qn===null?Gt=Dt:qn.sibling=Dt,qn=Dt);return In&&ti(Ee,yn),Gt}for(Dt=y(Dt);yn<Me.length;yn++)Dn=Ue(Dt,Ee,yn,Me[yn],Ye),Dn!==null&&(u&&Dn.alternate!==null&&Dt.delete(Dn.key===null?yn:Dn.key),Te=T(Dn,Te,yn),qn===null?Gt=Dn:qn.sibling=Dn,qn=Dn);return u&&Dt.forEach(function(fh){return h(Ee,fh)}),In&&ti(Ee,yn),Gt}function Xt(Ee,Te,Me,Ye){if(Me==null)throw Error(s(151));for(var Gt=null,qn=null,Dt=Te,yn=Te=0,Dn=null,Hn=Me.next();Dt!==null&&!Hn.done;yn++,Hn=Me.next()){Dt.index>yn?(Dn=Dt,Dt=null):Dn=Dt.sibling;var fh=Pe(Ee,Dt,Hn.value,Ye);if(fh===null){Dt===null&&(Dt=Dn);break}u&&Dt&&fh.alternate===null&&h(Ee,Dt),Te=T(fh,Te,yn),qn===null?Gt=fh:qn.sibling=fh,qn=fh,Dt=Dn}if(Hn.done)return p(Ee,Dt),In&&ti(Ee,yn),Gt;if(Dt===null){for(;!Hn.done;yn++,Hn=Me.next())Hn=Ze(Ee,Hn.value,Ye),Hn!==null&&(Te=T(Hn,Te,yn),qn===null?Gt=Hn:qn.sibling=Hn,qn=Hn);return In&&ti(Ee,yn),Gt}for(Dt=y(Dt);!Hn.done;yn++,Hn=Me.next())Hn=Ue(Dt,Ee,yn,Hn.value,Ye),Hn!==null&&(u&&Hn.alternate!==null&&Dt.delete(Hn.key===null?yn:Hn.key),Te=T(Hn,Te,yn),qn===null?Gt=Hn:qn.sibling=Hn,qn=Hn);return u&&Dt.forEach(function(RM){return h(Ee,RM)}),In&&ti(Ee,yn),Gt}function ps(Ee,Te,Me,Ye){if(typeof Me=="object"&&Me!==null&&Me.type===x&&Me.key===null&&(Me=Me.props.children),typeof Me=="object"&&Me!==null){switch(Me.$$typeof){case g:e:{for(var Gt=Me.key;Te!==null;){if(Te.key===Gt){if(Gt=Me.type,Gt===x){if(Te.tag===7){p(Ee,Te.sibling),Ye=N(Te,Me.props.children),Ye.return=Ee,Ee=Ye;break e}}else if(Te.elementType===Gt||typeof Gt=="object"&&Gt!==null&&Gt.$$typeof===P&&Oe(Gt)===Te.type){p(Ee,Te.sibling),Ye=N(Te,Me.props),rn(Ye,Me),Ye.return=Ee,Ee=Ye;break e}p(Ee,Te);break}else h(Ee,Te);Te=Te.sibling}Me.type===x?(Ye=Zl(Me.props.children,Ee.mode,Ye,Me.key),Ye.return=Ee,Ee=Ye):(Ye=Wc(Me.type,Me.key,Me.props,null,Ee.mode,Ye),rn(Ye,Me),Ye.return=Ee,Ee=Ye)}return z(Ee);case b:e:{for(Gt=Me.key;Te!==null;){if(Te.key===Gt)if(Te.tag===4&&Te.stateNode.containerInfo===Me.containerInfo&&Te.stateNode.implementation===Me.implementation){p(Ee,Te.sibling),Ye=N(Te,Me.children||[]),Ye.return=Ee,Ee=Ye;break e}else{p(Ee,Te);break}else h(Ee,Te);Te=Te.sibling}Ye=Gc(Me,Ee.mode,Ye),Ye.return=Ee,Ee=Ye}return z(Ee);case P:return Me=Oe(Me),ps(Ee,Te,Me,Ye)}if(ae(Me))return kt(Ee,Te,Me,Ye);if(M(Me)){if(Gt=M(Me),typeof Gt!="function")throw Error(s(150));return Me=Gt.call(Me),Xt(Ee,Te,Me,Ye)}if(typeof Me.then=="function")return ps(Ee,Te,gt(Me),Ye);if(Me.$$typeof===I)return ps(Ee,Te,Yd(Ee,Me),Ye);wt(Ee,Me)}return typeof Me=="string"&&Me!==""||typeof Me=="number"||typeof Me=="bigint"?(Me=""+Me,Te!==null&&Te.tag===6?(p(Ee,Te.sibling),Ye=N(Te,Me),Ye.return=Ee,Ee=Ye):(p(Ee,Te),Ye=xf(Me,Ee.mode,Ye),Ye.return=Ee,Ee=Ye),z(Ee)):p(Ee,Te)}return function(Ee,Te,Me,Ye){try{At=0;var Gt=ps(Ee,Te,Me,Ye);return Qe=null,Gt}catch(Dt){if(Dt===Se||Dt===he)throw Dt;var qn=na(29,Dt,null,Ee.mode);return qn.lanes=Ye,qn.return=Ee,qn}finally{}}}var ys=Cn(!0),cn=Cn(!1),yt=!1;function ut(u){u.updateQueue={baseState:u.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function As(u,h){u=u.updateQueue,h.updateQueue===u&&(h.updateQueue={baseState:u.baseState,firstBaseUpdate:u.firstBaseUpdate,lastBaseUpdate:u.lastBaseUpdate,shared:u.shared,callbacks:null})}function Ht(u){return{lane:u,tag:0,payload:null,callback:null,next:null}}function pn(u,h,p){var y=u.updateQueue;if(y===null)return null;if(y=y.shared,(Zn&2)!==0){var N=y.pending;return N===null?h.next=h:(h.next=N.next,N.next=h),y.pending=h,h=ta(u),yf(u,null,p),h}return gf(u,y,h,p),ta(u)}function Xn(u,h,p){if(h=h.updateQueue,h!==null&&(h=h.shared,(p&4194048)!==0)){var y=h.lanes;y&=u.pendingLanes,p|=y,h.lanes=p,Ga(u,p)}}function gr(u,h){var p=u.updateQueue,y=u.alternate;if(y!==null&&(y=y.updateQueue,p===y)){var N=null,T=null;if(p=p.firstBaseUpdate,p!==null){do{var z={lane:p.lane,tag:p.tag,payload:p.payload,callback:null,next:null};T===null?N=T=z:T=T.next=z,p=p.next}while(p!==null);T===null?N=T=h:T=T.next=h}else N=T=h;p={baseState:y.baseState,firstBaseUpdate:N,lastBaseUpdate:T,shared:y.shared,callbacks:y.callbacks},u.updateQueue=p;return}u=p.lastBaseUpdate,u===null?p.firstBaseUpdate=h:u.next=h,p.lastBaseUpdate=h}var jr=!1;function hs(){if(jr){var u=C;if(u!==null)throw u}}function tr(u,h,p,y){jr=!1;var N=u.updateQueue;yt=!1;var T=N.firstBaseUpdate,z=N.lastBaseUpdate,ne=N.shared.pending;if(ne!==null){N.shared.pending=null;var be=ne,ze=be.next;be.next=null,z===null?T=ze:z.next=ze,z=be;var He=u.alternate;He!==null&&(He=He.updateQueue,ne=He.lastBaseUpdate,ne!==z&&(ne===null?He.firstBaseUpdate=ze:ne.next=ze,He.lastBaseUpdate=be))}if(T!==null){var Ze=N.baseState;z=0,He=ze=be=null,ne=T;do{var Pe=ne.lane&-536870913,Ue=Pe!==ne.lane;if(Ue?(Rn&Pe)===Pe:(y&Pe)===Pe){Pe!==0&&Pe===S&&(jr=!0),He!==null&&(He=He.next={lane:0,tag:ne.tag,payload:ne.payload,callback:null,next:null});e:{var kt=u,Xt=ne;Pe=h;var ps=p;switch(Xt.tag){case 1:if(kt=Xt.payload,typeof kt=="function"){Ze=kt.call(ps,Ze,Pe);break e}Ze=kt;break e;case 3:kt.flags=kt.flags&-65537|128;case 0:if(kt=Xt.payload,Pe=typeof kt=="function"?kt.call(ps,Ze,Pe):kt,Pe==null)break e;Ze=d({},Ze,Pe);break e;case 2:yt=!0}}Pe=ne.callback,Pe!==null&&(u.flags|=64,Ue&&(u.flags|=8192),Ue=N.callbacks,Ue===null?N.callbacks=[Pe]:Ue.push(Pe))}else Ue={lane:Pe,tag:ne.tag,payload:ne.payload,callback:ne.callback,next:null},He===null?(ze=He=Ue,be=Ze):He=He.next=Ue,z|=Pe;if(ne=ne.next,ne===null){if(ne=N.shared.pending,ne===null)break;Ue=ne,ne=Ue.next,Ue.next=null,N.lastBaseUpdate=Ue,N.shared.pending=null}}while(!0);He===null&&(be=Ze),N.baseState=be,N.firstBaseUpdate=ze,N.lastBaseUpdate=He,T===null&&(N.shared.lanes=0),nh|=z,u.lanes=z,u.memoizedState=Ze}}function sa(u,h){if(typeof u!="function")throw Error(s(191,u));u.call(h)}function nr(u,h){var p=u.callbacks;if(p!==null)for(u.callbacks=null,u=0;u<p.length;u++)sa(p[u],h)}var wn=G(null),Pn=G(0);function Is(u,h){u=rc,j(Pn,u),j(wn,h),rc=u|h.baseLanes}function Gn(){j(Pn,rc),j(wn,wn.current)}function yr(){rc=Pn.current,O(wn),O(Pn)}var Es=G(null),Bn=null;function Xs(u){var h=u.alternate;j(Mn,Mn.current&1),j(Es,u),Bn===null&&(h===null||wn.current!==null||h.memoizedState!==null)&&(Bn=u)}function Yn(u){j(Mn,Mn.current),j(Es,u),Bn===null&&(Bn=u)}function sr(u){u.tag===22?(j(Mn,Mn.current),j(Es,u),Bn===null&&(Bn=u)):rr()}function rr(){j(Mn,Mn.current),j(Es,Es.current)}function ns(u){O(Es),Bn===u&&(Bn=null),O(Mn)}var Mn=G(0);function ra(u){for(var h=u;h!==null;){if(h.tag===13){var p=h.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||u5(p)||c5(p)))return h}else if(h.tag===19&&(h.memoizedProps.revealOrder==="forwards"||h.memoizedProps.revealOrder==="backwards"||h.memoizedProps.revealOrder==="unstable_legacy-backwards"||h.memoizedProps.revealOrder==="together")){if((h.flags&128)!==0)return h}else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===u)break;for(;h.sibling===null;){if(h.return===null||h.return===u)return null;h=h.return}h.sibling.return=h.return,h=h.sibling}return null}var Ls=0,Bt=null,Wt=null,Un=null,$a=!1,Ci=!1,Sa=!1,ar=0,ru=0,au=null,Jd=0;function fs(){throw Error(s(321))}function wg(u,h){if(h===null)return!1;for(var p=0;p<h.length&&p<u.length;p++)if(!zr(u[p],h[p]))return!1;return!0}function Sg(u,h,p,y,N,T){return Ls=T,Bt=h,h.memoizedState=null,h.updateQueue=null,h.lanes=0,W.H=u===null||u.memoizedState===null?jC:vw,Sa=!1,T=p(y,N),Sa=!1,Ci&&(T=yl(h,p,y,N)),Qd(u),T}function Qd(u){W.H=_g;var h=Wt!==null&&Wt.next!==null;if(Ls=0,Un=Wt=Bt=null,$a=!1,ru=0,au=null,h)throw Error(s(300));u===null||Ir||(u=u.dependencies,u!==null&&Xd(u)&&(Ir=!0))}function yl(u,h,p,y){Bt=u;var N=0;do{if(Ci&&(au=null),ru=0,Ci=!1,25<=N)throw Error(s(301));if(N+=1,Un=Wt=null,u.updateQueue!=null){var T=u.updateQueue;T.lastEffect=null,T.events=null,T.stores=null,T.memoCache!=null&&(T.memoCache.index=0)}W.H=WC,T=h(p,y)}while(Ci);return T}function dw(){var u=W.H,h=u.useState()[0];return h=typeof h.then=="function"?iu(h):h,u=u.useState()[0],(Wt!==null?Wt.memoizedState:null)!==u&&(Bt.flags|=1024),h}function Ng(){var u=ar!==0;return ar=0,u}function kg(u,h,p){h.updateQueue=u.updateQueue,h.flags&=-2053,u.lanes&=~p}function ep(u){if($a){for(u=u.memoizedState;u!==null;){var h=u.queue;h!==null&&(h.pending=null),u=u.next}$a=!1}Ls=0,Un=Wt=Bt=null,Ci=!1,ru=ar=0,au=null}function Ar(){var u={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Un===null?Bt.memoizedState=Un=u:Un=Un.next=u,Un}function Fs(){if(Wt===null){var u=Bt.alternate;u=u!==null?u.memoizedState:null}else u=Wt.next;var h=Un===null?Bt.memoizedState:Un.next;if(h!==null)Un=h,Wt=u;else{if(u===null)throw Bt.alternate===null?Error(s(467)):Error(s(310));Wt=u,u={memoizedState:Wt.memoizedState,baseState:Wt.baseState,baseQueue:Wt.baseQueue,queue:Wt.queue,next:null},Un===null?Bt.memoizedState=Un=u:Un=Un.next=u}return Un}function Nf(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function iu(u){var h=ru;return ru+=1,au===null&&(au=[]),u=qe(au,u,h),h=Bt,(Un===null?h.memoizedState:Un.next)===null&&(h=h.alternate,W.H=h===null||h.memoizedState===null?jC:vw),u}function Yc(u){if(u!==null&&typeof u=="object"){if(typeof u.then=="function")return iu(u);if(u.$$typeof===I)return Vr(u)}throw Error(s(438,String(u)))}function Xu(u){var h=null,p=Bt.updateQueue;if(p!==null&&(h=p.memoCache),h==null){var y=Bt.alternate;y!==null&&(y=y.updateQueue,y!==null&&(y=y.memoCache,y!=null&&(h={data:y.data.map(function(N){return N.slice()}),index:0})))}if(h==null&&(h={data:[],index:0}),p===null&&(p=Nf(),Bt.updateQueue=p),p.memoCache=h,p=h.data[h.index],p===void 0)for(p=h.data[h.index]=Array(u),y=0;y<u;y++)p[y]=B;return h.index++,p}function Ro(u,h){return typeof h=="function"?h(u):h}function tp(u){var h=Fs();return Zc(h,Wt,u)}function Zc(u,h,p){var y=u.queue;if(y===null)throw Error(s(311));y.lastRenderedReducer=p;var N=u.baseQueue,T=y.pending;if(T!==null){if(N!==null){var z=N.next;N.next=T.next,T.next=z}h.baseQueue=N=T,y.pending=null}if(T=u.baseState,N===null)u.memoizedState=T;else{h=N.next;var ne=z=null,be=null,ze=h,He=!1;do{var Ze=ze.lane&-536870913;if(Ze!==ze.lane?(Rn&Ze)===Ze:(Ls&Ze)===Ze){var Pe=ze.revertLane;if(Pe===0)be!==null&&(be=be.next={lane:0,revertLane:0,gesture:null,action:ze.action,hasEagerState:ze.hasEagerState,eagerState:ze.eagerState,next:null}),Ze===S&&(He=!0);else if((Ls&Pe)===Pe){ze=ze.next,Pe===S&&(He=!0);continue}else Ze={lane:0,revertLane:ze.revertLane,gesture:null,action:ze.action,hasEagerState:ze.hasEagerState,eagerState:ze.eagerState,next:null},be===null?(ne=be=Ze,z=T):be=be.next=Ze,Bt.lanes|=Pe,nh|=Pe;Ze=ze.action,Sa&&p(T,Ze),T=ze.hasEagerState?ze.eagerState:p(T,Ze)}else Pe={lane:Ze,revertLane:ze.revertLane,gesture:ze.gesture,action:ze.action,hasEagerState:ze.hasEagerState,eagerState:ze.eagerState,next:null},be===null?(ne=be=Pe,z=T):be=be.next=Pe,Bt.lanes|=Ze,nh|=Ze;ze=ze.next}while(ze!==null&&ze!==h);if(be===null?z=T:be.next=ne,!zr(T,u.memoizedState)&&(Ir=!0,He&&(p=C,p!==null)))throw p;u.memoizedState=T,u.baseState=z,u.baseQueue=be,y.lastRenderedState=T}return N===null&&(y.lanes=0),[u.memoizedState,y.dispatch]}function np(u){var h=Fs(),p=h.queue;if(p===null)throw Error(s(311));p.lastRenderedReducer=u;var y=p.dispatch,N=p.pending,T=h.memoizedState;if(N!==null){p.pending=null;var z=N=N.next;do T=u(T,z.action),z=z.next;while(z!==N);zr(T,h.memoizedState)||(Ir=!0),h.memoizedState=T,h.baseQueue===null&&(h.baseState=T),p.lastRenderedState=T}return[T,y]}function sp(u,h,p){var y=Bt,N=Fs(),T=In;if(T){if(p===void 0)throw Error(s(407));p=p()}else p=h();var z=!zr((Wt||N).memoizedState,p);if(z&&(N.memoizedState=p,Ir=!0),N=N.queue,pw(Tg.bind(null,y,N,u),[u]),N.getSnapshot!==h||z||Un!==null&&Un.memoizedState.tag&1){if(y.flags|=2048,Zu(9,{destroy:void 0},Cg.bind(null,y,N,p,h),null),bs===null)throw Error(s(349));T||(Ls&127)!==0||bl(y,h,p)}return p}function bl(u,h,p){u.flags|=16384,u={getSnapshot:h,value:p},h=Bt.updateQueue,h===null?(h=Nf(),Bt.updateQueue=h,h.stores=[u]):(p=h.stores,p===null?h.stores=[u]:p.push(u))}function Cg(u,h,p,y){h.value=p,h.getSnapshot=y,Ry(h)&&Ag(u)}function Tg(u,h,p){return p(function(){Ry(h)&&Ag(u)})}function Ry(u){var h=u.getSnapshot;u=u.value;try{var p=h();return!zr(u,p)}catch{return!0}}function Ag(u){var h=ml(u,2);h!==null&&_i(h,u,2)}function ou(u){var h=Ar();if(typeof u=="function"){var p=u;if(u=p(),Sa){Zt(!0);try{p()}finally{Zt(!1)}}}return h.memoizedState=h.baseState=u,h.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ro,lastRenderedState:u},h}function Dy(u,h,p,y){return u.baseState=p,Zc(u,Wt,typeof y=="function"?y:Ro)}function Oy(u,h,p,y,N){if(zy(u))throw Error(s(485));if(u=h.action,u!==null){var T={payload:N,action:u,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(z){T.listeners.push(z)}};W.T!==null?p(!0):T.isTransition=!1,y(T),p=h.pending,p===null?(T.next=h.pending=T,Ly(h,T)):(T.next=p.next,h.pending=p.next=T)}}function Ly(u,h){var p=h.action,y=h.payload,N=u.state;if(h.isTransition){var T=W.T,z={};W.T=z;try{var ne=p(N,y),be=W.S;be!==null&&be(z,ne),Ig(u,h,ne)}catch(ze){Yu(u,h,ze)}finally{T!==null&&z.types!==null&&(T.types=z.types),W.T=T}}else try{T=p(N,y),Ig(u,h,T)}catch(ze){Yu(u,h,ze)}}function Ig(u,h,p){p!==null&&typeof p=="object"&&typeof p.then=="function"?p.then(function(y){Fy(u,h,y)},function(y){return Yu(u,h,y)}):Fy(u,h,p)}function Fy(u,h,p){h.status="fulfilled",h.value=p,rp(h),u.state=p,h=u.pending,h!==null&&(p=h.next,p===h?u.pending=null:(p=p.next,h.next=p,Ly(u,p)))}function Yu(u,h,p){var y=u.pending;if(u.pending=null,y!==null){y=y.next;do h.status="rejected",h.reason=p,rp(h),h=h.next;while(h!==y)}u.action=null}function rp(u){u=u.listeners;for(var h=0;h<u.length;h++)(0,u[h])()}function kf(u,h){return h}function Do(u,h){if(In){var p=bs.formState;if(p!==null){e:{var y=Bt;if(In){if(gs){t:{for(var N=gs,T=Os;N.nodeType!==8;){if(!T){N=null;break t}if(N=Oo(N.nextSibling),N===null){N=null;break t}}T=N.data,N=T==="F!"||T==="F"?N:null}if(N){gs=Oo(N.nextSibling),y=N.data==="F!";break e}}Ql(y)}y=!1}y&&(h=p[0])}}return p=Ar(),p.memoizedState=p.baseState=h,y={pending:null,lanes:0,dispatch:null,lastRenderedReducer:kf,lastRenderedState:h},p.queue=y,p=BC.bind(null,Bt,y),y.dispatch=p,y=ou(!1),T=xw.bind(null,Bt,!1,y.queue),y=Ar(),N={state:h,dispatch:null,action:u,pending:null},y.queue=N,p=Oy.bind(null,Bt,N,T,p),N.dispatch=p,y.memoizedState=u,[h,p,!1]}function xl(u){var h=Fs();return vl(h,Wt,u)}function vl(u,h,p){if(h=Zc(u,h,kf)[0],u=tp(Ro)[0],typeof h=="object"&&h!==null&&typeof h.then=="function")try{var y=iu(h)}catch(z){throw z===Se?he:z}else y=h;h=Fs();var N=h.queue,T=N.dispatch;return p!==h.memoizedState&&(Bt.flags|=2048,Zu(9,{destroy:void 0},ap.bind(null,N,p),null)),[y,T,u]}function ap(u,h){u.action=h}function ip(u){var h=Fs(),p=Wt;if(p!==null)return vl(h,p,u);Fs(),h=h.memoizedState,p=Fs();var y=p.queue.dispatch;return p.memoizedState=u,[h,y,!1]}function Zu(u,h,p,y){return u={tag:u,create:p,deps:y,inst:h,next:null},h=Bt.updateQueue,h===null&&(h=Nf(),Bt.updateQueue=h),p=h.lastEffect,p===null?h.lastEffect=u.next=u:(y=p.next,p.next=u,u.next=y,h.lastEffect=u),u}function My(){return Fs().memoizedState}function Jc(u,h,p,y){var N=Ar();Bt.flags|=u,N.memoizedState=Zu(1|h,{destroy:void 0},p,y===void 0?null:y)}function Qc(u,h,p,y){var N=Fs();y=y===void 0?null:y;var T=N.memoizedState.inst;Wt!==null&&y!==null&&wg(y,Wt.memoizedState.deps)?N.memoizedState=Zu(h,T,p,y):(Bt.flags|=u,N.memoizedState=Zu(1|h,T,p,y))}function TC(u,h){Jc(8390656,8,u,h)}function pw(u,h){Qc(2048,8,u,h)}function T8(u){Bt.flags|=4;var h=Bt.updateQueue;if(h===null)h=Nf(),Bt.updateQueue=h,h.events=[u];else{var p=h.events;p===null?h.events=[u]:p.push(u)}}function AC(u){var h=Fs().memoizedState;return T8({ref:h,nextImpl:u}),function(){if((Zn&2)!==0)throw Error(s(440));return h.impl.apply(void 0,arguments)}}function IC(u,h){return Qc(4,2,u,h)}function EC(u,h){return Qc(4,4,u,h)}function _C(u,h){if(typeof h=="function"){u=u();var p=h(u);return function(){typeof p=="function"?p():h(null)}}if(h!=null)return u=u(),h.current=u,function(){h.current=null}}function $C(u,h,p){p=p!=null?p.concat([u]):null,Qc(4,4,_C.bind(null,h,u),p)}function mw(){}function RC(u,h){var p=Fs();h=h===void 0?null:h;var y=p.memoizedState;return h!==null&&wg(h,y[1])?y[0]:(p.memoizedState=[u,h],u)}function DC(u,h){var p=Fs();h=h===void 0?null:h;var y=p.memoizedState;if(h!==null&&wg(h,y[1]))return y[0];if(y=u(),Sa){Zt(!0);try{u()}finally{Zt(!1)}}return p.memoizedState=[y,h],y}function gw(u,h,p){return p===void 0||(Ls&1073741824)!==0&&(Rn&261930)===0?u.memoizedState=h:(u.memoizedState=p,u=OT(),Bt.lanes|=u,nh|=u,p)}function OC(u,h,p,y){return zr(p,h)?p:wn.current!==null?(u=gw(u,p,y),zr(u,h)||(Ir=!0),u):(Ls&42)===0||(Ls&1073741824)!==0&&(Rn&261930)===0?(Ir=!0,u.memoizedState=p):(u=OT(),Bt.lanes|=u,nh|=u,h)}function LC(u,h,p,y,N){var T=se.p;se.p=T!==0&&8>T?T:8;var z=W.T,ne={};W.T=ne,xw(u,!1,h,p);try{var be=N(),ze=W.S;if(ze!==null&&ze(ne,be),be!==null&&typeof be=="object"&&typeof be.then=="function"){var He=H(be,y);Eg(u,h,He,ro(u))}else Eg(u,h,y,ro(u))}catch(Ze){Eg(u,h,{then:function(){},status:"rejected",reason:Ze},ro())}finally{se.p=T,z!==null&&ne.types!==null&&(z.types=ne.types),W.T=z}}function A8(){}function yw(u,h,p,y){if(u.tag!==5)throw Error(s(476));var N=FC(u).queue;LC(u,N,h,ee,p===null?A8:function(){return MC(u),p(y)})}function FC(u){var h=u.memoizedState;if(h!==null)return h;h={memoizedState:ee,baseState:ee,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ro,lastRenderedState:ee},next:null};var p={};return h.next={memoizedState:p,baseState:p,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ro,lastRenderedState:p},next:null},u.memoizedState=h,u=u.alternate,u!==null&&(u.memoizedState=h),h}function MC(u){var h=FC(u);h.next===null&&(h=u.alternate.memoizedState),Eg(u,h.next.queue,{},ro())}function bw(){return Vr(qg)}function zC(){return Fs().memoizedState}function PC(){return Fs().memoizedState}function I8(u){for(var h=u.return;h!==null;){switch(h.tag){case 24:case 3:var p=ro();u=Ht(p);var y=pn(h,u,p);y!==null&&(_i(y,h,p),Xn(y,h,p)),h={cache:Xc()},u.payload=h;return}h=h.return}}function E8(u,h,p){var y=ro();p={lane:y,revertLane:0,gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null},zy(u)?UC(h,p):(p=Ud(u,h,p,y),p!==null&&(_i(p,u,y),VC(p,h,y)))}function BC(u,h,p){var y=ro();Eg(u,h,p,y)}function Eg(u,h,p,y){var N={lane:y,revertLane:0,gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null};if(zy(u))UC(h,N);else{var T=u.alternate;if(u.lanes===0&&(T===null||T.lanes===0)&&(T=h.lastRenderedReducer,T!==null))try{var z=h.lastRenderedState,ne=T(z,p);if(N.hasEagerState=!0,N.eagerState=ne,zr(ne,z))return gf(u,h,N,0),bs===null&&mf(),!1}catch{}finally{}if(p=Ud(u,h,N,y),p!==null)return _i(p,u,y),VC(p,h,y),!0}return!1}function xw(u,h,p,y){if(y={lane:2,revertLane:Zw(),gesture:null,action:y,hasEagerState:!1,eagerState:null,next:null},zy(u)){if(h)throw Error(s(479))}else h=Ud(u,p,y,2),h!==null&&_i(h,u,2)}function zy(u){var h=u.alternate;return u===Bt||h!==null&&h===Bt}function UC(u,h){Ci=$a=!0;var p=u.pending;p===null?h.next=h:(h.next=p.next,p.next=h),u.pending=h}function VC(u,h,p){if((p&4194048)!==0){var y=h.lanes;y&=u.pendingLanes,p|=y,h.lanes=p,Ga(u,p)}}var _g={readContext:Vr,use:Yc,useCallback:fs,useContext:fs,useEffect:fs,useImperativeHandle:fs,useLayoutEffect:fs,useInsertionEffect:fs,useMemo:fs,useReducer:fs,useRef:fs,useState:fs,useDebugValue:fs,useDeferredValue:fs,useTransition:fs,useSyncExternalStore:fs,useId:fs,useHostTransitionStatus:fs,useFormState:fs,useActionState:fs,useOptimistic:fs,useMemoCache:fs,useCacheRefresh:fs};_g.useEffectEvent=fs;var jC={readContext:Vr,use:Yc,useCallback:function(u,h){return Ar().memoizedState=[u,h===void 0?null:h],u},useContext:Vr,useEffect:TC,useImperativeHandle:function(u,h,p){p=p!=null?p.concat([u]):null,Jc(4194308,4,_C.bind(null,h,u),p)},useLayoutEffect:function(u,h){return Jc(4194308,4,u,h)},useInsertionEffect:function(u,h){Jc(4,2,u,h)},useMemo:function(u,h){var p=Ar();h=h===void 0?null:h;var y=u();if(Sa){Zt(!0);try{u()}finally{Zt(!1)}}return p.memoizedState=[y,h],y},useReducer:function(u,h,p){var y=Ar();if(p!==void 0){var N=p(h);if(Sa){Zt(!0);try{p(h)}finally{Zt(!1)}}}else N=h;return y.memoizedState=y.baseState=N,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:u,lastRenderedState:N},y.queue=u,u=u.dispatch=E8.bind(null,Bt,u),[y.memoizedState,u]},useRef:function(u){var h=Ar();return u={current:u},h.memoizedState=u},useState:function(u){u=ou(u);var h=u.queue,p=BC.bind(null,Bt,h);return h.dispatch=p,[u.memoizedState,p]},useDebugValue:mw,useDeferredValue:function(u,h){var p=Ar();return gw(p,u,h)},useTransition:function(){var u=ou(!1);return u=LC.bind(null,Bt,u.queue,!0,!1),Ar().memoizedState=u,[!1,u]},useSyncExternalStore:function(u,h,p){var y=Bt,N=Ar();if(In){if(p===void 0)throw Error(s(407));p=p()}else{if(p=h(),bs===null)throw Error(s(349));(Rn&127)!==0||bl(y,h,p)}N.memoizedState=p;var T={value:p,getSnapshot:h};return N.queue=T,TC(Tg.bind(null,y,T,u),[u]),y.flags|=2048,Zu(9,{destroy:void 0},Cg.bind(null,y,T,p,h),null),p},useId:function(){var u=Ar(),h=bs.identifierPrefix;if(In){var p=Ni,y=Si;p=(y&~(1<<32-kn(y)-1)).toString(32)+p,h="_"+h+"R_"+p,p=ar++,0<p&&(h+="H"+p.toString(32)),h+="_"}else p=Jd++,h="_"+h+"r_"+p.toString(32)+"_";return u.memoizedState=h},useHostTransitionStatus:bw,useFormState:Do,useActionState:Do,useOptimistic:function(u){var h=Ar();h.memoizedState=h.baseState=u;var p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return h.queue=p,h=xw.bind(null,Bt,!0,p),p.dispatch=h,[u,h]},useMemoCache:Xu,useCacheRefresh:function(){return Ar().memoizedState=I8.bind(null,Bt)},useEffectEvent:function(u){var h=Ar(),p={impl:u};return h.memoizedState=p,function(){if((Zn&2)!==0)throw Error(s(440));return p.impl.apply(void 0,arguments)}}},vw={readContext:Vr,use:Yc,useCallback:RC,useContext:Vr,useEffect:pw,useImperativeHandle:$C,useInsertionEffect:IC,useLayoutEffect:EC,useMemo:DC,useReducer:tp,useRef:My,useState:function(){return tp(Ro)},useDebugValue:mw,useDeferredValue:function(u,h){var p=Fs();return OC(p,Wt.memoizedState,u,h)},useTransition:function(){var u=tp(Ro)[0],h=Fs().memoizedState;return[typeof u=="boolean"?u:iu(u),h]},useSyncExternalStore:sp,useId:zC,useHostTransitionStatus:bw,useFormState:xl,useActionState:xl,useOptimistic:function(u,h){var p=Fs();return Dy(p,Wt,u,h)},useMemoCache:Xu,useCacheRefresh:PC};vw.useEffectEvent=AC;var WC={readContext:Vr,use:Yc,useCallback:RC,useContext:Vr,useEffect:pw,useImperativeHandle:$C,useInsertionEffect:IC,useLayoutEffect:EC,useMemo:DC,useReducer:np,useRef:My,useState:function(){return np(Ro)},useDebugValue:mw,useDeferredValue:function(u,h){var p=Fs();return Wt===null?gw(p,u,h):OC(p,Wt.memoizedState,u,h)},useTransition:function(){var u=np(Ro)[0],h=Fs().memoizedState;return[typeof u=="boolean"?u:iu(u),h]},useSyncExternalStore:sp,useId:zC,useHostTransitionStatus:bw,useFormState:ip,useActionState:ip,useOptimistic:function(u,h){var p=Fs();return Wt!==null?Dy(p,Wt,u,h):(p.baseState=u,[u,p.queue.dispatch])},useMemoCache:Xu,useCacheRefresh:PC};WC.useEffectEvent=AC;function ww(u,h,p,y){h=u.memoizedState,p=p(y,h),p=p==null?h:d({},h,p),u.memoizedState=p,u.lanes===0&&(u.updateQueue.baseState=p)}var Sw={enqueueSetState:function(u,h,p){u=u._reactInternals;var y=ro(),N=Ht(y);N.payload=h,p!=null&&(N.callback=p),h=pn(u,N,y),h!==null&&(_i(h,u,y),Xn(h,u,y))},enqueueReplaceState:function(u,h,p){u=u._reactInternals;var y=ro(),N=Ht(y);N.tag=1,N.payload=h,p!=null&&(N.callback=p),h=pn(u,N,y),h!==null&&(_i(h,u,y),Xn(h,u,y))},enqueueForceUpdate:function(u,h){u=u._reactInternals;var p=ro(),y=Ht(p);y.tag=2,h!=null&&(y.callback=h),h=pn(u,y,p),h!==null&&(_i(h,u,p),Xn(h,u,p))}};function GC(u,h,p,y,N,T,z){return u=u.stateNode,typeof u.shouldComponentUpdate=="function"?u.shouldComponentUpdate(y,T,z):h.prototype&&h.prototype.isPureReactComponent?!hl(p,y)||!hl(N,T):!0}function qC(u,h,p,y){u=h.state,typeof h.componentWillReceiveProps=="function"&&h.componentWillReceiveProps(p,y),typeof h.UNSAFE_componentWillReceiveProps=="function"&&h.UNSAFE_componentWillReceiveProps(p,y),h.state!==u&&Sw.enqueueReplaceState(h,h.state,null)}function Cf(u,h){var p=h;if("ref"in h){p={};for(var y in h)y!=="ref"&&(p[y]=h[y])}if(u=u.defaultProps){p===h&&(p=d({},p));for(var N in u)p[N]===void 0&&(p[N]=u[N])}return p}function HC(u){pf(u)}function KC(u){console.error(u)}function XC(u){pf(u)}function Py(u,h){try{var p=u.onUncaughtError;p(h.value,{componentStack:h.stack})}catch(y){setTimeout(function(){throw y})}}function YC(u,h,p){try{var y=u.onCaughtError;y(p.value,{componentStack:p.stack,errorBoundary:h.tag===1?h.stateNode:null})}catch(N){setTimeout(function(){throw N})}}function Nw(u,h,p){return p=Ht(p),p.tag=3,p.payload={element:null},p.callback=function(){Py(u,h)},p}function ZC(u){return u=Ht(u),u.tag=3,u}function JC(u,h,p,y){var N=p.type.getDerivedStateFromError;if(typeof N=="function"){var T=y.value;u.payload=function(){return N(T)},u.callback=function(){YC(h,p,y)}}var z=p.stateNode;z!==null&&typeof z.componentDidCatch=="function"&&(u.callback=function(){YC(h,p,y),typeof N!="function"&&(sh===null?sh=new Set([this]):sh.add(this));var ne=y.stack;this.componentDidCatch(y.value,{componentStack:ne!==null?ne:""})})}function _8(u,h,p,y,N){if(p.flags|=32768,y!==null&&typeof y=="object"&&typeof y.then=="function"){if(h=p.alternate,h!==null&&nu(h,p,N,!0),p=Es.current,p!==null){switch(p.tag){case 31:case 13:return Bn===null?Zy():p.alternate===null&&ir===0&&(ir=3),p.flags&=-257,p.flags|=65536,p.lanes=N,y===Ae?p.flags|=16384:(h=p.updateQueue,h===null?p.updateQueue=new Set([y]):h.add(y),Kw(u,y,N)),!1;case 22:return p.flags|=65536,y===Ae?p.flags|=16384:(h=p.updateQueue,h===null?(h={transitions:null,markerInstances:null,retryQueue:new Set([y])},p.updateQueue=h):(p=h.retryQueue,p===null?h.retryQueue=new Set([y]):p.add(y)),Kw(u,y,N)),!1}throw Error(s(435,p.tag))}return Kw(u,y,N),Zy(),!1}if(In)return h=Es.current,h!==null?((h.flags&65536)===0&&(h.flags|=256),h.flags|=65536,h.lanes=N,y!==to&&(u=Error(s(422),{cause:y}),Hc(xi(u,p)))):(y!==to&&(h=Error(s(423),{cause:y}),Hc(xi(h,p))),u=u.current.alternate,u.flags|=65536,N&=-N,u.lanes|=N,y=xi(y,p),N=Nw(u.stateNode,y,N),gr(u,N),ir!==4&&(ir=2)),!1;var T=Error(s(520),{cause:y});if(T=xi(T,p),zg===null?zg=[T]:zg.push(T),ir!==4&&(ir=2),h===null)return!0;y=xi(y,p),p=h;do{switch(p.tag){case 3:return p.flags|=65536,u=N&-N,p.lanes|=u,u=Nw(p.stateNode,y,u),gr(p,u),!1;case 1:if(h=p.type,T=p.stateNode,(p.flags&128)===0&&(typeof h.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(sh===null||!sh.has(T))))return p.flags|=65536,N&=-N,p.lanes|=N,N=ZC(N),JC(N,u,p,y),gr(p,N),!1}p=p.return}while(p!==null);return!1}var kw=Error(s(461)),Ir=!1;function Na(u,h,p,y){h.child=u===null?cn(h,null,p,y):ys(h,u.child,p,y)}function QC(u,h,p,y,N){p=p.render;var T=h.ref;if("ref"in y){var z={};for(var ne in y)ne!=="ref"&&(z[ne]=y[ne])}else z=y;return su(h),y=Sg(u,h,p,z,T,N),ne=Ng(),u!==null&&!Ir?(kg(u,h,N),Ju(u,h,N)):(In&&ne&&bg(h),h.flags|=1,Na(u,h,y,N),h.child)}function eT(u,h,p,y,N){if(u===null){var T=p.type;return typeof T=="function"&&!jd(T)&&T.defaultProps===void 0&&p.compare===null?(h.tag=15,h.type=T,tT(u,h,T,y,N)):(u=Wc(p.type,null,y,h,h.mode,N),u.ref=h.ref,u.return=h,h.child=u)}if(T=u.child,!Rw(u,N)){var z=T.memoizedProps;if(p=p.compare,p=p!==null?p:hl,p(z,y)&&u.ref===h.ref)return Ju(u,h,N)}return h.flags|=1,u=bi(T,y),u.ref=h.ref,u.return=h,h.child=u}function tT(u,h,p,y,N){if(u!==null){var T=u.memoizedProps;if(hl(T,y)&&u.ref===h.ref)if(Ir=!1,h.pendingProps=y=T,Rw(u,N))(u.flags&131072)!==0&&(Ir=!0);else return h.lanes=u.lanes,Ju(u,h,N)}return Cw(u,h,p,y,N)}function nT(u,h,p,y){var N=y.children,T=u!==null?u.memoizedState:null;if(u===null&&h.stateNode===null&&(h.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),y.mode==="hidden"){if((h.flags&128)!==0){if(T=T!==null?T.baseLanes|p:p,u!==null){for(y=h.child=u.child,N=0;y!==null;)N=N|y.lanes|y.childLanes,y=y.sibling;y=N&~T}else y=0,h.child=null;return sT(u,h,T,p,y)}if((p&536870912)!==0)h.memoizedState={baseLanes:0,cachePool:null},u!==null&&le(h,T!==null?T.cachePool:null),T!==null?Is(h,T):Gn(),sr(h);else return y=h.lanes=536870912,sT(u,h,T!==null?T.baseLanes|p:p,p,y)}else T!==null?(le(h,T.cachePool),Is(h,T),rr(),h.memoizedState=null):(u!==null&&le(h,null),Gn(),rr());return Na(u,h,N,p),h.child}function $g(u,h){return u!==null&&u.tag===22||h.stateNode!==null||(h.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),h.sibling}function sT(u,h,p,y,N){var T=re();return T=T===null?null:{parent:Ks._currentValue,pool:T},h.memoizedState={baseLanes:p,cachePool:T},u!==null&&le(h,null),Gn(),sr(h),u!==null&&nu(u,h,y,!0),h.childLanes=N,null}function By(u,h){return h=Vy({mode:h.mode,children:h.children},u.mode),h.ref=u.ref,u.child=h,h.return=u,h}function rT(u,h,p){return ys(h,u.child,null,p),u=By(h,h.pendingProps),u.flags|=2,ns(h),h.memoizedState=null,u}function $8(u,h,p){var y=h.pendingProps,N=(h.flags&128)!==0;if(h.flags&=-129,u===null){if(In){if(y.mode==="hidden")return u=By(h,y),h.lanes=536870912,$g(null,u);if(Yn(h),(u=gs)?(u=gA(u,Os),u=u!==null&&u.data==="&"?u:null,u!==null&&(h.memoizedState={dehydrated:u,treeContext:Jl!==null?{id:Si,overflow:Ni}:null,retryLane:536870912,hydrationErrors:null},p=Wd(u),p.return=h,h.child=p,Br=h,gs=null)):u=null,u===null)throw Ql(h);return h.lanes=536870912,null}return By(h,y)}var T=u.memoizedState;if(T!==null){var z=T.dehydrated;if(Yn(h),N)if(h.flags&256)h.flags&=-257,h=rT(u,h,p);else if(h.memoizedState!==null)h.child=u.child,h.flags|=128,h=null;else throw Error(s(558));else if(Ir||nu(u,h,p,!1),N=(p&u.childLanes)!==0,Ir||N){if(y=bs,y!==null&&(z=qa(y,p),z!==0&&z!==T.retryLane))throw T.retryLane=z,ml(u,z),_i(y,u,z),kw;Zy(),h=rT(u,h,p)}else u=T.treeContext,gs=Oo(z.nextSibling),Br=h,In=!0,wa=null,Os=!1,u!==null&&_y(h,u),h=By(h,y),h.flags|=4096;return h}return u=bi(u.child,{mode:y.mode,children:y.children}),u.ref=h.ref,h.child=u,u.return=h,u}function Uy(u,h){var p=h.ref;if(p===null)u!==null&&u.ref!==null&&(h.flags|=4194816);else{if(typeof p!="function"&&typeof p!="object")throw Error(s(284));(u===null||u.ref!==p)&&(h.flags|=4194816)}}function Cw(u,h,p,y,N){return su(h),p=Sg(u,h,p,y,void 0,N),y=Ng(),u!==null&&!Ir?(kg(u,h,N),Ju(u,h,N)):(In&&y&&bg(h),h.flags|=1,Na(u,h,p,N),h.child)}function aT(u,h,p,y,N,T){return su(h),h.updateQueue=null,p=yl(h,y,p,N),Qd(u),y=Ng(),u!==null&&!Ir?(kg(u,h,T),Ju(u,h,T)):(In&&y&&bg(h),h.flags|=1,Na(u,h,p,T),h.child)}function iT(u,h,p,y,N){if(su(h),h.stateNode===null){var T=Pr,z=p.contextType;typeof z=="object"&&z!==null&&(T=Vr(z)),T=new p(y,T),h.memoizedState=T.state!==null&&T.state!==void 0?T.state:null,T.updater=Sw,h.stateNode=T,T._reactInternals=h,T=h.stateNode,T.props=y,T.state=h.memoizedState,T.refs={},ut(h),z=p.contextType,T.context=typeof z=="object"&&z!==null?Vr(z):Pr,T.state=h.memoizedState,z=p.getDerivedStateFromProps,typeof z=="function"&&(ww(h,p,z,y),T.state=h.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof T.getSnapshotBeforeUpdate=="function"||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(z=T.state,typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount(),z!==T.state&&Sw.enqueueReplaceState(T,T.state,null),tr(h,y,T,N),hs(),T.state=h.memoizedState),typeof T.componentDidMount=="function"&&(h.flags|=4194308),y=!0}else if(u===null){T=h.stateNode;var ne=h.memoizedProps,be=Cf(p,ne);T.props=be;var ze=T.context,He=p.contextType;z=Pr,typeof He=="object"&&He!==null&&(z=Vr(He));var Ze=p.getDerivedStateFromProps;He=typeof Ze=="function"||typeof T.getSnapshotBeforeUpdate=="function",ne=h.pendingProps!==ne,He||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(ne||ze!==z)&&qC(h,T,y,z),yt=!1;var Pe=h.memoizedState;T.state=Pe,tr(h,y,T,N),hs(),ze=h.memoizedState,ne||Pe!==ze||yt?(typeof Ze=="function"&&(ww(h,p,Ze,y),ze=h.memoizedState),(be=yt||GC(h,p,be,y,Pe,ze,z))?(He||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount()),typeof T.componentDidMount=="function"&&(h.flags|=4194308)):(typeof T.componentDidMount=="function"&&(h.flags|=4194308),h.memoizedProps=y,h.memoizedState=ze),T.props=y,T.state=ze,T.context=z,y=be):(typeof T.componentDidMount=="function"&&(h.flags|=4194308),y=!1)}else{T=h.stateNode,As(u,h),z=h.memoizedProps,He=Cf(p,z),T.props=He,Ze=h.pendingProps,Pe=T.context,ze=p.contextType,be=Pr,typeof ze=="object"&&ze!==null&&(be=Vr(ze)),ne=p.getDerivedStateFromProps,(ze=typeof ne=="function"||typeof T.getSnapshotBeforeUpdate=="function")||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(z!==Ze||Pe!==be)&&qC(h,T,y,be),yt=!1,Pe=h.memoizedState,T.state=Pe,tr(h,y,T,N),hs();var Ue=h.memoizedState;z!==Ze||Pe!==Ue||yt||u!==null&&u.dependencies!==null&&Xd(u.dependencies)?(typeof ne=="function"&&(ww(h,p,ne,y),Ue=h.memoizedState),(He=yt||GC(h,p,He,y,Pe,Ue,be)||u!==null&&u.dependencies!==null&&Xd(u.dependencies))?(ze||typeof T.UNSAFE_componentWillUpdate!="function"&&typeof T.componentWillUpdate!="function"||(typeof T.componentWillUpdate=="function"&&T.componentWillUpdate(y,Ue,be),typeof T.UNSAFE_componentWillUpdate=="function"&&T.UNSAFE_componentWillUpdate(y,Ue,be)),typeof T.componentDidUpdate=="function"&&(h.flags|=4),typeof T.getSnapshotBeforeUpdate=="function"&&(h.flags|=1024)):(typeof T.componentDidUpdate!="function"||z===u.memoizedProps&&Pe===u.memoizedState||(h.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||z===u.memoizedProps&&Pe===u.memoizedState||(h.flags|=1024),h.memoizedProps=y,h.memoizedState=Ue),T.props=y,T.state=Ue,T.context=be,y=He):(typeof T.componentDidUpdate!="function"||z===u.memoizedProps&&Pe===u.memoizedState||(h.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||z===u.memoizedProps&&Pe===u.memoizedState||(h.flags|=1024),y=!1)}return T=y,Uy(u,h),y=(h.flags&128)!==0,T||y?(T=h.stateNode,p=y&&typeof p.getDerivedStateFromError!="function"?null:T.render(),h.flags|=1,u!==null&&y?(h.child=ys(h,u.child,null,N),h.child=ys(h,null,p,N)):Na(u,h,p,N),h.memoizedState=T.state,u=h.child):u=Ju(u,h,N),u}function oT(u,h,p,y){return Hu(),h.flags|=256,Na(u,h,p,y),h.child}var Tw={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Aw(u){return{baseLanes:u,cachePool:fe()}}function Iw(u,h,p){return u=u!==null?u.childLanes&~p:0,h&&(u|=so),u}function lT(u,h,p){var y=h.pendingProps,N=!1,T=(h.flags&128)!==0,z;if((z=T)||(z=u!==null&&u.memoizedState===null?!1:(Mn.current&2)!==0),z&&(N=!0,h.flags&=-129),z=(h.flags&32)!==0,h.flags&=-33,u===null){if(In){if(N?Xs(h):rr(),(u=gs)?(u=gA(u,Os),u=u!==null&&u.data!=="&"?u:null,u!==null&&(h.memoizedState={dehydrated:u,treeContext:Jl!==null?{id:Si,overflow:Ni}:null,retryLane:536870912,hydrationErrors:null},p=Wd(u),p.return=h,h.child=p,Br=h,gs=null)):u=null,u===null)throw Ql(h);return c5(u)?h.lanes=32:h.lanes=536870912,null}var ne=y.children;return y=y.fallback,N?(rr(),N=h.mode,ne=Vy({mode:"hidden",children:ne},N),y=Zl(y,N,p,null),ne.return=h,y.return=h,ne.sibling=y,h.child=ne,y=h.child,y.memoizedState=Aw(p),y.childLanes=Iw(u,z,p),h.memoizedState=Tw,$g(null,y)):(Xs(h),Ew(h,ne))}var be=u.memoizedState;if(be!==null&&(ne=be.dehydrated,ne!==null)){if(T)h.flags&256?(Xs(h),h.flags&=-257,h=_w(u,h,p)):h.memoizedState!==null?(rr(),h.child=u.child,h.flags|=128,h=null):(rr(),ne=y.fallback,N=h.mode,y=Vy({mode:"visible",children:y.children},N),ne=Zl(ne,N,p,null),ne.flags|=2,y.return=h,ne.return=h,y.sibling=ne,h.child=y,ys(h,u.child,null,p),y=h.child,y.memoizedState=Aw(p),y.childLanes=Iw(u,z,p),h.memoizedState=Tw,h=$g(null,y));else if(Xs(h),c5(ne)){if(z=ne.nextSibling&&ne.nextSibling.dataset,z)var ze=z.dgst;z=ze,y=Error(s(419)),y.stack="",y.digest=z,Hc({value:y,source:null,stack:null}),h=_w(u,h,p)}else if(Ir||nu(u,h,p,!1),z=(p&u.childLanes)!==0,Ir||z){if(z=bs,z!==null&&(y=qa(z,p),y!==0&&y!==be.retryLane))throw be.retryLane=y,ml(u,y),_i(z,u,y),kw;u5(ne)||Zy(),h=_w(u,h,p)}else u5(ne)?(h.flags|=192,h.child=u.child,h=null):(u=be.treeContext,gs=Oo(ne.nextSibling),Br=h,In=!0,wa=null,Os=!1,u!==null&&_y(h,u),h=Ew(h,y.children),h.flags|=4096);return h}return N?(rr(),ne=y.fallback,N=h.mode,be=u.child,ze=be.sibling,y=bi(be,{mode:"hidden",children:y.children}),y.subtreeFlags=be.subtreeFlags&65011712,ze!==null?ne=bi(ze,ne):(ne=Zl(ne,N,p,null),ne.flags|=2),ne.return=h,y.return=h,y.sibling=ne,h.child=y,$g(null,y),y=h.child,ne=u.child.memoizedState,ne===null?ne=Aw(p):(N=ne.cachePool,N!==null?(be=Ks._currentValue,N=N.parent!==be?{parent:be,pool:be}:N):N=fe(),ne={baseLanes:ne.baseLanes|p,cachePool:N}),y.memoizedState=ne,y.childLanes=Iw(u,z,p),h.memoizedState=Tw,$g(u.child,y)):(Xs(h),p=u.child,u=p.sibling,p=bi(p,{mode:"visible",children:y.children}),p.return=h,p.sibling=null,u!==null&&(z=h.deletions,z===null?(h.deletions=[u],h.flags|=16):z.push(u)),h.child=p,h.memoizedState=null,p)}function Ew(u,h){return h=Vy({mode:"visible",children:h},u.mode),h.return=u,u.child=h}function Vy(u,h){return u=na(22,u,null,h),u.lanes=0,u}function _w(u,h,p){return ys(h,u.child,null,p),u=Ew(h,h.pendingProps.children),u.flags|=2,h.memoizedState=null,u}function uT(u,h,p){u.lanes|=h;var y=u.alternate;y!==null&&(y.lanes|=h),Kc(u.return,h,p)}function $w(u,h,p,y,N,T){var z=u.memoizedState;z===null?u.memoizedState={isBackwards:h,rendering:null,renderingStartTime:0,last:y,tail:p,tailMode:N,treeForkCount:T}:(z.isBackwards=h,z.rendering=null,z.renderingStartTime=0,z.last=y,z.tail=p,z.tailMode=N,z.treeForkCount=T)}function cT(u,h,p){var y=h.pendingProps,N=y.revealOrder,T=y.tail;y=y.children;var z=Mn.current,ne=(z&2)!==0;if(ne?(z=z&1|2,h.flags|=128):z&=1,j(Mn,z),Na(u,h,y,p),y=In?vf:0,!ne&&u!==null&&(u.flags&128)!==0)e:for(u=h.child;u!==null;){if(u.tag===13)u.memoizedState!==null&&uT(u,p,h);else if(u.tag===19)uT(u,p,h);else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===h)break e;for(;u.sibling===null;){if(u.return===null||u.return===h)break e;u=u.return}u.sibling.return=u.return,u=u.sibling}switch(N){case"forwards":for(p=h.child,N=null;p!==null;)u=p.alternate,u!==null&&ra(u)===null&&(N=p),p=p.sibling;p=N,p===null?(N=h.child,h.child=null):(N=p.sibling,p.sibling=null),$w(h,!1,N,p,T,y);break;case"backwards":case"unstable_legacy-backwards":for(p=null,N=h.child,h.child=null;N!==null;){if(u=N.alternate,u!==null&&ra(u)===null){h.child=N;break}u=N.sibling,N.sibling=p,p=N,N=u}$w(h,!0,p,null,T,y);break;case"together":$w(h,!1,null,null,void 0,y);break;default:h.memoizedState=null}return h.child}function Ju(u,h,p){if(u!==null&&(h.dependencies=u.dependencies),nh|=h.lanes,(p&h.childLanes)===0)if(u!==null){if(nu(u,h,p,!1),(p&h.childLanes)===0)return null}else return null;if(u!==null&&h.child!==u.child)throw Error(s(153));if(h.child!==null){for(u=h.child,p=bi(u,u.pendingProps),h.child=p,p.return=h;u.sibling!==null;)u=u.sibling,p=p.sibling=bi(u,u.pendingProps),p.return=h;p.sibling=null}return h.child}function Rw(u,h){return(u.lanes&h)!==0?!0:(u=u.dependencies,!!(u!==null&&Xd(u)))}function R8(u,h,p){switch(h.tag){case 3:Ce(h,h.stateNode.containerInfo),tu(h,Ks,u.memoizedState.cache),Hu();break;case 27:case 5:Le(h);break;case 4:Ce(h,h.stateNode.containerInfo);break;case 10:tu(h,h.type,h.memoizedProps.value);break;case 31:if(h.memoizedState!==null)return h.flags|=128,Yn(h),null;break;case 13:var y=h.memoizedState;if(y!==null)return y.dehydrated!==null?(Xs(h),h.flags|=128,null):(p&h.child.childLanes)!==0?lT(u,h,p):(Xs(h),u=Ju(u,h,p),u!==null?u.sibling:null);Xs(h);break;case 19:var N=(u.flags&128)!==0;if(y=(p&h.childLanes)!==0,y||(nu(u,h,p,!1),y=(p&h.childLanes)!==0),N){if(y)return cT(u,h,p);h.flags|=128}if(N=h.memoizedState,N!==null&&(N.rendering=null,N.tail=null,N.lastEffect=null),j(Mn,Mn.current),y)break;return null;case 22:return h.lanes=0,nT(u,h,p,h.pendingProps);case 24:tu(h,Ks,u.memoizedState.cache)}return Ju(u,h,p)}function hT(u,h,p){if(u!==null)if(u.memoizedProps!==h.pendingProps)Ir=!0;else{if(!Rw(u,p)&&(h.flags&128)===0)return Ir=!1,R8(u,h,p);Ir=(u.flags&131072)!==0}else Ir=!1,In&&(h.flags&1048576)!==0&&Ey(h,vf,h.index);switch(h.lanes=0,h.tag){case 16:e:{var y=h.pendingProps;if(u=Oe(h.elementType),h.type=u,typeof u=="function")jd(u)?(y=Cf(u,y),h.tag=1,h=iT(null,h,u,y,p)):(h.tag=0,h=Cw(null,h,u,y,p));else{if(u!=null){var N=u.$$typeof;if(N===A){h.tag=11,h=QC(null,h,u,y,p);break e}else if(N===V){h.tag=14,h=eT(null,h,u,y,p);break e}}throw h=X(u)||u,Error(s(306,h,""))}}return h;case 0:return Cw(u,h,h.type,h.pendingProps,p);case 1:return y=h.type,N=Cf(y,h.pendingProps),iT(u,h,y,N,p);case 3:e:{if(Ce(h,h.stateNode.containerInfo),u===null)throw Error(s(387));y=h.pendingProps;var T=h.memoizedState;N=T.element,As(u,h),tr(h,y,null,p);var z=h.memoizedState;if(y=z.cache,tu(h,Ks,y),y!==T.cache&&Ku(h,[Ks],p,!0),hs(),y=z.element,T.isDehydrated)if(T={element:y,isDehydrated:!1,cache:z.cache},h.updateQueue.baseState=T,h.memoizedState=T,h.flags&256){h=oT(u,h,y,p);break e}else if(y!==N){N=xi(Error(s(424)),h),Hc(N),h=oT(u,h,y,p);break e}else{switch(u=h.stateNode.containerInfo,u.nodeType){case 9:u=u.body;break;default:u=u.nodeName==="HTML"?u.ownerDocument.body:u}for(gs=Oo(u.firstChild),Br=h,In=!0,wa=null,Os=!0,p=cn(h,null,y,p),h.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling}else{if(Hu(),y===N){h=Ju(u,h,p);break e}Na(u,h,y,p)}h=h.child}return h;case 26:return Uy(u,h),u===null?(p=SA(h.type,null,h.pendingProps,null))?h.memoizedState=p:In||(p=h.type,u=h.pendingProps,y=r2(ue.current).createElement(p),y[ts]=h,y[Cs]=u,ka(y,p,u),Ws(y),h.stateNode=y):h.memoizedState=SA(h.type,u.memoizedProps,h.pendingProps,u.memoizedState),null;case 27:return Le(h),u===null&&In&&(y=h.stateNode=xA(h.type,h.pendingProps,ue.current),Br=h,Os=!0,N=gs,oh(h.type)?(h5=N,gs=Oo(y.firstChild)):gs=N),Na(u,h,h.pendingProps.children,p),Uy(u,h),u===null&&(h.flags|=4194304),h.child;case 5:return u===null&&In&&((N=y=gs)&&(y=lM(y,h.type,h.pendingProps,Os),y!==null?(h.stateNode=y,Br=h,gs=Oo(y.firstChild),Os=!1,N=!0):N=!1),N||Ql(h)),Le(h),N=h.type,T=h.pendingProps,z=u!==null?u.memoizedProps:null,y=T.children,i5(N,T)?y=null:z!==null&&i5(N,z)&&(h.flags|=32),h.memoizedState!==null&&(N=Sg(u,h,dw,null,null,p),qg._currentValue=N),Uy(u,h),Na(u,h,y,p),h.child;case 6:return u===null&&In&&((u=p=gs)&&(p=uM(p,h.pendingProps,Os),p!==null?(h.stateNode=p,Br=h,gs=null,u=!0):u=!1),u||Ql(h)),null;case 13:return lT(u,h,p);case 4:return Ce(h,h.stateNode.containerInfo),y=h.pendingProps,u===null?h.child=ys(h,null,y,p):Na(u,h,y,p),h.child;case 11:return QC(u,h,h.type,h.pendingProps,p);case 7:return Na(u,h,h.pendingProps,p),h.child;case 8:return Na(u,h,h.pendingProps.children,p),h.child;case 12:return Na(u,h,h.pendingProps.children,p),h.child;case 10:return y=h.pendingProps,tu(h,h.type,y.value),Na(u,h,y.children,p),h.child;case 9:return N=h.type._context,y=h.pendingProps.children,su(h),N=Vr(N),y=y(N),h.flags|=1,Na(u,h,y,p),h.child;case 14:return eT(u,h,h.type,h.pendingProps,p);case 15:return tT(u,h,h.type,h.pendingProps,p);case 19:return cT(u,h,p);case 31:return $8(u,h,p);case 22:return nT(u,h,p,h.pendingProps);case 24:return su(h),y=Vr(Ks),u===null?(N=re(),N===null&&(N=bs,T=Xc(),N.pooledCache=T,T.refCount++,T!==null&&(N.pooledCacheLanes|=p),N=T),h.memoizedState={parent:y,cache:N},ut(h),tu(h,Ks,N)):((u.lanes&p)!==0&&(As(u,h),tr(h,null,null,p),hs()),N=u.memoizedState,T=h.memoizedState,N.parent!==y?(N={parent:y,cache:y},h.memoizedState=N,h.lanes===0&&(h.memoizedState=h.updateQueue.baseState=N),tu(h,Ks,y)):(y=T.cache,tu(h,Ks,y),y!==N.cache&&Ku(h,[Ks],p,!0))),Na(u,h,h.pendingProps.children,p),h.child;case 29:throw h.pendingProps}throw Error(s(156,h.tag))}function Qu(u){u.flags|=4}function Dw(u,h,p,y,N){if((h=(u.mode&32)!==0)&&(h=!1),h){if(u.flags|=16777216,(N&335544128)===N)if(u.stateNode.complete)u.flags|=8192;else if(zT())u.flags|=8192;else throw Ge=Ae,Fe}else u.flags&=-16777217}function fT(u,h){if(h.type!=="stylesheet"||(h.state.loading&4)!==0)u.flags&=-16777217;else if(u.flags|=16777216,!AA(h))if(zT())u.flags|=8192;else throw Ge=Ae,Fe}function jy(u,h){h!==null&&(u.flags|=4),u.flags&16384&&(h=u.tag!==22?yo():536870912,u.lanes|=h,cp|=h)}function Rg(u,h){if(!In)switch(u.tailMode){case"hidden":h=u.tail;for(var p=null;h!==null;)h.alternate!==null&&(p=h),h=h.sibling;p===null?u.tail=null:p.sibling=null;break;case"collapsed":p=u.tail;for(var y=null;p!==null;)p.alternate!==null&&(y=p),p=p.sibling;y===null?h||u.tail===null?u.tail=null:u.tail.sibling=null:y.sibling=null}}function _s(u){var h=u.alternate!==null&&u.alternate.child===u.child,p=0,y=0;if(h)for(var N=u.child;N!==null;)p|=N.lanes|N.childLanes,y|=N.subtreeFlags&65011712,y|=N.flags&65011712,N.return=u,N=N.sibling;else for(N=u.child;N!==null;)p|=N.lanes|N.childLanes,y|=N.subtreeFlags,y|=N.flags,N.return=u,N=N.sibling;return u.subtreeFlags|=y,u.childLanes=p,h}function D8(u,h,p){var y=h.pendingProps;switch(Hd(h),h.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _s(h),null;case 1:return _s(h),null;case 3:return p=h.stateNode,y=null,u!==null&&(y=u.memoizedState.cache),h.memoizedState.cache!==y&&(h.flags|=2048),ki(Ks),Ne(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(u===null||u.child===null)&&(Ur(h)?Qu(h):u===null||u.memoizedState.isDehydrated&&(h.flags&256)===0||(h.flags|=1024,vg())),_s(h),null;case 26:var N=h.type,T=h.memoizedState;return u===null?(Qu(h),T!==null?(_s(h),fT(h,T)):(_s(h),Dw(h,N,null,y,p))):T?T!==u.memoizedState?(Qu(h),_s(h),fT(h,T)):(_s(h),h.flags&=-16777217):(u=u.memoizedProps,u!==y&&Qu(h),_s(h),Dw(h,N,u,y,p)),null;case 27:if(Ve(h),p=ue.current,N=h.type,u!==null&&h.stateNode!=null)u.memoizedProps!==y&&Qu(h);else{if(!y){if(h.stateNode===null)throw Error(s(166));return _s(h),null}u=Y.current,Ur(h)?xg(h):(u=xA(N,y,p),h.stateNode=u,Qu(h))}return _s(h),null;case 5:if(Ve(h),N=h.type,u!==null&&h.stateNode!=null)u.memoizedProps!==y&&Qu(h);else{if(!y){if(h.stateNode===null)throw Error(s(166));return _s(h),null}if(T=Y.current,Ur(h))xg(h);else{var z=r2(ue.current);switch(T){case 1:T=z.createElementNS("http://www.w3.org/2000/svg",N);break;case 2:T=z.createElementNS("http://www.w3.org/1998/Math/MathML",N);break;default:switch(N){case"svg":T=z.createElementNS("http://www.w3.org/2000/svg",N);break;case"math":T=z.createElementNS("http://www.w3.org/1998/Math/MathML",N);break;case"script":T=z.createElement("div"),T.innerHTML="<script><\/script>",T=T.removeChild(T.firstChild);break;case"select":T=typeof y.is=="string"?z.createElement("select",{is:y.is}):z.createElement("select"),y.multiple?T.multiple=!0:y.size&&(T.size=y.size);break;default:T=typeof y.is=="string"?z.createElement(N,{is:y.is}):z.createElement(N)}}T[ts]=h,T[Cs]=y;e:for(z=h.child;z!==null;){if(z.tag===5||z.tag===6)T.appendChild(z.stateNode);else if(z.tag!==4&&z.tag!==27&&z.child!==null){z.child.return=z,z=z.child;continue}if(z===h)break e;for(;z.sibling===null;){if(z.return===null||z.return===h)break e;z=z.return}z.sibling.return=z.return,z=z.sibling}h.stateNode=T;e:switch(ka(T,N,y),N){case"button":case"input":case"select":case"textarea":y=!!y.autoFocus;break e;case"img":y=!0;break e;default:y=!1}y&&Qu(h)}}return _s(h),Dw(h,h.type,u===null?null:u.memoizedProps,h.pendingProps,p),null;case 6:if(u&&h.stateNode!=null)u.memoizedProps!==y&&Qu(h);else{if(typeof y!="string"&&h.stateNode===null)throw Error(s(166));if(u=ue.current,Ur(h)){if(u=h.stateNode,p=h.memoizedProps,y=null,N=Br,N!==null)switch(N.tag){case 27:case 5:y=N.memoizedProps}u[ts]=h,u=!!(u.nodeValue===p||y!==null&&y.suppressHydrationWarning===!0||lA(u.nodeValue,p)),u||Ql(h,!0)}else u=r2(u).createTextNode(y),u[ts]=h,h.stateNode=u}return _s(h),null;case 31:if(p=h.memoizedState,u===null||u.memoizedState!==null){if(y=Ur(h),p!==null){if(u===null){if(!y)throw Error(s(318));if(u=h.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(s(557));u[ts]=h}else Hu(),(h.flags&128)===0&&(h.memoizedState=null),h.flags|=4;_s(h),u=!1}else p=vg(),u!==null&&u.memoizedState!==null&&(u.memoizedState.hydrationErrors=p),u=!0;if(!u)return h.flags&256?(ns(h),h):(ns(h),null);if((h.flags&128)!==0)throw Error(s(558))}return _s(h),null;case 13:if(y=h.memoizedState,u===null||u.memoizedState!==null&&u.memoizedState.dehydrated!==null){if(N=Ur(h),y!==null&&y.dehydrated!==null){if(u===null){if(!N)throw Error(s(318));if(N=h.memoizedState,N=N!==null?N.dehydrated:null,!N)throw Error(s(317));N[ts]=h}else Hu(),(h.flags&128)===0&&(h.memoizedState=null),h.flags|=4;_s(h),N=!1}else N=vg(),u!==null&&u.memoizedState!==null&&(u.memoizedState.hydrationErrors=N),N=!0;if(!N)return h.flags&256?(ns(h),h):(ns(h),null)}return ns(h),(h.flags&128)!==0?(h.lanes=p,h):(p=y!==null,u=u!==null&&u.memoizedState!==null,p&&(y=h.child,N=null,y.alternate!==null&&y.alternate.memoizedState!==null&&y.alternate.memoizedState.cachePool!==null&&(N=y.alternate.memoizedState.cachePool.pool),T=null,y.memoizedState!==null&&y.memoizedState.cachePool!==null&&(T=y.memoizedState.cachePool.pool),T!==N&&(y.flags|=2048)),p!==u&&p&&(h.child.flags|=8192),jy(h,h.updateQueue),_s(h),null);case 4:return Ne(),u===null&&t5(h.stateNode.containerInfo),_s(h),null;case 10:return ki(h.type),_s(h),null;case 19:if(O(Mn),y=h.memoizedState,y===null)return _s(h),null;if(N=(h.flags&128)!==0,T=y.rendering,T===null)if(N)Rg(y,!1);else{if(ir!==0||u!==null&&(u.flags&128)!==0)for(u=h.child;u!==null;){if(T=ra(u),T!==null){for(h.flags|=128,Rg(y,!1),u=T.updateQueue,h.updateQueue=u,jy(h,u),h.subtreeFlags=0,u=p,p=h.child;p!==null;)bf(p,u),p=p.sibling;return j(Mn,Mn.current&1|2),In&&ti(h,y.treeForkCount),h.child}u=u.sibling}y.tail!==null&&zt()>Ky&&(h.flags|=128,N=!0,Rg(y,!1),h.lanes=4194304)}else{if(!N)if(u=ra(T),u!==null){if(h.flags|=128,N=!0,u=u.updateQueue,h.updateQueue=u,jy(h,u),Rg(y,!0),y.tail===null&&y.tailMode==="hidden"&&!T.alternate&&!In)return _s(h),null}else 2*zt()-y.renderingStartTime>Ky&&p!==536870912&&(h.flags|=128,N=!0,Rg(y,!1),h.lanes=4194304);y.isBackwards?(T.sibling=h.child,h.child=T):(u=y.last,u!==null?u.sibling=T:h.child=T,y.last=T)}return y.tail!==null?(u=y.tail,y.rendering=u,y.tail=u.sibling,y.renderingStartTime=zt(),u.sibling=null,p=Mn.current,j(Mn,N?p&1|2:p&1),In&&ti(h,y.treeForkCount),u):(_s(h),null);case 22:case 23:return ns(h),yr(),y=h.memoizedState!==null,u!==null?u.memoizedState!==null!==y&&(h.flags|=8192):y&&(h.flags|=8192),y?(p&536870912)!==0&&(h.flags&128)===0&&(_s(h),h.subtreeFlags&6&&(h.flags|=8192)):_s(h),p=h.updateQueue,p!==null&&jy(h,p.retryQueue),p=null,u!==null&&u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(p=u.memoizedState.cachePool.pool),y=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(y=h.memoizedState.cachePool.pool),y!==p&&(h.flags|=2048),u!==null&&O(Q),null;case 24:return p=null,u!==null&&(p=u.memoizedState.cache),h.memoizedState.cache!==p&&(h.flags|=2048),ki(Ks),_s(h),null;case 25:return null;case 30:return null}throw Error(s(156,h.tag))}function O8(u,h){switch(Hd(h),h.tag){case 1:return u=h.flags,u&65536?(h.flags=u&-65537|128,h):null;case 3:return ki(Ks),Ne(),u=h.flags,(u&65536)!==0&&(u&128)===0?(h.flags=u&-65537|128,h):null;case 26:case 27:case 5:return Ve(h),null;case 31:if(h.memoizedState!==null){if(ns(h),h.alternate===null)throw Error(s(340));Hu()}return u=h.flags,u&65536?(h.flags=u&-65537|128,h):null;case 13:if(ns(h),u=h.memoizedState,u!==null&&u.dehydrated!==null){if(h.alternate===null)throw Error(s(340));Hu()}return u=h.flags,u&65536?(h.flags=u&-65537|128,h):null;case 19:return O(Mn),null;case 4:return Ne(),null;case 10:return ki(h.type),null;case 22:case 23:return ns(h),yr(),u!==null&&O(Q),u=h.flags,u&65536?(h.flags=u&-65537|128,h):null;case 24:return ki(Ks),null;case 25:return null;default:return null}}function dT(u,h){switch(Hd(h),h.tag){case 3:ki(Ks),Ne();break;case 26:case 27:case 5:Ve(h);break;case 4:Ne();break;case 31:h.memoizedState!==null&&ns(h);break;case 13:ns(h);break;case 19:O(Mn);break;case 10:ki(h.type);break;case 22:case 23:ns(h),yr(),u!==null&&O(Q);break;case 24:ki(Ks)}}function Dg(u,h){try{var p=h.updateQueue,y=p!==null?p.lastEffect:null;if(y!==null){var N=y.next;p=N;do{if((p.tag&u)===u){y=void 0;var T=p.create,z=p.inst;y=T(),z.destroy=y}p=p.next}while(p!==N)}}catch(ne){rs(h,h.return,ne)}}function eh(u,h,p){try{var y=h.updateQueue,N=y!==null?y.lastEffect:null;if(N!==null){var T=N.next;y=T;do{if((y.tag&u)===u){var z=y.inst,ne=z.destroy;if(ne!==void 0){z.destroy=void 0,N=h;var be=p,ze=ne;try{ze()}catch(He){rs(N,be,He)}}}y=y.next}while(y!==T)}}catch(He){rs(h,h.return,He)}}function pT(u){var h=u.updateQueue;if(h!==null){var p=u.stateNode;try{nr(h,p)}catch(y){rs(u,u.return,y)}}}function mT(u,h,p){p.props=Cf(u.type,u.memoizedProps),p.state=u.memoizedState;try{p.componentWillUnmount()}catch(y){rs(u,h,y)}}function Og(u,h){try{var p=u.ref;if(p!==null){switch(u.tag){case 26:case 27:case 5:var y=u.stateNode;break;case 30:y=u.stateNode;break;default:y=u.stateNode}typeof p=="function"?u.refCleanup=p(y):p.current=y}}catch(N){rs(u,h,N)}}function lu(u,h){var p=u.ref,y=u.refCleanup;if(p!==null)if(typeof y=="function")try{y()}catch(N){rs(u,h,N)}finally{u.refCleanup=null,u=u.alternate,u!=null&&(u.refCleanup=null)}else if(typeof p=="function")try{p(null)}catch(N){rs(u,h,N)}else p.current=null}function gT(u){var h=u.type,p=u.memoizedProps,y=u.stateNode;try{e:switch(h){case"button":case"input":case"select":case"textarea":p.autoFocus&&y.focus();break e;case"img":p.src?y.src=p.src:p.srcSet&&(y.srcset=p.srcSet)}}catch(N){rs(u,u.return,N)}}function Ow(u,h,p){try{var y=u.stateNode;nM(y,u.type,p,h),y[Cs]=h}catch(N){rs(u,u.return,N)}}function yT(u){return u.tag===5||u.tag===3||u.tag===26||u.tag===27&&oh(u.type)||u.tag===4}function Lw(u){e:for(;;){for(;u.sibling===null;){if(u.return===null||yT(u.return))return null;u=u.return}for(u.sibling.return=u.return,u=u.sibling;u.tag!==5&&u.tag!==6&&u.tag!==18;){if(u.tag===27&&oh(u.type)||u.flags&2||u.child===null||u.tag===4)continue e;u.child.return=u,u=u.child}if(!(u.flags&2))return u.stateNode}}function Fw(u,h,p){var y=u.tag;if(y===5||y===6)u=u.stateNode,h?(p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p).insertBefore(u,h):(h=p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p,h.appendChild(u),p=p._reactRootContainer,p!=null||h.onclick!==null||(h.onclick=Xi));else if(y!==4&&(y===27&&oh(u.type)&&(p=u.stateNode,h=null),u=u.child,u!==null))for(Fw(u,h,p),u=u.sibling;u!==null;)Fw(u,h,p),u=u.sibling}function Wy(u,h,p){var y=u.tag;if(y===5||y===6)u=u.stateNode,h?p.insertBefore(u,h):p.appendChild(u);else if(y!==4&&(y===27&&oh(u.type)&&(p=u.stateNode),u=u.child,u!==null))for(Wy(u,h,p),u=u.sibling;u!==null;)Wy(u,h,p),u=u.sibling}function bT(u){var h=u.stateNode,p=u.memoizedProps;try{for(var y=u.type,N=h.attributes;N.length;)h.removeAttributeNode(N[0]);ka(h,y,p),h[ts]=u,h[Cs]=p}catch(T){rs(u,u.return,T)}}var ec=!1,Er=!1,Mw=!1,xT=typeof WeakSet=="function"?WeakSet:Set,aa=null;function L8(u,h){if(u=u.containerInfo,r5=h2,u=dl(u),Eo(u)){if("selectionStart"in u)var p={start:u.selectionStart,end:u.selectionEnd};else e:{p=(p=u.ownerDocument)&&p.defaultView||window;var y=p.getSelection&&p.getSelection();if(y&&y.rangeCount!==0){p=y.anchorNode;var N=y.anchorOffset,T=y.focusNode;y=y.focusOffset;try{p.nodeType,T.nodeType}catch{p=null;break e}var z=0,ne=-1,be=-1,ze=0,He=0,Ze=u,Pe=null;t:for(;;){for(var Ue;Ze!==p||N!==0&&Ze.nodeType!==3||(ne=z+N),Ze!==T||y!==0&&Ze.nodeType!==3||(be=z+y),Ze.nodeType===3&&(z+=Ze.nodeValue.length),(Ue=Ze.firstChild)!==null;)Pe=Ze,Ze=Ue;for(;;){if(Ze===u)break t;if(Pe===p&&++ze===N&&(ne=z),Pe===T&&++He===y&&(be=z),(Ue=Ze.nextSibling)!==null)break;Ze=Pe,Pe=Ze.parentNode}Ze=Ue}p=ne===-1||be===-1?null:{start:ne,end:be}}else p=null}p=p||{start:0,end:0}}else p=null;for(a5={focusedElem:u,selectionRange:p},h2=!1,aa=h;aa!==null;)if(h=aa,u=h.child,(h.subtreeFlags&1028)!==0&&u!==null)u.return=h,aa=u;else for(;aa!==null;){switch(h=aa,T=h.alternate,u=h.flags,h.tag){case 0:if((u&4)!==0&&(u=h.updateQueue,u=u!==null?u.events:null,u!==null))for(p=0;p<u.length;p++)N=u[p],N.ref.impl=N.nextImpl;break;case 11:case 15:break;case 1:if((u&1024)!==0&&T!==null){u=void 0,p=h,N=T.memoizedProps,T=T.memoizedState,y=p.stateNode;try{var kt=Cf(p.type,N);u=y.getSnapshotBeforeUpdate(kt,T),y.__reactInternalSnapshotBeforeUpdate=u}catch(Xt){rs(p,p.return,Xt)}}break;case 3:if((u&1024)!==0){if(u=h.stateNode.containerInfo,p=u.nodeType,p===9)l5(u);else if(p===1)switch(u.nodeName){case"HEAD":case"HTML":case"BODY":l5(u);break;default:u.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((u&1024)!==0)throw Error(s(163))}if(u=h.sibling,u!==null){u.return=h.return,aa=u;break}aa=h.return}}function vT(u,h,p){var y=p.flags;switch(p.tag){case 0:case 11:case 15:nc(u,p),y&4&&Dg(5,p);break;case 1:if(nc(u,p),y&4)if(u=p.stateNode,h===null)try{u.componentDidMount()}catch(z){rs(p,p.return,z)}else{var N=Cf(p.type,h.memoizedProps);h=h.memoizedState;try{u.componentDidUpdate(N,h,u.__reactInternalSnapshotBeforeUpdate)}catch(z){rs(p,p.return,z)}}y&64&&pT(p),y&512&&Og(p,p.return);break;case 3:if(nc(u,p),y&64&&(u=p.updateQueue,u!==null)){if(h=null,p.child!==null)switch(p.child.tag){case 27:case 5:h=p.child.stateNode;break;case 1:h=p.child.stateNode}try{nr(u,h)}catch(z){rs(p,p.return,z)}}break;case 27:h===null&&y&4&&bT(p);case 26:case 5:nc(u,p),h===null&&y&4&&gT(p),y&512&&Og(p,p.return);break;case 12:nc(u,p);break;case 31:nc(u,p),y&4&&NT(u,p);break;case 13:nc(u,p),y&4&&kT(u,p),y&64&&(u=p.memoizedState,u!==null&&(u=u.dehydrated,u!==null&&(p=W8.bind(null,p),cM(u,p))));break;case 22:if(y=p.memoizedState!==null||ec,!y){h=h!==null&&h.memoizedState!==null||Er,N=ec;var T=Er;ec=y,(Er=h)&&!T?sc(u,p,(p.subtreeFlags&8772)!==0):nc(u,p),ec=N,Er=T}break;case 30:break;default:nc(u,p)}}function wT(u){var h=u.alternate;h!==null&&(u.alternate=null,wT(h)),u.child=null,u.deletions=null,u.sibling=null,u.tag===5&&(h=u.stateNode,h!==null&&Gl(h)),u.stateNode=null,u.return=null,u.dependencies=null,u.memoizedProps=null,u.memoizedState=null,u.pendingProps=null,u.stateNode=null,u.updateQueue=null}var Ms=null,Ti=!1;function tc(u,h,p){for(p=p.child;p!==null;)ST(u,h,p),p=p.sibling}function ST(u,h,p){if(Vt&&typeof Vt.onCommitFiberUnmount=="function")try{Vt.onCommitFiberUnmount(ln,p)}catch{}switch(p.tag){case 26:Er||lu(p,h),tc(u,h,p),p.memoizedState?p.memoizedState.count--:p.stateNode&&(p=p.stateNode,p.parentNode.removeChild(p));break;case 27:Er||lu(p,h);var y=Ms,N=Ti;oh(p.type)&&(Ms=p.stateNode,Ti=!1),tc(u,h,p),jg(p.stateNode),Ms=y,Ti=N;break;case 5:Er||lu(p,h);case 6:if(y=Ms,N=Ti,Ms=null,tc(u,h,p),Ms=y,Ti=N,Ms!==null)if(Ti)try{(Ms.nodeType===9?Ms.body:Ms.nodeName==="HTML"?Ms.ownerDocument.body:Ms).removeChild(p.stateNode)}catch(T){rs(p,h,T)}else try{Ms.removeChild(p.stateNode)}catch(T){rs(p,h,T)}break;case 18:Ms!==null&&(Ti?(u=Ms,pA(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,p.stateNode),bp(u)):pA(Ms,p.stateNode));break;case 4:y=Ms,N=Ti,Ms=p.stateNode.containerInfo,Ti=!0,tc(u,h,p),Ms=y,Ti=N;break;case 0:case 11:case 14:case 15:eh(2,p,h),Er||eh(4,p,h),tc(u,h,p);break;case 1:Er||(lu(p,h),y=p.stateNode,typeof y.componentWillUnmount=="function"&&mT(p,h,y)),tc(u,h,p);break;case 21:tc(u,h,p);break;case 22:Er=(y=Er)||p.memoizedState!==null,tc(u,h,p),Er=y;break;default:tc(u,h,p)}}function NT(u,h){if(h.memoizedState===null&&(u=h.alternate,u!==null&&(u=u.memoizedState,u!==null))){u=u.dehydrated;try{bp(u)}catch(p){rs(h,h.return,p)}}}function kT(u,h){if(h.memoizedState===null&&(u=h.alternate,u!==null&&(u=u.memoizedState,u!==null&&(u=u.dehydrated,u!==null))))try{bp(u)}catch(p){rs(h,h.return,p)}}function F8(u){switch(u.tag){case 31:case 13:case 19:var h=u.stateNode;return h===null&&(h=u.stateNode=new xT),h;case 22:return u=u.stateNode,h=u._retryCache,h===null&&(h=u._retryCache=new xT),h;default:throw Error(s(435,u.tag))}}function Gy(u,h){var p=F8(u);h.forEach(function(y){if(!p.has(y)){p.add(y);var N=G8.bind(null,u,y);y.then(N,N)}})}function Ai(u,h){var p=h.deletions;if(p!==null)for(var y=0;y<p.length;y++){var N=p[y],T=u,z=h,ne=z;e:for(;ne!==null;){switch(ne.tag){case 27:if(oh(ne.type)){Ms=ne.stateNode,Ti=!1;break e}break;case 5:Ms=ne.stateNode,Ti=!1;break e;case 3:case 4:Ms=ne.stateNode.containerInfo,Ti=!0;break e}ne=ne.return}if(Ms===null)throw Error(s(160));ST(T,z,N),Ms=null,Ti=!1,T=N.alternate,T!==null&&(T.return=null),N.return=null}if(h.subtreeFlags&13886)for(h=h.child;h!==null;)CT(h,u),h=h.sibling}var wl=null;function CT(u,h){var p=u.alternate,y=u.flags;switch(u.tag){case 0:case 11:case 14:case 15:Ai(h,u),Ii(u),y&4&&(eh(3,u,u.return),Dg(3,u),eh(5,u,u.return));break;case 1:Ai(h,u),Ii(u),y&512&&(Er||p===null||lu(p,p.return)),y&64&&ec&&(u=u.updateQueue,u!==null&&(y=u.callbacks,y!==null&&(p=u.shared.hiddenCallbacks,u.shared.hiddenCallbacks=p===null?y:p.concat(y))));break;case 26:var N=wl;if(Ai(h,u),Ii(u),y&512&&(Er||p===null||lu(p,p.return)),y&4){var T=p!==null?p.memoizedState:null;if(y=u.memoizedState,p===null)if(y===null)if(u.stateNode===null){e:{y=u.type,p=u.memoizedProps,N=N.ownerDocument||N;t:switch(y){case"title":T=N.getElementsByTagName("title")[0],(!T||T[ji]||T[ts]||T.namespaceURI==="http://www.w3.org/2000/svg"||T.hasAttribute("itemprop"))&&(T=N.createElement(y),N.head.insertBefore(T,N.querySelector("head > title"))),ka(T,y,p),T[ts]=u,Ws(T),y=T;break e;case"link":var z=CA("link","href",N).get(y+(p.href||""));if(z){for(var ne=0;ne<z.length;ne++)if(T=z[ne],T.getAttribute("href")===(p.href==null||p.href===""?null:p.href)&&T.getAttribute("rel")===(p.rel==null?null:p.rel)&&T.getAttribute("title")===(p.title==null?null:p.title)&&T.getAttribute("crossorigin")===(p.crossOrigin==null?null:p.crossOrigin)){z.splice(ne,1);break t}}T=N.createElement(y),ka(T,y,p),N.head.appendChild(T);break;case"meta":if(z=CA("meta","content",N).get(y+(p.content||""))){for(ne=0;ne<z.length;ne++)if(T=z[ne],T.getAttribute("content")===(p.content==null?null:""+p.content)&&T.getAttribute("name")===(p.name==null?null:p.name)&&T.getAttribute("property")===(p.property==null?null:p.property)&&T.getAttribute("http-equiv")===(p.httpEquiv==null?null:p.httpEquiv)&&T.getAttribute("charset")===(p.charSet==null?null:p.charSet)){z.splice(ne,1);break t}}T=N.createElement(y),ka(T,y,p),N.head.appendChild(T);break;default:throw Error(s(468,y))}T[ts]=u,Ws(T),y=T}u.stateNode=y}else TA(N,u.type,u.stateNode);else u.stateNode=kA(N,y,u.memoizedProps);else T!==y?(T===null?p.stateNode!==null&&(p=p.stateNode,p.parentNode.removeChild(p)):T.count--,y===null?TA(N,u.type,u.stateNode):kA(N,y,u.memoizedProps)):y===null&&u.stateNode!==null&&Ow(u,u.memoizedProps,p.memoizedProps)}break;case 27:Ai(h,u),Ii(u),y&512&&(Er||p===null||lu(p,p.return)),p!==null&&y&4&&Ow(u,u.memoizedProps,p.memoizedProps);break;case 5:if(Ai(h,u),Ii(u),y&512&&(Er||p===null||lu(p,p.return)),u.flags&32){N=u.stateNode;try{Ki(N,"")}catch(kt){rs(u,u.return,kt)}}y&4&&u.stateNode!=null&&(N=u.memoizedProps,Ow(u,N,p!==null?p.memoizedProps:N)),y&1024&&(Mw=!0);break;case 6:if(Ai(h,u),Ii(u),y&4){if(u.stateNode===null)throw Error(s(162));y=u.memoizedProps,p=u.stateNode;try{p.nodeValue=y}catch(kt){rs(u,u.return,kt)}}break;case 3:if(o2=null,N=wl,wl=a2(h.containerInfo),Ai(h,u),wl=N,Ii(u),y&4&&p!==null&&p.memoizedState.isDehydrated)try{bp(h.containerInfo)}catch(kt){rs(u,u.return,kt)}Mw&&(Mw=!1,TT(u));break;case 4:y=wl,wl=a2(u.stateNode.containerInfo),Ai(h,u),Ii(u),wl=y;break;case 12:Ai(h,u),Ii(u);break;case 31:Ai(h,u),Ii(u),y&4&&(y=u.updateQueue,y!==null&&(u.updateQueue=null,Gy(u,y)));break;case 13:Ai(h,u),Ii(u),u.child.flags&8192&&u.memoizedState!==null!=(p!==null&&p.memoizedState!==null)&&(Hy=zt()),y&4&&(y=u.updateQueue,y!==null&&(u.updateQueue=null,Gy(u,y)));break;case 22:N=u.memoizedState!==null;var be=p!==null&&p.memoizedState!==null,ze=ec,He=Er;if(ec=ze||N,Er=He||be,Ai(h,u),Er=He,ec=ze,Ii(u),y&8192)e:for(h=u.stateNode,h._visibility=N?h._visibility&-2:h._visibility|1,N&&(p===null||be||ec||Er||Tf(u)),p=null,h=u;;){if(h.tag===5||h.tag===26){if(p===null){be=p=h;try{if(T=be.stateNode,N)z=T.style,typeof z.setProperty=="function"?z.setProperty("display","none","important"):z.display="none";else{ne=be.stateNode;var Ze=be.memoizedProps.style,Pe=Ze!=null&&Ze.hasOwnProperty("display")?Ze.display:null;ne.style.display=Pe==null||typeof Pe=="boolean"?"":(""+Pe).trim()}}catch(kt){rs(be,be.return,kt)}}}else if(h.tag===6){if(p===null){be=h;try{be.stateNode.nodeValue=N?"":be.memoizedProps}catch(kt){rs(be,be.return,kt)}}}else if(h.tag===18){if(p===null){be=h;try{var Ue=be.stateNode;N?mA(Ue,!0):mA(be.stateNode,!1)}catch(kt){rs(be,be.return,kt)}}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===u)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===u)break e;for(;h.sibling===null;){if(h.return===null||h.return===u)break e;p===h&&(p=null),h=h.return}p===h&&(p=null),h.sibling.return=h.return,h=h.sibling}y&4&&(y=u.updateQueue,y!==null&&(p=y.retryQueue,p!==null&&(y.retryQueue=null,Gy(u,p))));break;case 19:Ai(h,u),Ii(u),y&4&&(y=u.updateQueue,y!==null&&(u.updateQueue=null,Gy(u,y)));break;case 30:break;case 21:break;default:Ai(h,u),Ii(u)}}function Ii(u){var h=u.flags;if(h&2){try{for(var p,y=u.return;y!==null;){if(yT(y)){p=y;break}y=y.return}if(p==null)throw Error(s(160));switch(p.tag){case 27:var N=p.stateNode,T=Lw(u);Wy(u,T,N);break;case 5:var z=p.stateNode;p.flags&32&&(Ki(z,""),p.flags&=-33);var ne=Lw(u);Wy(u,ne,z);break;case 3:case 4:var be=p.stateNode.containerInfo,ze=Lw(u);Fw(u,ze,be);break;default:throw Error(s(161))}}catch(He){rs(u,u.return,He)}u.flags&=-3}h&4096&&(u.flags&=-4097)}function TT(u){if(u.subtreeFlags&1024)for(u=u.child;u!==null;){var h=u;TT(h),h.tag===5&&h.flags&1024&&h.stateNode.reset(),u=u.sibling}}function nc(u,h){if(h.subtreeFlags&8772)for(h=h.child;h!==null;)vT(u,h.alternate,h),h=h.sibling}function Tf(u){for(u=u.child;u!==null;){var h=u;switch(h.tag){case 0:case 11:case 14:case 15:eh(4,h,h.return),Tf(h);break;case 1:lu(h,h.return);var p=h.stateNode;typeof p.componentWillUnmount=="function"&&mT(h,h.return,p),Tf(h);break;case 27:jg(h.stateNode);case 26:case 5:lu(h,h.return),Tf(h);break;case 22:h.memoizedState===null&&Tf(h);break;case 30:Tf(h);break;default:Tf(h)}u=u.sibling}}function sc(u,h,p){for(p=p&&(h.subtreeFlags&8772)!==0,h=h.child;h!==null;){var y=h.alternate,N=u,T=h,z=T.flags;switch(T.tag){case 0:case 11:case 15:sc(N,T,p),Dg(4,T);break;case 1:if(sc(N,T,p),y=T,N=y.stateNode,typeof N.componentDidMount=="function")try{N.componentDidMount()}catch(ze){rs(y,y.return,ze)}if(y=T,N=y.updateQueue,N!==null){var ne=y.stateNode;try{var be=N.shared.hiddenCallbacks;if(be!==null)for(N.shared.hiddenCallbacks=null,N=0;N<be.length;N++)sa(be[N],ne)}catch(ze){rs(y,y.return,ze)}}p&&z&64&&pT(T),Og(T,T.return);break;case 27:bT(T);case 26:case 5:sc(N,T,p),p&&y===null&&z&4&&gT(T),Og(T,T.return);break;case 12:sc(N,T,p);break;case 31:sc(N,T,p),p&&z&4&&NT(N,T);break;case 13:sc(N,T,p),p&&z&4&&kT(N,T);break;case 22:T.memoizedState===null&&sc(N,T,p),Og(T,T.return);break;case 30:break;default:sc(N,T,p)}h=h.sibling}}function zw(u,h){var p=null;u!==null&&u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(p=u.memoizedState.cachePool.pool),u=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(u=h.memoizedState.cachePool.pool),u!==p&&(u!=null&&u.refCount++,p!=null&&wf(p))}function Pw(u,h){u=null,h.alternate!==null&&(u=h.alternate.memoizedState.cache),h=h.memoizedState.cache,h!==u&&(h.refCount++,u!=null&&wf(u))}function Sl(u,h,p,y){if(h.subtreeFlags&10256)for(h=h.child;h!==null;)AT(u,h,p,y),h=h.sibling}function AT(u,h,p,y){var N=h.flags;switch(h.tag){case 0:case 11:case 15:Sl(u,h,p,y),N&2048&&Dg(9,h);break;case 1:Sl(u,h,p,y);break;case 3:Sl(u,h,p,y),N&2048&&(u=null,h.alternate!==null&&(u=h.alternate.memoizedState.cache),h=h.memoizedState.cache,h!==u&&(h.refCount++,u!=null&&wf(u)));break;case 12:if(N&2048){Sl(u,h,p,y),u=h.stateNode;try{var T=h.memoizedProps,z=T.id,ne=T.onPostCommit;typeof ne=="function"&&ne(z,h.alternate===null?"mount":"update",u.passiveEffectDuration,-0)}catch(be){rs(h,h.return,be)}}else Sl(u,h,p,y);break;case 31:Sl(u,h,p,y);break;case 13:Sl(u,h,p,y);break;case 23:break;case 22:T=h.stateNode,z=h.alternate,h.memoizedState!==null?T._visibility&2?Sl(u,h,p,y):Lg(u,h):T._visibility&2?Sl(u,h,p,y):(T._visibility|=2,op(u,h,p,y,(h.subtreeFlags&10256)!==0||!1)),N&2048&&zw(z,h);break;case 24:Sl(u,h,p,y),N&2048&&Pw(h.alternate,h);break;default:Sl(u,h,p,y)}}function op(u,h,p,y,N){for(N=N&&((h.subtreeFlags&10256)!==0||!1),h=h.child;h!==null;){var T=u,z=h,ne=p,be=y,ze=z.flags;switch(z.tag){case 0:case 11:case 15:op(T,z,ne,be,N),Dg(8,z);break;case 23:break;case 22:var He=z.stateNode;z.memoizedState!==null?He._visibility&2?op(T,z,ne,be,N):Lg(T,z):(He._visibility|=2,op(T,z,ne,be,N)),N&&ze&2048&&zw(z.alternate,z);break;case 24:op(T,z,ne,be,N),N&&ze&2048&&Pw(z.alternate,z);break;default:op(T,z,ne,be,N)}h=h.sibling}}function Lg(u,h){if(h.subtreeFlags&10256)for(h=h.child;h!==null;){var p=u,y=h,N=y.flags;switch(y.tag){case 22:Lg(p,y),N&2048&&zw(y.alternate,y);break;case 24:Lg(p,y),N&2048&&Pw(y.alternate,y);break;default:Lg(p,y)}h=h.sibling}}var Fg=8192;function lp(u,h,p){if(u.subtreeFlags&Fg)for(u=u.child;u!==null;)IT(u,h,p),u=u.sibling}function IT(u,h,p){switch(u.tag){case 26:lp(u,h,p),u.flags&Fg&&u.memoizedState!==null&&SM(p,wl,u.memoizedState,u.memoizedProps);break;case 5:lp(u,h,p);break;case 3:case 4:var y=wl;wl=a2(u.stateNode.containerInfo),lp(u,h,p),wl=y;break;case 22:u.memoizedState===null&&(y=u.alternate,y!==null&&y.memoizedState!==null?(y=Fg,Fg=16777216,lp(u,h,p),Fg=y):lp(u,h,p));break;default:lp(u,h,p)}}function ET(u){var h=u.alternate;if(h!==null&&(u=h.child,u!==null)){h.child=null;do h=u.sibling,u.sibling=null,u=h;while(u!==null)}}function Mg(u){var h=u.deletions;if((u.flags&16)!==0){if(h!==null)for(var p=0;p<h.length;p++){var y=h[p];aa=y,$T(y,u)}ET(u)}if(u.subtreeFlags&10256)for(u=u.child;u!==null;)_T(u),u=u.sibling}function _T(u){switch(u.tag){case 0:case 11:case 15:Mg(u),u.flags&2048&&eh(9,u,u.return);break;case 3:Mg(u);break;case 12:Mg(u);break;case 22:var h=u.stateNode;u.memoizedState!==null&&h._visibility&2&&(u.return===null||u.return.tag!==13)?(h._visibility&=-3,qy(u)):Mg(u);break;default:Mg(u)}}function qy(u){var h=u.deletions;if((u.flags&16)!==0){if(h!==null)for(var p=0;p<h.length;p++){var y=h[p];aa=y,$T(y,u)}ET(u)}for(u=u.child;u!==null;){switch(h=u,h.tag){case 0:case 11:case 15:eh(8,h,h.return),qy(h);break;case 22:p=h.stateNode,p._visibility&2&&(p._visibility&=-3,qy(h));break;default:qy(h)}u=u.sibling}}function $T(u,h){for(;aa!==null;){var p=aa;switch(p.tag){case 0:case 11:case 15:eh(8,p,h);break;case 23:case 22:if(p.memoizedState!==null&&p.memoizedState.cachePool!==null){var y=p.memoizedState.cachePool.pool;y!=null&&y.refCount++}break;case 24:wf(p.memoizedState.cache)}if(y=p.child,y!==null)y.return=p,aa=y;else e:for(p=u;aa!==null;){y=aa;var N=y.sibling,T=y.return;if(wT(y),y===p){aa=null;break e}if(N!==null){N.return=T,aa=N;break e}aa=T}}}var M8={getCacheForType:function(u){var h=Vr(Ks),p=h.data.get(u);return p===void 0&&(p=u(),h.data.set(u,p)),p},cacheSignal:function(){return Vr(Ks).controller.signal}},z8=typeof WeakMap=="function"?WeakMap:Map,Zn=0,bs=null,En=null,Rn=0,ss=0,no=null,th=!1,up=!1,Bw=!1,rc=0,ir=0,nh=0,Af=0,Uw=0,so=0,cp=0,zg=null,Ei=null,Vw=!1,Hy=0,RT=0,Ky=1/0,Xy=null,sh=null,Wr=0,rh=null,hp=null,ac=0,jw=0,Ww=null,DT=null,Pg=0,Gw=null;function ro(){return(Zn&2)!==0&&Rn!==0?Rn&-Rn:W.T!==null?Zw():kr()}function OT(){if(so===0)if((Rn&536870912)===0||In){var u=es;es<<=1,(es&3932160)===0&&(es=262144),so=u}else so=536870912;return u=Es.current,u!==null&&(u.flags|=32),so}function _i(u,h,p){(u===bs&&(ss===2||ss===9)||u.cancelPendingCommit!==null)&&(fp(u,0),ah(u,Rn,so,!1)),Pt(u,p),((Zn&2)===0||u!==bs)&&(u===bs&&((Zn&2)===0&&(Af|=p),ir===4&&ah(u,Rn,so,!1)),uu(u))}function LT(u,h,p){if((Zn&6)!==0)throw Error(s(327));var y=!p&&(h&127)===0&&(h&u.expiredLanes)===0||Ui(u,h),N=y?U8(u,h):Hw(u,h,!0),T=y;do{if(N===0){up&&!y&&ah(u,h,0,!1);break}else{if(p=u.current.alternate,T&&!P8(p)){N=Hw(u,h,!1),T=!1;continue}if(N===2){if(T=h,u.errorRecoveryDisabledLanes&T)var z=0;else z=u.pendingLanes&-536870913,z=z!==0?z:z&536870912?536870912:0;if(z!==0){h=z;e:{var ne=u;N=zg;var be=ne.current.memoizedState.isDehydrated;if(be&&(fp(ne,z).flags|=256),z=Hw(ne,z,!1),z!==2){if(Bw&&!be){ne.errorRecoveryDisabledLanes|=T,Af|=T,N=4;break e}T=Ei,Ei=N,T!==null&&(Ei===null?Ei=T:Ei.push.apply(Ei,T))}N=z}if(T=!1,N!==2)continue}}if(N===1){fp(u,0),ah(u,h,0,!0);break}e:{switch(y=u,T=N,T){case 0:case 1:throw Error(s(345));case 4:if((h&4194048)!==h)break;case 6:ah(y,h,so,!th);break e;case 2:Ei=null;break;case 3:case 5:break;default:throw Error(s(329))}if((h&62914560)===h&&(N=Hy+300-zt(),10<N)){if(ah(y,h,so,!th),On(y,0,!0)!==0)break e;ac=h,y.timeoutHandle=fA(FT.bind(null,y,p,Ei,Xy,Vw,h,so,Af,cp,th,T,"Throttled",-0,0),N);break e}FT(y,p,Ei,Xy,Vw,h,so,Af,cp,th,T,null,-0,0)}}break}while(!0);uu(u)}function FT(u,h,p,y,N,T,z,ne,be,ze,He,Ze,Pe,Ue){if(u.timeoutHandle=-1,Ze=h.subtreeFlags,Ze&8192||(Ze&16785408)===16785408){Ze={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Xi},IT(h,T,Ze);var kt=(T&62914560)===T?Hy-zt():(T&4194048)===T?RT-zt():0;if(kt=NM(Ze,kt),kt!==null){ac=T,u.cancelPendingCommit=kt(WT.bind(null,u,h,T,p,y,N,z,ne,be,He,Ze,null,Pe,Ue)),ah(u,T,z,!ze);return}}WT(u,h,T,p,y,N,z,ne,be)}function P8(u){for(var h=u;;){var p=h.tag;if((p===0||p===11||p===15)&&h.flags&16384&&(p=h.updateQueue,p!==null&&(p=p.stores,p!==null)))for(var y=0;y<p.length;y++){var N=p[y],T=N.getSnapshot;N=N.value;try{if(!zr(T(),N))return!1}catch{return!1}}if(p=h.child,h.subtreeFlags&16384&&p!==null)p.return=h,h=p;else{if(h===u)break;for(;h.sibling===null;){if(h.return===null||h.return===u)return!0;h=h.return}h.sibling.return=h.return,h=h.sibling}}return!0}function ah(u,h,p,y){h&=~Uw,h&=~Af,u.suspendedLanes|=h,u.pingedLanes&=~h,y&&(u.warmLanes|=h),y=u.expirationTimes;for(var N=h;0<N;){var T=31-kn(N),z=1<<T;y[T]=-1,N&=~z}p!==0&&bo(u,p,h)}function Yy(){return(Zn&6)===0?(Bg(0),!1):!0}function qw(){if(En!==null){if(ss===0)var u=En.return;else u=En,$o=eu=null,ep(u),Qe=null,At=0,u=En;for(;u!==null;)dT(u.alternate,u),u=u.return;En=null}}function fp(u,h){var p=u.timeoutHandle;p!==-1&&(u.timeoutHandle=-1,aM(p)),p=u.cancelPendingCommit,p!==null&&(u.cancelPendingCommit=null,p()),ac=0,qw(),bs=u,En=p=bi(u.current,null),Rn=h,ss=0,no=null,th=!1,up=Ui(u,h),Bw=!1,cp=so=Uw=Af=nh=ir=0,Ei=zg=null,Vw=!1,(h&8)!==0&&(h|=h&32);var y=u.entangledLanes;if(y!==0)for(u=u.entanglements,y&=h;0<y;){var N=31-kn(y),T=1<<N;h|=u[N],y&=~T}return rc=h,mf(),p}function MT(u,h){Bt=null,W.H=_g,h===Se||h===he?(h=Xe(),ss=3):h===Fe?(h=Xe(),ss=4):ss=h===kw?8:h!==null&&typeof h=="object"&&typeof h.then=="function"?6:1,no=h,En===null&&(ir=1,Py(u,xi(h,u.current)))}function zT(){var u=Es.current;return u===null?!0:(Rn&4194048)===Rn?Bn===null:(Rn&62914560)===Rn||(Rn&536870912)!==0?u===Bn:!1}function PT(){var u=W.H;return W.H=_g,u===null?_g:u}function BT(){var u=W.A;return W.A=M8,u}function Zy(){ir=4,th||(Rn&4194048)!==Rn&&Es.current!==null||(up=!0),(nh&134217727)===0&&(Af&134217727)===0||bs===null||ah(bs,Rn,so,!1)}function Hw(u,h,p){var y=Zn;Zn|=2;var N=PT(),T=BT();(bs!==u||Rn!==h)&&(Xy=null,fp(u,h)),h=!1;var z=ir;e:do try{if(ss!==0&&En!==null){var ne=En,be=no;switch(ss){case 8:qw(),z=6;break e;case 3:case 2:case 9:case 6:Es.current===null&&(h=!0);var ze=ss;if(ss=0,no=null,dp(u,ne,be,ze),p&&up){z=0;break e}break;default:ze=ss,ss=0,no=null,dp(u,ne,be,ze)}}B8(),z=ir;break}catch(He){MT(u,He)}while(!0);return h&&u.shellSuspendCounter++,$o=eu=null,Zn=y,W.H=N,W.A=T,En===null&&(bs=null,Rn=0,mf()),z}function B8(){for(;En!==null;)UT(En)}function U8(u,h){var p=Zn;Zn|=2;var y=PT(),N=BT();bs!==u||Rn!==h?(Xy=null,Ky=zt()+500,fp(u,h)):up=Ui(u,h);e:do try{if(ss!==0&&En!==null){h=En;var T=no;t:switch(ss){case 1:ss=0,no=null,dp(u,h,T,1);break;case 2:case 9:if(Re(T)){ss=0,no=null,VT(h);break}h=function(){ss!==2&&ss!==9||bs!==u||(ss=7),uu(u)},T.then(h,h);break e;case 3:ss=7;break e;case 4:ss=5;break e;case 7:Re(T)?(ss=0,no=null,VT(h)):(ss=0,no=null,dp(u,h,T,7));break;case 5:var z=null;switch(En.tag){case 26:z=En.memoizedState;case 5:case 27:var ne=En;if(z?AA(z):ne.stateNode.complete){ss=0,no=null;var be=ne.sibling;if(be!==null)En=be;else{var ze=ne.return;ze!==null?(En=ze,Jy(ze)):En=null}break t}}ss=0,no=null,dp(u,h,T,5);break;case 6:ss=0,no=null,dp(u,h,T,6);break;case 8:qw(),ir=6;break e;default:throw Error(s(462))}}V8();break}catch(He){MT(u,He)}while(!0);return $o=eu=null,W.H=y,W.A=N,Zn=p,En!==null?0:(bs=null,Rn=0,mf(),ir)}function V8(){for(;En!==null&&!bt();)UT(En)}function UT(u){var h=hT(u.alternate,u,rc);u.memoizedProps=u.pendingProps,h===null?Jy(u):En=h}function VT(u){var h=u,p=h.alternate;switch(h.tag){case 15:case 0:h=aT(p,h,h.pendingProps,h.type,void 0,Rn);break;case 11:h=aT(p,h,h.pendingProps,h.type.render,h.ref,Rn);break;case 5:ep(h);default:dT(p,h),h=En=bf(h,rc),h=hT(p,h,rc)}u.memoizedProps=u.pendingProps,h===null?Jy(u):En=h}function dp(u,h,p,y){$o=eu=null,ep(h),Qe=null,At=0;var N=h.return;try{if(_8(u,N,h,p,Rn)){ir=1,Py(u,xi(p,u.current)),En=null;return}}catch(T){if(N!==null)throw En=N,T;ir=1,Py(u,xi(p,u.current)),En=null;return}h.flags&32768?(In||y===1?u=!0:up||(Rn&536870912)!==0?u=!1:(th=u=!0,(y===2||y===9||y===3||y===6)&&(y=Es.current,y!==null&&y.tag===13&&(y.flags|=16384))),jT(h,u)):Jy(h)}function Jy(u){var h=u;do{if((h.flags&32768)!==0){jT(h,th);return}u=h.return;var p=D8(h.alternate,h,rc);if(p!==null){En=p;return}if(h=h.sibling,h!==null){En=h;return}En=h=u}while(h!==null);ir===0&&(ir=5)}function jT(u,h){do{var p=O8(u.alternate,u);if(p!==null){p.flags&=32767,En=p;return}if(p=u.return,p!==null&&(p.flags|=32768,p.subtreeFlags=0,p.deletions=null),!h&&(u=u.sibling,u!==null)){En=u;return}En=u=p}while(u!==null);ir=6,En=null}function WT(u,h,p,y,N,T,z,ne,be){u.cancelPendingCommit=null;do Qy();while(Wr!==0);if((Zn&6)!==0)throw Error(s(327));if(h!==null){if(h===u.current)throw Error(s(177));if(T=h.lanes|h.childLanes,T|=Bd,Xo(u,p,T,z,ne,be),u===bs&&(En=bs=null,Rn=0),hp=h,rh=u,ac=p,jw=T,Ww=N,DT=y,(h.subtreeFlags&10256)!==0||(h.flags&10256)!==0?(u.callbackNode=null,u.callbackPriority=0,q8(Yt,function(){return XT(),null})):(u.callbackNode=null,u.callbackPriority=0),y=(h.flags&13878)!==0,(h.subtreeFlags&13878)!==0||y){y=W.T,W.T=null,N=se.p,se.p=2,z=Zn,Zn|=4;try{L8(u,h,p)}finally{Zn=z,se.p=N,W.T=y}}Wr=1,GT(),qT(),HT()}}function GT(){if(Wr===1){Wr=0;var u=rh,h=hp,p=(h.flags&13878)!==0;if((h.subtreeFlags&13878)!==0||p){p=W.T,W.T=null;var y=se.p;se.p=2;var N=Zn;Zn|=4;try{CT(h,u);var T=a5,z=dl(u.containerInfo),ne=T.focusedElem,be=T.selectionRange;if(z!==ne&&ne&&ne.ownerDocument&&fl(ne.ownerDocument.documentElement,ne)){if(be!==null&&Eo(ne)){var ze=be.start,He=be.end;if(He===void 0&&(He=ze),"selectionStart"in ne)ne.selectionStart=ze,ne.selectionEnd=Math.min(He,ne.value.length);else{var Ze=ne.ownerDocument||document,Pe=Ze&&Ze.defaultView||window;if(Pe.getSelection){var Ue=Pe.getSelection(),kt=ne.textContent.length,Xt=Math.min(be.start,kt),ps=be.end===void 0?Xt:Math.min(be.end,kt);!Ue.extend&&Xt>ps&&(z=ps,ps=Xt,Xt=z);var Ee=jc(ne,Xt),Te=jc(ne,ps);if(Ee&&Te&&(Ue.rangeCount!==1||Ue.anchorNode!==Ee.node||Ue.anchorOffset!==Ee.offset||Ue.focusNode!==Te.node||Ue.focusOffset!==Te.offset)){var Me=Ze.createRange();Me.setStart(Ee.node,Ee.offset),Ue.removeAllRanges(),Xt>ps?(Ue.addRange(Me),Ue.extend(Te.node,Te.offset)):(Me.setEnd(Te.node,Te.offset),Ue.addRange(Me))}}}}for(Ze=[],Ue=ne;Ue=Ue.parentNode;)Ue.nodeType===1&&Ze.push({element:Ue,left:Ue.scrollLeft,top:Ue.scrollTop});for(typeof ne.focus=="function"&&ne.focus(),ne=0;ne<Ze.length;ne++){var Ye=Ze[ne];Ye.element.scrollLeft=Ye.left,Ye.element.scrollTop=Ye.top}}h2=!!r5,a5=r5=null}finally{Zn=N,se.p=y,W.T=p}}u.current=h,Wr=2}}function qT(){if(Wr===2){Wr=0;var u=rh,h=hp,p=(h.flags&8772)!==0;if((h.subtreeFlags&8772)!==0||p){p=W.T,W.T=null;var y=se.p;se.p=2;var N=Zn;Zn|=4;try{vT(u,h.alternate,h)}finally{Zn=N,se.p=y,W.T=p}}Wr=3}}function HT(){if(Wr===4||Wr===3){Wr=0,Tt();var u=rh,h=hp,p=ac,y=DT;(h.subtreeFlags&10256)!==0||(h.flags&10256)!==0?Wr=5:(Wr=0,hp=rh=null,KT(u,u.pendingLanes));var N=u.pendingLanes;if(N===0&&(sh=null),Js(p),h=h.stateNode,Vt&&typeof Vt.onCommitFiberRoot=="function")try{Vt.onCommitFiberRoot(ln,h,void 0,(h.current.flags&128)===128)}catch{}if(y!==null){h=W.T,N=se.p,se.p=2,W.T=null;try{for(var T=u.onRecoverableError,z=0;z<y.length;z++){var ne=y[z];T(ne.value,{componentStack:ne.stack})}}finally{W.T=h,se.p=N}}(ac&3)!==0&&Qy(),uu(u),N=u.pendingLanes,(p&261930)!==0&&(N&42)!==0?u===Gw?Pg++:(Pg=0,Gw=u):Pg=0,Bg(0)}}function KT(u,h){(u.pooledCacheLanes&=h)===0&&(h=u.pooledCache,h!=null&&(u.pooledCache=null,wf(h)))}function Qy(){return GT(),qT(),HT(),XT()}function XT(){if(Wr!==5)return!1;var u=rh,h=jw;jw=0;var p=Js(ac),y=W.T,N=se.p;try{se.p=32>p?32:p,W.T=null,p=Ww,Ww=null;var T=rh,z=ac;if(Wr=0,hp=rh=null,ac=0,(Zn&6)!==0)throw Error(s(331));var ne=Zn;if(Zn|=4,_T(T.current),AT(T,T.current,z,p),Zn=ne,Bg(0,!1),Vt&&typeof Vt.onPostCommitFiberRoot=="function")try{Vt.onPostCommitFiberRoot(ln,T)}catch{}return!0}finally{se.p=N,W.T=y,KT(u,h)}}function YT(u,h,p){h=xi(p,h),h=Nw(u.stateNode,h,2),u=pn(u,h,2),u!==null&&(Pt(u,2),uu(u))}function rs(u,h,p){if(u.tag===3)YT(u,u,p);else for(;h!==null;){if(h.tag===3){YT(h,u,p);break}else if(h.tag===1){var y=h.stateNode;if(typeof h.type.getDerivedStateFromError=="function"||typeof y.componentDidCatch=="function"&&(sh===null||!sh.has(y))){u=xi(p,u),p=ZC(2),y=pn(h,p,2),y!==null&&(JC(p,y,h,u),Pt(y,2),uu(y));break}}h=h.return}}function Kw(u,h,p){var y=u.pingCache;if(y===null){y=u.pingCache=new z8;var N=new Set;y.set(h,N)}else N=y.get(h),N===void 0&&(N=new Set,y.set(h,N));N.has(p)||(Bw=!0,N.add(p),u=j8.bind(null,u,h,p),h.then(u,u))}function j8(u,h,p){var y=u.pingCache;y!==null&&y.delete(h),u.pingedLanes|=u.suspendedLanes&p,u.warmLanes&=~p,bs===u&&(Rn&p)===p&&(ir===4||ir===3&&(Rn&62914560)===Rn&&300>zt()-Hy?(Zn&2)===0&&fp(u,0):Uw|=p,cp===Rn&&(cp=0)),uu(u)}function ZT(u,h){h===0&&(h=yo()),u=ml(u,h),u!==null&&(Pt(u,h),uu(u))}function W8(u){var h=u.memoizedState,p=0;h!==null&&(p=h.retryLane),ZT(u,p)}function G8(u,h){var p=0;switch(u.tag){case 31:case 13:var y=u.stateNode,N=u.memoizedState;N!==null&&(p=N.retryLane);break;case 19:y=u.stateNode;break;case 22:y=u.stateNode._retryCache;break;default:throw Error(s(314))}y!==null&&y.delete(h),ZT(u,p)}function q8(u,h){return dt(u,h)}var e2=null,pp=null,Xw=!1,t2=!1,Yw=!1,ih=0;function uu(u){u!==pp&&u.next===null&&(pp===null?e2=pp=u:pp=pp.next=u),t2=!0,Xw||(Xw=!0,K8())}function Bg(u,h){if(!Yw&&t2){Yw=!0;do for(var p=!1,y=e2;y!==null;){if(u!==0){var N=y.pendingLanes;if(N===0)var T=0;else{var z=y.suspendedLanes,ne=y.pingedLanes;T=(1<<31-kn(42|u)+1)-1,T&=N&~(z&~ne),T=T&201326741?T&201326741|1:T?T|2:0}T!==0&&(p=!0,tA(y,T))}else T=Rn,T=On(y,y===bs?T:0,y.cancelPendingCommit!==null||y.timeoutHandle!==-1),(T&3)===0||Ui(y,T)||(p=!0,tA(y,T));y=y.next}while(p);Yw=!1}}function H8(){JT()}function JT(){t2=Xw=!1;var u=0;ih!==0&&rM()&&(u=ih);for(var h=zt(),p=null,y=e2;y!==null;){var N=y.next,T=QT(y,h);T===0?(y.next=null,p===null?e2=N:p.next=N,N===null&&(pp=p)):(p=y,(u!==0||(T&3)!==0)&&(t2=!0)),y=N}Wr!==0&&Wr!==5||Bg(u),ih!==0&&(ih=0)}function QT(u,h){for(var p=u.suspendedLanes,y=u.pingedLanes,N=u.expirationTimes,T=u.pendingLanes&-62914561;0<T;){var z=31-kn(T),ne=1<<z,be=N[z];be===-1?((ne&p)===0||(ne&y)!==0)&&(N[z]=Jr(ne,h)):be<=h&&(u.expiredLanes|=ne),T&=~ne}if(h=bs,p=Rn,p=On(u,u===h?p:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),y=u.callbackNode,p===0||u===h&&(ss===2||ss===9)||u.cancelPendingCommit!==null)return y!==null&&y!==null&&ft(y),u.callbackNode=null,u.callbackPriority=0;if((p&3)===0||Ui(u,p)){if(h=p&-p,h===u.callbackPriority)return h;switch(y!==null&&ft(y),Js(p)){case 2:case 8:p=sn;break;case 32:p=Yt;break;case 268435456:p=en;break;default:p=Yt}return y=eA.bind(null,u),p=dt(p,y),u.callbackPriority=h,u.callbackNode=p,h}return y!==null&&y!==null&&ft(y),u.callbackPriority=2,u.callbackNode=null,2}function eA(u,h){if(Wr!==0&&Wr!==5)return u.callbackNode=null,u.callbackPriority=0,null;var p=u.callbackNode;if(Qy()&&u.callbackNode!==p)return null;var y=Rn;return y=On(u,u===bs?y:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),y===0?null:(LT(u,y,h),QT(u,zt()),u.callbackNode!=null&&u.callbackNode===p?eA.bind(null,u):null)}function tA(u,h){if(Qy())return null;LT(u,h,!0)}function K8(){iM(function(){(Zn&6)!==0?dt(Ut,H8):JT()})}function Zw(){if(ih===0){var u=S;u===0&&(u=nn,nn<<=1,(nn&261888)===0&&(nn=256)),ih=u}return ih}function nA(u){return u==null||typeof u=="symbol"||typeof u=="boolean"?null:typeof u=="function"?u:Ea(""+u)}function sA(u,h){var p=h.ownerDocument.createElement("input");return p.name=h.name,p.value=h.value,u.id&&p.setAttribute("form",u.id),h.parentNode.insertBefore(p,h),u=new FormData(u),p.parentNode.removeChild(p),u}function X8(u,h,p,y,N){if(h==="submit"&&p&&p.stateNode===N){var T=nA((N[Cs]||null).action),z=y.submitter;z&&(h=(h=z[Cs]||null)?nA(h.formAction):z.getAttribute("formAction"),h!==null&&(T=h,z=null));var ne=new mi("action","action",null,y,N);u.push({event:ne,listeners:[{instance:null,listener:function(){if(y.defaultPrevented){if(ih!==0){var be=z?sA(N,z):new FormData(N);yw(p,{pending:!0,data:be,method:N.method,action:T},null,be)}}else typeof T=="function"&&(ne.preventDefault(),be=z?sA(N,z):new FormData(N),yw(p,{pending:!0,data:be,method:N.method,action:T},T,be))},currentTarget:N}]})}}for(var Jw=0;Jw<Wu.length;Jw++){var Qw=Wu[Jw],Y8=Qw.toLowerCase(),Z8=Qw[0].toUpperCase()+Qw.slice(1);yi(Y8,"on"+Z8)}yi(ju,"onAnimationEnd"),yi(df,"onAnimationIteration"),yi(mg,"onAnimationStart"),yi("dblclick","onDoubleClick"),yi("focusin","onFocus"),yi("focusout","onBlur"),yi(Ty,"onTransitionRun"),yi(Ay,"onTransitionStart"),yi(Iy,"onTransitionCancel"),yi(gg,"onTransitionEnd"),Yo("onMouseEnter",["mouseout","mouseover"]),Yo("onMouseLeave",["mouseout","mouseover"]),Yo("onPointerEnter",["pointerout","pointerover"]),Yo("onPointerLeave",["pointerout","pointerover"]),qi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),qi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),qi("onBeforeInput",["compositionend","keypress","textInput","paste"]),qi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),qi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),qi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ug="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),J8=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ug));function rA(u,h){h=(h&4)!==0;for(var p=0;p<u.length;p++){var y=u[p],N=y.event;y=y.listeners;e:{var T=void 0;if(h)for(var z=y.length-1;0<=z;z--){var ne=y[z],be=ne.instance,ze=ne.currentTarget;if(ne=ne.listener,be!==T&&N.isPropagationStopped())break e;T=ne,N.currentTarget=ze;try{T(N)}catch(He){pf(He)}N.currentTarget=null,T=be}else for(z=0;z<y.length;z++){if(ne=y[z],be=ne.instance,ze=ne.currentTarget,ne=ne.listener,be!==T&&N.isPropagationStopped())break e;T=ne,N.currentTarget=ze;try{T(N)}catch(He){pf(He)}N.currentTarget=null,T=be}}}}function _n(u,h){var p=h[Ha];p===void 0&&(p=h[Ha]=new Set);var y=u+"__bubble";p.has(y)||(aA(h,u,2,!1),p.add(y))}function e5(u,h,p){var y=0;h&&(y|=4),aA(p,u,y,h)}var n2="_reactListening"+Math.random().toString(36).slice(2);function t5(u){if(!u[n2]){u[n2]=!0,Xh.forEach(function(p){p!=="selectionchange"&&(J8.has(p)||e5(p,!1,u),e5(p,!0,u))});var h=u.nodeType===9?u:u.ownerDocument;h===null||h[n2]||(h[n2]=!0,e5("selectionchange",!1,h))}}function aA(u,h,p,y){switch(OA(h)){case 2:var N=TM;break;case 8:N=AM;break;default:N=g5}p=N.bind(null,h,p,u),N=void 0,!lf||h!=="touchstart"&&h!=="touchmove"&&h!=="wheel"||(N=!0),y?N!==void 0?u.addEventListener(h,p,{capture:!0,passive:N}):u.addEventListener(h,p,!0):N!==void 0?u.addEventListener(h,p,{passive:N}):u.addEventListener(h,p,!1)}function n5(u,h,p,y,N){var T=y;if((h&1)===0&&(h&2)===0&&y!==null)e:for(;;){if(y===null)return;var z=y.tag;if(z===3||z===4){var ne=y.stateNode.containerInfo;if(ne===N)break;if(z===4)for(z=y.return;z!==null;){var be=z.tag;if((be===3||be===4)&&z.stateNode.containerInfo===N)return;z=z.return}for(;ne!==null;){if(z=Wi(ne),z===null)return;if(be=z.tag,be===5||be===6||be===26||be===27){y=T=z;continue e}ne=ne.parentNode}}y=y.return}Ld(function(){var ze=T,He=Fu(p),Ze=[];e:{var Pe=yg.get(u);if(Pe!==void 0){var Ue=mi,kt=u;switch(u){case"keypress":if(pi(p)===0)break e;case"keydown":case"keyup":Ue=Ln;break;case"focusin":kt="focus",Ue=rl;break;case"focusout":kt="blur",Ue=rl;break;case"beforeblur":case"afterblur":Ue=rl;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ue=uf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ue=sl;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ue=mr;break;case ju:case df:case mg:Ue=_;break;case gg:Ue=Mr;break;case"scroll":case"scrollend":Ue=Fc;break;case"wheel":Ue=Yi;break;case"copy":case"cut":case"paste":Ue=de;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ue=Gs;break;case"toggle":case"beforetoggle":Ue=cf}var Xt=(h&4)!==0,ps=!Xt&&(u==="scroll"||u==="scrollend"),Ee=Xt?Pe!==null?Pe+"Capture":null:Pe;Xt=[];for(var Te=ze,Me;Te!==null;){var Ye=Te;if(Me=Ye.stateNode,Ye=Ye.tag,Ye!==5&&Ye!==26&&Ye!==27||Me===null||Ee===null||(Ye=Ya(Te,Ee),Ye!=null&&Xt.push(Vg(Te,Ye,Me))),ps)break;Te=Te.return}0<Xt.length&&(Pe=new Ue(Pe,kt,null,p,He),Ze.push({event:Pe,listeners:Xt}))}}if((h&7)===0){e:{if(Pe=u==="mouseover"||u==="pointerover",Ue=u==="mouseout"||u==="pointerout",Pe&&p!==Jo&&(kt=p.relatedTarget||p.fromElement)&&(Wi(kt)||kt[Qr]))break e;if((Ue||Pe)&&(Pe=He.window===He?He:(Pe=He.ownerDocument)?Pe.defaultView||Pe.parentWindow:window,Ue?(kt=p.relatedTarget||p.toElement,Ue=ze,kt=kt?Wi(kt):null,kt!==null&&(ps=a(kt),Xt=kt.tag,kt!==ps||Xt!==5&&Xt!==27&&Xt!==6)&&(kt=null)):(Ue=null,kt=ze),Ue!==kt)){if(Xt=uf,Ye="onMouseLeave",Ee="onMouseEnter",Te="mouse",(u==="pointerout"||u==="pointerover")&&(Xt=Gs,Ye="onPointerLeave",Ee="onPointerEnter",Te="pointer"),ps=Ue==null?Pe:Ou(Ue),Me=kt==null?Pe:Ou(kt),Pe=new Xt(Ye,Te+"leave",Ue,p,He),Pe.target=ps,Pe.relatedTarget=Me,Ye=null,Wi(He)===ze&&(Xt=new Xt(Ee,Te+"enter",kt,p,He),Xt.target=Me,Xt.relatedTarget=ps,Ye=Xt),ps=Ye,Ue&&kt)t:{for(Xt=Q8,Ee=Ue,Te=kt,Me=0,Ye=Ee;Ye;Ye=Xt(Ye))Me++;Ye=0;for(var Gt=Te;Gt;Gt=Xt(Gt))Ye++;for(;0<Me-Ye;)Ee=Xt(Ee),Me--;for(;0<Ye-Me;)Te=Xt(Te),Ye--;for(;Me--;){if(Ee===Te||Te!==null&&Ee===Te.alternate){Xt=Ee;break t}Ee=Xt(Ee),Te=Xt(Te)}Xt=null}else Xt=null;Ue!==null&&iA(Ze,Pe,Ue,Xt,!1),kt!==null&&ps!==null&&iA(Ze,ps,kt,Xt,!0)}}e:{if(Pe=ze?Ou(ze):window,Ue=Pe.nodeName&&Pe.nodeName.toLowerCase(),Ue==="select"||Ue==="input"&&Pe.type==="file")var qn=Yl;else if(hf(Pe))if(_a)qn=Ao;else{qn=qs;var Dt=Uc}else Ue=Pe.nodeName,!Ue||Ue.toLowerCase()!=="input"||Pe.type!=="checkbox"&&Pe.type!=="radio"?ze&&rf(ze.elementType)&&(qn=Yl):qn=Pd;if(qn&&(qn=qn(u,ze))){Ja(Ze,qn,p,He);break e}Dt&&Dt(u,Pe,ze),u==="focusout"&&ze&&Pe.type==="number"&&ze.memoizedProps.value!=null&&tf(Pe,"number",Pe.value)}switch(Dt=ze?Ou(ze):window,u){case"focusin":(hf(Dt)||Dt.contentEditable==="true")&&(Qa=Dt,pl=ze,ea=null);break;case"focusout":ea=pl=Qa=null;break;case"mousedown":gi=!0;break;case"contextmenu":case"mouseup":case"dragend":gi=!1,Wn(Ze,p,He);break;case"selectionchange":if(Vu)break;case"keydown":case"keyup":Wn(Ze,p,He)}var yn;if(No)e:{switch(u){case"compositionstart":var Dn="onCompositionStart";break e;case"compositionend":Dn="onCompositionEnd";break e;case"compositionupdate":Dn="onCompositionUpdate";break e}Dn=void 0}else ko?Xl(u,p)&&(Dn="onCompositionEnd"):u==="keydown"&&p.keyCode===229&&(Dn="onCompositionStart");Dn&&(ol&&p.locale!=="ko"&&(ko||Dn!=="onCompositionStart"?Dn==="onCompositionEnd"&&ko&&(yn=Fd()):(Za=He,zu="value"in Za?Za.value:Za.textContent,ko=!0)),Dt=s2(ze,Dn),0<Dt.length&&(Dn=new Ie(Dn,u,null,p,He),Ze.push({event:Dn,listeners:Dt}),yn?Dn.data=yn:(yn=zc(p),yn!==null&&(Dn.data=yn)))),(yn=Uu?xa(u,p):ll(u,p))&&(Dn=s2(ze,"onBeforeInput"),0<Dn.length&&(Dt=new Ie("onBeforeInput","beforeinput",null,p,He),Ze.push({event:Dt,listeners:Dn}),Dt.data=yn)),X8(Ze,u,ze,p,He)}rA(Ze,h)})}function Vg(u,h,p){return{instance:u,listener:h,currentTarget:p}}function s2(u,h){for(var p=h+"Capture",y=[];u!==null;){var N=u,T=N.stateNode;if(N=N.tag,N!==5&&N!==26&&N!==27||T===null||(N=Ya(u,p),N!=null&&y.unshift(Vg(u,N,T)),N=Ya(u,h),N!=null&&y.push(Vg(u,N,T))),u.tag===3)return y;u=u.return}return[]}function Q8(u){if(u===null)return null;do u=u.return;while(u&&u.tag!==5&&u.tag!==27);return u||null}function iA(u,h,p,y,N){for(var T=h._reactName,z=[];p!==null&&p!==y;){var ne=p,be=ne.alternate,ze=ne.stateNode;if(ne=ne.tag,be!==null&&be===y)break;ne!==5&&ne!==26&&ne!==27||ze===null||(be=ze,N?(ze=Ya(p,T),ze!=null&&z.unshift(Vg(p,ze,be))):N||(ze=Ya(p,T),ze!=null&&z.push(Vg(p,ze,be)))),p=p.return}z.length!==0&&u.push({event:h,listeners:z})}var eM=/\r\n?/g,tM=/\u0000|\uFFFD/g;function oA(u){return(typeof u=="string"?u:""+u).replace(eM,`
`).replace(tM,"")}function lA(u,h){return h=oA(h),oA(u)===h}function ds(u,h,p,y,N,T){switch(p){case"children":typeof y=="string"?h==="body"||h==="textarea"&&y===""||Ki(u,y):(typeof y=="number"||typeof y=="bigint")&&h!=="body"&&Ki(u,""+y);break;case"className":Zo(u,"class",y);break;case"tabIndex":Zo(u,"tabindex",y);break;case"dir":case"role":case"viewBox":case"width":case"height":Zo(u,p,y);break;case"style":Rd(u,y,T);break;case"data":if(h!=="object"){Zo(u,"data",y);break}case"src":case"href":if(y===""&&(h!=="a"||p!=="href")){u.removeAttribute(p);break}if(y==null||typeof y=="function"||typeof y=="symbol"||typeof y=="boolean"){u.removeAttribute(p);break}y=Ea(""+y),u.setAttribute(p,y);break;case"action":case"formAction":if(typeof y=="function"){u.setAttribute(p,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof T=="function"&&(p==="formAction"?(h!=="input"&&ds(u,h,"name",N.name,N,null),ds(u,h,"formEncType",N.formEncType,N,null),ds(u,h,"formMethod",N.formMethod,N,null),ds(u,h,"formTarget",N.formTarget,N,null)):(ds(u,h,"encType",N.encType,N,null),ds(u,h,"method",N.method,N,null),ds(u,h,"target",N.target,N,null)));if(y==null||typeof y=="symbol"||typeof y=="boolean"){u.removeAttribute(p);break}y=Ea(""+y),u.setAttribute(p,y);break;case"onClick":y!=null&&(u.onclick=Xi);break;case"onScroll":y!=null&&_n("scroll",u);break;case"onScrollEnd":y!=null&&_n("scrollend",u);break;case"dangerouslySetInnerHTML":if(y!=null){if(typeof y!="object"||!("__html"in y))throw Error(s(61));if(p=y.__html,p!=null){if(N.children!=null)throw Error(s(60));u.innerHTML=p}}break;case"multiple":u.multiple=y&&typeof y!="function"&&typeof y!="symbol";break;case"muted":u.muted=y&&typeof y!="function"&&typeof y!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(y==null||typeof y=="function"||typeof y=="boolean"||typeof y=="symbol"){u.removeAttribute("xlink:href");break}p=Ea(""+y),u.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",p);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":y!=null&&typeof y!="function"&&typeof y!="symbol"?u.setAttribute(p,""+y):u.removeAttribute(p);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":y&&typeof y!="function"&&typeof y!="symbol"?u.setAttribute(p,""):u.removeAttribute(p);break;case"capture":case"download":y===!0?u.setAttribute(p,""):y!==!1&&y!=null&&typeof y!="function"&&typeof y!="symbol"?u.setAttribute(p,y):u.removeAttribute(p);break;case"cols":case"rows":case"size":case"span":y!=null&&typeof y!="function"&&typeof y!="symbol"&&!isNaN(y)&&1<=y?u.setAttribute(p,y):u.removeAttribute(p);break;case"rowSpan":case"start":y==null||typeof y=="function"||typeof y=="symbol"||isNaN(y)?u.removeAttribute(p):u.setAttribute(p,y);break;case"popover":_n("beforetoggle",u),_n("toggle",u),Xa(u,"popover",y);break;case"xlinkActuate":Hi(u,"http://www.w3.org/1999/xlink","xlink:actuate",y);break;case"xlinkArcrole":Hi(u,"http://www.w3.org/1999/xlink","xlink:arcrole",y);break;case"xlinkRole":Hi(u,"http://www.w3.org/1999/xlink","xlink:role",y);break;case"xlinkShow":Hi(u,"http://www.w3.org/1999/xlink","xlink:show",y);break;case"xlinkTitle":Hi(u,"http://www.w3.org/1999/xlink","xlink:title",y);break;case"xlinkType":Hi(u,"http://www.w3.org/1999/xlink","xlink:type",y);break;case"xmlBase":Hi(u,"http://www.w3.org/XML/1998/namespace","xml:base",y);break;case"xmlLang":Hi(u,"http://www.w3.org/XML/1998/namespace","xml:lang",y);break;case"xmlSpace":Hi(u,"http://www.w3.org/XML/1998/namespace","xml:space",y);break;case"is":Xa(u,"is",y);break;case"innerText":case"textContent":break;default:(!(2<p.length)||p[0]!=="o"&&p[0]!=="O"||p[1]!=="n"&&p[1]!=="N")&&(p=af.get(p)||p,Xa(u,p,y))}}function s5(u,h,p,y,N,T){switch(p){case"style":Rd(u,y,T);break;case"dangerouslySetInnerHTML":if(y!=null){if(typeof y!="object"||!("__html"in y))throw Error(s(61));if(p=y.__html,p!=null){if(N.children!=null)throw Error(s(60));u.innerHTML=p}}break;case"children":typeof y=="string"?Ki(u,y):(typeof y=="number"||typeof y=="bigint")&&Ki(u,""+y);break;case"onScroll":y!=null&&_n("scroll",u);break;case"onScrollEnd":y!=null&&_n("scrollend",u);break;case"onClick":y!=null&&(u.onclick=Xi);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ka.hasOwnProperty(p))e:{if(p[0]==="o"&&p[1]==="n"&&(N=p.endsWith("Capture"),h=p.slice(2,N?p.length-7:void 0),T=u[Cs]||null,T=T!=null?T[p]:null,typeof T=="function"&&u.removeEventListener(h,T,N),typeof y=="function")){typeof T!="function"&&T!==null&&(p in u?u[p]=null:u.hasAttribute(p)&&u.removeAttribute(p)),u.addEventListener(h,y,N);break e}p in u?u[p]=y:y===!0?u.setAttribute(p,""):Xa(u,p,y)}}}function ka(u,h,p){switch(h){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":_n("error",u),_n("load",u);var y=!1,N=!1,T;for(T in p)if(p.hasOwnProperty(T)){var z=p[T];if(z!=null)switch(T){case"src":y=!0;break;case"srcSet":N=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,h));default:ds(u,h,T,z,p,null)}}N&&ds(u,h,"srcSet",p.srcSet,p,null),y&&ds(u,h,"src",p.src,p,null);return;case"input":_n("invalid",u);var ne=T=z=N=null,be=null,ze=null;for(y in p)if(p.hasOwnProperty(y)){var He=p[y];if(He!=null)switch(y){case"name":N=He;break;case"type":z=He;break;case"checked":be=He;break;case"defaultChecked":ze=He;break;case"value":T=He;break;case"defaultValue":ne=He;break;case"children":case"dangerouslySetInnerHTML":if(He!=null)throw Error(s(137,h));break;default:ds(u,h,y,He,p,null)}}_d(u,T,ne,be,ze,z,N,!1);return;case"select":_n("invalid",u),y=z=T=null;for(N in p)if(p.hasOwnProperty(N)&&(ne=p[N],ne!=null))switch(N){case"value":T=ne;break;case"defaultValue":z=ne;break;case"multiple":y=ne;default:ds(u,h,N,ne,p,null)}h=T,p=z,u.multiple=!!y,h!=null?ba(u,!!y,h,!1):p!=null&&ba(u,!!y,p,!0);return;case"textarea":_n("invalid",u),T=N=y=null;for(z in p)if(p.hasOwnProperty(z)&&(ne=p[z],ne!=null))switch(z){case"value":y=ne;break;case"defaultValue":N=ne;break;case"children":T=ne;break;case"dangerouslySetInnerHTML":if(ne!=null)throw Error(s(91));break;default:ds(u,h,z,ne,p,null)}sf(u,y,N,T);return;case"option":for(be in p)if(p.hasOwnProperty(be)&&(y=p[be],y!=null))switch(be){case"selected":u.selected=y&&typeof y!="function"&&typeof y!="symbol";break;default:ds(u,h,be,y,p,null)}return;case"dialog":_n("beforetoggle",u),_n("toggle",u),_n("cancel",u),_n("close",u);break;case"iframe":case"object":_n("load",u);break;case"video":case"audio":for(y=0;y<Ug.length;y++)_n(Ug[y],u);break;case"image":_n("error",u),_n("load",u);break;case"details":_n("toggle",u);break;case"embed":case"source":case"link":_n("error",u),_n("load",u);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ze in p)if(p.hasOwnProperty(ze)&&(y=p[ze],y!=null))switch(ze){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,h));default:ds(u,h,ze,y,p,null)}return;default:if(rf(h)){for(He in p)p.hasOwnProperty(He)&&(y=p[He],y!==void 0&&s5(u,h,He,y,p,void 0));return}}for(ne in p)p.hasOwnProperty(ne)&&(y=p[ne],y!=null&&ds(u,h,ne,y,p,null))}function nM(u,h,p,y){switch(h){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var N=null,T=null,z=null,ne=null,be=null,ze=null,He=null;for(Ue in p){var Ze=p[Ue];if(p.hasOwnProperty(Ue)&&Ze!=null)switch(Ue){case"checked":break;case"value":break;case"defaultValue":be=Ze;default:y.hasOwnProperty(Ue)||ds(u,h,Ue,null,y,Ze)}}for(var Pe in y){var Ue=y[Pe];if(Ze=p[Pe],y.hasOwnProperty(Pe)&&(Ue!=null||Ze!=null))switch(Pe){case"type":T=Ue;break;case"name":N=Ue;break;case"checked":ze=Ue;break;case"defaultChecked":He=Ue;break;case"value":z=Ue;break;case"defaultValue":ne=Ue;break;case"children":case"dangerouslySetInnerHTML":if(Ue!=null)throw Error(s(137,h));break;default:Ue!==Ze&&ds(u,h,Pe,Ue,y,Ze)}}Dc(u,z,ne,be,ze,He,T,N);return;case"select":Ue=z=ne=Pe=null;for(T in p)if(be=p[T],p.hasOwnProperty(T)&&be!=null)switch(T){case"value":break;case"multiple":Ue=be;default:y.hasOwnProperty(T)||ds(u,h,T,null,y,be)}for(N in y)if(T=y[N],be=p[N],y.hasOwnProperty(N)&&(T!=null||be!=null))switch(N){case"value":Pe=T;break;case"defaultValue":ne=T;break;case"multiple":z=T;default:T!==be&&ds(u,h,N,T,y,be)}h=ne,p=z,y=Ue,Pe!=null?ba(u,!!p,Pe,!1):!!y!=!!p&&(h!=null?ba(u,!!p,h,!0):ba(u,!!p,p?[]:"",!1));return;case"textarea":Ue=Pe=null;for(ne in p)if(N=p[ne],p.hasOwnProperty(ne)&&N!=null&&!y.hasOwnProperty(ne))switch(ne){case"value":break;case"children":break;default:ds(u,h,ne,null,y,N)}for(z in y)if(N=y[z],T=p[z],y.hasOwnProperty(z)&&(N!=null||T!=null))switch(z){case"value":Pe=N;break;case"defaultValue":Ue=N;break;case"children":break;case"dangerouslySetInnerHTML":if(N!=null)throw Error(s(91));break;default:N!==T&&ds(u,h,z,N,y,T)}nf(u,Pe,Ue);return;case"option":for(var kt in p)if(Pe=p[kt],p.hasOwnProperty(kt)&&Pe!=null&&!y.hasOwnProperty(kt))switch(kt){case"selected":u.selected=!1;break;default:ds(u,h,kt,null,y,Pe)}for(be in y)if(Pe=y[be],Ue=p[be],y.hasOwnProperty(be)&&Pe!==Ue&&(Pe!=null||Ue!=null))switch(be){case"selected":u.selected=Pe&&typeof Pe!="function"&&typeof Pe!="symbol";break;default:ds(u,h,be,Pe,y,Ue)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Xt in p)Pe=p[Xt],p.hasOwnProperty(Xt)&&Pe!=null&&!y.hasOwnProperty(Xt)&&ds(u,h,Xt,null,y,Pe);for(ze in y)if(Pe=y[ze],Ue=p[ze],y.hasOwnProperty(ze)&&Pe!==Ue&&(Pe!=null||Ue!=null))switch(ze){case"children":case"dangerouslySetInnerHTML":if(Pe!=null)throw Error(s(137,h));break;default:ds(u,h,ze,Pe,y,Ue)}return;default:if(rf(h)){for(var ps in p)Pe=p[ps],p.hasOwnProperty(ps)&&Pe!==void 0&&!y.hasOwnProperty(ps)&&s5(u,h,ps,void 0,y,Pe);for(He in y)Pe=y[He],Ue=p[He],!y.hasOwnProperty(He)||Pe===Ue||Pe===void 0&&Ue===void 0||s5(u,h,He,Pe,y,Ue);return}}for(var Ee in p)Pe=p[Ee],p.hasOwnProperty(Ee)&&Pe!=null&&!y.hasOwnProperty(Ee)&&ds(u,h,Ee,null,y,Pe);for(Ze in y)Pe=y[Ze],Ue=p[Ze],!y.hasOwnProperty(Ze)||Pe===Ue||Pe==null&&Ue==null||ds(u,h,Ze,Pe,y,Ue)}function uA(u){switch(u){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function sM(){if(typeof performance.getEntriesByType=="function"){for(var u=0,h=0,p=performance.getEntriesByType("resource"),y=0;y<p.length;y++){var N=p[y],T=N.transferSize,z=N.initiatorType,ne=N.duration;if(T&&ne&&uA(z)){for(z=0,ne=N.responseEnd,y+=1;y<p.length;y++){var be=p[y],ze=be.startTime;if(ze>ne)break;var He=be.transferSize,Ze=be.initiatorType;He&&uA(Ze)&&(be=be.responseEnd,z+=He*(be<ne?1:(ne-ze)/(be-ze)))}if(--y,h+=8*(T+z)/(N.duration/1e3),u++,10<u)break}}if(0<u)return h/u/1e6}return navigator.connection&&(u=navigator.connection.downlink,typeof u=="number")?u:5}var r5=null,a5=null;function r2(u){return u.nodeType===9?u:u.ownerDocument}function cA(u){switch(u){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function hA(u,h){if(u===0)switch(h){case"svg":return 1;case"math":return 2;default:return 0}return u===1&&h==="foreignObject"?0:u}function i5(u,h){return u==="textarea"||u==="noscript"||typeof h.children=="string"||typeof h.children=="number"||typeof h.children=="bigint"||typeof h.dangerouslySetInnerHTML=="object"&&h.dangerouslySetInnerHTML!==null&&h.dangerouslySetInnerHTML.__html!=null}var o5=null;function rM(){var u=window.event;return u&&u.type==="popstate"?u===o5?!1:(o5=u,!0):(o5=null,!1)}var fA=typeof setTimeout=="function"?setTimeout:void 0,aM=typeof clearTimeout=="function"?clearTimeout:void 0,dA=typeof Promise=="function"?Promise:void 0,iM=typeof queueMicrotask=="function"?queueMicrotask:typeof dA<"u"?function(u){return dA.resolve(null).then(u).catch(oM)}:fA;function oM(u){setTimeout(function(){throw u})}function oh(u){return u==="head"}function pA(u,h){var p=h,y=0;do{var N=p.nextSibling;if(u.removeChild(p),N&&N.nodeType===8)if(p=N.data,p==="/$"||p==="/&"){if(y===0){u.removeChild(N),bp(h);return}y--}else if(p==="$"||p==="$?"||p==="$~"||p==="$!"||p==="&")y++;else if(p==="html")jg(u.ownerDocument.documentElement);else if(p==="head"){p=u.ownerDocument.head,jg(p);for(var T=p.firstChild;T;){var z=T.nextSibling,ne=T.nodeName;T[ji]||ne==="SCRIPT"||ne==="STYLE"||ne==="LINK"&&T.rel.toLowerCase()==="stylesheet"||p.removeChild(T),T=z}}else p==="body"&&jg(u.ownerDocument.body);p=N}while(p);bp(h)}function mA(u,h){var p=u;u=0;do{var y=p.nextSibling;if(p.nodeType===1?h?(p._stashedDisplay=p.style.display,p.style.display="none"):(p.style.display=p._stashedDisplay||"",p.getAttribute("style")===""&&p.removeAttribute("style")):p.nodeType===3&&(h?(p._stashedText=p.nodeValue,p.nodeValue=""):p.nodeValue=p._stashedText||""),y&&y.nodeType===8)if(p=y.data,p==="/$"){if(u===0)break;u--}else p!=="$"&&p!=="$?"&&p!=="$~"&&p!=="$!"||u++;p=y}while(p)}function l5(u){var h=u.firstChild;for(h&&h.nodeType===10&&(h=h.nextSibling);h;){var p=h;switch(h=h.nextSibling,p.nodeName){case"HTML":case"HEAD":case"BODY":l5(p),Gl(p);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(p.rel.toLowerCase()==="stylesheet")continue}u.removeChild(p)}}function lM(u,h,p,y){for(;u.nodeType===1;){var N=p;if(u.nodeName.toLowerCase()!==h.toLowerCase()){if(!y&&(u.nodeName!=="INPUT"||u.type!=="hidden"))break}else if(y){if(!u[ji])switch(h){case"meta":if(!u.hasAttribute("itemprop"))break;return u;case"link":if(T=u.getAttribute("rel"),T==="stylesheet"&&u.hasAttribute("data-precedence"))break;if(T!==N.rel||u.getAttribute("href")!==(N.href==null||N.href===""?null:N.href)||u.getAttribute("crossorigin")!==(N.crossOrigin==null?null:N.crossOrigin)||u.getAttribute("title")!==(N.title==null?null:N.title))break;return u;case"style":if(u.hasAttribute("data-precedence"))break;return u;case"script":if(T=u.getAttribute("src"),(T!==(N.src==null?null:N.src)||u.getAttribute("type")!==(N.type==null?null:N.type)||u.getAttribute("crossorigin")!==(N.crossOrigin==null?null:N.crossOrigin))&&T&&u.hasAttribute("async")&&!u.hasAttribute("itemprop"))break;return u;default:return u}}else if(h==="input"&&u.type==="hidden"){var T=N.name==null?null:""+N.name;if(N.type==="hidden"&&u.getAttribute("name")===T)return u}else return u;if(u=Oo(u.nextSibling),u===null)break}return null}function uM(u,h,p){if(h==="")return null;for(;u.nodeType!==3;)if((u.nodeType!==1||u.nodeName!=="INPUT"||u.type!=="hidden")&&!p||(u=Oo(u.nextSibling),u===null))return null;return u}function gA(u,h){for(;u.nodeType!==8;)if((u.nodeType!==1||u.nodeName!=="INPUT"||u.type!=="hidden")&&!h||(u=Oo(u.nextSibling),u===null))return null;return u}function u5(u){return u.data==="$?"||u.data==="$~"}function c5(u){return u.data==="$!"||u.data==="$?"&&u.ownerDocument.readyState!=="loading"}function cM(u,h){var p=u.ownerDocument;if(u.data==="$~")u._reactRetry=h;else if(u.data!=="$?"||p.readyState!=="loading")h();else{var y=function(){h(),p.removeEventListener("DOMContentLoaded",y)};p.addEventListener("DOMContentLoaded",y),u._reactRetry=y}}function Oo(u){for(;u!=null;u=u.nextSibling){var h=u.nodeType;if(h===1||h===3)break;if(h===8){if(h=u.data,h==="$"||h==="$!"||h==="$?"||h==="$~"||h==="&"||h==="F!"||h==="F")break;if(h==="/$"||h==="/&")return null}}return u}var h5=null;function yA(u){u=u.nextSibling;for(var h=0;u;){if(u.nodeType===8){var p=u.data;if(p==="/$"||p==="/&"){if(h===0)return Oo(u.nextSibling);h--}else p!=="$"&&p!=="$!"&&p!=="$?"&&p!=="$~"&&p!=="&"||h++}u=u.nextSibling}return null}function bA(u){u=u.previousSibling;for(var h=0;u;){if(u.nodeType===8){var p=u.data;if(p==="$"||p==="$!"||p==="$?"||p==="$~"||p==="&"){if(h===0)return u;h--}else p!=="/$"&&p!=="/&"||h++}u=u.previousSibling}return null}function xA(u,h,p){switch(h=r2(p),u){case"html":if(u=h.documentElement,!u)throw Error(s(452));return u;case"head":if(u=h.head,!u)throw Error(s(453));return u;case"body":if(u=h.body,!u)throw Error(s(454));return u;default:throw Error(s(451))}}function jg(u){for(var h=u.attributes;h.length;)u.removeAttributeNode(h[0]);Gl(u)}var Lo=new Map,vA=new Set;function a2(u){return typeof u.getRootNode=="function"?u.getRootNode():u.nodeType===9?u:u.ownerDocument}var ic=se.d;se.d={f:hM,r:fM,D:dM,C:pM,L:mM,m:gM,X:bM,S:yM,M:xM};function hM(){var u=ic.f(),h=Yy();return u||h}function fM(u){var h=Gi(u);h!==null&&h.tag===5&&h.type==="form"?MC(h):ic.r(u)}var mp=typeof document>"u"?null:document;function wA(u,h,p){var y=mp;if(y&&typeof h=="string"&&h){var N=Qs(h);N='link[rel="'+u+'"][href="'+N+'"]',typeof p=="string"&&(N+='[crossorigin="'+p+'"]'),vA.has(N)||(vA.add(N),u={rel:u,crossOrigin:p,href:h},y.querySelector(N)===null&&(h=y.createElement("link"),ka(h,"link",u),Ws(h),y.head.appendChild(h)))}}function dM(u){ic.D(u),wA("dns-prefetch",u,null)}function pM(u,h){ic.C(u,h),wA("preconnect",u,h)}function mM(u,h,p){ic.L(u,h,p);var y=mp;if(y&&u&&h){var N='link[rel="preload"][as="'+Qs(h)+'"]';h==="image"&&p&&p.imageSrcSet?(N+='[imagesrcset="'+Qs(p.imageSrcSet)+'"]',typeof p.imageSizes=="string"&&(N+='[imagesizes="'+Qs(p.imageSizes)+'"]')):N+='[href="'+Qs(u)+'"]';var T=N;switch(h){case"style":T=gp(u);break;case"script":T=yp(u)}Lo.has(T)||(u=d({rel:"preload",href:h==="image"&&p&&p.imageSrcSet?void 0:u,as:h},p),Lo.set(T,u),y.querySelector(N)!==null||h==="style"&&y.querySelector(Wg(T))||h==="script"&&y.querySelector(Gg(T))||(h=y.createElement("link"),ka(h,"link",u),Ws(h),y.head.appendChild(h)))}}function gM(u,h){ic.m(u,h);var p=mp;if(p&&u){var y=h&&typeof h.as=="string"?h.as:"script",N='link[rel="modulepreload"][as="'+Qs(y)+'"][href="'+Qs(u)+'"]',T=N;switch(y){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":T=yp(u)}if(!Lo.has(T)&&(u=d({rel:"modulepreload",href:u},h),Lo.set(T,u),p.querySelector(N)===null)){switch(y){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(p.querySelector(Gg(T)))return}y=p.createElement("link"),ka(y,"link",u),Ws(y),p.head.appendChild(y)}}}function yM(u,h,p){ic.S(u,h,p);var y=mp;if(y&&u){var N=xo(y).hoistableStyles,T=gp(u);h=h||"default";var z=N.get(T);if(!z){var ne={loading:0,preload:null};if(z=y.querySelector(Wg(T)))ne.loading=5;else{u=d({rel:"stylesheet",href:u,"data-precedence":h},p),(p=Lo.get(T))&&f5(u,p);var be=z=y.createElement("link");Ws(be),ka(be,"link",u),be._p=new Promise(function(ze,He){be.onload=ze,be.onerror=He}),be.addEventListener("load",function(){ne.loading|=1}),be.addEventListener("error",function(){ne.loading|=2}),ne.loading|=4,i2(z,h,y)}z={type:"stylesheet",instance:z,count:1,state:ne},N.set(T,z)}}}function bM(u,h){ic.X(u,h);var p=mp;if(p&&u){var y=xo(p).hoistableScripts,N=yp(u),T=y.get(N);T||(T=p.querySelector(Gg(N)),T||(u=d({src:u,async:!0},h),(h=Lo.get(N))&&d5(u,h),T=p.createElement("script"),Ws(T),ka(T,"link",u),p.head.appendChild(T)),T={type:"script",instance:T,count:1,state:null},y.set(N,T))}}function xM(u,h){ic.M(u,h);var p=mp;if(p&&u){var y=xo(p).hoistableScripts,N=yp(u),T=y.get(N);T||(T=p.querySelector(Gg(N)),T||(u=d({src:u,async:!0,type:"module"},h),(h=Lo.get(N))&&d5(u,h),T=p.createElement("script"),Ws(T),ka(T,"link",u),p.head.appendChild(T)),T={type:"script",instance:T,count:1,state:null},y.set(N,T))}}function SA(u,h,p,y){var N=(N=ue.current)?a2(N):null;if(!N)throw Error(s(446));switch(u){case"meta":case"title":return null;case"style":return typeof p.precedence=="string"&&typeof p.href=="string"?(h=gp(p.href),p=xo(N).hoistableStyles,y=p.get(h),y||(y={type:"style",instance:null,count:0,state:null},p.set(h,y)),y):{type:"void",instance:null,count:0,state:null};case"link":if(p.rel==="stylesheet"&&typeof p.href=="string"&&typeof p.precedence=="string"){u=gp(p.href);var T=xo(N).hoistableStyles,z=T.get(u);if(z||(N=N.ownerDocument||N,z={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},T.set(u,z),(T=N.querySelector(Wg(u)))&&!T._p&&(z.instance=T,z.state.loading=5),Lo.has(u)||(p={rel:"preload",as:"style",href:p.href,crossOrigin:p.crossOrigin,integrity:p.integrity,media:p.media,hrefLang:p.hrefLang,referrerPolicy:p.referrerPolicy},Lo.set(u,p),T||vM(N,u,p,z.state))),h&&y===null)throw Error(s(528,""));return z}if(h&&y!==null)throw Error(s(529,""));return null;case"script":return h=p.async,p=p.src,typeof p=="string"&&h&&typeof h!="function"&&typeof h!="symbol"?(h=yp(p),p=xo(N).hoistableScripts,y=p.get(h),y||(y={type:"script",instance:null,count:0,state:null},p.set(h,y)),y):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,u))}}function gp(u){return'href="'+Qs(u)+'"'}function Wg(u){return'link[rel="stylesheet"]['+u+"]"}function NA(u){return d({},u,{"data-precedence":u.precedence,precedence:null})}function vM(u,h,p,y){u.querySelector('link[rel="preload"][as="style"]['+h+"]")?y.loading=1:(h=u.createElement("link"),y.preload=h,h.addEventListener("load",function(){return y.loading|=1}),h.addEventListener("error",function(){return y.loading|=2}),ka(h,"link",p),Ws(h),u.head.appendChild(h))}function yp(u){return'[src="'+Qs(u)+'"]'}function Gg(u){return"script[async]"+u}function kA(u,h,p){if(h.count++,h.instance===null)switch(h.type){case"style":var y=u.querySelector('style[data-href~="'+Qs(p.href)+'"]');if(y)return h.instance=y,Ws(y),y;var N=d({},p,{"data-href":p.href,"data-precedence":p.precedence,href:null,precedence:null});return y=(u.ownerDocument||u).createElement("style"),Ws(y),ka(y,"style",N),i2(y,p.precedence,u),h.instance=y;case"stylesheet":N=gp(p.href);var T=u.querySelector(Wg(N));if(T)return h.state.loading|=4,h.instance=T,Ws(T),T;y=NA(p),(N=Lo.get(N))&&f5(y,N),T=(u.ownerDocument||u).createElement("link"),Ws(T);var z=T;return z._p=new Promise(function(ne,be){z.onload=ne,z.onerror=be}),ka(T,"link",y),h.state.loading|=4,i2(T,p.precedence,u),h.instance=T;case"script":return T=yp(p.src),(N=u.querySelector(Gg(T)))?(h.instance=N,Ws(N),N):(y=p,(N=Lo.get(T))&&(y=d({},p),d5(y,N)),u=u.ownerDocument||u,N=u.createElement("script"),Ws(N),ka(N,"link",y),u.head.appendChild(N),h.instance=N);case"void":return null;default:throw Error(s(443,h.type))}else h.type==="stylesheet"&&(h.state.loading&4)===0&&(y=h.instance,h.state.loading|=4,i2(y,p.precedence,u));return h.instance}function i2(u,h,p){for(var y=p.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),N=y.length?y[y.length-1]:null,T=N,z=0;z<y.length;z++){var ne=y[z];if(ne.dataset.precedence===h)T=ne;else if(T!==N)break}T?T.parentNode.insertBefore(u,T.nextSibling):(h=p.nodeType===9?p.head:p,h.insertBefore(u,h.firstChild))}function f5(u,h){u.crossOrigin==null&&(u.crossOrigin=h.crossOrigin),u.referrerPolicy==null&&(u.referrerPolicy=h.referrerPolicy),u.title==null&&(u.title=h.title)}function d5(u,h){u.crossOrigin==null&&(u.crossOrigin=h.crossOrigin),u.referrerPolicy==null&&(u.referrerPolicy=h.referrerPolicy),u.integrity==null&&(u.integrity=h.integrity)}var o2=null;function CA(u,h,p){if(o2===null){var y=new Map,N=o2=new Map;N.set(p,y)}else N=o2,y=N.get(p),y||(y=new Map,N.set(p,y));if(y.has(u))return y;for(y.set(u,null),p=p.getElementsByTagName(u),N=0;N<p.length;N++){var T=p[N];if(!(T[ji]||T[ts]||u==="link"&&T.getAttribute("rel")==="stylesheet")&&T.namespaceURI!=="http://www.w3.org/2000/svg"){var z=T.getAttribute(h)||"";z=u+z;var ne=y.get(z);ne?ne.push(T):y.set(z,[T])}}return y}function TA(u,h,p){u=u.ownerDocument||u,u.head.insertBefore(p,h==="title"?u.querySelector("head > title"):null)}function wM(u,h,p){if(p===1||h.itemProp!=null)return!1;switch(u){case"meta":case"title":return!0;case"style":if(typeof h.precedence!="string"||typeof h.href!="string"||h.href==="")break;return!0;case"link":if(typeof h.rel!="string"||typeof h.href!="string"||h.href===""||h.onLoad||h.onError)break;switch(h.rel){case"stylesheet":return u=h.disabled,typeof h.precedence=="string"&&u==null;default:return!0}case"script":if(h.async&&typeof h.async!="function"&&typeof h.async!="symbol"&&!h.onLoad&&!h.onError&&h.src&&typeof h.src=="string")return!0}return!1}function AA(u){return!(u.type==="stylesheet"&&(u.state.loading&3)===0)}function SM(u,h,p,y){if(p.type==="stylesheet"&&(typeof y.media!="string"||matchMedia(y.media).matches!==!1)&&(p.state.loading&4)===0){if(p.instance===null){var N=gp(y.href),T=h.querySelector(Wg(N));if(T){h=T._p,h!==null&&typeof h=="object"&&typeof h.then=="function"&&(u.count++,u=l2.bind(u),h.then(u,u)),p.state.loading|=4,p.instance=T,Ws(T);return}T=h.ownerDocument||h,y=NA(y),(N=Lo.get(N))&&f5(y,N),T=T.createElement("link"),Ws(T);var z=T;z._p=new Promise(function(ne,be){z.onload=ne,z.onerror=be}),ka(T,"link",y),p.instance=T}u.stylesheets===null&&(u.stylesheets=new Map),u.stylesheets.set(p,h),(h=p.state.preload)&&(p.state.loading&3)===0&&(u.count++,p=l2.bind(u),h.addEventListener("load",p),h.addEventListener("error",p))}}var p5=0;function NM(u,h){return u.stylesheets&&u.count===0&&c2(u,u.stylesheets),0<u.count||0<u.imgCount?function(p){var y=setTimeout(function(){if(u.stylesheets&&c2(u,u.stylesheets),u.unsuspend){var T=u.unsuspend;u.unsuspend=null,T()}},6e4+h);0<u.imgBytes&&p5===0&&(p5=62500*sM());var N=setTimeout(function(){if(u.waitingForImages=!1,u.count===0&&(u.stylesheets&&c2(u,u.stylesheets),u.unsuspend)){var T=u.unsuspend;u.unsuspend=null,T()}},(u.imgBytes>p5?50:800)+h);return u.unsuspend=p,function(){u.unsuspend=null,clearTimeout(y),clearTimeout(N)}}:null}function l2(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)c2(this,this.stylesheets);else if(this.unsuspend){var u=this.unsuspend;this.unsuspend=null,u()}}}var u2=null;function c2(u,h){u.stylesheets=null,u.unsuspend!==null&&(u.count++,u2=new Map,h.forEach(kM,u),u2=null,l2.call(u))}function kM(u,h){if(!(h.state.loading&4)){var p=u2.get(u);if(p)var y=p.get(null);else{p=new Map,u2.set(u,p);for(var N=u.querySelectorAll("link[data-precedence],style[data-precedence]"),T=0;T<N.length;T++){var z=N[T];(z.nodeName==="LINK"||z.getAttribute("media")!=="not all")&&(p.set(z.dataset.precedence,z),y=z)}y&&p.set(null,y)}N=h.instance,z=N.getAttribute("data-precedence"),T=p.get(z)||y,T===y&&p.set(null,N),p.set(z,N),this.count++,y=l2.bind(this),N.addEventListener("load",y),N.addEventListener("error",y),T?T.parentNode.insertBefore(N,T.nextSibling):(u=u.nodeType===9?u.head:u,u.insertBefore(N,u.firstChild)),h.state.loading|=4}}var qg={$$typeof:I,Provider:null,Consumer:null,_currentValue:ee,_currentValue2:ee,_threadCount:0};function CM(u,h,p,y,N,T,z,ne,be){this.tag=1,this.containerInfo=u,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=fi(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=fi(0),this.hiddenUpdates=fi(null),this.identifierPrefix=y,this.onUncaughtError=N,this.onCaughtError=T,this.onRecoverableError=z,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=be,this.incompleteTransitions=new Map}function IA(u,h,p,y,N,T,z,ne,be,ze,He,Ze){return u=new CM(u,h,p,z,be,ze,He,Ze,ne),h=1,T===!0&&(h|=24),T=na(3,null,null,h),u.current=T,T.stateNode=u,h=Xc(),h.refCount++,u.pooledCache=h,h.refCount++,T.memoizedState={element:y,isDehydrated:p,cache:h},ut(T),u}function EA(u){return u?(u=Pr,u):Pr}function _A(u,h,p,y,N,T){N=EA(N),y.context===null?y.context=N:y.pendingContext=N,y=Ht(h),y.payload={element:p},T=T===void 0?null:T,T!==null&&(y.callback=T),p=pn(u,y,h),p!==null&&(_i(p,u,h),Xn(p,u,h))}function $A(u,h){if(u=u.memoizedState,u!==null&&u.dehydrated!==null){var p=u.retryLane;u.retryLane=p!==0&&p<h?p:h}}function m5(u,h){$A(u,h),(u=u.alternate)&&$A(u,h)}function RA(u){if(u.tag===13||u.tag===31){var h=ml(u,67108864);h!==null&&_i(h,u,67108864),m5(u,67108864)}}function DA(u){if(u.tag===13||u.tag===31){var h=ro();h=Ns(h);var p=ml(u,h);p!==null&&_i(p,u,h),m5(u,h)}}var h2=!0;function TM(u,h,p,y){var N=W.T;W.T=null;var T=se.p;try{se.p=2,g5(u,h,p,y)}finally{se.p=T,W.T=N}}function AM(u,h,p,y){var N=W.T;W.T=null;var T=se.p;try{se.p=8,g5(u,h,p,y)}finally{se.p=T,W.T=N}}function g5(u,h,p,y){if(h2){var N=y5(y);if(N===null)n5(u,h,y,f2,p),LA(u,y);else if(EM(N,u,h,p,y))y.stopPropagation();else if(LA(u,y),h&4&&-1<IM.indexOf(u)){for(;N!==null;){var T=Gi(N);if(T!==null)switch(T.tag){case 3:if(T=T.stateNode,T.current.memoizedState.isDehydrated){var z=Lt(T.pendingLanes);if(z!==0){var ne=T;for(ne.pendingLanes|=2,ne.entangledLanes|=2;z;){var be=1<<31-kn(z);ne.entanglements[1]|=be,z&=~be}uu(T),(Zn&6)===0&&(Ky=zt()+500,Bg(0))}}break;case 31:case 13:ne=ml(T,2),ne!==null&&_i(ne,T,2),Yy(),m5(T,2)}if(T=y5(y),T===null&&n5(u,h,y,f2,p),T===N)break;N=T}N!==null&&y.stopPropagation()}else n5(u,h,y,null,p)}}function y5(u){return u=Fu(u),b5(u)}var f2=null;function b5(u){if(f2=null,u=Wi(u),u!==null){var h=a(u);if(h===null)u=null;else{var p=h.tag;if(p===13){if(u=i(h),u!==null)return u;u=null}else if(p===31){if(u=o(h),u!==null)return u;u=null}else if(p===3){if(h.stateNode.current.memoizedState.isDehydrated)return h.tag===3?h.stateNode.containerInfo:null;u=null}else h!==u&&(u=null)}}return f2=u,null}function OA(u){switch(u){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(tn()){case Ut:return 2;case sn:return 8;case Yt:case vt:return 32;case en:return 268435456;default:return 32}default:return 32}}var x5=!1,lh=null,uh=null,ch=null,Hg=new Map,Kg=new Map,hh=[],IM="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function LA(u,h){switch(u){case"focusin":case"focusout":lh=null;break;case"dragenter":case"dragleave":uh=null;break;case"mouseover":case"mouseout":ch=null;break;case"pointerover":case"pointerout":Hg.delete(h.pointerId);break;case"gotpointercapture":case"lostpointercapture":Kg.delete(h.pointerId)}}function Xg(u,h,p,y,N,T){return u===null||u.nativeEvent!==T?(u={blockedOn:h,domEventName:p,eventSystemFlags:y,nativeEvent:T,targetContainers:[N]},h!==null&&(h=Gi(h),h!==null&&RA(h)),u):(u.eventSystemFlags|=y,h=u.targetContainers,N!==null&&h.indexOf(N)===-1&&h.push(N),u)}function EM(u,h,p,y,N){switch(h){case"focusin":return lh=Xg(lh,u,h,p,y,N),!0;case"dragenter":return uh=Xg(uh,u,h,p,y,N),!0;case"mouseover":return ch=Xg(ch,u,h,p,y,N),!0;case"pointerover":var T=N.pointerId;return Hg.set(T,Xg(Hg.get(T)||null,u,h,p,y,N)),!0;case"gotpointercapture":return T=N.pointerId,Kg.set(T,Xg(Kg.get(T)||null,u,h,p,y,N)),!0}return!1}function FA(u){var h=Wi(u.target);if(h!==null){var p=a(h);if(p!==null){if(h=p.tag,h===13){if(h=i(p),h!==null){u.blockedOn=h,Wl(u.priority,function(){DA(p)});return}}else if(h===31){if(h=o(p),h!==null){u.blockedOn=h,Wl(u.priority,function(){DA(p)});return}}else if(h===3&&p.stateNode.current.memoizedState.isDehydrated){u.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}u.blockedOn=null}function d2(u){if(u.blockedOn!==null)return!1;for(var h=u.targetContainers;0<h.length;){var p=y5(u.nativeEvent);if(p===null){p=u.nativeEvent;var y=new p.constructor(p.type,p);Jo=y,p.target.dispatchEvent(y),Jo=null}else return h=Gi(p),h!==null&&RA(h),u.blockedOn=p,!1;h.shift()}return!0}function MA(u,h,p){d2(u)&&p.delete(h)}function _M(){x5=!1,lh!==null&&d2(lh)&&(lh=null),uh!==null&&d2(uh)&&(uh=null),ch!==null&&d2(ch)&&(ch=null),Hg.forEach(MA),Kg.forEach(MA)}function p2(u,h){u.blockedOn===h&&(u.blockedOn=null,x5||(x5=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,_M)))}var m2=null;function zA(u){m2!==u&&(m2=u,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){m2===u&&(m2=null);for(var h=0;h<u.length;h+=3){var p=u[h],y=u[h+1],N=u[h+2];if(typeof y!="function"){if(b5(y||p)===null)continue;break}var T=Gi(p);T!==null&&(u.splice(h,3),h-=3,yw(T,{pending:!0,data:N,method:p.method,action:y},y,N))}}))}function bp(u){function h(be){return p2(be,u)}lh!==null&&p2(lh,u),uh!==null&&p2(uh,u),ch!==null&&p2(ch,u),Hg.forEach(h),Kg.forEach(h);for(var p=0;p<hh.length;p++){var y=hh[p];y.blockedOn===u&&(y.blockedOn=null)}for(;0<hh.length&&(p=hh[0],p.blockedOn===null);)FA(p),p.blockedOn===null&&hh.shift();if(p=(u.ownerDocument||u).$$reactFormReplay,p!=null)for(y=0;y<p.length;y+=3){var N=p[y],T=p[y+1],z=N[Cs]||null;if(typeof T=="function")z||zA(p);else if(z){var ne=null;if(T&&T.hasAttribute("formAction")){if(N=T,z=T[Cs]||null)ne=z.formAction;else if(b5(N)!==null)continue}else ne=z.action;typeof ne=="function"?p[y+1]=ne:(p.splice(y,3),y-=3),zA(p)}}}function PA(){function u(T){T.canIntercept&&T.info==="react-transition"&&T.intercept({handler:function(){return new Promise(function(z){return N=z})},focusReset:"manual",scroll:"manual"})}function h(){N!==null&&(N(),N=null),y||setTimeout(p,20)}function p(){if(!y&&!navigation.transition){var T=navigation.currentEntry;T&&T.url!=null&&navigation.navigate(T.url,{state:T.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var y=!1,N=null;return navigation.addEventListener("navigate",u),navigation.addEventListener("navigatesuccess",h),navigation.addEventListener("navigateerror",h),setTimeout(p,100),function(){y=!0,navigation.removeEventListener("navigate",u),navigation.removeEventListener("navigatesuccess",h),navigation.removeEventListener("navigateerror",h),N!==null&&(N(),N=null)}}}function v5(u){this._internalRoot=u}g2.prototype.render=v5.prototype.render=function(u){var h=this._internalRoot;if(h===null)throw Error(s(409));var p=h.current,y=ro();_A(p,y,u,h,null,null)},g2.prototype.unmount=v5.prototype.unmount=function(){var u=this._internalRoot;if(u!==null){this._internalRoot=null;var h=u.containerInfo;_A(u.current,2,null,u,null,null),Yy(),h[Qr]=null}};function g2(u){this._internalRoot=u}g2.prototype.unstable_scheduleHydration=function(u){if(u){var h=kr();u={blockedOn:null,target:u,priority:h};for(var p=0;p<hh.length&&h!==0&&h<hh[p].priority;p++);hh.splice(p,0,u),p===0&&FA(u)}};var BA=e.version;if(BA!=="19.2.0")throw Error(s(527,BA,"19.2.0"));se.findDOMNode=function(u){var h=u._reactInternals;if(h===void 0)throw typeof u.render=="function"?Error(s(188)):(u=Object.keys(u).join(","),Error(s(268,u)));return u=c(h),u=u!==null?f(u):null,u=u===null?null:u.stateNode,u};var $M={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:W,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var y2=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!y2.isDisabled&&y2.supportsFiber)try{ln=y2.inject($M),Vt=y2}catch{}}return Zg.createRoot=function(u,h){if(!r(u))throw Error(s(299));var p=!1,y="",N=HC,T=KC,z=XC;return h!=null&&(h.unstable_strictMode===!0&&(p=!0),h.identifierPrefix!==void 0&&(y=h.identifierPrefix),h.onUncaughtError!==void 0&&(N=h.onUncaughtError),h.onCaughtError!==void 0&&(T=h.onCaughtError),h.onRecoverableError!==void 0&&(z=h.onRecoverableError)),h=IA(u,1,!1,null,null,p,y,null,N,T,z,PA),u[Qr]=h.current,t5(u),new v5(h)},Zg.hydrateRoot=function(u,h,p){if(!r(u))throw Error(s(299));var y=!1,N="",T=HC,z=KC,ne=XC,be=null;return p!=null&&(p.unstable_strictMode===!0&&(y=!0),p.identifierPrefix!==void 0&&(N=p.identifierPrefix),p.onUncaughtError!==void 0&&(T=p.onUncaughtError),p.onCaughtError!==void 0&&(z=p.onCaughtError),p.onRecoverableError!==void 0&&(ne=p.onRecoverableError),p.formState!==void 0&&(be=p.formState)),h=IA(u,1,!0,h,p??null,y,N,be,T,z,ne,PA),h.context=EA(null),p=h.current,y=ro(),y=Ns(y),N=Ht(y),N.callback=null,pn(p,N,y),p=y,h.current.lanes=p,Pt(h,p),uu(h),u[Qr]=h.current,t5(u),new g2(h)},Zg.version="19.2.0",Zg}var YA;function jM(){if(YA)return N5.exports;YA=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),N5.exports=VM(),N5.exports}var WM=jM();const zh=We.createContext(null);function GM({children:n}){const[e,t]=We.useState(localStorage.getItem("theme")||"dark");We.useEffect(()=>{e==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),localStorage.setItem("theme",e)},[e]);const s=()=>{t(r=>r==="dark"?"light":"dark")};return $e.jsx(zh.Provider,{value:{theme:e,toggleTheme:s},children:n})}var h_={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},ZA=Vf.createContext&&Vf.createContext(h_),qM=["attr","size","title"];function HM(n,e){if(n==null)return{};var t=KM(n,e),s,r;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(n);for(r=0;r<a.length;r++)s=a[r],!(e.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(n,s)&&(t[s]=n[s])}return t}function KM(n,e){if(n==null)return{};var t={};for(var s in n)if(Object.prototype.hasOwnProperty.call(n,s)){if(e.indexOf(s)>=0)continue;t[s]=n[s]}return t}function lb(){return lb=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},lb.apply(this,arguments)}function JA(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,s)}return t}function ub(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?JA(Object(t),!0).forEach(function(s){XM(n,s,t[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):JA(Object(t)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(t,s))})}return n}function XM(n,e,t){return e=YM(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function YM(n){var e=ZM(n,"string");return typeof e=="symbol"?e:e+""}function ZM(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function f_(n){return n&&n.map((e,t)=>Vf.createElement(e.tag,ub({key:t},e.attr),f_(e.child)))}function d_(n){return e=>Vf.createElement(JM,lb({attr:ub({},n.attr)},e),f_(n.child))}function JM(n){var e=t=>{var{attr:s,size:r,title:a}=n,i=HM(n,qM),o=r||t.size||"1em",l;return t.className&&(l=t.className),n.className&&(l=(l?l+" ":"")+n.className),Vf.createElement("svg",lb({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,s,i,{className:l,style:ub(ub({color:n.color||t.color},t.style),n.style),height:o,width:o,xmlns:"http://www.w3.org/2000/svg"}),a&&Vf.createElement("title",null,a),n.children)};return ZA!==void 0?Vf.createElement(ZA.Consumer,null,t=>e(t)):e(h_)}function QM(n){return d_({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"3",y1:"12",x2:"21",y2:"12"},child:[]},{tag:"line",attr:{x1:"3",y1:"6",x2:"21",y2:"6"},child:[]},{tag:"line",attr:{x1:"3",y1:"18",x2:"21",y2:"18"},child:[]}]})(n)}function ez(n){return d_({attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M11.251.068a.5.5 0 0 1 .227.58L9.677 6.5H13a.5.5 0 0 1 .364.843l-8 8.5a.5.5 0 0 1-.842-.49L6.323 9.5H3a.5.5 0 0 1-.364-.843l8-8.5a.5.5 0 0 1 .615-.09z"},child:[]}]})(n)}const QA=()=>{const{theme:n,toggleTheme:e}=We.useContext(zh);return $e.jsx("div",{children:$e.jsxs("label",{className:"switch",children:[$e.jsx("input",{id:"input",type:"checkbox",checked:n==="dark",onChange:e}),$e.jsxs("div",{className:"slider round",children:[$e.jsxs("div",{className:"sun-moon",children:[$e.jsx("svg",{id:"moon-dot-1",className:"moon-dot",viewBox:"0 0 100 100",children:$e.jsx("circle",{cx:"50",cy:"50",r:"50"})}),$e.jsx("svg",{id:"moon-dot-2",className:"moon-dot",viewBox:"0 0 100 100",children:$e.jsx("circle",{cx:"50",cy:"50",r:"50"})}),$e.jsx("svg",{id:"moon-dot-3",className:"moon-dot",viewBox:"0 0 100 100",children:$e.jsx("circle",{cx:"50",cy:"50",r:"50"})}),$e.jsx("svg",{id:"light-ray-1",className:"light-ray",viewBox:"0 0 100 100",children:$e.jsx("circle",{cx:"50",cy:"50",r:"50"})}),$e.jsx("svg",{id:"light-ray-2",className:"light-ray",viewBox:"0 0 100 100",children:$e.jsx("circle",{cx:"50",cy:"50",r:"50"})}),$e.jsx("svg",{id:"light-ray-3",className:"light-ray",viewBox:"0 0 100 100",children:$e.jsx("circle",{cx:"50",cy:"50",r:"50"})}),$e.jsx("svg",{id:"cloud-1",className:"cloud-dark",viewBox:"0 0 100 100",children:$e.jsx("circle",{cx:"50",cy:"50",r:"50"})}),$e.jsx("svg",{id:"cloud-2",className:"cloud-dark",viewBox:"0 0 100 100",children:$e.jsx("circle",{cx:"50",cy:"50",r:"50"})}),$e.jsx("svg",{id:"cloud-3",className:"cloud-dark",viewBox:"0 0 100 100",children:$e.jsx("circle",{cx:"50",cy:"50",r:"50"})}),$e.jsx("svg",{id:"cloud-4",className:"cloud-light",viewBox:"0 0 100 100",children:$e.jsx("circle",{cx:"50",cy:"50",r:"50"})}),$e.jsx("svg",{id:"cloud-5",className:"cloud-light",viewBox:"0 0 100 100",children:$e.jsx("circle",{cx:"50",cy:"50",r:"50"})}),$e.jsx("svg",{id:"cloud-6",className:"cloud-light",viewBox:"0 0 100 100",children:$e.jsx("circle",{cx:"50",cy:"50",r:"50"})})]}),$e.jsxs("div",{className:"stars",children:[$e.jsx("svg",{id:"star-1",className:"star",viewBox:"0 0 20 20",children:$e.jsx("path",{d:"M 0 10 C 10 10,10 10 ,0 10 C 10 10 , 10 10 , 10 20 C 10 10 , 10 10 , 20 10 C 10 10 , 10 10 , 10 0 C 10 10,10 10 ,0 10 Z"})}),$e.jsx("svg",{id:"star-2",className:"star",viewBox:"0 0 20 20",children:$e.jsx("path",{d:"M 0 10 C 10 10,10 10 ,0 10 C 10 10 , 10 10 , 10 20 C 10 10 , 10 10 , 20 10 C 10 10 , 10 10 , 10 0 C 10 10,10 10 ,0 10 Z"})}),$e.jsx("svg",{id:"star-3",className:"star",viewBox:"0 0 20 20",children:$e.jsx("path",{d:"M 0 10 C 10 10,10 10 ,0 10 C 10 10 , 10 10 , 10 20 C 10 10 , 10 10 , 20 10 C 10 10 , 10 10 , 10 0 C 10 10,10 10 ,0 10 Z"})}),$e.jsx("svg",{id:"star-4",className:"star",viewBox:"0 0 20 20",children:$e.jsx("path",{d:"M 0 10 C 10 10,10 10 ,0 10 C 10 10 , 10 10 , 10 20 C 10 10 , 10 10 , 20 10 C 10 10 , 10 10 , 10 0 C 10 10,10 10 ,0 10 Z"})})]})]})]})})};var eI="popstate";function tz(n={}){function e(s,r){let{pathname:a,search:i,hash:o}=s.location;return xS("",{pathname:a,search:i,hash:o},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function t(s,r){return typeof r=="string"?r:p1(r)}return sz(e,t,null,n)}function Zs(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Rl(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function nz(){return Math.random().toString(36).substring(2,10)}function tI(n,e){return{usr:n.state,key:n.key,idx:e}}function xS(n,e,t=null,s){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?em(e):e,state:t,key:e&&e.key||s||nz()}}function p1({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function em(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let s=n.indexOf("?");s>=0&&(e.search=n.substring(s),n=n.substring(0,s)),n&&(e.pathname=n)}return e}function sz(n,e,t,s={}){let{window:r=document.defaultView,v5Compat:a=!1}=s,i=r.history,o="POP",l=null,c=f();c==null&&(c=0,i.replaceState({...i.state,idx:c},""));function f(){return(i.state||{idx:null}).idx}function d(){o="POP";let v=f(),w=v==null?null:v-c;c=v,l&&l({action:o,location:x.location,delta:w})}function m(v,w){o="PUSH";let k=xS(x.location,v,w);c=f()+1;let I=tI(k,c),A=x.createHref(k);try{i.pushState(I,"",A)}catch(R){if(R instanceof DOMException&&R.name==="DataCloneError")throw R;r.location.assign(A)}a&&l&&l({action:o,location:x.location,delta:1})}function g(v,w){o="REPLACE";let k=xS(x.location,v,w);c=f();let I=tI(k,c),A=x.createHref(k);i.replaceState(I,"",A),a&&l&&l({action:o,location:x.location,delta:0})}function b(v){return rz(v)}let x={get action(){return o},get location(){return n(r,i)},listen(v){if(l)throw new Error("A history only accepts one active listener");return r.addEventListener(eI,d),l=v,()=>{r.removeEventListener(eI,d),l=null}},createHref(v){return e(r,v)},createURL:b,encodeLocation(v){let w=b(v);return{pathname:w.pathname,search:w.search,hash:w.hash}},push:m,replace:g,go(v){return i.go(v)}};return x}function rz(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),Zs(t,"No window.location.(origin|href) available to create URL");let s=typeof n=="string"?n:p1(n);return s=s.replace(/ $/,"%20"),!e&&s.startsWith("//")&&(s=t+s),new URL(s,t)}function p_(n,e,t="/"){return az(n,e,t,!1)}function az(n,e,t,s){let r=typeof e=="string"?em(e):e,a=yc(r.pathname||"/",t);if(a==null)return null;let i=m_(n);iz(i);let o=null;for(let l=0;o==null&&l<i.length;++l){let c=yz(a);o=mz(i[l],c,s)}return o}function m_(n,e=[],t=[],s="",r=!1){let a=(i,o,l=r,c)=>{let f={relativePath:c===void 0?i.path||"":c,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};if(f.relativePath.startsWith("/")){if(!f.relativePath.startsWith(s)&&l)return;Zs(f.relativePath.startsWith(s),`Absolute route path "${f.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),f.relativePath=f.relativePath.slice(s.length)}let d=mc([s,f.relativePath]),m=t.concat(f);i.children&&i.children.length>0&&(Zs(i.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${d}".`),m_(i.children,e,m,d,l)),!(i.path==null&&!i.index)&&e.push({path:d,score:dz(d,i.index),routesMeta:m})};return n.forEach((i,o)=>{if(i.path===""||!i.path?.includes("?"))a(i,o);else for(let l of g_(i.path))a(i,o,!0,l)}),e}function g_(n){let e=n.split("/");if(e.length===0)return[];let[t,...s]=e,r=t.endsWith("?"),a=t.replace(/\?$/,"");if(s.length===0)return r?[a,""]:[a];let i=g_(s.join("/")),o=[];return o.push(...i.map(l=>l===""?a:[a,l].join("/"))),r&&o.push(...i),o.map(l=>n.startsWith("/")&&l===""?"/":l)}function iz(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:pz(e.routesMeta.map(s=>s.childrenIndex),t.routesMeta.map(s=>s.childrenIndex)))}var oz=/^:[\w-]+$/,lz=3,uz=2,cz=1,hz=10,fz=-2,nI=n=>n==="*";function dz(n,e){let t=n.split("/"),s=t.length;return t.some(nI)&&(s+=fz),e&&(s+=uz),t.filter(r=>!nI(r)).reduce((r,a)=>r+(oz.test(a)?lz:a===""?cz:hz),s)}function pz(n,e){return n.length===e.length&&n.slice(0,-1).every((s,r)=>s===e[r])?n[n.length-1]-e[e.length-1]:0}function mz(n,e,t=!1){let{routesMeta:s}=n,r={},a="/",i=[];for(let o=0;o<s.length;++o){let l=s[o],c=o===s.length-1,f=a==="/"?e:e.slice(a.length)||"/",d=cb({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},f),m=l.route;if(!d&&c&&t&&!s[s.length-1].route.index&&(d=cb({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},f)),!d)return null;Object.assign(r,d.params),i.push({params:r,pathname:mc([a,d.pathname]),pathnameBase:Sz(mc([a,d.pathnameBase])),route:m}),d.pathnameBase!=="/"&&(a=mc([a,d.pathnameBase]))}return i}function cb(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,s]=gz(n.path,n.caseSensitive,n.end),r=e.match(t);if(!r)return null;let a=r[0],i=a.replace(/(.)\/+$/,"$1"),o=r.slice(1);return{params:s.reduce((c,{paramName:f,isOptional:d},m)=>{if(f==="*"){let b=o[m]||"";i=a.slice(0,a.length-b.length).replace(/(.)\/+$/,"$1")}const g=o[m];return d&&!g?c[f]=void 0:c[f]=(g||"").replace(/%2F/g,"/"),c},{}),pathname:a,pathnameBase:i,pattern:n}}function gz(n,e=!1,t=!0){Rl(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let s=[],r="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,o,l)=>(s.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(s.push({paramName:"*"}),r+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?r+="\\/*$":n!==""&&n!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),s]}function yz(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Rl(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function yc(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,s=n.charAt(t);return s&&s!=="/"?null:n.slice(t)||"/"}var bz=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,xz=n=>bz.test(n);function vz(n,e="/"){let{pathname:t,search:s="",hash:r=""}=typeof n=="string"?em(n):n,a;if(t)if(xz(t))a=t;else{if(t.includes("//")){let i=t;t=t.replace(/\/\/+/g,"/"),Rl(!1,`Pathnames cannot have embedded double slashes - normalizing ${i} -> ${t}`)}t.startsWith("/")?a=sI(t.substring(1),"/"):a=sI(t,e)}else a=e;return{pathname:a,search:Nz(s),hash:kz(r)}}function sI(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(r=>{r===".."?t.length>1&&t.pop():r!=="."&&t.push(r)}),t.length>1?t.join("/"):"/"}function A5(n,e,t,s){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function wz(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function y_(n){let e=wz(n);return e.map((t,s)=>s===e.length-1?t.pathname:t.pathnameBase)}function b_(n,e,t,s=!1){let r;typeof n=="string"?r=em(n):(r={...n},Zs(!r.pathname||!r.pathname.includes("?"),A5("?","pathname","search",r)),Zs(!r.pathname||!r.pathname.includes("#"),A5("#","pathname","hash",r)),Zs(!r.search||!r.search.includes("#"),A5("#","search","hash",r)));let a=n===""||r.pathname==="",i=a?"/":r.pathname,o;if(i==null)o=t;else{let d=e.length-1;if(!s&&i.startsWith("..")){let m=i.split("/");for(;m[0]==="..";)m.shift(),d-=1;r.pathname=m.join("/")}o=d>=0?e[d]:"/"}let l=vz(r,o),c=i&&i!=="/"&&i.endsWith("/"),f=(a||i===".")&&t.endsWith("/");return!l.pathname.endsWith("/")&&(c||f)&&(l.pathname+="/"),l}var mc=n=>n.join("/").replace(/\/\/+/g,"/"),Sz=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),Nz=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,kz=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function Cz(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var x_=["POST","PUT","PATCH","DELETE"];new Set(x_);var Tz=["GET",...x_];new Set(Tz);var tm=We.createContext(null);tm.displayName="DataRouter";var Gb=We.createContext(null);Gb.displayName="DataRouterState";We.createContext(!1);var v_=We.createContext({isTransitioning:!1});v_.displayName="ViewTransition";var Az=We.createContext(new Map);Az.displayName="Fetchers";var Iz=We.createContext(null);Iz.displayName="Await";var Eu=We.createContext(null);Eu.displayName="Navigation";var M1=We.createContext(null);M1.displayName="Location";var zl=We.createContext({outlet:null,matches:[],isDataRoute:!1});zl.displayName="Route";var IN=We.createContext(null);IN.displayName="RouteError";function Ez(n,{relative:e}={}){Zs(z1(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:s}=We.useContext(Eu),{hash:r,pathname:a,search:i}=P1(n,{relative:e}),o=a;return t!=="/"&&(o=a==="/"?t:mc([t,a])),s.createHref({pathname:o,search:i,hash:r})}function z1(){return We.useContext(M1)!=null}function fd(){return Zs(z1(),"useLocation() may be used only in the context of a <Router> component."),We.useContext(M1).location}var w_="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function S_(n){We.useContext(Eu).static||We.useLayoutEffect(n)}function N_(){let{isDataRoute:n}=We.useContext(zl);return n?Gz():_z()}function _z(){Zs(z1(),"useNavigate() may be used only in the context of a <Router> component.");let n=We.useContext(tm),{basename:e,navigator:t}=We.useContext(Eu),{matches:s}=We.useContext(zl),{pathname:r}=fd(),a=JSON.stringify(y_(s)),i=We.useRef(!1);return S_(()=>{i.current=!0}),We.useCallback((l,c={})=>{if(Rl(i.current,w_),!i.current)return;if(typeof l=="number"){t.go(l);return}let f=b_(l,JSON.parse(a),r,c.relative==="path");n==null&&e!=="/"&&(f.pathname=f.pathname==="/"?e:mc([e,f.pathname])),(c.replace?t.replace:t.push)(f,c.state,c)},[e,t,a,r,n])}var $z=We.createContext(null);function Rz(n){let e=We.useContext(zl).outlet;return We.useMemo(()=>e&&We.createElement($z.Provider,{value:n},e),[e,n])}function Dz(){let{matches:n}=We.useContext(zl),e=n[n.length-1];return e?e.params:{}}function P1(n,{relative:e}={}){let{matches:t}=We.useContext(zl),{pathname:s}=fd(),r=JSON.stringify(y_(t));return We.useMemo(()=>b_(n,JSON.parse(r),s,e==="path"),[n,r,s,e])}function Oz(n,e){return k_(n,e)}function k_(n,e,t,s,r){Zs(z1(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=We.useContext(Eu),{matches:i}=We.useContext(zl),o=i[i.length-1],l=o?o.params:{},c=o?o.pathname:"/",f=o?o.pathnameBase:"/",d=o&&o.route;{let k=d&&d.path||"";C_(c,!d||k.endsWith("*")||k.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${k}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${k}"> to <Route path="${k==="/"?"*":`${k}/*`}">.`)}let m=fd(),g;if(e){let k=typeof e=="string"?em(e):e;Zs(f==="/"||k.pathname?.startsWith(f),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${f}" but pathname "${k.pathname}" was given in the \`location\` prop.`),g=k}else g=m;let b=g.pathname||"/",x=b;if(f!=="/"){let k=f.replace(/^\//,"").split("/");x="/"+b.replace(/^\//,"").split("/").slice(k.length).join("/")}let v=p_(n,{pathname:x});Rl(d||v!=null,`No routes matched location "${g.pathname}${g.search}${g.hash}" `),Rl(v==null||v[v.length-1].route.element!==void 0||v[v.length-1].route.Component!==void 0||v[v.length-1].route.lazy!==void 0,`Matched leaf route at location "${g.pathname}${g.search}${g.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let w=Pz(v&&v.map(k=>Object.assign({},k,{params:Object.assign({},l,k.params),pathname:mc([f,a.encodeLocation?a.encodeLocation(k.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:k.pathname]),pathnameBase:k.pathnameBase==="/"?f:mc([f,a.encodeLocation?a.encodeLocation(k.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:k.pathnameBase])})),i,t,s,r);return e&&w?We.createElement(M1.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...g},navigationType:"POP"}},w):w}function Lz(){let n=Wz(),e=Cz(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,s="rgba(200,200,200, 0.5)",r={padding:"0.5rem",backgroundColor:s},a={padding:"2px 4px",backgroundColor:s},i=null;return console.error("Error handled by React Router default ErrorBoundary:",n),i=We.createElement(We.Fragment,null,We.createElement("p",null," Hey developer "),We.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",We.createElement("code",{style:a},"ErrorBoundary")," or"," ",We.createElement("code",{style:a},"errorElement")," prop on your route.")),We.createElement(We.Fragment,null,We.createElement("h2",null,"Unexpected Application Error!"),We.createElement("h3",{style:{fontStyle:"italic"}},e),t?We.createElement("pre",{style:r},t):null,i)}var Fz=We.createElement(Lz,null),Mz=class extends We.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){this.props.onError?this.props.onError(n,e):console.error("React Router caught the following error during render",n)}render(){return this.state.error!==void 0?We.createElement(zl.Provider,{value:this.props.routeContext},We.createElement(IN.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function zz({routeContext:n,match:e,children:t}){let s=We.useContext(tm);return s&&s.static&&s.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=e.route.id),We.createElement(zl.Provider,{value:n},t)}function Pz(n,e=[],t=null,s=null,r=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let a=n,i=t?.errors;if(i!=null){let f=a.findIndex(d=>d.route.id&&i?.[d.route.id]!==void 0);Zs(f>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(i).join(",")}`),a=a.slice(0,Math.min(a.length,f+1))}let o=!1,l=-1;if(t)for(let f=0;f<a.length;f++){let d=a[f];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(l=f),d.route.id){let{loaderData:m,errors:g}=t,b=d.route.loader&&!m.hasOwnProperty(d.route.id)&&(!g||g[d.route.id]===void 0);if(d.route.lazy||b){o=!0,l>=0?a=a.slice(0,l+1):a=[a[0]];break}}}let c=t&&s?(f,d)=>{s(f,{location:t.location,params:t.matches?.[0]?.params??{},errorInfo:d})}:void 0;return a.reduceRight((f,d,m)=>{let g,b=!1,x=null,v=null;t&&(g=i&&d.route.id?i[d.route.id]:void 0,x=d.route.errorElement||Fz,o&&(l<0&&m===0?(C_("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),b=!0,v=null):l===m&&(b=!0,v=d.route.hydrateFallbackElement||null)));let w=e.concat(a.slice(0,m+1)),k=()=>{let I;return g?I=x:b?I=v:d.route.Component?I=We.createElement(d.route.Component,null):d.route.element?I=d.route.element:I=f,We.createElement(zz,{match:d,routeContext:{outlet:f,matches:w,isDataRoute:t!=null},children:I})};return t&&(d.route.ErrorBoundary||d.route.errorElement||m===0)?We.createElement(Mz,{location:t.location,revalidation:t.revalidation,component:x,error:g,children:k(),routeContext:{outlet:null,matches:w,isDataRoute:!0},onError:c}):k()},null)}function EN(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Bz(n){let e=We.useContext(tm);return Zs(e,EN(n)),e}function Uz(n){let e=We.useContext(Gb);return Zs(e,EN(n)),e}function Vz(n){let e=We.useContext(zl);return Zs(e,EN(n)),e}function _N(n){let e=Vz(n),t=e.matches[e.matches.length-1];return Zs(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function jz(){return _N("useRouteId")}function Wz(){let n=We.useContext(IN),e=Uz("useRouteError"),t=_N("useRouteError");return n!==void 0?n:e.errors?.[t]}function Gz(){let{router:n}=Bz("useNavigate"),e=_N("useNavigate"),t=We.useRef(!1);return S_(()=>{t.current=!0}),We.useCallback(async(r,a={})=>{Rl(t.current,w_),t.current&&(typeof r=="number"?n.navigate(r):await n.navigate(r,{fromRouteId:e,...a}))},[n,e])}var rI={};function C_(n,e,t){!e&&!rI[n]&&(rI[n]=!0,Rl(!1,t))}We.memo(qz);function qz({routes:n,future:e,state:t,unstable_onError:s}){return k_(n,void 0,t,s,e)}function Hz(n){return Rz(n.context)}function gh(n){Zs(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Kz({basename:n="/",children:e=null,location:t,navigationType:s="POP",navigator:r,static:a=!1}){Zs(!z1(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let i=n.replace(/^\/*/,"/"),o=We.useMemo(()=>({basename:i,navigator:r,static:a,future:{}}),[i,r,a]);typeof t=="string"&&(t=em(t));let{pathname:l="/",search:c="",hash:f="",state:d=null,key:m="default"}=t,g=We.useMemo(()=>{let b=yc(l,i);return b==null?null:{location:{pathname:b,search:c,hash:f,state:d,key:m},navigationType:s}},[i,l,c,f,d,m,s]);return Rl(g!=null,`<Router basename="${i}"> is not able to match the URL "${l}${c}${f}" because it does not start with the basename, so the <Router> won't render anything.`),g==null?null:We.createElement(Eu.Provider,{value:o},We.createElement(M1.Provider,{children:e,value:g}))}function Xz({children:n,location:e}){return Oz(vS(n),e)}function vS(n,e=[]){let t=[];return We.Children.forEach(n,(s,r)=>{if(!We.isValidElement(s))return;let a=[...e,r];if(s.type===We.Fragment){t.push.apply(t,vS(s.props.children,a));return}Zs(s.type===gh,`[${typeof s.type=="string"?s.type:s.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Zs(!s.props.index||!s.props.children,"An index route cannot have child routes.");let i={id:s.props.id||a.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,middleware:s.props.middleware,loader:s.props.loader,action:s.props.action,hydrateFallbackElement:s.props.hydrateFallbackElement,HydrateFallback:s.props.HydrateFallback,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.hasErrorBoundary===!0||s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(i.children=vS(s.props.children,a)),t.push(i)}),t}var j2="get",W2="application/x-www-form-urlencoded";function qb(n){return n!=null&&typeof n.tagName=="string"}function Yz(n){return qb(n)&&n.tagName.toLowerCase()==="button"}function Zz(n){return qb(n)&&n.tagName.toLowerCase()==="form"}function Jz(n){return qb(n)&&n.tagName.toLowerCase()==="input"}function Qz(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function eP(n,e){return n.button===0&&(!e||e==="_self")&&!Qz(n)}var b2=null;function tP(){if(b2===null)try{new FormData(document.createElement("form"),0),b2=!1}catch{b2=!0}return b2}var nP=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function I5(n){return n!=null&&!nP.has(n)?(Rl(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${W2}"`),null):n}function sP(n,e){let t,s,r,a,i;if(Zz(n)){let o=n.getAttribute("action");s=o?yc(o,e):null,t=n.getAttribute("method")||j2,r=I5(n.getAttribute("enctype"))||W2,a=new FormData(n)}else if(Yz(n)||Jz(n)&&(n.type==="submit"||n.type==="image")){let o=n.form;if(o==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=n.getAttribute("formaction")||o.getAttribute("action");if(s=l?yc(l,e):null,t=n.getAttribute("formmethod")||o.getAttribute("method")||j2,r=I5(n.getAttribute("formenctype"))||I5(o.getAttribute("enctype"))||W2,a=new FormData(o,n),!tP()){let{name:c,type:f,value:d}=n;if(f==="image"){let m=c?`${c}.`:"";a.append(`${m}x`,"0"),a.append(`${m}y`,"0")}else c&&a.append(c,d)}}else{if(qb(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=j2,s=null,r=W2,i=n}return a&&r==="text/plain"&&(i=a,a=void 0),{action:s,method:t.toLowerCase(),encType:r,formData:a,body:i}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function $N(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function rP(n,e,t){let s=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return s.pathname==="/"?s.pathname=`_root.${t}`:e&&yc(s.pathname,e)==="/"?s.pathname=`${e.replace(/\/$/,"")}/_root.${t}`:s.pathname=`${s.pathname.replace(/\/$/,"")}.${t}`,s}async function aP(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function iP(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function oP(n,e,t){let s=await Promise.all(n.map(async r=>{let a=e.routes[r.route.id];if(a){let i=await aP(a,t);return i.links?i.links():[]}return[]}));return hP(s.flat(1).filter(iP).filter(r=>r.rel==="stylesheet"||r.rel==="preload").map(r=>r.rel==="stylesheet"?{...r,rel:"prefetch",as:"style"}:{...r,rel:"prefetch"}))}function aI(n,e,t,s,r,a){let i=(l,c)=>t[c]?l.route.id!==t[c].route.id:!0,o=(l,c)=>t[c].pathname!==l.pathname||t[c].route.path?.endsWith("*")&&t[c].params["*"]!==l.params["*"];return a==="assets"?e.filter((l,c)=>i(l,c)||o(l,c)):a==="data"?e.filter((l,c)=>{let f=s.routes[l.route.id];if(!f||!f.hasLoader)return!1;if(i(l,c)||o(l,c))return!0;if(l.route.shouldRevalidate){let d=l.route.shouldRevalidate({currentUrl:new URL(r.pathname+r.search+r.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof d=="boolean")return d}return!0}):[]}function lP(n,e,{includeHydrateFallback:t}={}){return uP(n.map(s=>{let r=e.routes[s.route.id];if(!r)return[];let a=[r.module];return r.clientActionModule&&(a=a.concat(r.clientActionModule)),r.clientLoaderModule&&(a=a.concat(r.clientLoaderModule)),t&&r.hydrateFallbackModule&&(a=a.concat(r.hydrateFallbackModule)),r.imports&&(a=a.concat(r.imports)),a}).flat(1))}function uP(n){return[...new Set(n)]}function cP(n){let e={},t=Object.keys(n).sort();for(let s of t)e[s]=n[s];return e}function hP(n,e){let t=new Set;return new Set(e),n.reduce((s,r)=>{let a=JSON.stringify(cP(r));return t.has(a)||(t.add(a),s.push({key:a,link:r})),s},[])}function T_(){let n=We.useContext(tm);return $N(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function fP(){let n=We.useContext(Gb);return $N(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var RN=We.createContext(void 0);RN.displayName="FrameworkContext";function A_(){let n=We.useContext(RN);return $N(n,"You must render this element inside a <HydratedRouter> element"),n}function dP(n,e){let t=We.useContext(RN),[s,r]=We.useState(!1),[a,i]=We.useState(!1),{onFocus:o,onBlur:l,onMouseEnter:c,onMouseLeave:f,onTouchStart:d}=e,m=We.useRef(null);We.useEffect(()=>{if(n==="render"&&i(!0),n==="viewport"){let x=w=>{w.forEach(k=>{i(k.isIntersecting)})},v=new IntersectionObserver(x,{threshold:.5});return m.current&&v.observe(m.current),()=>{v.disconnect()}}},[n]),We.useEffect(()=>{if(s){let x=setTimeout(()=>{i(!0)},100);return()=>{clearTimeout(x)}}},[s]);let g=()=>{r(!0)},b=()=>{r(!1),i(!1)};return t?n!=="intent"?[a,m,{}]:[a,m,{onFocus:Jg(o,g),onBlur:Jg(l,b),onMouseEnter:Jg(c,g),onMouseLeave:Jg(f,b),onTouchStart:Jg(d,g)}]:[!1,m,{}]}function Jg(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function pP({page:n,...e}){let{router:t}=T_(),s=We.useMemo(()=>p_(t.routes,n,t.basename),[t.routes,n,t.basename]);return s?We.createElement(gP,{page:n,matches:s,...e}):null}function mP(n){let{manifest:e,routeModules:t}=A_(),[s,r]=We.useState([]);return We.useEffect(()=>{let a=!1;return oP(n,e,t).then(i=>{a||r(i)}),()=>{a=!0}},[n,e,t]),s}function gP({page:n,matches:e,...t}){let s=fd(),{manifest:r,routeModules:a}=A_(),{basename:i}=T_(),{loaderData:o,matches:l}=fP(),c=We.useMemo(()=>aI(n,e,l,r,s,"data"),[n,e,l,r,s]),f=We.useMemo(()=>aI(n,e,l,r,s,"assets"),[n,e,l,r,s]),d=We.useMemo(()=>{if(n===s.pathname+s.search+s.hash)return[];let b=new Set,x=!1;if(e.forEach(w=>{let k=r.routes[w.route.id];!k||!k.hasLoader||(!c.some(I=>I.route.id===w.route.id)&&w.route.id in o&&a[w.route.id]?.shouldRevalidate||k.hasClientLoader?x=!0:b.add(w.route.id))}),b.size===0)return[];let v=rP(n,i,"data");return x&&b.size>0&&v.searchParams.set("_routes",e.filter(w=>b.has(w.route.id)).map(w=>w.route.id).join(",")),[v.pathname+v.search]},[i,o,s,r,c,e,n,a]),m=We.useMemo(()=>lP(f,r),[f,r]),g=mP(f);return We.createElement(We.Fragment,null,d.map(b=>We.createElement("link",{key:b,rel:"prefetch",as:"fetch",href:b,...t})),m.map(b=>We.createElement("link",{key:b,rel:"modulepreload",href:b,...t})),g.map(({key:b,link:x})=>We.createElement("link",{key:b,nonce:t.nonce,...x})))}function yP(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var I_=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{I_&&(window.__reactRouterVersion="7.9.6")}catch{}function bP({basename:n,children:e,window:t}){let s=We.useRef();s.current==null&&(s.current=tz({window:t,v5Compat:!0}));let r=s.current,[a,i]=We.useState({action:r.action,location:r.location}),o=We.useCallback(l=>{We.startTransition(()=>i(l))},[i]);return We.useLayoutEffect(()=>r.listen(o),[r,o]),We.createElement(Kz,{basename:n,children:e,location:a.location,navigationType:a.action,navigator:r})}var E_=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Pp=We.forwardRef(function({onClick:e,discover:t="render",prefetch:s="none",relative:r,reloadDocument:a,replace:i,state:o,target:l,to:c,preventScrollReset:f,viewTransition:d,...m},g){let{basename:b}=We.useContext(Eu),x=typeof c=="string"&&E_.test(c),v,w=!1;if(typeof c=="string"&&x&&(v=c,I_))try{let D=new URL(window.location.href),B=c.startsWith("//")?new URL(D.protocol+c):new URL(c),E=yc(B.pathname,b);B.origin===D.origin&&E!=null?c=E+B.search+B.hash:w=!0}catch{Rl(!1,`<Link to="${c}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let k=Ez(c,{relative:r}),[I,A,R]=dP(s,m),U=SP(c,{replace:i,state:o,target:l,preventScrollReset:f,relative:r,viewTransition:d});function V(D){e&&e(D),D.defaultPrevented||U(D)}let P=We.createElement("a",{...m,...R,href:v||k,onClick:w||a?e:V,ref:yP(g,A),target:l,"data-discover":!x&&t==="render"?"true":void 0});return I&&!x?We.createElement(We.Fragment,null,P,We.createElement(pP,{page:k})):P});Pp.displayName="Link";var xP=We.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:s="",end:r=!1,style:a,to:i,viewTransition:o,children:l,...c},f){let d=P1(i,{relative:c.relative}),m=fd(),g=We.useContext(Gb),{navigator:b,basename:x}=We.useContext(Eu),v=g!=null&&AP(d)&&o===!0,w=b.encodeLocation?b.encodeLocation(d).pathname:d.pathname,k=m.pathname,I=g&&g.navigation&&g.navigation.location?g.navigation.location.pathname:null;t||(k=k.toLowerCase(),I=I?I.toLowerCase():null,w=w.toLowerCase()),I&&x&&(I=yc(I,x)||I);const A=w!=="/"&&w.endsWith("/")?w.length-1:w.length;let R=k===w||!r&&k.startsWith(w)&&k.charAt(A)==="/",U=I!=null&&(I===w||!r&&I.startsWith(w)&&I.charAt(w.length)==="/"),V={isActive:R,isPending:U,isTransitioning:v},P=R?e:void 0,D;typeof s=="function"?D=s(V):D=[s,R?"active":null,U?"pending":null,v?"transitioning":null].filter(Boolean).join(" ");let B=typeof a=="function"?a(V):a;return We.createElement(Pp,{...c,"aria-current":P,className:D,ref:f,style:B,to:i,viewTransition:o},typeof l=="function"?l(V):l)});xP.displayName="NavLink";var vP=We.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:s,replace:r,state:a,method:i=j2,action:o,onSubmit:l,relative:c,preventScrollReset:f,viewTransition:d,...m},g)=>{let b=CP(),x=TP(o,{relative:c}),v=i.toLowerCase()==="get"?"get":"post",w=typeof o=="string"&&E_.test(o),k=I=>{if(l&&l(I),I.defaultPrevented)return;I.preventDefault();let A=I.nativeEvent.submitter,R=A?.getAttribute("formmethod")||i;b(A||I.currentTarget,{fetcherKey:e,method:R,navigate:t,replace:r,state:a,relative:c,preventScrollReset:f,viewTransition:d})};return We.createElement("form",{ref:g,method:v,action:x,onSubmit:s?l:k,...m,"data-discover":!w&&n==="render"?"true":void 0})});vP.displayName="Form";function wP(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function __(n){let e=We.useContext(tm);return Zs(e,wP(n)),e}function SP(n,{target:e,replace:t,state:s,preventScrollReset:r,relative:a,viewTransition:i}={}){let o=N_(),l=fd(),c=P1(n,{relative:a});return We.useCallback(f=>{if(eP(f,e)){f.preventDefault();let d=t!==void 0?t:p1(l)===p1(c);o(n,{replace:d,state:s,preventScrollReset:r,relative:a,viewTransition:i})}},[l,o,c,t,s,e,n,r,a,i])}var NP=0,kP=()=>`__${String(++NP)}__`;function CP(){let{router:n}=__("useSubmit"),{basename:e}=We.useContext(Eu),t=jz();return We.useCallback(async(s,r={})=>{let{action:a,method:i,encType:o,formData:l,body:c}=sP(s,e);if(r.navigate===!1){let f=r.fetcherKey||kP();await n.fetch(f,t,r.action||a,{preventScrollReset:r.preventScrollReset,formData:l,body:c,formMethod:r.method||i,formEncType:r.encType||o,flushSync:r.flushSync})}else await n.navigate(r.action||a,{preventScrollReset:r.preventScrollReset,formData:l,body:c,formMethod:r.method||i,formEncType:r.encType||o,replace:r.replace,state:r.state,fromRouteId:t,flushSync:r.flushSync,viewTransition:r.viewTransition})},[n,e,t])}function TP(n,{relative:e}={}){let{basename:t}=We.useContext(Eu),s=We.useContext(zl);Zs(s,"useFormAction must be used inside a RouteContext");let[r]=s.matches.slice(-1),a={...P1(n||".",{relative:e})},i=fd();if(n==null){a.search=i.search;let o=new URLSearchParams(a.search),l=o.getAll("index");if(l.some(f=>f==="")){o.delete("index"),l.filter(d=>d).forEach(d=>o.append("index",d));let f=o.toString();a.search=f?`?${f}`:""}}return(!n||n===".")&&r.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(a.pathname=a.pathname==="/"?t:mc([t,a.pathname])),p1(a)}function AP(n,{relative:e}={}){let t=We.useContext(v_);Zs(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=__("useViewTransitionState"),r=P1(n,{relative:e});if(!t.isTransitioning)return!1;let a=yc(t.currentLocation.pathname,s)||t.currentLocation.pathname,i=yc(t.nextLocation.pathname,s)||t.nextLocation.pathname;return cb(r.pathname,i)!=null||cb(r.pathname,a)!=null}function $_(){const[n,e]=We.useState(!1),{theme:t}=We.useContext(zh),s=t==="dark";return $e.jsxs("nav",{className:`w-full backdrop-blur-xl border-b px-4 md:px-8 py-4 sticky top-0 z-50 rounded-b-3xl transition-colors duration-500
        ${s?"bg-[#0f1629]/80 border-blue-500/20":"bg-white/80 border-gray-200"}
      `,children:[$e.jsxs("div",{className:"w-full flex items-center justify-between",children:[$e.jsxs("div",{className:"flex items-center gap-2 cursor-pointer transition-transform duration-300 hover:scale-105",children:[$e.jsx(ez,{className:`${s?"text-pink-400":"text-pink-500"} text-3xl`}),$e.jsx("h1",{className:`text-2xl md:text-3xl font-semibold tracking-wide
              ${s?"text-white":"text-gray-900"}
            `,children:"Smart Recipe"})]}),$e.jsx("div",{className:`hidden md:flex flex-1 justify-center gap-12 font-semibold text-xl
            ${s?"text-blue-200":"text-gray-700"}
          `,children:["Home","Input","Recipes"].map(r=>$e.jsxs(Pp,{to:r==="Home"?"/":"/"+r.toLowerCase(),className:"relative group transition-all",children:[$e.jsx("span",{className:"group-hover:text-pink-500 transition-colors duration-300",children:r}),$e.jsx("span",{className:"absolute left-0 -bottom-1 w-0 h-[2px] bg-pink-500 transition-all duration-300 group-hover:w-full"})]},r))}),$e.jsx("div",{className:"hidden md:flex items-center",children:$e.jsx(QA,{})}),$e.jsx("button",{className:`md:hidden text-3xl transition-colors duration-300
            ${s?"text-blue-200":"text-gray-700"}
          `,onClick:()=>e(!n),children:$e.jsx(QM,{})})]}),n&&$e.jsxs("div",{className:`md:hidden mt-4 rounded-xl p-4 shadow-lg border animate-slideDown
            ${s?"bg-[#0f1629] border-blue-500/20 text-blue-200":"bg-white border-gray-200 text-gray-700"}
          `,children:[["Home","Input","Recipes"].map(r=>$e.jsx(Pp,{to:r==="Home"?"/":"/"+r.toLowerCase(),onClick:()=>e(!1),className:"py-2 block hover:text-pink-500 transition-colors duration-300 text-lg",children:r},r)),$e.jsx("div",{className:"mt-3",children:$e.jsx(QA,{})})]})]})}function IP(){return $e.jsxs("button",{className:"btn",children:[$e.jsx("svg",{height:"24",width:"24",fill:"#FFFFFF",viewBox:"0 0 24 24","data-name":"Layer 1",id:"Layer_1",className:"sparkle",children:$e.jsx("path",{d:"M10,21.236,6.755,14.745.264,11.5,6.755,8.255,10,1.764l3.245,6.491L19.736,11.5l-6.491,3.245ZM18,21l1.5,3L21,21l3-1.5L21,18l-1.5-3L18,18l-3,1.5ZM19.333,4.667,20.5,7l1.167-2.333L24,3.5,21.667,2.333,20.5,0,19.333,2.333,17,3.5Z"})}),$e.jsx("span",{className:"text",children:"Generate"})]})}function EP(){const{theme:n}=We.useContext(zh),e=n==="dark";return $e.jsx("div",{className:"min-h-screen w-full flex items-center justify-center px-6 py-10",children:$e.jsxs("div",{className:"text-center glass-panel p-10 max-w-3xl mx-auto rounded-3xl backdrop-blur-xl shadow-2xl",children:[$e.jsx("h1",{className:`text-4xl md:text-6xl font-extrabold mb-6 drop-shadow-lg transition-colors duration-300
            ${e?"text-blue-200":"text-[#0f1629]/80"}
          `,children:"Smart Recipe Generator"}),$e.jsx("p",{className:`text-lg md:text-xl max-w-2xl mx-auto leading-relaxed transition-colors duration-300
            ${e?"text-blue-100 opacity-90":"text-[#0f1629]/80 opacity-80"}
          `,children:"Upload ingredient photos, choose your dietary preferences, and get instant AI-powered recipe ideas with a delightful blueberry neon theme."}),$e.jsx("a",{href:"/input",className:`\r
            inline-block mt-10 px-8 py-3 md:px-10 md:py-4 \r
            text-lg md:text-xl font-semibold \r
            rounded-xl\r
            transition-all duration-300\r
          `,children:$e.jsx(IP,{})})]})})}const _P=1e-7,$P=1e-4;class DN{constructor(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,t){this.dataIdsCount++,this.data.set(e,t)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class Hb{refCount(e){return $i("refCount")}incRef(e){return $i("incRef")}timerAvailable(){return!0}time(e){return $i("time")}read(e){return $i("read")}readSync(e){return $i("readSync")}readToGPU(e,t){return $i("readToGPU")}numDataIds(){return $i("numDataIds")}disposeData(e,t){return $i("disposeData")}write(e,t,s){return $i("write")}move(e,t,s,r,a){return $i("move")}createTensorFromGPUData(e,t,s){return $i("createTensorFromGPUData")}memory(){return $i("memory")}floatPrecision(){return $i("floatPrecision")}epsilon(){return this.floatPrecision()===32?_P:$P}dispose(){return $i("dispose")}}function $i(n){throw new Error(`'${n}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}function ON(n){let e=n.length,t=0;for(;e>0;)t=Math.random()*e|0,e--,dc(n,e,t)}function RP(n,e){if(n.length!==e.length)throw new Error(`Array sizes must match to be shuffled together First array length was ${n.length}Second array length was ${e.length}`);let t=n.length,s=0;for(;t>0;)s=Math.random()*t|0,t--,dc(n,t,s),dc(e,t,s)}function Ch(n,e,t){return Math.max(n,Math.min(e,t))}function Kb(n){return n%2===0?n:n+1}function dc(n,e,t){const s=n[e];n[e]=n[t],n[t]=s}function R_(n){let e=0;for(let t=0;t<n.length;t++)e+=n[t];return e}function DP(n,e){const t=Math.random();return e*t+(1-t)*n}function OP(n,e){let t=0;for(let s=0;s<n.length;s++){const r=Number(n[s])-Number(e[s]);t+=r*r}return t}function Z(n,e){if(!n)throw new Error(typeof e=="string"?e:e())}function ha(n,e,t=""){Z(Nn(n,e),()=>t+` Shapes ${n} and ${e} must match`)}function dd(n){Z(n!=null,()=>"The input to the tensor constructor must be a non-null value.")}function Be(n){if(n.length===0)return 1;let e=n[0];for(let t=1;t<n.length;t++)e*=n[t];return e}function LP(n){return n.length===0}function D_(n,e){if(n===e)return!0;if(n==null||e==null||n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==null&&e[t]!==null&&n[t]!==e[t])return!1;return!0}function Nn(n,e){if(n===e)return!0;if(n==null||e==null||n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function Xf(n){return n%1===0}function FP(n){if(Math.tanh!=null)return Math.tanh(n);if(n===1/0)return 1;if(n===-1/0)return-1;{const e=Math.exp(2*n);return(e-1)/(e+1)}}function hb(n){const e=Math.ceil(Math.sqrt(n));return[e,Math.ceil(n/e)]}function MP(n){const e=new Uint32Array(n);for(let t=0;t<n;++t)e[t]=t;return ON(e),e}function jf(n,e){return e<=n.length?n:n+" ".repeat(e-n.length)}function wS(n,e=r=>0,t,s){return new Promise((r,a)=>{let i=0;const o=()=>{if(n()){r();return}i++;const l=e(i);if(t!=null&&i>=t){a();return}s!=null?s(o,l):setTimeout(o,l)};o()})}function LN(n,e){let t=1,s=-1;for(let a=0;a<n.length;++a)if(n[a]>=0)t*=n[a];else if(n[a]===-1){if(s!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${s} and dim ${a}`);s=a}else if(n[a]<0)throw Error(`Shapes can not be < 0. Found ${n[a]} at dim ${a}`);if(s===-1){if(e>0&&e!==t)throw Error(`Size(${e}) must match the product of shape ${n}`);return n}if(t===0)throw Error(`Cannot infer the missing size in [${n}] when there are 0 elements`);if(e%t!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${t}`);const r=n.slice();return r[s]=e/t,r}function vn(n,e){const t=e.length;return n=n==null?e.map((s,r)=>r):[].concat(n),Z(n.every(s=>s>=-t&&s<t),()=>`All values in axis param must be in range [-${t}, ${t}) but got axis ${n}`),Z(n.every(s=>Xf(s)),()=>`All values in axis param must be integers but got axis ${n}`),n.map(s=>s<0?t+s:s)}function Nc(n,e){const t=[],s=[],r=e!=null&&Array.isArray(e)&&e.length===0,a=e==null||r?null:vn(e,n).sort();let i=0;for(let o=0;o<n.length;++o){if(a!=null){if(a[i]===o&&n[o]!==1)throw new Error(`Can't squeeze axis ${o} since its dim '${n[o]}' is not 1`);(a[i]==null||a[i]>o)&&n[o]===1&&(t.push(n[o]),s.push(o)),a[i]<=o&&i++}n[o]!==1&&(t.push(n[o]),s.push(o))}return{newShape:t,keptDims:s}}function Kr(n,e){return Ys(n,e)}function Ys(n,e){let t=null;if(n==null||n==="float32")t=new Float32Array(e);else if(n==="int32")t=new Int32Array(e);else if(n==="bool")t=new Uint8Array(e);else if(n==="string")t=new Array(e);else throw new Error(`Unknown data type ${n}`);return t}function O_(n,e){for(let t=0;t<n.length;t++){const s=n[t];if(isNaN(s)||!isFinite(s))throw Error(`A tensor of type ${e} being uploaded contains ${s}.`)}}function L_(n){return n==="bool"||n==="complex64"||n==="float32"||n==="int32"||n==="string"}function FN(n,e){return!(e==="complex64"||e==="float32"&&n!=="complex64"||e==="int32"&&n!=="float32"&&n!=="complex64"||e==="bool"&&n==="bool")}function m1(n){if(n==="float32"||n==="int32")return 4;if(n==="complex64")return 8;if(n==="bool")return 1;throw new Error(`Unknown dtype ${n}`)}function F_(n){if(n==null)return 0;let e=0;return n.forEach(t=>e+=t.length),e}function mu(n){return typeof n=="string"||n instanceof String}function M_(n){return typeof n=="boolean"}function fb(n){return typeof n=="number"}function pd(n){return Array.isArray(n)?pd(n[0]):n instanceof Float32Array?"float32":n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray?"int32":fb(n)?"float32":mu(n)?"string":M_(n)?"bool":"float32"}function Th(n){return!!(n&&n.constructor&&n.call&&n.apply)}function db(n,e){for(let t=e;t<n;++t)if(n%t===0)return t;return n}function Ot(n){const e=n.length;if(e<2)return[];const t=new Array(e-1);t[e-2]=n[e-1];for(let s=e-3;s>=0;--s)t[s]=t[s+1]*n[s+1];return t}function z_(n,e,t,s=!1){const r=new Array;if(e.length===1){const a=e[0]*(s?2:1);for(let i=0;i<a;i++)r[i]=t[n+i]}else{const a=e[0],i=e.slice(1),o=i.reduce((l,c)=>l*c)*(s?2:1);for(let l=0;l<a;l++)r[l]=z_(n+l*o,i,t,s)}return r}function ho(n,e,t=!1){if(n.length===0)return e[0];const s=n.reduce((r,a)=>r*a)*(t?2:1);if(s===0)return[];if(s!==e.length)throw new Error(`[${n}] does not match the input size ${e.length}${t?" for a complex tensor":""}.`);return z_(0,n,e,t)}function P_(n,e){if(Array.isArray(n))return n;if(e==="float32")return n instanceof Float32Array?n:new Float32Array(n);if(e==="int32")return n instanceof Int32Array?n:new Int32Array(n);if(e==="bool"||e==="string")return Uint8Array.from(new Int32Array(n));throw new Error(`Unknown dtype ${e}`)}function Xb(n,e){const t=ca(n,e);for(let s=0;s<t.length;s++)t[s]=1;return t}function ca(n,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(n);if(e==="int32")return new Int32Array(n);if(e==="bool")return new Uint8Array(n);throw new Error(`Unknown data type ${e}`)}function MN(n,e){const t=n.reduce((s,r)=>s*r,1);if(e==null||e==="float32")return ho(n,new Float32Array(t));if(e==="int32")return ho(n,new Int32Array(t));if(e==="bool")return ho(n,new Uint8Array(t));throw new Error(`Unknown data type ${e}`)}function Pi(n){n.forEach(e=>{Z(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${n}].`)})}function El(n,e,t){if(e===0)return 0;if(e===1)return n[0];let s=n[n.length-1];for(let r=0;r<n.length-1;++r)s+=t[r]*n[r];return s}function md(n,e,t){if(e===0)return[];if(e===1)return[n];const s=new Array(e);for(let r=0;r<s.length-1;++r)s[r]=Math.floor(n/t[r]),n-=s[r]*t[r];return s[s.length-1]=n,s}function Ah(n){return n&&n.then&&typeof n.then=="function"}const iI="tfjsflags";class B_{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=zP,this.populateURLFlags()}setPlatform(e,t){this.platform!=null&&(De().getBool("IS_TEST")||De().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=t}registerFlag(e,t,s){if(this.flagRegistry[e]={evaluationFn:t,setHook:s},this.urlFlags[e]!=null){const r=this.urlFlags[e];De().getBool("IS_TEST")||De().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${r}.`),this.set(e,r)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const t=this.evaluateFlag(e);if(Ah(t))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=t,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,t){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=t,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(t)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);iI in e&&e[iI].split(",").forEach(s=>{const[r,a]=s.split(":");this.urlFlags[r]=BP(r,a)})}}function zP(n){const e={};return n.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(t,...s)=>(PP(e,s[0],s[1]),s.join("="))),e}function PP(n,e,t){n[decodeURIComponent(e)]=decodeURIComponent(t||"")}function BP(n,e){const t=e.toLowerCase();return t==="true"||t==="false"?t==="true":`${+t}`===t?+t:e}function De(){return zN}let zN=null;function UP(n){zN=n}let E5;function U_(){if(E5==null){let n;if(typeof window<"u")n=window;else if(typeof global<"u")n=global;else if(typeof process<"u")n=process;else if(typeof self<"u")n=self;else throw new Error("Could not find a global object");E5=n}return E5}function VP(){const n=U_();return n._tfGlobals==null&&(n._tfGlobals=new Map),n._tfGlobals}function PN(n,e){const t=VP();if(t.has(n))return t.get(n);{const s=e();return t.set(n,s),t.get(n)}}const B1="Abs",nm="Acos",sm="Acosh",gd="Add",U1="AddN",Yb="All",Zb="Any",V1="ArgMax",j1="ArgMin",rm="Asin",am="Asinh",im="Atan",om="Atanh",lm="Atan2",W1="AvgPool",Jb="AvgPoolGrad",G1="AvgPool3D",Qb="AvgPool3DGrad",q1="BatchMatMul",H1="BatchToSpaceND",ex="Bincount",K1="BitwiseAnd",V_="BroadcastTo",tx="BroadcastArgs",um="Cast",cm="Ceil",hm="ClipByValue",nx="Complex",X1="ComplexAbs",Y1="Concat",Z1="Conv2D",sx="Conv2DBackpropFilter",J1="Conv2DBackpropInput",Q1="Conv3D",rx="Conv3DBackpropFilterV2",ax="Conv3DBackpropInputV2",fm="Cos",dm="Cosh",ix="Cumprod",e0="Cumsum",ox="CropAndResize",lx="DenseBincount",ux="DepthToSpace",t0="DepthwiseConv2dNative",cx="DepthwiseConv2dNativeBackpropFilter",hx="DepthwiseConv2dNativeBackpropInput",fx="Diag",n0="Dilation2D",pb="Dilation2DBackpropInput",mb="Dilation2DBackpropFilter",dx="Draw",pm="RealDiv",px="Einsum",mm="Elu",mx="EluGrad",gm="Erf",s0="Equal",ym="Exp",r0="ExpandDims",bm="Expm1",gx="FFT",yx="Fill",bx="FlipLeftRight",xm="Floor",vm="FloorDiv",a0="FusedBatchNorm",i0="GatherV2",xx="GatherNd",o0="Greater",wm="GreaterEqual",Sm="Identity",vx="IFFT",wx="Imag",Nm="IsFinite",km="IsInf",Cm="IsNan",l0="LeakyRelu",u0="Less",c0="LessEqual",Sx="LinSpace",Tm="Log",Am="Log1p",h0="LogicalAnd",f0="LogicalNot",d0="LogicalOr",jP="LogicalXor",j_="LogSoftmax",WP="LowerBound",p0="LRN",Nx="LRNGrad",GP="MatrixBandPart",m0="Max",Im="Maximum",g0="MaxPool",kx="MaxPoolGrad",y0="MaxPool3D",Cx="MaxPool3DGrad",Tx="MaxPoolWithArgmax",b0="Mean",x0="Min",Em="Minimum",v0="MirrorPad",_m="Mod",Ax="Multinomial",$m="Multiply",w0="Neg",S0="NotEqual",Ix="NonMaxSuppressionV3",Ex="NonMaxSuppressionV4",_x="NonMaxSuppressionV5",N0="OnesLike",k0="OneHot",C0="Pack",T0="PadV2",qP="Pool",Rm="Pow",A0="Prelu",I0="Prod",$x="RaggedGather",Rx="RaggedRange",Dx="RaggedTensorToTensor",Ox="Range",Lx="Real",Dm="Reciprocal",Om="Relu",E0="Reshape",_0="ResizeNearestNeighbor",Fx="ResizeNearestNeighborGrad",$0="ResizeBilinear",Mx="ResizeBilinearGrad",Lm="Relu6",R0="Reverse",Fm="Round",Mm="Rsqrt",zx="ScatterNd",Px="TensorScatterUpdate",Bx="SearchSorted",D0="Select",zm="Selu",O0="Slice",Pm="Sin",Bm="Sinh",Um="Sign",Vm="Sigmoid",jm="Softplus",Wm="Sqrt",L0="Sum",F0="SpaceToBatchND",M0="SplitV",z0="Softmax",Ux="SparseFillEmptyRows",Vx="SparseReshape",jx="SparseSegmentMean",Wx="SparseSegmentSum",Gx="SparseToDense",Gm="SquaredDifference",qx="Square",P0="StaticRegexReplace",Hx="StridedSlice",Kx="StringNGrams",Xx="StringSplit",Yx="StringToHashBucketFast",qm="Sub",Hm="Tan",Km="Tanh",Xm="Tile",Zx="TopK",Jx="Transform",Wf="Transpose",Qx="Unique",B0="Unpack",U0="UnsortedSegmentSum",HP="UpperBound",V0="ZerosLike",Ym="Step",gb="FromPixels",ev="RotateWithOffset",g1="_FusedMatMul",y1="FusedConv2D",b1="FusedDepthwiseConv2D";function io(...n){De().getBool("IS_TEST")||De().getBool("PROD")||console.warn(...n)}function KP(...n){De().getBool("IS_TEST")||De().getBool("PROD")||console.log(...n)}const Bp=PN("kernelRegistry",()=>new Map),x1=PN("gradRegistry",()=>new Map);function v1(n,e){const t=BN(n,e);return Bp.get(t)}function SS(n){return x1.get(n)}function yb(n){const e=Bp.entries(),t=[];for(;;){const{done:s,value:r}=e.next();if(s)break;const[a,i]=r,[o]=a.split("_");o===n&&t.push(i)}return t}function tv(n){const{kernelName:e,backendName:t}=n,s=BN(e,t);Bp.has(s)&&io(`The kernel '${e}' for backend '${t}' is already registered`),Bp.set(s,n)}function W_(n){const{kernelName:e}=n;x1.has(e)&&De().getBool("DEBUG")&&io(`Overriding the gradient for '${e}'`),x1.set(e,n)}function XP(n,e){const t=BN(n,e);if(!Bp.has(t))throw new Error(`The kernel '${n}' for backend '${e}' is not registered`);Bp.delete(t)}function YP(n){if(!x1.has(n))throw new Error(`The gradient '${n}' for backend is not registered`);x1.delete(n)}function ZP(n,e){yb(n).forEach(s=>{const r=Object.assign({},s,{backendName:e});tv(r)})}function BN(n,e){return`${e}_${n}`}function G_(n){return n instanceof Float32Array||n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray}var _5,oI;function JP(){if(oI)return _5;oI=1,_5=e;var n=null;try{n=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function e(B,E,M){this.low=B|0,this.high=E|0,this.unsigned=!!M}e.prototype.__isLong__,Object.defineProperty(e.prototype,"__isLong__",{value:!0});function t(B){return(B&&B.__isLong__)===!0}e.isLong=t;var s={},r={};function a(B,E){var M,K,X;return E?(B>>>=0,(X=0<=B&&B<256)&&(K=r[B],K)?K:(M=o(B,(B|0)<0?-1:0,!0),X&&(r[B]=M),M)):(B|=0,(X=-128<=B&&B<128)&&(K=s[B],K)?K:(M=o(B,B<0?-1:0,!1),X&&(s[B]=M),M))}e.fromInt=a;function i(B,E){if(isNaN(B))return E?k:w;if(E){if(B<0)return k;if(B>=b)return V}else{if(B<=-x)return P;if(B+1>=x)return U}return B<0?i(-B,E).neg():o(B%g|0,B/g|0,E)}e.fromNumber=i;function o(B,E,M){return new e(B,E,M)}e.fromBits=o;var l=Math.pow;function c(B,E,M){if(B.length===0)throw Error("empty string");if(B==="NaN"||B==="Infinity"||B==="+Infinity"||B==="-Infinity")return w;if(typeof E=="number"?(M=E,E=!1):E=!!E,M=M||10,M<2||36<M)throw RangeError("radix");var K;if((K=B.indexOf("-"))>0)throw Error("interior hyphen");if(K===0)return c(B.substring(1),E,M).neg();for(var X=i(l(M,8)),ae=w,W=0;W<B.length;W+=8){var se=Math.min(8,B.length-W),ee=parseInt(B.substring(W,W+se),M);if(se<8){var ce=i(l(M,se));ae=ae.mul(ce).add(i(ee))}else ae=ae.mul(X),ae=ae.add(i(ee))}return ae.unsigned=E,ae}e.fromString=c;function f(B,E){return typeof B=="number"?i(B,E):typeof B=="string"?c(B,E):o(B.low,B.high,typeof E=="boolean"?E:B.unsigned)}e.fromValue=f;var d=65536,m=1<<24,g=d*d,b=g*g,x=b/2,v=a(m),w=a(0);e.ZERO=w;var k=a(0,!0);e.UZERO=k;var I=a(1);e.ONE=I;var A=a(1,!0);e.UONE=A;var R=a(-1);e.NEG_ONE=R;var U=o(-1,2147483647,!1);e.MAX_VALUE=U;var V=o(-1,-1,!0);e.MAX_UNSIGNED_VALUE=V;var P=o(0,-2147483648,!1);e.MIN_VALUE=P;var D=e.prototype;return D.toInt=function(){return this.unsigned?this.low>>>0:this.low},D.toNumber=function(){return this.unsigned?(this.high>>>0)*g+(this.low>>>0):this.high*g+(this.low>>>0)},D.toString=function(E){if(E=E||10,E<2||36<E)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(P)){var M=i(E),K=this.div(M),X=K.mul(M).sub(this);return K.toString(E)+X.toInt().toString(E)}else return"-"+this.neg().toString(E);for(var ae=i(l(E,6),this.unsigned),W=this,se="";;){var ee=W.div(ae),ce=W.sub(ee.mul(ae)).toInt()>>>0,ye=ce.toString(E);if(W=ee,W.isZero())return ye+se;for(;ye.length<6;)ye="0"+ye;se=""+ye+se}},D.getHighBits=function(){return this.high},D.getHighBitsUnsigned=function(){return this.high>>>0},D.getLowBits=function(){return this.low},D.getLowBitsUnsigned=function(){return this.low>>>0},D.getNumBitsAbs=function(){if(this.isNegative())return this.eq(P)?64:this.neg().getNumBitsAbs();for(var E=this.high!=0?this.high:this.low,M=31;M>0&&(E&1<<M)==0;M--);return this.high!=0?M+33:M+1},D.isZero=function(){return this.high===0&&this.low===0},D.eqz=D.isZero,D.isNegative=function(){return!this.unsigned&&this.high<0},D.isPositive=function(){return this.unsigned||this.high>=0},D.isOdd=function(){return(this.low&1)===1},D.isEven=function(){return(this.low&1)===0},D.equals=function(E){return t(E)||(E=f(E)),this.unsigned!==E.unsigned&&this.high>>>31===1&&E.high>>>31===1?!1:this.high===E.high&&this.low===E.low},D.eq=D.equals,D.notEquals=function(E){return!this.eq(E)},D.neq=D.notEquals,D.ne=D.notEquals,D.lessThan=function(E){return this.comp(E)<0},D.lt=D.lessThan,D.lessThanOrEqual=function(E){return this.comp(E)<=0},D.lte=D.lessThanOrEqual,D.le=D.lessThanOrEqual,D.greaterThan=function(E){return this.comp(E)>0},D.gt=D.greaterThan,D.greaterThanOrEqual=function(E){return this.comp(E)>=0},D.gte=D.greaterThanOrEqual,D.ge=D.greaterThanOrEqual,D.compare=function(E){if(t(E)||(E=f(E)),this.eq(E))return 0;var M=this.isNegative(),K=E.isNegative();return M&&!K?-1:!M&&K?1:this.unsigned?E.high>>>0>this.high>>>0||E.high===this.high&&E.low>>>0>this.low>>>0?-1:1:this.sub(E).isNegative()?-1:1},D.comp=D.compare,D.negate=function(){return!this.unsigned&&this.eq(P)?P:this.not().add(I)},D.neg=D.negate,D.add=function(E){t(E)||(E=f(E));var M=this.high>>>16,K=this.high&65535,X=this.low>>>16,ae=this.low&65535,W=E.high>>>16,se=E.high&65535,ee=E.low>>>16,ce=E.low&65535,ye=0,G=0,O=0,j=0;return j+=ae+ce,O+=j>>>16,j&=65535,O+=X+ee,G+=O>>>16,O&=65535,G+=K+se,ye+=G>>>16,G&=65535,ye+=M+W,ye&=65535,o(O<<16|j,ye<<16|G,this.unsigned)},D.subtract=function(E){return t(E)||(E=f(E)),this.add(E.neg())},D.sub=D.subtract,D.multiply=function(E){if(this.isZero())return w;if(t(E)||(E=f(E)),n){var M=n.mul(this.low,this.high,E.low,E.high);return o(M,n.get_high(),this.unsigned)}if(E.isZero())return w;if(this.eq(P))return E.isOdd()?P:w;if(E.eq(P))return this.isOdd()?P:w;if(this.isNegative())return E.isNegative()?this.neg().mul(E.neg()):this.neg().mul(E).neg();if(E.isNegative())return this.mul(E.neg()).neg();if(this.lt(v)&&E.lt(v))return i(this.toNumber()*E.toNumber(),this.unsigned);var K=this.high>>>16,X=this.high&65535,ae=this.low>>>16,W=this.low&65535,se=E.high>>>16,ee=E.high&65535,ce=E.low>>>16,ye=E.low&65535,G=0,O=0,j=0,Y=0;return Y+=W*ye,j+=Y>>>16,Y&=65535,j+=ae*ye,O+=j>>>16,j&=65535,j+=W*ce,O+=j>>>16,j&=65535,O+=X*ye,G+=O>>>16,O&=65535,O+=ae*ce,G+=O>>>16,O&=65535,O+=W*ee,G+=O>>>16,O&=65535,G+=K*ye+X*ce+ae*ee+W*se,G&=65535,o(j<<16|Y,G<<16|O,this.unsigned)},D.mul=D.multiply,D.divide=function(E){if(t(E)||(E=f(E)),E.isZero())throw Error("division by zero");if(n){if(!this.unsigned&&this.high===-2147483648&&E.low===-1&&E.high===-1)return this;var M=(this.unsigned?n.div_u:n.div_s)(this.low,this.high,E.low,E.high);return o(M,n.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?k:w;var K,X,ae;if(this.unsigned){if(E.unsigned||(E=E.toUnsigned()),E.gt(this))return k;if(E.gt(this.shru(1)))return A;ae=k}else{if(this.eq(P)){if(E.eq(I)||E.eq(R))return P;if(E.eq(P))return I;var W=this.shr(1);return K=W.div(E).shl(1),K.eq(w)?E.isNegative()?I:R:(X=this.sub(E.mul(K)),ae=K.add(X.div(E)),ae)}else if(E.eq(P))return this.unsigned?k:w;if(this.isNegative())return E.isNegative()?this.neg().div(E.neg()):this.neg().div(E).neg();if(E.isNegative())return this.div(E.neg()).neg();ae=w}for(X=this;X.gte(E);){K=Math.max(1,Math.floor(X.toNumber()/E.toNumber()));for(var se=Math.ceil(Math.log(K)/Math.LN2),ee=se<=48?1:l(2,se-48),ce=i(K),ye=ce.mul(E);ye.isNegative()||ye.gt(X);)K-=ee,ce=i(K,this.unsigned),ye=ce.mul(E);ce.isZero()&&(ce=I),ae=ae.add(ce),X=X.sub(ye)}return ae},D.div=D.divide,D.modulo=function(E){if(t(E)||(E=f(E)),n){var M=(this.unsigned?n.rem_u:n.rem_s)(this.low,this.high,E.low,E.high);return o(M,n.get_high(),this.unsigned)}return this.sub(this.div(E).mul(E))},D.mod=D.modulo,D.rem=D.modulo,D.not=function(){return o(~this.low,~this.high,this.unsigned)},D.and=function(E){return t(E)||(E=f(E)),o(this.low&E.low,this.high&E.high,this.unsigned)},D.or=function(E){return t(E)||(E=f(E)),o(this.low|E.low,this.high|E.high,this.unsigned)},D.xor=function(E){return t(E)||(E=f(E)),o(this.low^E.low,this.high^E.high,this.unsigned)},D.shiftLeft=function(E){return t(E)&&(E=E.toInt()),(E&=63)===0?this:E<32?o(this.low<<E,this.high<<E|this.low>>>32-E,this.unsigned):o(0,this.low<<E-32,this.unsigned)},D.shl=D.shiftLeft,D.shiftRight=function(E){return t(E)&&(E=E.toInt()),(E&=63)===0?this:E<32?o(this.low>>>E|this.high<<32-E,this.high>>E,this.unsigned):o(this.high>>E-32,this.high>=0?0:-1,this.unsigned)},D.shr=D.shiftRight,D.shiftRightUnsigned=function(E){if(t(E)&&(E=E.toInt()),E&=63,E===0)return this;var M=this.high;if(E<32){var K=this.low;return o(K>>>E|M<<32-E,M>>>E,this.unsigned)}else return E===32?o(M,0,this.unsigned):o(M>>>E-32,0,this.unsigned)},D.shru=D.shiftRightUnsigned,D.shr_u=D.shiftRightUnsigned,D.toSigned=function(){return this.unsigned?o(this.low,this.high,!1):this},D.toUnsigned=function(){return this.unsigned?this:o(this.low,this.high,!0)},D.toBytes=function(E){return E?this.toBytesLE():this.toBytesBE()},D.toBytesLE=function(){var E=this.high,M=this.low;return[M&255,M>>>8&255,M>>>16&255,M>>>24,E&255,E>>>8&255,E>>>16&255,E>>>24]},D.toBytesBE=function(){var E=this.high,M=this.low;return[E>>>24,E>>>16&255,E>>>8&255,E&255,M>>>24,M>>>16&255,M>>>8&255,M&255]},e.fromBytes=function(E,M,K){return K?e.fromBytesLE(E,M):e.fromBytesBE(E,M)},e.fromBytesLE=function(E,M){return new e(E[0]|E[1]<<8|E[2]<<16|E[3]<<24,E[4]|E[5]<<8|E[6]<<16|E[7]<<24,M)},e.fromBytesBE=function(E,M){return new e(E[4]<<24|E[5]<<16|E[6]<<8|E[7],E[0]<<24|E[1]<<16|E[2]<<8|E[3],M)},_5}var q_=JP();const H_=c_(q_),QP=DM({__proto__:null,default:H_},[q_]);const Of=H_||QP;function j0(n){return Of.fromString(n,!0,16)}const K_=j0("c3a5c85c97cb3127"),$f=j0("b492b66fbe98f273"),Pa=j0("9ae16a3b2f90404f");function NS(n){return n.xor(n.shru(47))}function X_(n,e,t){const s=n.slice(e,e+t);return Of.fromBytes(Array.from(s),!0,!0)}function vs(n,e){return X_(n,e,8)}function lI(n,e){return X_(n,e,4)}function Gr(n,e){return e===0?n:n.shru(e).or(n.shl(64-e))}function Sh(n,e,t=j0("9ddfea08eb382d69")){let s=n.xor(e).mul(t);s=s.xor(s.shru(47));let r=e.xor(s).mul(t);return r=r.xor(r.shru(47)),r=r.mul(t),r}function eB(n,e,t,s,r,a){r=r.add(n),a=Gr(a.add(r).add(s),21);const i=r;return r=r.add(e),r=r.add(t),a=a.add(Gr(r,44)),[r.add(s),a.add(i)]}function x2(n,e,t,s){return eB(vs(n,e),vs(n,e+8),vs(n,e+16),vs(n,e+24),t,s)}function tB(n,e=n.length){if(e>=8){const t=Pa.add(e*2),s=vs(n,0).add(Pa),r=vs(n,e-8),a=Gr(r,37).mul(t).add(s),i=Gr(s,25).add(r).mul(t);return Sh(a,i,t)}if(e>=4){const t=Pa.add(e*2),s=lI(n,0);return Sh(s.shl(3).add(e),lI(n,e-4),t)}if(e>0){const t=n[0],s=n[e>>1],r=n[e-1],a=t+(s<<8),i=e+(r<<2);return NS(Pa.mul(a).xor(K_.mul(i))).mul(Pa)}return Pa}function nB(n,e=n.length){const t=Pa.add(e*2),s=vs(n,0).mul($f),r=vs(n,8),a=vs(n,e-8).mul(t),i=vs(n,e-16).mul(Pa);return Sh(Gr(s.add(r),43).add(Gr(a,30)).add(i),s.add(Gr(r.add(Pa),18)).add(a),t)}function sB(n,e=n.length){const t=Pa.add(e*2),s=vs(n,0).mul(Pa),r=vs(n,8),a=vs(n,e-8).mul(t),i=vs(n,e-16).mul(Pa),o=Gr(s.add(r),43).add(Gr(a,30)).add(i),l=Sh(o,s.add(Gr(r.add(Pa),18)).add(a),t),c=vs(n,16).mul(t),f=vs(n,24),d=o.add(vs(n,e-32)).mul(t),m=l.add(vs(n,e-24)).mul(t);return Sh(Gr(c.add(f),43).add(Gr(d,30)).add(m),c.add(Gr(f.add(s),18)).add(d),t)}function Y_(n,e=n.length){const t=Of.fromNumber(81,!0);if(e<=32)return e<=16?tB(n,e):nB(n,e);if(e<=64)return sB(n,e);let s=t,r=t.mul($f).add(113),a=NS(r.mul(Pa).add(113)).mul(Pa),i=[Of.UZERO,Of.UZERO],o=[Of.UZERO,Of.UZERO];s=s.mul(Pa).add(vs(n,0));let l=0;const c=(e-1>>6)*64,f=c+(e-1&63)-63;do s=Gr(s.add(r).add(i[0]).add(vs(n,l+8)),37).mul($f),r=Gr(r.add(i[1]).add(vs(n,l+48)),42).mul($f),s=s.xor(o[1]),r=r.add(i[0]).add(vs(n,l+40)),a=Gr(a.add(o[0]),33).mul($f),i=x2(n,l,i[1].mul($f),s.add(o[0])),o=x2(n,l+32,a.add(o[1]),r.add(vs(n,l+16))),[a,s]=[s,a],l+=64;while(l!==c);const d=$f.add(a.and(255).shl(1));return l=f,o[0]=o[0].add(e-1&63),i[0]=i[0].add(o[0]),o[0]=o[0].add(i[0]),s=Gr(s.add(r).add(i[0]).add(vs(n,l+8)),37).mul(d),r=Gr(r.add(i[1]).add(vs(n,l+48)),42).mul(d),s=s.xor(o[1].mul(9)),r=r.add(i[0].mul(9).add(vs(n,l+40))),a=Gr(a.add(o[0]),33).mul(d),i=x2(n,l,i[1].mul(d),s.add(o[0])),o=x2(n,l+32,a.add(o[1]),r.add(vs(n,l+16))),[a,s]=[s,a],Sh(Sh(i[0],o[0],d).add(NS(r).mul(K_)).add(a),Sh(i[1],o[1],d).add(s),d)}function kc(n,e){return e==="string"?bu(n):Ph([n],e)}function rB(n,e){return n instanceof Float32Array&&e==="float32"||n instanceof Int32Array&&e==="int32"||n instanceof Uint8Array&&e==="bool"}function Ph(n,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(n)&&(n=Nu(n)),De().getBool("DEBUG")&&O_(n,e),rB(n,e))return n;if(e==null||e==="float32"||e==="complex64")return new Float32Array(n);if(e==="int32")return new Int32Array(n);if(e==="bool"){const t=new Uint8Array(n.length);for(let s=0;s<t.length;++s)Math.round(n[s])!==0&&(t[s]=1);return t}else throw new Error(`Unknown data type ${e}`)}function Ma(){return De().platform.now()}function aB(n,e){return De().platform.fetch(n,e)}function bu(n,e="utf-8"){return e=e||"utf-8",De().platform.encode(n,e)}function bc(n,e="utf-8"){return e=e||"utf-8",De().platform.decode(n,e)}function qr(n){return De().platform.isTypedArray!=null?De().platform.isTypedArray(n):G_(n)}function Nu(n,e=[],t=!1){if(e==null&&(e=[]),typeof n=="boolean"||typeof n=="number"||typeof n=="string"||Ah(n)||n==null||qr(n)&&t)e.push(n);else if(Array.isArray(n)||qr(n))for(let s=0;s<n.length;++s)Nu(n[s],e,t);else{let s=-1;for(const r of Object.keys(n))/^([1-9]+[0-9]*|0)$/.test(r)&&(s=Math.max(s,Number(r)));for(let r=0;r<=s;r++)Nu(n[r],e,t)}return e}const iB=Object.freeze(Object.defineProperty({__proto__:null,arraysEqual:Nn,arraysEqualWithNull:D_,assert:Z,assertNonNegativeIntegerDimensions:Pi,assertNonNull:dd,assertShapesMatch:ha,bytesFromStringArray:F_,bytesPerElement:m1,checkConversionForErrors:O_,clamp:Ch,computeStrides:Ot,convertBackendValuesAndArrayBuffer:P_,createScalarValue:kc,createShuffledIndices:MP,decodeString:bc,distSquared:OP,encodeString:bu,fetch:aB,fingerPrint64:Y_,flatten:Nu,getArrayFromDType:Ys,getTypedArrayFromDType:Kr,hasEncodingLoss:FN,hexToLong:j0,indexToLoc:md,inferDtype:pd,inferFromImplicitShape:LN,isBoolean:M_,isFunction:Th,isInt:Xf,isNumber:fb,isPromise:Ah,isScalarShape:LP,isString:mu,isTypedArray:qr,isValidDtype:L_,locToIndex:El,makeOnesTypedArray:Xb,makeZerosNestedTypedArray:MN,makeZerosTypedArray:ca,nearestDivisor:db,nearestLargerEven:Kb,now:Ma,parseAxisParam:vn,randUniform:DP,repeatedTry:wS,rightPad:jf,shuffle:ON,shuffleCombo:RP,sizeFromShape:Be,sizeToSquarishShape:hb,squeezeShape:Nc,sum:R_,swap:dc,tanh:FP,toNestedArray:ho,toTypedArray:Ph},Symbol.toStringTag,{value:"Module"}));class oB{constructor(e,t){this.backendTimer=e,this.logger=t,t==null&&(this.logger=new uB)}profileKernel(e,t,s){let r;const a=()=>{r=s()};let i;const o=Ma();if(this.backendTimer.timerAvailable())i=this.backendTimer.time(a);else{a();for(const c of r)c.dataSync();i=Promise.resolve({kernelMs:Ma()-o})}if(De().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let c=0;c<r.length;c++){const f=r[c];f.data().then(d=>{lB(d,f.dtype,e)})}return{kernelName:e,outputs:r,inputs:t,timeMs:i.then(c=>c.kernelMs),extraInfo:i.then(c=>c.getExtraProfileInfo!=null?c.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:t,outputs:s,timeMs:r,inputs:a,extraInfo:i}=e;s.forEach(o=>{Promise.all([o.data(),r,i]).then(l=>{this.logger.logKernelProfile(t,o,l[0],l[1],a,l[2])})})}}function lB(n,e,t){if(e!=="float32")return!1;for(let s=0;s<n.length;s++){const r=n[s];if(isNaN(r)||!isFinite(r))return console.warn(`Found ${r} in the result of '${t}'`),!0}return!1}class uB{logKernelProfile(e,t,s,r,a,i){const o=typeof r=="number"?jf(`${r}ms`,9):r.error,l=jf(e,25),c=t.rank,f=t.size,d=jf(t.shape.toString(),14);let m="";for(const g in a){const b=a[g];if(b!=null){const x=b.shape||t.shape,v=x.length;m+=`${g}: ${v}D ${v>0?x:""} `}}console.log(`%c${l}	%c${o}	%c${c}D ${d}	%c${f}	%c${m}	%c${i}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}function cB(n,e,t){const s={},r={};for(let l=0;l<e.length;l++)s[e[l].id]=!0;for(let l=0;l<n.length;l++){const c=n[l],f=c.inputs;for(const d in f){const m=f[d];let g=!1;for(let b=0;b<e.length;b++)if(s[m.id]){c.outputs.forEach(x=>s[x.id]=!0),g=!0,r[c.id]=!0;break}if(g)break}}const a={};a[t.id]=!0;const i={};for(let l=n.length-1;l>=0;l--){const c=n[l],f=c.inputs;for(let d=0;d<c.outputs.length;d++)if(a[c.outputs[d].id]){for(const m in f)a[f[m].id]=!0,i[c.id]=!0;break}}const o=[];for(let l=0;l<n.length;l++){const c=n[l];if(r[c.id]&&i[c.id]){const f={};for(const m in c.inputs){const g=c.inputs[m];s[g.id]&&(f[m]=g)}const d=Object.assign({},c);d.inputs=f,d.outputs=c.outputs,o.push(d)}}return o}function hB(n,e,t,s){for(let r=e.length-1;r>=0;r--){const a=e[r],i=[];if(a.outputs.forEach(l=>{const c=n[l.id];c!=null?i.push(c):i.push(null)}),a.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${a.kernelName}.`);const o=a.gradient(i);for(const l in a.inputs){if(!(l in o))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(o)}.`);const c=t(()=>o[l]());if(c.dtype!=="float32")throw new Error(`Error in gradient for op ${a.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${c.dtype}'`);const f=a.inputs[l];if(!Nn(c.shape,f.shape))throw new Error(`Error in gradient for op ${a.kernelName}. The gradient of input '${l}' has shape '${c.shape}', which does not match the shape of the input '${f.shape}'`);if(n[f.id]==null)n[f.id]=c;else{const d=n[f.id];n[f.id]=s(d,c),d.dispose()}}}}const uI=20,Qg=3,$5=7;function fB(n,e,t,s){const r=Ot(e),a=dB(n,e,t,r),i=e.length,o=G2(n,e,t,r,a),l=["Tensor"];return s&&(l.push(`  dtype: ${t}`),l.push(`  rank: ${i}`),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(o.map(c=>"    "+c).join(`
`)),l.join(`
`)}function dB(n,e,t,s){const r=Be(e),a=s[s.length-1],i=new Array(a).fill(0),o=e.length,l=t==="complex64"?i1(n):n;if(o>1)for(let c=0;c<r/a;c++){const f=c*a;for(let d=0;d<a;d++)i[d]=Math.max(i[d],a1(l[f+d],0,t).length)}return i}function a1(n,e,t){let s;return Array.isArray(n)?s=`${parseFloat(n[0].toFixed($5))} + ${parseFloat(n[1].toFixed($5))}j`:mu(n)?s=`'${n}'`:t==="bool"?s=Z_(n):s=parseFloat(n.toFixed($5)).toString(),jf(s,e)}function Z_(n){return n===0?"false":"true"}function G2(n,e,t,s,r,a=!0){const i=t==="complex64"?2:1,o=e[0],l=e.length;if(l===0){if(t==="complex64"){const x=i1(n);return[a1(x[0],0,t)]}return t==="bool"?[Z_(n[0])]:[n[0].toString()]}if(l===1){if(o>uI){const v=Qg*i;let w=Array.from(n.slice(0,v)),k=Array.from(n.slice((o-Qg)*i,o*i));return t==="complex64"&&(w=i1(w),k=i1(k)),["["+w.map((I,A)=>a1(I,r[A],t)).join(", ")+", ..., "+k.map((I,A)=>a1(I,r[o-Qg+A],t)).join(", ")+"]"]}return["["+(t==="complex64"?i1(n):Array.from(n)).map((v,w)=>a1(v,r[w],t)).join(", ")+"]"]}const c=e.slice(1),f=s.slice(1),d=s[0]*i,m=[];if(o>uI){for(let x=0;x<Qg;x++){const v=x*d,w=v+d;m.push(...G2(n.slice(v,w),c,t,f,r,!1))}m.push("...");for(let x=o-Qg;x<o;x++){const v=x*d,w=v+d;m.push(...G2(n.slice(v,w),c,t,f,r,x===o-1))}}else for(let x=0;x<o;x++){const v=x*d,w=v+d;m.push(...G2(n.slice(v,w),c,t,f,r,x===o-1))}const g=l===2?",":"";m[0]="["+(o>0?m[0]+g:"");for(let x=1;x<m.length-1;x++)m[x]=" "+m[x]+g;let b=`,
`;for(let x=2;x<l;x++)b+=`
`;return m[m.length-1]=" "+m[m.length-1]+"]"+(a?"":b),m}function i1(n){const e=[];for(let t=0;t<n.length;t+=2)e.push([n[t],n[t+1]]);return e}class Sr{constructor(e,t,s){if(this.dtype=t,this.shape=e.slice(),this.size=Be(e),s!=null){const r=s.length;Z(r===this.size,()=>`Length of values '${r}' does not match the size inferred by the shape '${this.size}'.`)}if(t==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=s||Ys(t,this.size),this.strides=Ot(e)}set(e,...t){t.length===0&&(t=[0]),Z(t.length===this.rank,()=>`The number of provided coordinates (${t.length}) must match the rank (${this.rank})`);const s=this.locToIndex(t);this.values[s]=e}get(...e){e.length===0&&(e=[0]);let t=0;for(const r of e){if(r<0||r>=this.shape[t]){const a=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(a)}t++}let s=e[e.length-1];for(let r=0;r<e.length-1;++r)s+=this.strides[r]*e[r];return this.values[s]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let t=e[e.length-1];for(let s=0;s<e.length-1;++s)t+=this.strides[s]*e[s];return t}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const t=new Array(this.shape.length);for(let s=0;s<t.length-1;++s)t[s]=Math.floor(e/this.strides[s]),e-=t[s]*this.strides[s];return t[t.length-1]=e,t}get rank(){return this.shape.length}toTensor(){return Al().makeTensor(this.values,this.shape,this.dtype)}}let Al=null,kp=null;function pB(n){Al=n}function mB(n){kp=n}class Kn{constructor(e,t,s,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=Be(e),this.strides=Ot(e),this.dataId=s,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return kp.buffer(this.shape,this.dtype,e)}bufferSync(){return kp.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return ho(this.shape,e,this.dtype==="complex64")}arraySync(){return ho(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=Al().read(this.dataId);if(this.dtype==="string"){const t=await e;try{return t.map(s=>bc(s))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),Al().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=Al().readSync(this.dataId);if(this.dtype==="string")try{return e.map(t=>bc(t))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await Al().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),Al().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return kp.print(this,e)}clone(){return this.throwIfDisposed(),kp.clone(this)}toString(e=!1){const t=this.dataSync();return fB(t,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),kp.cast(this,e)}variable(e=!0,t,s){return this.throwIfDisposed(),Al().makeVariable(this,e,t,s)}}Object.defineProperty(Kn,Symbol.hasInstance,{value:n=>!!n&&n.data!=null&&n.dataSync!=null&&n.throwIfDisposed!=null});function je(){return PN("Tensor",()=>Kn)}je();class w1 extends Kn{constructor(e,t,s,r){super(e.shape,e.dtype,e.dataId,r),this.trainable=t,this.name=s}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!Nn(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);Al().disposeTensor(this),this.dataId=e.dataId,Al().incRef(this,null)}dispose(){Al().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(w1,Symbol.hasInstance,{value:n=>n instanceof Kn&&n.assign!=null&&n.assign instanceof Function});var kS;(function(n){n.R0="R0",n.R1="R1",n.R2="R2",n.R3="R3",n.R4="R4",n.R5="R5",n.R6="R6"})(kS||(kS={}));var CS;(function(n){n.float32="float32",n.int32="int32",n.bool="int32",n.complex64="complex64"})(CS||(CS={}));var TS;(function(n){n.float32="float32",n.int32="int32",n.bool="bool",n.complex64="complex64"})(TS||(TS={}));var AS;(function(n){n.float32="float32",n.int32="float32",n.bool="float32",n.complex64="complex64"})(AS||(AS={}));var IS;(function(n){n.float32="complex64",n.int32="complex64",n.bool="complex64",n.complex64="complex64"})(IS||(IS={}));const gB={float32:AS,int32:CS,bool:TS,complex64:IS};function ai(n,e){if(n==="string"||e==="string"){if(n==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${n} with ${e}`)}return gB[n][e]}function nv(n){return ai(n,"int32")}function J_(n){return n!=null&&typeof n=="object"&&"texture"in n&&n.texture instanceof WebGLTexture}function Q_(n){return typeof GPUBuffer<"u"&&n!=null&&typeof n=="object"&&"buffer"in n&&n.buffer instanceof GPUBuffer}function Vs(n,e){if(n.dtype===e.dtype)return[n,e];const t=ai(n.dtype,e.dtype);return[n.cast(t),e.cast(t)]}function e$(n,e){Z(n.dtype===e.dtype,()=>`The dtypes of the first(${n.dtype}) and second(${e.dtype}) input must match`)}function yB(n,e){return e.some(t=>t.id===n.id)}function UN(n){const e=[];return t$(n,e,new Set),e}function t$(n,e,t){if(n==null)return;if(n instanceof Kn){e.push(n);return}if(!bB(n))return;const s=n;for(const r in s){const a=s[r];t.has(a)||(t.add(a),t$(a,e,t))}}function bB(n){return Array.isArray(n)||typeof n=="object"}const xB=Object.freeze(Object.defineProperty({__proto__:null,assertTypesMatch:e$,getTensorsInContainer:UN,isTensorInList:yB,makeTypesMatch:Vs},Symbol.toStringTag,{value:"Module"}));function R5(n){return n.kernelName!=null}class cI{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class Up{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new cI}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const s=e[t];if(await this.initializeBackend(s).success){await this.setBackend(s);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:t}=this.initializeBackendsAndReturnBest();if(t)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:t}=this.initializeBackend(e);if(t)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,t,s=1){return e in this.registryFactory?(io(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:t,priority:s},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:t,asyncInit:s}=this.initializeBackend(e);if(!(s?await t:t))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new oB(this.backendInstance),!0}setupRegisteredKernels(){yb(this.backendName).forEach(t=>{t.setupFunc!=null&&t.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){yb(e).forEach(s=>{s.disposeFunc!=null&&s.disposeFunc(this.registry[e])})}initializeBackend(e){const t=this.registryFactory[e];if(t==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const s=t.factory();if(s&&!(s instanceof Hb)&&typeof s.then=="function"){const r=++this.pendingBackendInitId,a=s.then(i=>r<this.pendingBackendInitId?!1:(this.registry[e]=i,this.pendingBackendInit=null,!0)).catch(i=>(r<this.pendingBackendInitId||(this.pendingBackendInit=null,io(`Initialization of backend ${e} failed`),io(i.stack||i.message)),!1));return this.pendingBackendInit=a,{success:a,asyncInit:!0}}else return this.registry[e]=s,{success:!0,asyncInit:!1}}catch(s){return io(`Initialization of backend ${e} failed`),io(s.stack||s.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,t)=>this.registryFactory[t].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const s=e[t],{success:r,asyncInit:a}=this.initializeBackend(s);if(a||r)return{name:s,asyncInit:a}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,t){const s=this.state.tensorInfo.get(t),r=s.backend,a=this.readSync(t),i=r.refCount(t);r.disposeData(t,!0),s.backend=e,e.move(t,a,s.shape,s.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,t){let s=null;if(t==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");t=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof t!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");s=e}let r;return this.scopedRun(()=>this.startScope(s),()=>this.endScope(r),()=>(r=t(),r instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r))}scopedRun(e,t,s){e();try{const r=s();return t(),r}catch(r){throw t(),r}}nextTensorId(){return Up.nextTensorId++}nextVariableId(){return Up.nextVariableId++}clone(e){const t=me.runKernel(Sm,{x:e}),s={x:e},r=i=>({x:()=>{const o="float32",l={x:i},c={dtype:o};return me.runKernel(um,l,c)}}),a=[];return this.addTapeNode(this.state.activeScope.name,s,[t],r,a,{}),t}runKernel(e,t,s){if(this.backendName==null&&this.backend,!(v1(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:t,attrs:s})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,t,s){const r=this.backend.numDataIds();let a=0;s.forEach(l=>{a+=l.dtype==="complex64"?3:1});const i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=r-t-a-i;if(o>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${o} data ids) after running '${e}'`)}runKernelFunc(e){let t,s=[];const r=this.isTapeOn(),a=this.state.numBytes,i=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let o;this.backendName==null&&this.backend;let l;const c=R5(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(R5(e)){const{kernelName:b,inputs:x,attrs:v}=e;this.backendName==null&&this.backend;const w=v1(b,this.backendName);Z(w!=null,()=>`Cannot find registered kernel '${b}' for backend '${this.backendName}'`),o=()=>{const k=this.backend.numDataIds();l=w.kernelFunc({inputs:x,attrs:v,backend:this.backend});const I=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(b,k,I);const A=I.map(R=>R.rank!=null?R:this.makeTensorFromTensorInfo(R));if(r){const R=this.getTensorsForGradient(b,x,A);s=this.saveTensorsForBackwardMode(R)}return A}}else{const{forwardFunc:b}=e,x=v=>{r&&(s=v.map(w=>this.keep(this.clone(w))))};o=()=>{const v=this.backend.numDataIds();l=this.tidy(()=>b(this.backend,x));const w=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(c,v,w),w}}const{inputs:f,attrs:d}=e,m=R5(e)?null:e.backwardsFunc;let g;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?t=o():(g=this.profiler.profileKernel(c,f,()=>o()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(g),t=g.outputs)}),r&&this.addTapeNode(c,f,t,m,s,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-a,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-i,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(f).map(b=>f[b]!=null?f[b].shape:null),outputShapes:t.map(b=>b.shape),kernelTimeMs:g.timeMs,extraInfo:g.extraInfo}),Array.isArray(l)?t:t[0]}saveTensorsForBackwardMode(e){return e.map(s=>this.keep(this.clone(s)))}getTensorsForGradient(e,t,s){const r=SS(e);if(r!=null){const a=r.inputsToSave||[],i=r.outputsToSave||[];let o;r.saveAllInputs?(Z(Array.isArray(t),()=>"saveAllInputs is true, expected inputs to be an array."),o=Object.keys(t).map(c=>t[c])):o=a.map(c=>t[c]);const l=s.filter((c,f)=>i[f]);return o.concat(l)}return[]}makeTensor(e,t,s,r){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");s=s||"float32",r=r||this.backend;let a=e;s==="string"&&mu(e[0])&&(a=e.map(l=>bu(l)));const i=r.write(a,t,s),o=new Kn(t,s,i,this.nextTensorId());if(this.trackTensor(o,r),s==="string"){const l=this.state.tensorInfo.get(i),c=F_(a);this.state.numBytes+=c-l.bytes,l.bytes=c}return o}makeTensorFromDataId(e,t,s,r){s=s||"float32";const a={dataId:e,shape:t,dtype:s};return this.makeTensorFromTensorInfo(a,r)}makeTensorFromTensorInfo(e,t){const{dataId:s,shape:r,dtype:a}=e,i=new Kn(r,a,s,this.nextTensorId());return this.trackTensor(i,t),i}makeVariable(e,t=!0,s,r){s=s||this.nextVariableId().toString(),r!=null&&r!==e.dtype&&(e=e.cast(r));const a=new w1(e,t,s,this.nextTensorId());if(this.state.registeredVariables[a.name]!=null)throw new Error(`Variable with name ${a.name} was already registered`);return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a}trackTensor(e,t){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let s=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(s=e.size*m1(e.dtype)),this.state.numBytes+=s,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:s})),e instanceof w1||this.track(e)}incRef(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}removeDataId(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const s=e.size*m1(e.dtype);this.state.numBytes-=s}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const t=this.state.registeredVariables[e];this.disposeVariable(t)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const t=this.state.numBytes,s=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(r=>r.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-s;for(const r of this.state.activeProfile.kernels)r.kernelTimeMs=await r.kernelTimeMs,r.extraInfo=await r.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,t,s,r,a,i){const o={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:s,saved:a},l=SS(e);l!=null&&(r=l.gradFunc),r!=null&&(o.gradient=c=>(c=c.map((f,d)=>{if(f==null){const m=s[d],g=ca(m.size,m.dtype);return this.makeTensor(g,m.shape,m.dtype)}return f}),r(c.length>1?c:c[0],a,i))),this.state.activeTape.push(o)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}endScope(e){const t=UN(e),s=new Set(t.map(a=>a.id));for(let a=0;a<this.state.activeScope.track.length;a++){const i=this.state.activeScope.track[a];!i.kept&&!s.has(i.id)&&i.dispose()}const r=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],t.forEach(a=>{!a.kept&&a.scopeId===r.id&&this.track(a)})}gradients(e,t,s,r=!1){if(Z(t.length>0,()=>"gradients() received an empty list of xs."),s!=null&&s.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${s.dtype}'`);const a=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));Z(a instanceof Kn,()=>"The result y returned by f() must be a tensor.");const i=cB(this.state.activeTape,t,a);if(!r&&i.length===0&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const o={};o[a.id]=s??vB(a.shape),hB(o,i,c=>this.tidy(c),wB);const l=t.map(c=>o[c.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(c=>{for(const f of c.saved)f.dispose()}),this.state.activeTape=null),{value:a,grads:l}})}customGrad(e){return Z(Th(e),()=>"The f passed in customGrad(f) must be a function."),(...t)=>{Z(t.every(o=>o instanceof Kn),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let s;const r={};t.forEach((o,l)=>{r[l]=o});const a=(o,l)=>(s=e(...t,l),Z(s.value instanceof Kn,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),Z(Th(s.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),s.value),i=(o,l)=>{const c=s.gradFunc(o,l),f=Array.isArray(c)?c:[c];Z(f.length===t.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),Z(f.every(m=>m instanceof Kn),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const d={};return f.forEach((m,g)=>{d[g]=()=>m}),d};return this.runKernelFunc({forwardFunc:a,backwardsFunc:i,inputs:r})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,t){return this.state.tensorInfo.get(e).backend.readToGPU(e,t)}async time(e){const t=Ma(),s=await this.backend.time(e);return s.wallMs=Ma()-t,s}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new cI;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}Up.nextTensorId=0;Up.nextVariableId=0;function vB(n){const e=Xb(Be(n),"float32");return me.makeTensor(e,n,"float32")}function n$(){const n=U_();if(n._tfengine==null){const e=new B_(n);n._tfengine=new Up(e)}return UP(n._tfengine.ENV),pB(()=>n._tfengine),n._tfengine}const me=n$();function wB(n,e){const t={a:n,b:e};return me.runKernel(gd,t)}function SB(){return typeof navigator<"u"&&navigator!=null}let ES;function NB(n){ES=n}function VN(n){if(ES!==void 0)return ES;if(n||SB()){if(n||(n=navigator),n.product==="ReactNative")return!0;const e=n.userAgent||n.vendor||(typeof window<"u"?window.opera:"");if(!e){const t=n;return t.userAgentData&&t.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function jN(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}const kB=Object.freeze(Object.defineProperty({__proto__:null,isBrowser:jN,isMobile:VN,mockIsMobile:NB},Symbol.toStringTag,{value:"Module"}));const ii=De();ii.registerFlag("DEBUG",()=>!1,n=>{n&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});ii.registerFlag("IS_BROWSER",()=>jN());ii.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");ii.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));ii.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));ii.registerFlag("PROD",()=>!1);ii.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>ii.getBool("DEBUG"));ii.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);ii.registerFlag("IS_TEST",()=>!1);ii.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>ii.getBool("DEBUG"));ii.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);ii.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);ii.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);function ku(n,e){let t=n;if(qr(n))return e==="string"?[]:[n.length];if(J_(n)){const r=n.channels||"RGBA";return[n.height,n.width*r.length]}else if(Q_(n))return[n.buffer.size/(e==null?4:m1(e))];if(!Array.isArray(n))return[];const s=[];for(;Array.isArray(t)||qr(t)&&e!=="string";)s.push(t.length),t=t[0];return Array.isArray(n)&&De().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&s$(n,s,[]),s}function s$(n,e,t){if(t=t||[],!Array.isArray(n)&&!qr(n)){Z(e.length===0,()=>`Element arr[${t.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}Z(e.length>0,()=>`Element arr[${t.join("][")}] should be a primitive, but is an array of ${n.length} elements`),Z(n.length===e[0],()=>`Element arr[${t.join("][")}] should have ${e[0]} elements, but has ${n.length} elements`);const s=e.slice(1);for(let r=0;r<n.length;++r)s$(n[r],s,t.concat(r))}function hI(n,e,t,s){if(n!=="string_or_numeric"){if(n==null)throw new Error("Expected dtype cannot be null.");if(n!=="numeric"&&n!==e||n==="numeric"&&e==="string")throw new Error(`Argument '${t}' passed to '${s}' must be ${n} tensor, but got ${e} tensor`)}}function te(n,e,t,s="numeric"){if(n instanceof je())return hI(s,n.dtype,e,t),n;let r=pd(n);if(r!=="string"&&["bool","int32","float32"].indexOf(s)>=0&&(r=s),hI(s,r,e,t),n==null||!qr(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string"){const l=n==null?"null":n.constructor.name;throw new Error(`Argument '${e}' passed to '${t}' must be a Tensor or TensorLike, but got '${l}'`)}const a=ku(n,r);!qr(n)&&!Array.isArray(n)&&(n=[n]);const o=r!=="string"?Ph(n,r):Nu(n,[],!0);return me.makeTensor(o,a,r)}function S1(n,e,t,s="numeric"){if(!Array.isArray(n))throw new Error(`Argument ${e} passed to ${t} must be a \`Tensor[]\` or \`TensorLike[]\``);return n.map((a,i)=>te(a,`${e}[${i}]`,t,s))}const WN="__op";function ge(n){const e=Object.keys(n);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let t=e[0];const s=n[t];t.endsWith("_")&&(t=t.substring(0,t.length-1)),t=t+WN;const r=(...a)=>{me.startScope(t);try{const i=s(...a);return Ah(i)&&console.error("Cannot return a Promise inside of tidy."),me.endScope(i),i}catch(i){throw me.endScope(null),i}};return Object.defineProperty(r,"name",{value:t,configurable:!0}),r}function CB(n,e){const t=te(n,"real","complex"),s=te(e,"imag","complex");ha(t.shape,s.shape,`real and imag shapes, ${t.shape} and ${s.shape}, must match in call to tf.complex().`);const r={real:t,imag:s};return me.runKernel(nx,r)}const xc=ge({complex_:CB});function Bh(n,e,t,s){if(s==null)s=pd(n);else if(s==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(Q_(n)||J_(n)){if(s!=="float32"&&s!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${s}.`);return me.backend.createTensorFromGPUData(n,e||t,s)}if(!qr(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){Pi(e);const r=Be(e),a=Be(t);Z(r===a,()=>`Based on the provided shape, [${e}], the tensor should have ${r} values but has ${a}`);for(let i=0;i<t.length;++i){const o=t[i],l=i===t.length-1?o!==Be(e.slice(i)):!0;Z(t[i]===e[i]||!l,()=>`Error creating a new Tensor. Inferred shape (${t}) does not match the provided shape (${e}). `)}}return!qr(n)&&!Array.isArray(n)&&(n=[n]),e=e||t,n=s!=="string"?Ph(n,s):Nu(n,[],!0),me.makeTensor(n,e,s)}function jo(n,e,t){const s=ku(n,t);return Bh(n,e,s,t)}const Yf={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};class Pl{static join(e){return new Pl(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,e==null||(e instanceof Array||(e=[e]),e=e.map(s=>qr(s)?s.buffer:s),e.length===0))return;this.bufferUniformSize=e[0].byteLength;let t=0;for(let s=0;s<e.length;s++){const r=e[s];s!==e.length-1&&r.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const a=t+r.byteLength;this.shards.push({buffer:r,start:t,end:a}),t=a}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(e=0,t=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,t=isNaN(Number(t))?0:t,e=Math.max(0,e),t=Math.min(this.byteLength,t),t<=e)return new ArrayBuffer(0);const s=this.findShardForByte(e);if(s===-1)throw new Error(`Could not find start shard for byte ${e}`);const r=t-e,a=new ArrayBuffer(r),i=new Uint8Array(a);let o=0;for(let l=s;l<this.shards.length;l++){const c=this.shards[l],d=e+o-c.start,m=o,b=Math.min(t,c.end)-c.start,x=new Uint8Array(c.buffer,d,b-d);if(i.set(x,m),o+=x.length,t<c.end)break}return a}findShardForByte(e){if(this.shards.length===0||e<0||e>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function t(r){return e<r.start?-1:e>=r.end?1:0}if(t(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const s=TB(this.shards,t);return s===-1?-1:(this.previousShardIndex=s,this.previousShardIndex)}}function TB(n,e){let t=0,s=n.length;for(;t<=s;){const r=Math.floor((s-t)/2)+t,a=e(n[r]);if(a===0)return r;a<0?s=r:t=r+1}return-1}function AB(){De().set("PROD",!0)}function IB(){De().set("DEBUG",!0)}function EB(){De().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function _B(n){De().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(n+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function $B(){me.disposeVariables()}function Tl(){return me}function _S(){return me.memory()}function RB(n){return me.profile(n)}function _e(n,e){return me.tidy(n,e)}function xn(n){UN(n).forEach(t=>t.dispose())}function _r(n){return me.keep(n)}function DB(n){return me.time(n)}function OB(n){return me.setBackend(n)}function LB(){return me.ready()}function r$(){return me.backendName}function FB(n){me.removeBackend(n)}function MB(n){return me.findBackend(n)}function zB(n){return me.findBackendFactory(n)}function GN(n,e,t=1){return me.registerBackend(n,e,t)}function qN(){return me.backend}function PB(n,e){De().setPlatform(n,e)}const Ih=4;async function $S(n,e){const t=[],s=[],r=Array.isArray(n)?n.map(i=>i.name):Object.keys(n);for(let i=0;i<r.length;++i){const o=r[i],l=Array.isArray(n)?n[i].tensor:n[o];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${o}': ${l.dtype}`);const c={name:o,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const f=new Promise(async d=>{const m=await l.bytes(),g=m.reduce((v,w)=>v+w.length,0)+Ih*m.length,b=new Uint8Array(g);let x=0;for(let v=0;v<m.length;v++){const w=m[v],k=new Uint8Array(new Uint32Array([w.length]).buffer);b.set(k,x),x+=Ih,b.set(w,x),x+=w.length}d(b)});s.push(f)}else s.push(l.data());e!=null&&(c.group=e),t.push(c)}const a=await Promise.all(s);return{data:VB(a),specs:t}}function a$(n,e){const t=new Pl(n),s={};let r=0;for(const a of e){const i=BB(a,(o,l)=>t.slice(r+o,r+l));s[a.name]=i$(a,t.slice(r,r+i)),r+=i}return s}function BB(n,e){const t=Be(n.shape);let s;if("quantization"in n){const r=n.quantization;s=Yf[r.dtype]}else if(n.dtype==="string"){let r=0;for(let a=0;a<t;a++)r+=Ih+new Uint32Array(e(r,r+Ih))[0];return r}else s=Yf[n.dtype];return t*s}async function UB(n,e){const t=Be(n.shape);let s;if("quantization"in n){const r=n.quantization;s=Yf[r.dtype]}else if(n.dtype==="string"){let r=0;for(let a=0;a<t;a++)r+=Ih+new Uint32Array(await e(r,r+Ih))[0];return r}else s=Yf[n.dtype];return t*s}function i$(n,e){const t=n.name,s=n.dtype,r=n.shape,a=Be(r);let i,o=0;if("quantization"in n){const l=n.quantization;if(l.dtype==="uint8"||l.dtype==="uint16"){if(!("min"in l&&"scale"in l))throw new Error(`Weight ${n.name} with quantization ${l.dtype} doesn't have corresponding metadata min and scale.`)}else if(l.dtype==="float16"){if(s!=="float32")throw new Error(`Weight ${n.name} is quantized with ${l.dtype} which only supports weights of type float32 not ${s}.`)}else throw new Error(`Weight ${n.name} has unknown quantization dtype ${l.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const c=Yf[l.dtype],f=l.dtype==="uint8"?new Uint8Array(e):new Uint16Array(e);if(s==="float32")if(l.dtype==="uint8"||l.dtype==="uint16"){i=new Float32Array(f.length);for(let d=0;d<f.length;d++){const m=f[d];i[d]=m*l.scale+l.min}}else if(l.dtype==="float16")i=KB()(f);else throw new Error(`Unsupported quantization type ${l.dtype} for weight type float32.`);else if(s==="int32"){if(l.dtype!=="uint8"&&l.dtype!=="uint16")throw new Error(`Unsupported quantization type ${l.dtype} for weight type int32.`);i=new Int32Array(f.length);for(let d=0;d<f.length;d++){const m=f[d];i[d]=Math.round(m*l.scale+l.min)}}else throw new Error(`Unsupported dtype in weight '${t}': ${s}`);o+=a*c}else if(s==="string"){const l=Be(n.shape);i=[];for(let c=0;c<l;c++){const f=new Uint32Array(e.slice(o,o+Ih))[0];o+=Ih;const d=new Uint8Array(e.slice(o,o+f));i.push(d),o+=f}}else{const l=Yf[s];if(s==="float32")i=new Float32Array(e);else if(s==="int32")i=new Int32Array(e);else if(s==="bool")i=new Uint8Array(e);else if(s==="complex64"){i=new Float32Array(e);const c=new Float32Array(i.length/2),f=new Float32Array(i.length/2);for(let b=0;b<c.length;b++)c[b]=i[b*2],f[b]=i[b*2+1];const d=jo(c,r,"float32"),m=jo(f,r,"float32"),g=xc(d,m);return d.dispose(),m.dispose(),g}else throw new Error(`Unsupported dtype in weight '${t}': ${s}`);o+=a*l}return jo(i,r,s)}async function fI(n,e,t){let s=new Uint8Array(e);for(;s.byteLength<t;){const{done:r,value:a}=await n.read();if(r&&a==null){const o=t-s.byteLength;throw new Error(`Reader is done but ${o} bytes are still expected`)}const i=new Uint8Array(s.length+a.byteLength);i.set(s,0),i.set(new Uint8Array(a),s.length),s=i}return s.buffer}async function o$(n,e){const t={},s=n.getReader();let r=new ArrayBuffer(0);for(const a of e){const i=await UB(a,async(c,f)=>(r=await fI(s,r,f),r.slice(c,f)));r=await fI(s,r,i);const o=r.slice(0,i);r=r.slice(i);const l=i$(a,o);if(t[a.name]=l,r$()==="webgpu"){const c=qN();"uploadToGPU"in c&&Be(l.shape)>=De().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&c.uploadToGPU(l.dataId)}}return t}function VB(n){if(n===null)throw new Error(`Invalid input value: ${JSON.stringify(n)}`);let e=0;const t=[];n.forEach(a=>{if(e+=a.byteLength,t.push(a.byteLength===a.buffer.byteLength?a:new a.constructor(a)),!(a instanceof Float32Array||a instanceof Int32Array||a instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${a.constructor.name}`)});const s=new Uint8Array(e);let r=0;return t.forEach(a=>{s.set(new Uint8Array(a.buffer),r),r+=a.byteLength}),s.buffer}const HN=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function dI(n){return HN?Buffer.byteLength(n,"utf8"):new Blob([n]).size}function jB(n){if(HN)return Buffer.from(n).toString("base64");const e=new Uint8Array(n);let t="";for(let s=0,r=e.length;s<r;s++)t+=String.fromCharCode(e[s]);return btoa(t)}function WB(n){if(HN){const s=Buffer.from(n,"base64");return s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength)}const e=atob(n),t=new Uint8Array(e.length);for(let s=0;s<e.length;++s)t.set([e.charCodeAt(s)],s);return t.buffer}function l$(n){return Pl.join(n)}function pI(n){for(n=n.trim();n.endsWith("/");)n=n.slice(0,n.length-1);const t=n.split("/");return t[t.length-1]}function u$(n,e){const t={modelTopology:n.modelTopology,format:n.format,generatedBy:n.generatedBy,convertedBy:n.convertedBy,weightsManifest:e};return n.signature!=null&&(t.signature=n.signature),n.userDefinedMetadata!=null&&(t.userDefinedMetadata=n.userDefinedMetadata),n.modelInitializer!=null&&(t.modelInitializer=n.modelInitializer),n.initializerSignature!=null&&(t.initializerSignature=n.initializerSignature),n.trainingConfig!=null&&(t.trainingConfig=n.trainingConfig),t}function c$(n,e,t){const s={modelTopology:n.modelTopology,format:n.format,generatedBy:n.generatedBy,convertedBy:n.convertedBy};if(n.trainingConfig!=null&&(s.trainingConfig=n.trainingConfig),n.weightsManifest!=null){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!t)throw new Error("modelJSON has weightsManifest but weightData is null");s.weightSpecs=e,s.weightData=t}return n.signature!=null&&(s.signature=n.signature),n.userDefinedMetadata!=null&&(s.userDefinedMetadata=n.userDefinedMetadata),n.modelInitializer!=null&&(s.modelInitializer=n.modelInitializer),n.initializerSignature!=null&&(s.initializerSignature=n.initializerSignature),s}async function KN(n,e){let t,s;return n.weightsManifest!=null&&([t,s]=await e(n.weightsManifest)),c$(n,t,s)}function W0(n){if(n.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:n.modelTopology==null?0:dI(JSON.stringify(n.modelTopology)),weightSpecsBytes:n.weightSpecs==null?0:dI(JSON.stringify(n.weightSpecs)),weightDataBytes:n.weightData==null?0:new Pl(n.weightData).byteLength}}function RS(n){const e=[];for(const t of n)e.push(...t.weights);return e}function GB(){const n=t=>{let s=t<<13,r=0;for(;(s&8388608)===0;)r-=8388608,s<<=1;return s&=-8388609,r+=947912704,s|r},e=new Uint32Array(2048);e[0]=0;for(let t=1;t<1024;t++)e[t]=n(t);for(let t=1024;t<2048;t++)e[t]=939524096+(t-1024<<13);return e}function qB(){const n=new Uint32Array(64);n[0]=0,n[31]=1199570944,n[32]=2147483648,n[63]=3347054592;for(let e=1;e<31;e++)n[e]=e<<23;for(let e=33;e<63;e++)n[e]=2147483648+(e-32<<23);return n}function HB(){const n=new Uint32Array(64);for(let e=0;e<64;e++)n[e]=1024;return n[0]=n[32]=0,n}function KB(){const n=GB(),e=qB(),t=HB();return s=>{const r=new ArrayBuffer(4*s.length),a=new Uint32Array(r);for(let i=0;i<s.length;i++){const o=s[i],l=n[t[o>>10]+(o&1023)]+e[o>>10];a[i]=l}return new Float32Array(r)}}class Ps{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return Ps.instance==null&&(Ps.instance=new Ps),Ps.instance}static registerSaveRouter(e){Ps.getInstance().saveRouters.push(e)}static registerLoadRouter(e){Ps.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return Ps.getHandlers(e,"save")}static getLoadHandlers(e,t){return Ps.getHandlers(e,"load",t)}static getHandlers(e,t,s){const r=[];return(t==="load"?Ps.getInstance().loadRouters:Ps.getInstance().saveRouters).forEach(i=>{const o=i(e,s);o!==null&&r.push(o)}),r}}const XB=n=>Ps.registerSaveRouter(n),YB=n=>Ps.registerLoadRouter(n),h$=n=>Ps.getSaveHandlers(n),ZB=(n,e)=>Ps.getLoadHandlers(n,e);const DS="tensorflowjs",OS=1,Bf="models_store",bh="model_info_store";function f$(){if(!De().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const n=typeof window>"u"?self:window,e=n.indexedDB||n.mozIndexedDB||n.webkitIndexedDB||n.msIndexedDB||n.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function LS(n){const e=n.result;e.createObjectStore(Bf,{keyPath:"modelPath"}),e.createObjectStore(bh,{keyPath:"modelPath"})}class Zf{constructor(e){if(this.indexedDB=f$(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,t){return new Promise((s,r)=>{const a=this.indexedDB.open(DS,OS);a.onupgradeneeded=()=>LS(a),a.onsuccess=()=>{const i=a.result;if(t==null){const o=i.transaction(Bf,"readonly"),c=o.objectStore(Bf).get(this.modelPath);c.onsuccess=()=>{if(c.result==null)return i.close(),r(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));s(c.result.modelArtifacts)},c.onerror=f=>(i.close(),r(c.error)),o.oncomplete=()=>i.close()}else{t.weightData=Pl.join(t.weightData);const o=W0(t),l=i.transaction(bh,"readwrite");let c=l.objectStore(bh),f;try{f=c.put({modelPath:this.modelPath,modelArtifactsInfo:o})}catch(m){return r(m)}let d;f.onsuccess=()=>{d=i.transaction(Bf,"readwrite");const m=d.objectStore(Bf);let g;try{g=m.put({modelPath:this.modelPath,modelArtifacts:t,modelArtifactsInfo:o})}catch(b){return r(b)}g.onsuccess=()=>s({modelArtifactsInfo:o}),g.onerror=b=>{c=l.objectStore(bh);const x=c.delete(this.modelPath);x.onsuccess=()=>(i.close(),r(g.error)),x.onerror=v=>(i.close(),r(g.error))}},f.onerror=m=>(i.close(),r(f.error)),l.oncomplete=()=>{d==null?i.close():d.oncomplete=()=>i.close()}}},a.onerror=i=>r(a.error)})}}Zf.URL_SCHEME="indexeddb://";const d$=n=>De().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(Zf.URL_SCHEME)?JB(n.slice(Zf.URL_SCHEME.length)):null;Ps.registerSaveRouter(d$);Ps.registerLoadRouter(d$);function JB(n){return new Zf(n)}function QB(n){return n.startsWith(Zf.URL_SCHEME)?n.slice(Zf.URL_SCHEME.length):n}class e7{constructor(){this.indexedDB=f$()}async listModels(){return new Promise((e,t)=>{const s=this.indexedDB.open(DS,OS);s.onupgradeneeded=()=>LS(s),s.onsuccess=()=>{const r=s.result,a=r.transaction(bh,"readonly"),o=a.objectStore(bh).getAll();o.onsuccess=()=>{const l={};for(const c of o.result)l[c.modelPath]=c.modelArtifactsInfo;e(l)},o.onerror=l=>(r.close(),t(o.error)),a.oncomplete=()=>r.close()},s.onerror=r=>t(s.error)})}async removeModel(e){return e=QB(e),new Promise((t,s)=>{const r=this.indexedDB.open(DS,OS);r.onupgradeneeded=()=>LS(r),r.onsuccess=()=>{const a=r.result,i=a.transaction(bh,"readwrite"),o=i.objectStore(bh),l=o.get(e);let c;l.onsuccess=()=>{if(l.result==null)return a.close(),s(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const f=o.delete(e),d=()=>{c=a.transaction(Bf,"readwrite");const g=c.objectStore(Bf).delete(e);g.onsuccess=()=>t(l.result.modelArtifactsInfo),g.onerror=b=>s(l.error)};f.onsuccess=d,f.onerror=m=>(d(),a.close(),s(l.error))}},l.onerror=f=>(a.close(),s(l.error)),i.oncomplete=()=>{c==null?a.close():c.oncomplete=()=>a.close()}},r.onerror=a=>s(r.error)})}}const pc="/",Cp="tensorflowjs_models",p$="info",t7="model_topology",n7="weight_specs",s7="weight_data",r7="model_metadata";function m$(n){return{info:[Cp,n,p$].join(pc),topology:[Cp,n,t7].join(pc),weightSpecs:[Cp,n,n7].join(pc),weightData:[Cp,n,s7].join(pc),modelMetadata:[Cp,n,r7].join(pc)}}function g$(n){for(const e of Object.values(n))window.localStorage.removeItem(e)}function a7(n){const e=n.split(pc);if(e.length<3)throw new Error(`Invalid key format: ${n}`);return e.slice(1,e.length-1).join(pc)}function i7(n){return n.startsWith(Jf.URL_SCHEME)?n.slice(Jf.URL_SCHEME.length):n}class Jf{constructor(e){if(!De().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=m$(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const t=JSON.stringify(e.modelTopology),s=JSON.stringify(e.weightSpecs),r=W0(e),a=Pl.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,s),this.LS.setItem(this.keys.weightData,jB(a));const i={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(i)),{modelArtifactsInfo:r}}catch{throw g$(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${r.modelTopologyBytes}, weightSpecsBytes=${r.weightSpecsBytes}, weightDataBytes=${r.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const t={},s=JSON.parse(this.LS.getItem(this.keys.topology));if(s==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);t.modelTopology=s;const r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(r==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);t.weightSpecs=r;const a=this.LS.getItem(this.keys.modelMetadata);if(a!=null){const o=JSON.parse(a);t.format=o.format,t.generatedBy=o.generatedBy,t.convertedBy=o.convertedBy,o.signature!=null&&(t.signature=o.signature),o.userDefinedMetadata!=null&&(t.userDefinedMetadata=o.userDefinedMetadata),o.modelInitializer!=null&&(t.modelInitializer=o.modelInitializer),o.initializerSignature!=null&&(t.initializerSignature=o.initializerSignature),o.trainingConfig!=null&&(t.trainingConfig=o.trainingConfig)}const i=this.LS.getItem(this.keys.weightData);if(i==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return t.weightData=WB(i),t}}Jf.URL_SCHEME="localstorage://";const y$=n=>De().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(Jf.URL_SCHEME)?o7(n.slice(Jf.URL_SCHEME.length)):null;Ps.registerSaveRouter(y$);Ps.registerLoadRouter(y$);function o7(n){return new Jf(n)}class l7{constructor(){Z(De().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),Z(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},t=Cp+pc,s=pc+p$;for(let r=0;r<this.LS.length;++r){const a=this.LS.key(r);if(a.startsWith(t)&&a.endsWith(s)){const i=a7(a);e[i]=JSON.parse(this.LS.getItem(a))}}return e}async removeModel(e){e=i7(e);const t=m$(e);if(this.LS.getItem(t.info)==null)throw new Error(`Cannot find model at path '${e}'`);const s=JSON.parse(this.LS.getItem(t.info));return g$(t),s}}const _p="://";class za{constructor(){this.managers={}}static getInstance(){return za.instance==null&&(za.instance=new za),za.instance}static registerManager(e,t){Z(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(_p)&&(e=e.slice(0,e.indexOf(_p))),Z(e.length>0,()=>"scheme must not be an empty string.");const s=za.getInstance();Z(s.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),s.managers[e]=t}static getManager(e){const t=za.getInstance().managers[e];if(t==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return t}static getSchemes(){return Object.keys(za.getInstance().managers)}}function q2(n){if(n.indexOf(_p)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${za.getSchemes().join(",")}`);return{scheme:n.split(_p)[0],path:n.split(_p)[1]}}async function b$(n,e,t=!1){Z(n!==e,()=>`Old path and new path are the same: '${n}'`);const s=Ps.getLoadHandlers(n);Z(s.length>0,()=>`Copying failed because no load handler is found for source URL ${n}.`),Z(s.length<2,()=>`Copying failed because more than one (${s.length}) load handlers for source URL ${n}.`);const r=s[0],a=Ps.getSaveHandlers(e);Z(a.length>0,()=>`Copying failed because no save handler is found for destination URL ${e}.`),Z(a.length<2,()=>`Copying failed because more than one (${s.length}) save handlers for destination URL ${e}.`);const i=a[0],o=q2(n).scheme,l=q2(n).path,c=o===q2(n).scheme,f=await r.load();t&&c&&await za.getManager(o).removeModel(l);const d=await i.save(f);return t&&!c&&await za.getManager(o).removeModel(l),d.modelArtifactsInfo}async function u7(){const n=za.getSchemes(),e={};for(const t of n){const s=await za.getManager(t).listModels();for(const r in s){const a=t+_p+r;e[a]=s[r]}}return e}async function c7(n){const e=q2(n);return za.getManager(e.scheme).removeModel(e.path)}async function h7(n,e){return b$(n,e,!1)}async function f7(n,e){return b$(n,e,!0)}class d7{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,t){return fetch(e,t)}now(){return performance.now()}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${t}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,t){return new TextDecoder(t).decode(e)}setTimeoutCustom(e,t){if(typeof window>"u"||!De().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,t);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},t),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",s=>{if(s.source===window&&s.data.name===this.messageName){s.stopPropagation();const r=this.functionRefs[s.data.index];r(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return G_(e)}}if(De().get("IS_BROWSER")){De().setPlatform("browser",new d7);try{za.registerManager(Jf.URL_SCHEME,new l7)}catch{}try{za.registerManager(Zf.URL_SCHEME,new e7)}catch{}}const p7={importFetch:()=>require("node-fetch")};let D5;class m7{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,t){return De().global.fetch!=null?De().global.fetch(e,t):(D5==null&&(D5=p7.importFetch()),D5(e,t))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${t}`);return this.textEncoder.encode(e)}decode(e,t){return e.length===0?"":new this.util.TextDecoder(t).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}De().get("IS_NODE")&&!De().get("IS_BROWSER")&&De().setPlatform("node",new m7);function mn(n,e="float32",t){return e=e||"float32",Pi(n),new Sr(n,e,t)}function g7(n,e){const t=te(n,"x","cast");if(!L_(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&t.dtype!=="string"||e!=="string"&&t.dtype==="string")throw new Error("Only strings can be casted to strings");const s={x:t},r={dtype:e};return me.runKernel(um,s,r)}const lt=ge({cast_:g7});function y7(n){const t={x:te(n,"x","clone","string_or_numeric")};return me.runKernel(Sm,t)}const xu=ge({clone_:y7});function XN(n,e=!1){console.log(n.toString(e))}n$();const b7={buffer:mn,cast:lt,clone:xu,print:XN};mB(b7);function x7(n,e){let t=te(n,"a","add"),s=te(e,"b","add");[t,s]=Vs(t,s);const r={a:t,b:s};return me.runKernel(gd,r)}const et=ge({add_:x7});function v7(n,e){let t=te(n,"a","floorDiv"),s=te(e,"b","floorDiv");[t,s]=Vs(t,s);const r={a:t,b:s};return me.runKernel(vm,r)}const sv=ge({floorDiv_:v7});function w7(n,e){let t=te(n,"a","div"),s=te(e,"b","div");if([t,s]=Vs(t,s),t.dtype==="int32"&&s.dtype==="int32")return sv(t,s);const r={a:t,b:s},a={};return me.runKernel(pm,r,a)}const $t=ge({div_:w7});function S7(n,e){let t=te(n,"a","mul"),s=te(e,"b","mul");[t,s]=Vs(t,s);const r={a:t,b:s};return me.runKernel($m,r)}const xe=ge({mul_:S7});function N7(n){const e=te(n,"x","abs");if(e.dtype==="complex64"){const t={x:e};return me.runKernel(X1,t)}else{const t={x:e};return me.runKernel(B1,t)}}const br=ge({abs_:N7});function k7(n){const t={x:te(n,"x","acos")};return me.runKernel(nm,t)}const YN=ge({acos_:k7});function C7(n){const t={x:te(n,"x","acosh")};return me.runKernel(sm,t)}const ZN=ge({acosh_:C7});function T7(n){Z(Array.isArray(n),()=>"The argument passed to tf.addN() must be a list of tensors"),Z(n.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${n.length}`);const e=n.map((r,a)=>te(r,`tensors${a}`,"addN")),t=e[0];e.forEach(r=>{if(r.dtype!==t.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(r=>{if(!Nn(r.shape,t.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const s=e;return me.runKernel(U1,s)}const x$=ge({addN_:T7});function A7(n,e=null,t=!1){const r={x:te(n,"x","all","bool")},a={axis:e,keepDims:t};return me.runKernel(Yb,r,a)}const rv=ge({all_:A7});function I7(n,e=null,t=!1){const r={x:te(n,"x","any","bool")},a={axis:e,keepDims:t};return me.runKernel(Zb,r,a)}const N1=ge({any_:I7});function E7(n,e=0){const s={x:te(n,"x","argMax")},r={axis:e};return me.runKernel(V1,s,r)}const Qf=ge({argMax_:E7});function _7(n,e=0){const s={x:te(n,"x","argMin")},r={axis:e};return me.runKernel(j1,s,r)}const JN=ge({argMin_:_7});function $7(n){const t={x:te(n,"x","asin")};return me.runKernel(rm,t)}const QN=ge({asin_:$7});function R7(n){const t={x:te(n,"x","asinh")};return me.runKernel(am,t)}const ek=ge({asinh_:R7});function D7(n){const t={x:te(n,"x","atan")};return me.runKernel(im,t)}const tk=ge({atan_:D7});function O7(n,e){let t=te(n,"a","atan2"),s=te(e,"b","atan2");[t,s]=Vs(t,s);const r={a:t,b:s};return me.runKernel(lm,r)}const nk=ge({atan2_:O7});function L7(n){const t={x:te(n,"x","atanh")};return me.runKernel(om,t)}const sk=ge({atanh_:L7});function G0(n,e,t,s,r="NHWC",a){const i=n[3],o=[...e,i],l=Tc(r);return Yr(n,o,t,a,s,null,null,l)}function qo(n,e,t,s,r,a,i="channelsLast"){const[o,l]=k1(e);let c;if(i==="channelsLast")c=[o,l,n[3],n[3]];else if(i==="channelsFirst")c=[o,l,n[1],n[1]];else throw new Error(`Unknown dataFormat ${i}`);return Yr(n,c,t,s,r,a,!1,i)}function Cc(n,e,t,s,r,a,i="NDHWC"){const[o,l,c]=FS(e);let f,d;if(i==="NDHWC")d="channelsLast",f=[o,l,c,n[4],n[4]];else if(i==="NCDHW")d="channelsFirst",f=[o,l,c,n[1],n[1]];else throw new Error(`Unknown dataFormat ${i}`);return Uh(n,f,t,s,r,!1,d,a)}function Yr(n,e,t,s,r,a,i=!1,o="channelsLast"){let[l,c,f,d]=[-1,-1,-1,-1];if(o==="channelsLast")[l,c,f,d]=n;else if(o==="channelsFirst")[l,d,c,f]=n;else throw new Error(`Unknown dataFormat ${o}`);const[m,g,,b]=e,[x,v]=k1(t),[w,k]=k1(s),I=$p(m,w),A=$p(g,k),{padInfo:R,outHeight:U,outWidth:V}=z7(r,c,f,x,v,I,A,a,o),P=i?b*d:b;let D;return o==="channelsFirst"?D=[l,P,U,V]:o==="channelsLast"&&(D=[l,U,V,P]),{batchSize:l,dataFormat:o,inHeight:c,inWidth:f,inChannels:d,outHeight:U,outWidth:V,outChannels:P,padInfo:R,strideHeight:x,strideWidth:v,filterHeight:m,filterWidth:g,effectiveFilterHeight:I,effectiveFilterWidth:A,dilationHeight:w,dilationWidth:k,inShape:n,outShape:D,filterShape:e}}function Uh(n,e,t,s,r,a=!1,i="channelsLast",o){let[l,c,f,d,m]=[-1,-1,-1,-1,-1];if(i==="channelsLast")[l,c,f,d,m]=n;else if(i==="channelsFirst")[l,m,c,f,d]=n;else throw new Error(`Unknown dataFormat ${i}`);const[g,b,x,,v]=e,[w,k,I]=FS(t),[A,R,U]=FS(s),V=$p(g,A),P=$p(b,R),D=$p(x,U),{padInfo:B,outDepth:E,outHeight:M,outWidth:K}=P7(r,c,f,d,w,k,I,V,P,D,o),X=a?v*m:v;let ae;return i==="channelsFirst"?ae=[l,X,E,M,K]:i==="channelsLast"&&(ae=[l,E,M,K,X]),{batchSize:l,dataFormat:i,inDepth:c,inHeight:f,inWidth:d,inChannels:m,outDepth:E,outHeight:M,outWidth:K,outChannels:X,padInfo:B,strideDepth:w,strideHeight:k,strideWidth:I,filterDepth:g,filterHeight:b,filterWidth:x,effectiveFilterDepth:V,effectiveFilterHeight:P,effectiveFilterWidth:D,dilationDepth:A,dilationHeight:R,dilationWidth:U,inShape:n,outShape:ae,filterShape:e}}function F7(n,e,t,s,r){s==null&&(s=rk(n,e,t));const a=n[0],i=n[1],o=C1((a-e+2*s)/t+1,r),l=C1((i-e+2*s)/t+1,r);return[o,l]}function M7(n,e,t,s,r,a){r==null&&(r=rk(n,e[0],s[0]));const i=[0,0,0,t];for(let o=0;o<3;o++)n[o]+2*r>=e[o]&&(i[o]=C1((n[o]-e[o]+2*r)/s[o]+1,a));return i}function rk(n,e,t,s=1){const r=$p(e,s);return Math.floor((n[0]*(t-1)-t+r)/2)}function k1(n){return typeof n=="number"?[n,n,n]:n.length===2?[n[0],n[1],1]:n}function FS(n){return typeof n=="number"?[n,n,n]:n}function $p(n,e){return e<=1?n:n+(n-1)*(e-1)}function z7(n,e,t,s,r,a,i,o,l){let c,f,d;if(typeof n=="number"){c={top:n,bottom:n,left:n,right:n,type:n===0?"VALID":"NUMBER"};const g=F7([e,t],a,s,n,o);f=g[0],d=g[1]}else if(n==="same"){f=Math.ceil(e/s),d=Math.ceil(t/r);const m=Math.max(0,(f-1)*s+a-e),g=Math.max(0,(d-1)*r+i-t),b=Math.floor(m/2),x=m-b,v=Math.floor(g/2),w=g-v;c={top:b,bottom:x,left:v,right:w,type:"SAME"}}else if(n==="valid")c={top:0,bottom:0,left:0,right:0,type:"VALID"},f=Math.ceil((e-a+1)/s),d=Math.ceil((t-i+1)/r);else if(typeof n=="object"){const m=l==="channelsLast"?n[1][0]:n[2][0],g=l==="channelsLast"?n[1][1]:n[2][1],b=l==="channelsLast"?n[2][0]:n[3][0],x=l==="channelsLast"?n[2][1]:n[3][1];c={top:m,bottom:g,left:b,right:x,type:m===0&&g===0&&b===0&&x===0?"VALID":"EXPLICIT"},f=C1((e-a+m+g)/s+1,o),d=C1((t-i+b+x)/r+1,o)}else throw Error(`Unknown padding parameter: ${n}`);return{padInfo:c,outHeight:f,outWidth:d}}function P7(n,e,t,s,r,a,i,o,l,c,f){let d,m,g,b;if(n==="valid"&&(n=0),typeof n=="number"){d={top:n,bottom:n,left:n,right:n,front:n,back:n,type:n===0?"VALID":"NUMBER"};const v=M7([e,t,s,1],[o,l,c],1,[r,a,i],n,f);m=v[0],g=v[1],b=v[2]}else if(n==="same"){m=Math.ceil(e/r),g=Math.ceil(t/a),b=Math.ceil(s/i);const x=(m-1)*r+o-e,v=(g-1)*a+l-t,w=(b-1)*i+c-s,k=Math.floor(x/2),I=x-k,A=Math.floor(v/2),R=v-A,U=Math.floor(w/2),V=w-U;d={top:A,bottom:R,left:U,right:V,front:k,back:I,type:"SAME"}}else throw Error(`Unknown padding parameter: ${n}`);return{padInfo:d,outDepth:m,outHeight:g,outWidth:b}}function C1(n,e){if(!e)return Math.trunc(n);switch(e){case"round":return Math.round(n);case"ceil":return Math.ceil(n);case"floor":return Math.floor(n);default:throw new Error(`Unknown roundingMode ${e}`)}}function Eh(n){const[e,t,s]=k1(n);return e===1&&t===1&&s===1}function fa(n,e){return Eh(n)||Eh(e)}function ed(n){return k1(n).every(e=>e>0)}function Tc(n){if(n==="NHWC")return"channelsLast";if(n==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${n}`)}function ja(n,e,t){if(t!=null){if(typeof e=="string")throw Error(`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${e}.`);if(typeof e=="number")Z(Xf(e),()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${e}.`);else if(typeof e=="object")e.forEach(s=>{s.forEach(r=>{Z(Xf(r),()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${r}.`)})});else throw Error(`Error in ${n}: Unknown padding parameter: ${e}`)}}function B7(n,e){const s={x:te(n,"x","reshape","string_or_numeric")},r={shape:e};return me.runKernel(E0,s,r)}const we=ge({reshape_:B7});function U7(n,e,t,s,r){const a=te(n,"x","avgPool","float32"),i=1;Z(fa(t,i),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${t} and dilations '${i}'`);let o=a,l=!1;a.rank===3&&(l=!0,o=we(a,[1,a.shape[0],a.shape[1],a.shape[2]])),Z(o.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${o.rank}.`),ja("avgPool",s,r);const c={x:o},f={filterSize:e,strides:t,pad:s,dimRoundingMode:r};let d=me.runKernel(W1,c,f);return d=lt(d,a.dtype),l?we(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const q0=ge({avgPool_:U7});function V7(n,e,t,s,r,a="NDHWC"){const i=te(n,"x","avgPool3d","float32");let o=i,l=!1;i.rank===4&&(l=!0,o=we(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),Z(o.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${o.rank}.`),Z(a==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${a}`),Z(typeof t=="number"&&t>0||Array.isArray(t)&&t[0]>0&&t[1]>0&&t[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${t}'`),ja("avgPool3d",s,r);const c={x:o},f={filterSize:e,strides:t,pad:s,dimRoundingMode:r,dataFormat:a};let d=me.runKernel(G1,c,f);return d=lt(d,o.dtype),l?we(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const ak=ge({avgPool3d_:V7});function j7(n,e=0){Z(n.length>=1,()=>"Pass at least one tensor to concat");const t=S1(n,"tensors","concat","string_or_numeric");if(t[0].dtype==="complex64"&&t.forEach(a=>{if(a.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${a.dtype}. `)}),t.length===1)return xu(t[0]);const s=t,r={axis:e};return me.runKernel(Y1,s,r)}const ur=ge({concat_:j7});function W7(n,e,t=!1,s=!1){let r=te(n,"a","matMul"),a=te(e,"b","matMul");[r,a]=Vs(r,a);const i={a:r,b:a},o={transposeA:t,transposeB:s};return me.runKernel(q1,i,o)}const bn=ge({matMul_:W7});function G7(n){const t={x:te(n,"x","sigmoid","float32")};return me.runKernel(Vm,t)}const _l=ge({sigmoid_:G7});function q7(n,e,t){const s=te(n,"x","slice","string_or_numeric");if(s.rank===0)throw new Error("Slicing scalar is not possible");const r={x:s},a={begin:e,size:t};return me.runKernel(O0,r,a)}const Tn=ge({slice_:q7});function H7(n){const t={x:te(n,"x","tanh","float32")};return me.runKernel(Km,t)}const _h=ge({tanh_:H7});function K7(n,e,t,s,r,a){const i=te(n,"forgetBias","basicLSTMCell"),o=te(e,"lstmKernel","basicLSTMCell"),l=te(t,"lstmBias","basicLSTMCell"),c=te(s,"data","basicLSTMCell"),f=te(r,"c","basicLSTMCell"),d=te(a,"h","basicLSTMCell"),m=ur([c,d],1),g=bn(m,o),b=et(g,l),x=b.shape[0],v=b.shape[1]/4,w=[x,v],k=Tn(b,[0,0],w),I=Tn(b,[0,v],w),A=Tn(b,[0,v*2],w),R=Tn(b,[0,v*3],w),U=et(xe(_l(k),_h(I)),xe(f,_l(et(i,A)))),V=xe(_h(U),_l(R));return[U,V]}const v$=ge({basicLSTMCell_:K7});function X7(n,e,t){const s=te(n,"x","batchToSpaceND"),r=e.reduce((o,l)=>o*l);Z(s.rank>=1+e.length,()=>`input rank is ${s.rank} but should be > than blockShape.length ${e.length}`),Z(t.length===e.length,()=>`crops.length is ${t.length} but should be equal to blockShape.length  ${e.length}`),Z(s.shape[0]%r===0,()=>`input tensor batch is ${s.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${r}`);const a={x:s},i={blockShape:e,crops:t};return me.runKernel(H1,a,i)}const H0=ge({batchToSpaceND_:X7});function Y7(n){let e;return n.rank===0||n.rank===1?e=we(n,[1,1,1,n.size]):n.rank===2?e=we(n,[1,1,n.shape[0],n.shape[1]]):n.rank===3?e=we(n,[1,n.shape[0],n.shape[1],n.shape[2]]):e=n,e}function Z7(n,e,t,s,r,a){a==null&&(a=.001);const i=te(n,"x","batchNorm"),o=te(e,"mean","batchNorm"),l=te(t,"variance","batchNorm");let c;r!=null&&(c=te(r,"scale","batchNorm"));let f;s!=null&&(f=te(s,"offset","batchNorm")),Z(o.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),Z(f==null||o.rank===f.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),Z(c==null||o.rank===c.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const m={x:Y7(i),scale:c,offset:f,mean:o,variance:l},g={varianceEpsilon:a},b=me.runKernel(a0,m,g);return we(b,i.shape)}const Zm=ge({batchNorm_:Z7});function J7(n,e,t,s,r,a){const i=te(n,"x","batchNorm"),o=te(e,"mean","batchNorm"),l=te(t,"variance","batchNorm");let c;r!=null&&(c=te(r,"scale","batchNorm"));let f;return s!=null&&(f=te(s,"offset","batchNorm")),Z(i.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${i.rank}.`),Z(o.rank===2||o.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${o.rank}.`),Z(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),c!=null&&Z(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${c.rank}.`),f!=null&&Z(f.rank===2||f.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${f.rank}.`),Zm(i,o,l,f,c,a)}const ik=ge({batchNorm2d_:J7});function Q7(n,e,t,s,r,a){const i=te(n,"x","batchNorm"),o=te(e,"mean","batchNorm"),l=te(t,"variance","batchNorm");let c;r!=null&&(c=te(r,"scale","batchNorm"));let f;return s!=null&&(f=te(s,"offset","batchNorm")),Z(i.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${i.rank}.`),Z(o.rank===3||o.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${o.rank}.`),Z(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),c!=null&&Z(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${c.rank}.`),f!=null&&Z(f.rank===3||f.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${f.rank}.`),Zm(i,o,l,f,c,a)}const ok=ge({batchNorm3d_:Q7});function eU(n,e,t,s,r,a){const i=te(n,"x","batchNorm"),o=te(e,"mean","batchNorm"),l=te(t,"variance","batchNorm");let c;r!=null&&(c=te(r,"scale","batchNorm"));let f;return s!=null&&(f=te(s,"offset","batchNorm")),Z(i.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${i.rank}.`),Z(o.rank===4||o.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${o.rank}.`),Z(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),c!=null&&Z(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${c.rank}.`),f!=null&&Z(f.rank===4||f.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${f.rank}.`),Zm(i,o,l,f,c,a)}const lk=ge({batchNorm4d_:eU});function tU(n,e,t){const s=te(n,"x","bincount"),r=te(e,"weights","bincount");Z(s.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${s.dtype}`),Z(t>=0,()=>`size must be non-negative, but got ${t}.`),Z(r.size===s.size||r.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${s.shape}, weights shape: ${r.shape}.`);const a={x:s,weights:r},i={size:t};return me.runKernel(ex,a,i)}const uk=ge({bincount_:tU});function nU(n,e){const t=te(n,"x","bitwiseAnd"),s=te(e,"y","bitwiseAnd");if(!Nn(t.shape,s.shape))throw new Error(`BitwiseAnd: Tensors must have the same shape. x: ${t.shape}, y: ${s.shape}`);if(t.dtype!=="int32"||s.dtype!=="int32")throw new Error(`BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ${t.dtype} and type of y: ${s.dtype}`);const r={a:t,b:s};return me.runKernel(K1,r)}const w$=ge({bitwiseAnd_:nU});function sU(n,e){const t=te(n,"s0","broadcastArgs","int32"),s=te(e,"s1","broadcastArgs","int32");if(t.rank!==1)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${t.rank}`);if(s.rank!==1)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${s.rank}`);const r={s0:t,s1:s};return me.runKernel(tx,r)}const S$=ge({broadcastArgs_:sU});function rU(n,e){let t=te(n,"broadcastTo","x");const s=t.shape;if(Pi(e),e.length<t.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${t.rank}.`);if(e.length>t.rank){const c=t.shape.slice();for(;c.length<e.length;)c.unshift(1);t=we(t,c)}const r=t.shape,a=Array.from(e);for(let c=e.length-1;c>=0;c--)if(r[c]===e[c])a[c]=1;else if(t.shape[c]!==1)throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${e}].`);if(a.map((c,f)=>c>1?f:-1).filter(c=>c>=0).length===0)return xu(t);const o={x:t},l={reps:a};return me.runKernel(Xm,o,l)}const Gf=ge({broadcastTo_:rU});function aU(n){const t={x:te(n,"x","ceil","float32")};return me.runKernel(cm,t)}const ck=ge({ceil_:aU});function yd(n,e,t){Pi(n),t=t||pd(e);const s={shape:n,value:e,dtype:t};return me.runKernel(yx,{},s)}function iU(n,e,t){const s=te(n,"x","clipByValue");if(Z(e<=t,()=>`Error in clip: min (${e}) must be less than or equal to max (${t}).`),e===t)return yd(s.shape,e,s.dtype);const r={x:s},a={clipValueMin:e,clipValueMax:t};return me.runKernel(hm,r,a)}const oi=ge({clipByValue_:iU});function oU(n){return ur(n,0)}const hk=ge({concat1d_:oU});function lU(n,e){return ur(n,e)}const fk=ge({concat2d_:lU});function uU(n,e){return ur(n,e)}const dk=ge({concat3d_:uU});function cU(n,e){return ur(n,e)}const pk=ge({concat4d_:cU});function hU(n,e,t,s,r="NHWC",a=[1,1],i){const o=te(n,"x","conv2d","float32"),l=te(e,"filter","conv2d","float32");let c=o,f=!1;o.rank===3&&(f=!0,c=we(o,[1,o.shape[0],o.shape[1],o.shape[2]])),Z(c.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${c.rank}.`),Z(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),ja("conv2d",s,i);const d=r==="NHWC"?c.shape[3]:c.shape[1];Z(d===l.shape[2],()=>`Error in conv2d: depth of input (${d}) must match input depth for filter ${l.shape[2]}.`),Z(fa(t,a),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${t} and dilations '${a}'`),Z(ed(a),()=>"Error in conv2D: Dilated rates should be larger than 0."),Z(ed(t),()=>"Error in conv2D: Strides should be larger than 0.");const m={x:c,filter:l},g={strides:t,pad:s,dataFormat:r,dilations:a,dimRoundingMode:i},b=me.runKernel(Z1,m,g);return f?we(b,[b.shape[1],b.shape[2],b.shape[3]]):b}const vc=ge({conv2d_:hU});function fU(n,e,t,s,r="NWC",a=1,i){const o=te(n,"x","conv1d"),l=te(e,"filter","conv1d");let c=o,f=!1;o.rank===2&&(f=!0,c=we(o,[1,o.shape[0],o.shape[1]])),Z(c.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${c.rank}.`),Z(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),ja("conv1d",s,i),Z(c.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${c.shape[2]}) must match input depth for filter ${l.shape[1]}.`),Z(fa(t,a),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${t} and dilation '${a}'`),Z(ed(a),()=>"Error in conv1D: Dilated rates should be larger than 0."),Z(ed(t),()=>"Error in conv1D: Stride should be larger than 0."),Z(r==="NWC",()=>`Error in conv1d: got dataFormat of ${r} but only NWC is currently supported.`);const d=we(l,[1,l.shape[0],l.shape[1],l.shape[2]]),m=we(c,[c.shape[0],1,c.shape[1],c.shape[2]]),v=vc(m,d,[1,t],s,"NHWC",[1,a],i);return f?we(v,[v.shape[2],v.shape[3]]):we(v,[v.shape[0],v.shape[2],v.shape[3]])}const av=ge({conv1d_:fU});function dU(n,e,t,s,r,a="NHWC",i){Z(n.length===e.rank,()=>`Length of inShape (${n.length}) and rank of dy (${e.rank}) must match`);let o=n,l=e,c=!1;e.rank===3&&(c=!0,l=we(e,[1,e.shape[0],e.shape[1],e.shape[2]]),o=[1,n[0],n[1],n[2]]),Z(o.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${o.length}.`),Z(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),Z(t.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${t.rank}`);const f=a==="NHWC"?o[3]:o[1],d=a==="NHWC"?l.shape[3]:l.shape[1];Z(f===t.shape[2],()=>`Error in conv2dDerInput: depth of input (${f}) must match input depth for filter ${t.shape[2]}.`),Z(d===t.shape[3],()=>`Error in conv2dDerInput: depth of output (${d}) must match output depth for filter ${t.shape[3]}.`),ja("conv2dDerInput",r,i);const m={dy:l,filter:t},g={strides:s,pad:r,dataFormat:a,dimRoundingMode:i,inputShape:o},b=me.runKernel(J1,m,g);return c?we(b,[b.shape[1],b.shape[2],b.shape[3]]):b}const mk=ge({conv2DBackpropInput_:dU});function pU(n,e,t,s,r,a){const i=te(n,"x","conv2dTranspose"),o=te(e,"filter","conv2dTranspose");return mk(t,i,o,s,r,"NHWC",a)}const iv=ge({conv2dTranspose_:pU});function mU(n,e,t,s,r="NDHWC",a=[1,1,1]){const i=te(n,"x","conv3d"),o=te(e,"filter","conv3d");let l=i,c=!1;i.rank===4&&(c=!0,l=we(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),Z(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),Z(o.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${o.rank}.`),Z(l.shape[4]===o.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${o.shape[3]}.`),Z(fa(t,a),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${t} and dilations '${a}'`),Z(r==="NDHWC",()=>`Error in conv3d: got dataFormat of ${r} but only NDHWC is currently supported.`),Z(ed(a),()=>"Error in conv3D: Dilated rates should be larger than 0."),Z(ed(t),()=>"Error in conv3D: Strides should be larger than 0.");const f={x:l,filter:o},d={strides:t,pad:s,dataFormat:r,dilations:a},m=me.runKernel(Q1,f,d);return c?we(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}const gk=ge({conv3d_:mU});function gU(n,e,t,s,r){Z(n.length===e.rank,()=>`Length of inShape (${n.length}) and rank of dy (${e.rank}) must match`);let a=n,i=e,o=!1;e.rank===4&&(o=!0,i=we(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),a=[1,n[0],n[1],n[2],n[3]]);const l=a[4],c=i.shape[4];Z(a.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${a.length}.`),Z(i.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${i.rank}`),Z(t.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${t.rank}`),Z(l===t.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${t.shape[3]}.`),Z(c===t.shape[4],()=>`Error in conv3dDerInput: depth of output (${c}) must match output depth for filter ${t.shape[4]}.`);const f={dy:i,filter:t},d={pad:r,strides:s,inputShape:a},m=me.runKernel(ax,f,d);return o?we(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}const N$=ge({conv3DBackpropInput_:gU});function yU(n,e,t,s,r){const a=te(n,"x","conv3dTranspose"),i=te(e,"filter","conv3dTranspose");return N$(t,a,i,s,r)}const yk=ge({conv3dTranspose_:yU});function bU(n){const t={x:te(n,"x","cos","float32")};return me.runKernel(fm,t)}const K0=ge({cos_:bU});function xU(n){const t={x:te(n,"x","cosh","float32")};return me.runKernel(dm,t)}const ov=ge({cosh_:xU});function vU(n,e=0,t=!1,s=!1){const a={x:te(n,"x","cumprod")},i={axis:e,exclusive:t,reverse:s};return me.runKernel(ix,a,i)}const T1=ge({cumprod_:vU});function wU(n,e=0,t=!1,s=!1){const a={x:te(n,"x","cumsum")},i={axis:e,exclusive:t,reverse:s};return me.runKernel(e0,a,i)}const lv=ge({cumsum_:wU});function SU(n,e,t,s=!1){const r=te(n,"x","denseBincount"),a=te(e,"weights","denseBincount");Z(r.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${r.dtype}`),Z(r.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${r.rank}.`),Z(t>=0,()=>`size must be non-negative, but got ${t}.`),Z(a.size===r.size||a.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${r.shape}, weights shape: ${a.shape}.`);const i={x:r,weights:a},o={size:t,binaryOutput:s};return me.runKernel(lx,i,o)}const bb=ge({denseBincount_:SU});function NU(n,e,t="NHWC"){const s=te(n,"x","depthToSpace","float32"),r=t==="NHWC"?s.shape[1]:s.shape[2],a=t==="NHWC"?s.shape[2]:s.shape[3],i=t==="NHWC"?s.shape[3]:s.shape[1];Z(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),Z(r*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${r} and ${e}  for depthToSpace with input shape
    ${s.shape}`),Z(a*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${a} and ${e} for depthToSpace with input shape
        ${s.shape}`),Z(i%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${i} for depthToSpace with input shape ${s.shape}`);const o={x:s},l={blockSize:e,dataFormat:t};return me.runKernel(ux,o,l)}const bk=ge({depthToSpace_:NU});function kU(n,e,t,s,r="NHWC",a=[1,1],i){const o=te(n,"x","depthwiseConv2d","float32"),l=te(e,"filter","depthwiseConv2d","float32");let c=o,f=!1;o.rank===3&&(f=!0,c=we(o,[1,o.shape[0],o.shape[1],o.shape[2]])),Z(c.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${c.rank}.`),Z(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const d=r==="NHWC"?c.shape[3]:c.shape[1];Z(d===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${d}) must match the inChannels dimension in filter ${l.shape[2]}.`),ja("depthwiseConv2d",s,i);const m={x:c,filter:l},g={strides:t,pad:s,dataFormat:r,dilations:a,dimRoundingMode:i},b=me.runKernel(t0,m,g);return f?we(b,[b.shape[1],b.shape[2],b.shape[3]]):b}const Jm=ge({depthwiseConv2d_:kU});function CU(n){const t={x:te(n,"x","diag")};return me.runKernel(fx,t)}const k$=ge({diag_:CU});function TU(n,e,t,s,r=[1,1],a="NHWC"){const i=te(n,"x","dilation2d"),o=te(e,"filter","dilation2d");Z(i.rank===3||i.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${i.rank}.`),Z(o.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${o.rank}.`),Z(a==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${a}`);let l=i,c=!1;i.rank===3&&(l=we(i,[1,i.shape[0],i.shape[1],i.shape[2]]),c=!0),Z(l.shape[3]===o.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${o.shape[2]}`);const f={x:l,filter:o},d={strides:t,pad:s,dilations:r},m=me.runKernel(n0,f,d);return c?we(m,[m.shape[1],m.shape[2],m.shape[3]]):m}const xk=ge({dilation2d_:TU});function td(n,e){const t=n.length,s=[];for(let r=0;r<t;r++){const a=t-1-r,i=n[a]||1;(e[e.length-1-r]||1)>1&&i===1&&s.unshift(a)}return s}function Nr(n,e){const t=[];for(let s=0;s<e.length;s++){const r=n[n.length-s-1],a=e.length-s-1,i=e[a];(r==null||r===1&&i>1)&&t.unshift(a)}return t}function on(n,e){const t=Math.max(n.length,e.length),s=new Array(t);for(let r=0;r<t;r++){let a=n[n.length-r-1];a==null&&(a=1);let i=e[e.length-r-1];if(i==null&&(i=1),a===1)s[t-r-1]=i;else if(i===1)s[t-r-1]=a;else if(a!==i){const o=`Operands could not be broadcast together with shapes ${n} and ${e}.`;throw Error(o)}else s[t-r-1]=a}return s}const AU=Object.freeze(Object.defineProperty({__proto__:null,assertAndGetBroadcastShape:on,getBroadcastDims:td,getReductionAxes:Nr},Symbol.toStringTag,{value:"Module"}));function IU(n,e){let t=te(n,"a","equal","string_or_numeric"),s=te(e,"b","equal","string_or_numeric");[t,s]=Vs(t,s),on(t.shape,s.shape);const r={a:t,b:s};return me.runKernel(s0,r)}const Wo=ge({equal_:IU});function EU(n,e,t){const s=te(e,"a","where"),r=te(t,"b","where"),a=te(n,"condition","where","bool"),i=on(on(a.shape,s.shape),r.shape),o=Gf(a,i),l=Gf(s,i),c=Gf(r,i),f={condition:o,t:l,e:c};return me.runKernel(D0,f)}const ua=ge({where_:EU});function _U(n){const t={x:te(n,"x","zerosLike")};return me.runKernel(V0,t)}const $n=ge({zerosLike_:_U});function $U(n,e){let t=te(n,"a","div"),s=te(e,"b","div");[t,s]=Vs(t,s);const r=$t(t,s),a=$n(r),i=Wo(s,a);return ua(i,a,r)}const vk=ge({divNoNan_:$U});function RU(n,e){const t=te(n,"t1","dot"),s=te(e,"t2","dot");Z((t.rank===1||t.rank===2)&&(s.rank===1||s.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${t.rank} and ${s.rank}.`);const r=t.rank===1?t.size:t.shape[1],a=s.rank===1?s.size:s.shape[0];if(Z(r===a,()=>`Error in dot: inner dimensions of inputs must match, but got ${r} and ${a}.`),t.rank===1&&s.rank===1){const i=we(t,[1,-1]),o=we(s,[-1,1]),l=bn(i,o);return we(l,[])}else if(t.rank===1&&s.rank===2){const i=we(t,[1,-1]),o=we(s,[s.shape[0],s.shape[1]]),l=bn(i,o);return we(l,[l.size])}else if(t.rank===2&&s.rank===1){const i=we(s,[-1,1]),o=bn(t,i);return we(o,[o.size])}else{const i=we(s,[s.shape[0],s.shape[1]]);return bn(t,i)}}const wk=ge({dot_:RU});function DU(n,...e){const t=e.map((r,a)=>te(r,`tensors${a}`,"einsum")),s={equation:n};return me.runKernel(px,t,s)}const Lf=ge({einsum_:DU});function OU(n){const t={x:te(n,"x","elu","float32")};return me.runKernel(mm,t)}const Qm=ge({elu_:OU});function LU(n,e){const t=te(n,"x","ensureShape","string_or_numeric");if(!D_(t.shape,e))throw new Error(`EnsureShape: Shape of tensor ${t.shape} is not compatible with expected shape ${e}`);return n}const C$=ge({ensureShape_:LU});function FU(n){let e=te(n,"x","erf");Z(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=lt(e,"float32"));const t={x:e};return me.runKernel(gm,t)}const uv=ge({erf_:FU});function Sk(n,e){for(let t=0;t<n.length;++t)if(n[n.length-t-1]!==e-1-t)return!1;return!0}function T$(n,e,t){const s=n.length+e.length,r=[];let a=0,i=0;for(let o=0;o<s;o++)t.indexOf(o)===-1?r.push(n[a++]):r.push(e[i++]);return r}function Zr(n,e){const t=[],s=n.length;for(let a=0;a<s;a++)e.indexOf(a)===-1&&t.push(n[a]);const r=e.map(a=>n[a]);return[t,r]}function cr(n,e){const t=e.map(s=>1);return T$(n,t,e)}function da(n,e,t){Z(Sk(e,t),()=>`${n} supports only inner-most axes for now. Got axes ${e} and rank-${t} input.`)}function js(n,e){if(Sk(n,e))return null;const t=[];for(let s=0;s<e;++s)n.indexOf(s)===-1&&t.push(s);return n.forEach(s=>t.push(s)),t}function Vh(n){return n.map((e,t)=>[t,e]).sort((e,t)=>e[1]-t[1]).map(e=>e[0])}function hr(n,e){const t=[];for(let s=e-n;s<e;++s)t.push(s);return t}function MU(n,e=null,t=!1){const r={x:te(n,"x","max")},a={reductionIndices:e,keepDims:t};return me.runKernel(m0,r,a)}const fo=ge({max_:MU});function zU(n,e=null,t=!1){const r={x:te(n,"x","min")},a={axis:e,keepDims:t};return me.runKernel(x0,r,a)}const Vp=ge({min_:zU});function PU(n,e){let t=te(n,"base","pow"),s=te(e,"exp","pow");[t,s]=Vs(t,s);const r={a:t,b:s};return me.runKernel(Rm,r)}const Cu=ge({pow_:PU});function Mt(n,e){if((qr(n)&&e!=="string"||Array.isArray(n))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&qr(n)&&!(n instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Bh(n,[],[],e)}function BU(n){const t={x:te(n,"x","sqrt","float32")};return me.runKernel(Wm,t)}const Xr=ge({sqrt_:BU});function UU(n){const e=te(n,"x","square"),t={};return me.runKernel("Square",{x:e},t)}const is=ge({square_:UU});function VU(n,e=null,t=!1){let s=te(n,"x","sum");s.dtype==="bool"&&(s=lt(s,"int32"));const r={x:s},a={axis:e,keepDims:t};return me.runKernel(L0,r,a)}const St=ge({sum_:VU});function jU(n,e="euclidean",t=null,s=!1){n=te(n,"x","norm");const r=A$(n,e,t);let a=r.shape;if(s){const i=vn(t,n.shape);a=cr(r.shape,i)}return we(r,a)}function A$(n,e,t=null){if(n.rank===0)return br(n);if(n.rank!==1&&t===null)return A$(we(n,[-1]),e,t);if(n.rank===1||typeof t=="number"||Array.isArray(t)&&t.length===1){if(e===1)return St(br(n),t);if(e===1/0)return fo(br(n),t);if(e===-1/0)return Vp(br(n),t);if(e==="euclidean"||e===2)return Xr(St(Cu(br(n),Mt(2,"int32")),t));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(t)&&t.length===2){if(e===1)return fo(St(br(n),t[0]),t[1]-1);if(e===1/0)return fo(St(br(n),t[1]),t[0]);if(e===-1/0)return Vp(St(br(n),t[1]),t[0]);if(e==="fro"||e==="euclidean")return Xr(St(is(n),t));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${t}`)}const eg=ge({norm_:jU});function WU(n,e=null,t=!1){return eg(n,"euclidean",e,t)}const Nk=ge({euclideanNorm_:WU});function GU(n){const t={x:te(n,"x","exp")};return me.runKernel(ym,t)}const li=ge({exp_:GU});function qU(n,e=0){const t=te(n,"x","expandDims","string_or_numeric");Z(e<=t.rank,()=>"Axis must be <= rank of the tensor");const s={input:t},r={dim:e};return me.runKernel(r0,s,r)}const Ca=ge({expandDims_:qU});function HU(n){const t={x:te(n,"x","expm1")};return me.runKernel(bm,t)}const kk=ge({expm1_:HU});function KU(n,e){const t=te(n,"x","tile","string_or_numeric");Z(t.rank===e.length,()=>`Error in transpose: rank of input ${t.rank} must match length of reps ${e}.`);const s={x:t},r={reps:e};return me.runKernel(Xm,s,r)}const lo=ge({tile_:KU});function XU(n,e,t,s="float32"){e==null&&(e=n);const r=mn([n,e],s),a=n<=e?n:e;for(let o=0;o<a;++o)r.set(1,o,o);const i=we(r.toTensor(),[n,e]);if(t==null)return i;if(t.length===1)return lo(Ca(i,0),[t[0],1,1]);if(t.length===2)return lo(Ca(Ca(i,0),0),[t[0],t[1],1,1]);if(t.length===3)return lo(Ca(Ca(Ca(i,0),0),0),[t[0],t[1],t[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${t.length}D.`)}const cv=ge({eye_:XU});function YU(n){const t={x:te(n,"x","floor","float32")};return me.runKernel(xm,t)}const tg=ge({floor_:YU});function ZU(n,e,t=0,s=0){const r=te(n,"x","gather"),a=te(e,"indices","gather","int32"),i={x:r,indices:a},o={axis:t,batchDims:s};return me.runKernel(i0,i,o)}const ng=ge({gather_:ZU});function JU(n,e){let t=te(n,"a","greater","string_or_numeric"),s=te(e,"b","greater","string_or_numeric");[t,s]=Vs(t,s),on(t.shape,s.shape);const r={a:t,b:s};return me.runKernel(o0,r)}const hi=ge({greater_:JU});function QU(n,e){let t=te(n,"a","greaterEqual","string_or_numeric"),s=te(e,"b","greaterEqual","string_or_numeric");[t,s]=Vs(t,s),on(t.shape,s.shape);const r={a:t,b:s};return me.runKernel(wm,r)}const Ac=ge({greaterEqual_:QU});function eV(n){const t={input:te(n,"input","imag")};return me.runKernel(wx,t)}const X0=ge({imag_:eV});function tV(n){const t={x:te(n,"x","isFinite")};return me.runKernel(Nm,t)}const Ck=ge({isFinite_:tV});function nV(n){const t={x:te(n,"x","isInf")};return me.runKernel(km,t)}const Tk=ge({isInf_:nV});function sV(n){const t={x:te(n,"x","isNaN")};return me.runKernel(Cm,t)}const Ak=ge({isNaN_:sV});function rV(n,e=.2){const s={x:te(n,"x","leakyRelu")},r={alpha:e};return me.runKernel(l0,s,r)}const Y0=ge({leakyRelu_:rV});function aV(n,e){let t=te(n,"a","less","string_or_numeric"),s=te(e,"b","less","string_or_numeric");[t,s]=Vs(t,s),on(t.shape,s.shape);const r={a:t,b:s};return me.runKernel(u0,r)}const jp=ge({less_:aV});function iV(n,e){let t=te(n,"a","lessEqual","string_or_numeric"),s=te(e,"b","lessEqual","string_or_numeric");[t,s]=Vs(t,s),on(t.shape,s.shape);const r={a:t,b:s};return me.runKernel(c0,r)}const jh=ge({lessEqual_:iV});function I$(n,e,t){if(t<=0)throw new Error("The number of values should be positive.");const s={start:n,stop:e,num:t};return me.runKernel(Sx,{},s)}function oV(n,e=5,t=1,s=1,r=.5){const a=te(n,"x","localResponseNormalization");Z(a.rank===4||a.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${a.rank}.`),Z(Xf(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let i=a,o=!1;a.rank===3&&(o=!0,i=we(a,[1,a.shape[0],a.shape[1],a.shape[2]]));const l={x:i},c={depthRadius:e,bias:t,alpha:s,beta:r},f=me.runKernel(p0,l,c);return o?we(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const Ik=ge({localResponseNormalization_:oV});function lV(n){const t={x:te(n,"x","log","float32")};return me.runKernel(Tm,t)}const Li=ge({log_:lV});function uV(n){const t={x:te(n,"x","log1p")};return me.runKernel(Am,t)}const Z0=ge({log1p_:uV});function cV(n){return Z(Th(n),()=>"The f passed in grad(f) must be a function"),(e,t)=>{const s=te(e,"x","tf.grad","string_or_numeric"),r=t!=null?te(t,"dy","tf.grad"):null;return me.tidy(()=>{const{value:a,grads:i}=me.gradients(()=>n(s),[s],r);return r!=null&&ha(a.shape,r.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),hv(i),i[0]})}}function hV(n){return Z(Th(n),()=>"The f passed in grads(f) must be a function"),(e,t)=>{Z(Array.isArray(e),()=>"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s");const s=S1(e,"args","tf.grads","string_or_numeric"),r=t!=null?te(t,"dy","tf.grads"):null;return me.tidy(()=>{const{value:a,grads:i}=me.gradients(()=>n(...s),s,r);return r!=null&&ha(a.shape,r.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),hv(i),i})}}function fV(n){return Z(Th(n),()=>"The f passed in valueAndGrad(f) must be a function"),(e,t)=>{Z(e instanceof Kn,()=>"The x passed in valueAndGrad(f)(x) must be a tensor"),Z(t==null||t instanceof Kn,()=>"The dy passed in valueAndGrad(f)(x, dy) must be a tensor");const{grads:s,value:r}=me.gradients(()=>n(e),[e],t);return hv(s),{grad:s[0],value:r}}}function dV(n){return Z(Th(n),()=>"The f passed in valueAndGrads(f) must be a function"),(e,t)=>{Z(Array.isArray(e)&&e.every(r=>r instanceof Kn),()=>"The args passed in valueAndGrads(f)(args) must be array of tensors"),Z(t==null||t instanceof Kn,()=>"The dy passed in valueAndGrads(f)(args, dy) must be a tensor");const s=me.gradients(()=>n(...e),e,t);return t!=null&&ha(s.value.shape,t.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),hv(s.grads),s}}function E$(n,e){Z(Th(n),()=>"The f passed in variableGrads(f) must be a function"),Z(e==null||Array.isArray(e)&&e.every(c=>c instanceof w1),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const t=e!=null;if(!t){e=[];for(const c in me.registeredVariables)e.push(me.registeredVariables[c])}const s=t?e.filter(c=>!c.trainable):null,r=e.length;e=e.filter(c=>c.trainable),Z(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${r} variables is trainable.`);const a=!0,{value:i,grads:o}=me.gradients(n,e,null,a);Z(o.some(c=>c!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),Z(i.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${i.rank} tensor`);const l={};return e.forEach((c,f)=>{o[f]!=null&&(l[c.name]=o[f])}),s?.forEach(c=>l[c.name]=null),{value:i,grads:l}}function Tu(n){return me.customGrad(n)}function hv(n){if(n.filter(t=>t==null).length>0)throw new Error(`Cannot compute gradient of y=f(x) with respect to x. Make sure that
    the f you passed encloses all operations that lead from x to y.`)}function pV(n){const t={x:te(n,"x","neg")};return me.runKernel(w0,t)}const ws=ge({neg_:pV});function mV(n){const t={x:te(n,"x","softplus")};return me.runKernel(jm,t)}const bd=ge({softplus_:mV});function gV(n){const e=te(n,"x","logSigmoid");return Tu(s=>({value:ws(bd(ws(s))),gradFunc:i=>xe(i,_l(ws(s)))}))(e)}const Ek=ge({logSigmoid_:gV});function yV(n,e){let t=te(n,"a","sub"),s=te(e,"b","sub");[t,s]=Vs(t,s);const r={a:t,b:s};return me.runKernel(qm,r)}const mt=ge({sub_:yV});function bV(n,e=-1){const t=te(n,"logits","logSoftmax");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${t.rank} and axis was ${e}`);return Tu((r,a)=>{const o=fo(r,e,!0),l=mt(r,o),c=mt(lt(l,"float32"),Li(St(li(l),e,!0)));return a([c]),{value:c,gradFunc:(d,m)=>{const[g]=m,b=!0,x=li(g);return mt(d,xe(St(d,e,b),x))}}})(t)}const fv=ge({logSoftmax_:bV});function xV(n,e=null,t=!1){const s=te(n,"x","logSumExp"),r=vn(e,s.shape),a=fo(s,r,!0),i=mt(s,a),o=li(i),l=St(o,r),c=Li(l),f=et(we(a,c.shape),c);if(t){const d=cr(f.shape,r);return we(f,d)}return f}const J0=ge({logSumExp_:xV});function vV(n,e){const t=te(n,"a","logicalAnd","bool"),s=te(e,"b","logicalAnd","bool");on(t.shape,s.shape);const r={a:t,b:s};return me.runKernel(h0,r)}const Dl=ge({logicalAnd_:vV});function wV(n){const t={x:te(n,"x","logicalNot","bool")};return me.runKernel(f0,t)}const Q0=ge({logicalNot_:wV});function SV(n,e){const t=te(n,"a","logicalOr","bool"),s=te(e,"b","logicalOr","bool");on(t.shape,s.shape);const r={a:t,b:s};return me.runKernel(d0,r)}const dv=ge({logicalOr_:SV});function NV(n,e){const t=te(n,"a","logicalXor","bool"),s=te(e,"b","logicalXor","bool");return on(t.shape,s.shape),Dl(dv(n,e),Q0(Dl(n,e)))}const _k=ge({logicalXor_:NV});const v2=2147483648;function kV(n,e,t="left"){const s=te(n,"sortedSequence","searchSorted"),r=te(e,"values","searchSorted"),a=s.shape[s.shape.length-1],i=r.shape[r.shape.length-1],o=we(s,[-1,a]),l=we(r,[-1,i]);if(o.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(o.shape[0]!==l.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(Be(l.shape)>=v2)throw new Error(`values tensor size must less than ${v2}`);if(o.shape[1]>=v2)throw new Error(`trailing dim_size must less than ${v2} for int32 output type, was ${o.shape[1]}`);const c={sortedSequence:o,values:l},f={side:t};return me.runKernel(Bx,c,f)}const pv=ge({searchSorted_:kV});function _$(n,e){return pv(n,e,"left")}function CV(n,e,t,s,r){const a=te(n,"x","maxPool"),i=1;let o=a,l=!1;a.rank===3&&(l=!0,o=we(a,[1,a.shape[0],a.shape[1],a.shape[2]])),Z(o.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${o.rank}.`),Z(fa(t,i),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${t} and dilations '${i}'`),ja("maxPool",s,r);const c={x:o},f={filterSize:e,strides:t,pad:s,dimRoundingMode:r},d=me.runKernel(g0,c,f);return l?we(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const ey=ge({maxPool_:CV});function TV(n,e=[1,1,1],t,s,r,a="NDHWC"){const i=te(n,"x","maxPool3d");let o=i,l=!1;i.rank===4&&(l=!0,o=we(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),Z(o.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${o.rank}.`),Z(a==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${a}`),ja("maxPool3d",s,r);const c={x:o},f={filterSize:e,strides:t,pad:s,dimRoundingMode:r,dataFormat:a},d=me.runKernel(y0,c,f);return l?we(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const $k=ge({maxPool3d_:TV});function AV(n,e,t,s,r=!1){const i={x:te(n,"x","maxPoolWithArgmax")},o={filterSize:e,strides:t,pad:s,includeBatchInIndex:r},l=me.runKernel(Tx,i,o);return{result:l[0],indexes:l[1]}}const $$=ge({maxPoolWithArgmax_:AV});function IV(n,e){let t=te(n,"a","maximum"),s=te(e,"b","maximum");[t,s]=Vs(t,s),t.dtype==="bool"&&(t=lt(t,"int32"),s=lt(s,"int32")),on(t.shape,s.shape);const r={a:t,b:s};return me.runKernel(Im,r)}const _u=ge({maximum_:IV});function EV(n,e=null,t=!1){const r={x:te(n,"x","mean")},a={axis:e,keepDims:t};return me.runKernel(b0,r,a)}const Bs=ge({mean_:EV});function lr(n,e="float32"){if(Pi(n),e==="complex64"){const s=lr(n,"float32"),r=lr(n,"float32");return xc(s,r)}const t=ca(Be(n),e);return me.makeTensor(t,n,e)}function si(n,e="float32"){if(Pi(n),e==="complex64"){const s=si(n,"float32"),r=lr(n,"float32");return xc(s,r)}const t=Xb(Be(n),e);return me.makeTensor(t,n,e)}function R$(n,e,{indexing:t="xy"}={}){if(t!=="xy"&&t!=="ij")throw new TypeError(`${t} is not a valid third argument to meshgrid`);if(n===void 0)return[];let s=te(n,"x","meshgrid",n instanceof Kn?n.dtype:"float32");if(e===void 0)return[s];let r=te(e,"y","meshgrid",e instanceof Kn?e.dtype:"float32");const a=Be(s.shape),i=Be(r.shape);return t==="xy"?(s=we(s,[1,-1]),r=we(r,[-1,1]),[bn(si([i,1],s.dtype),s),bn(r,si([1,a],r.dtype))]):(s=we(s,[-1,1]),r=we(r,[1,-1]),[bn(s,si([1,i],s.dtype)),bn(si([a,1],r.dtype),r)])}function _V(n,e){let t=te(n,"a","minimum"),s=te(e,"b","minimum");[t,s]=Vs(t,s),t.dtype==="bool"&&(t=lt(t,"int32"),s=lt(s,"int32")),on(t.shape,s.shape);const r={a:t,b:s};return me.runKernel(Em,r)}const $h=ge({minimum_:_V});function $V(n,e,t){Z(t==="reflect"||t==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${t}.`);const s=te(n,"x","mirrorPad");if(s.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");Z(e.length===s.rank,()=>`Padding doesn't match input. Must be ${s.rank}. Got ${e.length}.`);const r=t==="reflect"?1:0;for(let o=0;o<s.rank;o++)Z(e[o].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Z(e[o][0]>=0&&e[o][0]<=s.shape[o]-r&&e[o][1]>=0&&e[o][1]<=s.shape[o]-r,()=>`Padding in dimension ${o} cannot be greater than or equal to ${s.shape[o]-r} or less than 0 for input of shape ${s.shape}`);const a={paddings:e,mode:t},i={x:s};return me.runKernel(v0,i,a)}const Rk=ge({mirrorPad_:$V});function RV(n,e){let t=te(n,"a","mod"),s=te(e,"b","mod");[t,s]=Vs(t,s);const r={a:t,b:s};return me.runKernel(_m,r)}const Dk=ge({mod_:RV});function DV(n,e=null,t=!1){n=te(n,"x","moments");const s=vn(e,n.shape),r=Bs(n,s,t);let a=r.shape;t||(a=cr(r.shape,s));const i=is(mt(lt(n,"float32"),we(r,a))),o=Bs(i,s,t);return{mean:r,variance:o}}const ty=ge({moments_:DV});function OV(n,e,t,s){const r=te(e,"data","multiRNNCell"),a=S1(t,"c","multiRNNCell"),i=S1(s,"h","multiRNNCell");let o=r;const l=[];for(let d=0;d<n.length;d++){const m=n[d](o,a[d],i[d]);l.push(m[0]),l.push(m[1]),o=m[1]}const c=[],f=[];for(let d=0;d<l.length;d+=2)c.push(l[d]),f.push(l[d+1]);return[c,f]}const D$=ge({multiRNNCell_:OV});function LV(n,e,t,s=!1){const r=te(n,"logits","multinomial"),a=r.size,i=r.rank;if(a<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${a}.`);if(i>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${i}`);t=t||Math.random();const l={logits:i===1?we(r,[1,-1]):r},c={numSamples:e,seed:t,normalized:s},f=me.runKernel(Ax,l,c);return i===1?we(f,[f.size]):f}const O$=ge({multinomial_:LV});function FV(n,e){let t=te(n,"a","notEqual","string_or_numeric"),s=te(e,"b","notEqual","string_or_numeric");[t,s]=Vs(t,s),on(t.shape,s.shape);const r={a:t,b:s};return me.runKernel(S0,r)}const nd=ge({notEqual_:FV});function MV(n,e,t=1,s=0,r="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const i={indices:te(n,"indices","oneHot","int32")},o={dtype:r,depth:e,onValue:t,offValue:s};return me.runKernel(k0,i,o)}const Wp=ge({oneHot_:MV});function zV(n){const t={x:te(n,"x","onesLike")};return me.runKernel(N0,t)}const Fi=ge({onesLike_:zV});function PV(n,e){const t=te(n,"v1","outerProduct"),s=te(e,"v2","outerProduct");Z(t.rank===1&&s.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${t.rank} and ${s.rank}.`);const r=we(t,[-1,1]),a=we(s,[1,-1]);return bn(r,a)}const L$=ge({outerProduct_:PV});function BV(n,e,t=0){const s=te(n,"x","pad");if(s.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const r={paddings:e,constantValue:t},a={x:s};return me.runKernel(T0,a,r)}const Ic=ge({pad_:BV});function UV(n,e,t=0){return Z(e.length===2,()=>"Invalid number of paddings. Must be length of 2."),Ic(n,[e],t)}const F$=ge({pad1d_:UV});function VV(n,e,t=0){return Z(e.length===2&&e[0].length===2&&e[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Ic(n,e,t)}const M$=ge({pad2d_:VV});function jV(n,e,t=0){return Z(e.length===3&&e[0].length===2&&e[1].length===2&&e[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Ic(n,e,t)}const z$=ge({pad3d_:jV});function WV(n,e,t=0){return Z(e.length===4&&e[0].length===2&&e[1].length===2&&e[2].length===2&&e[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Ic(n,e,t)}const P$=ge({pad4d_:WV});function GV(n,e,t){const s=te(n,"x","spaceToBatchND");Z(s.rank>=1+e.length,()=>`input rank ${s.rank} should be > than [blockShape] ${e.length}`),Z(t.length===e.length,()=>`paddings.shape[0] ${t.length} must be equal to [blockShape] ${e.length}`),Z(s.shape.reduce((i,o,l)=>l>0&&l<=e.length?i&&(o+t[l-1][0]+t[l-1][1])%e[l-1]===0:i,!0),()=>`input spatial dimensions ${s.shape.slice(1)} with paddings ${t.toString()} must be divisible by blockShapes ${e.toString()}`);const r={x:s},a={blockShape:e,paddings:t};return me.runKernel(F0,r,a)}const ny=ge({spaceToBatchND_:GV});function qV(n,e,t,s,r,a,i){r==null&&(r=[1,1]),a==null&&(a=1),s===0&&(s="valid");const o=te(n,"x","maxPool");let l=o,c=!1;o.rank===3&&(c=!0,l=we(o,[1,o.shape[0],o.shape[1],o.shape[2]])),Z(fa(a,r),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${a} and dilations '${r}'`);const f=qo(l.shape,e,a,r,s),d=[f.dilationHeight,f.dilationWidth];let m;s==="same"?m=KV([f.filterHeight,f.filterWidth],d):m=[[0,0],[0,0]];const g=d[0]===1&&d[1]===1,[b,x]=HV([f.inHeight,f.inWidth],d,m),v=g?s:"valid",w=g?l:ny(l,d,b),I=(t==="avg"?()=>q0(w,e,a,v,i):()=>ey(w,e,a,v,i))(),A=g?I:H0(I,d,x);return c?we(A,[A.shape[1],A.shape[2],A.shape[3]]):A}function HV(n,e,t){const s=t.map(f=>f[0]),r=t.map(f=>f[1]),a=n.concat(s,r),i=e.map((f,d)=>(f-a[d]%f)%f),o=r.map((f,d)=>f+i[d]),l=e.map((f,d)=>[s[d],o[d]]),c=e.map((f,d)=>[0,i[d]]);return[l,c]}function KV(n,e){const s=n.map((i,o)=>i+(i-1)*(e[o]-1)).map(i=>i-1),r=s.map(i=>Math.floor(i/2)),a=s.map((i,o)=>i-r[o]);return s.map((i,o)=>[r[o],a[o]])}const Ok=ge({pool_:qV});function XV(n,e){const t=te(n,"x","prelu"),s=te(e,"alpha","prelu"),r={x:t,alpha:s};return me.runKernel(A0,r)}const sy=ge({prelu_:XV});function YV(n,e=null,t=!1){let s=te(n,"x","prod");s.dtype==="bool"&&(s=lt(s,"int32"));const r={x:s},a={axis:e,keepDims:t};return me.runKernel(I0,r,a)}const Lk=ge({prod_:YV});function ZV(n,e,t,s){const r=n.map((f,d)=>te(f,`tensors${d}`,"raggedGather","int32")),a=te(e,"paramsDenseValues","raggedGather"),i=te(t,"indices","raggedGather","int32"),o={paramsNestedSplits:r,paramsDenseValues:a,indices:i},l={outputRaggedRank:s},c=me.runKernel($x,o,l);return{outputNestedSplits:c.slice(0,c.length-1),outputDenseValues:c[c.length-1]}}const B$=ge({raggedGather_:ZV});function JV(n,e,t){const s=te(n,"starts","raggedRange"),r=te(e,"limits","raggedRange",s.dtype),a=te(t,"deltas","raggedRange",s.dtype),i={starts:s,limits:r,deltas:a},o=me.runKernel(Rx,i);return{rtNestedSplits:o[0],rtDenseValues:o[1]}}const U$=ge({raggedRange_:JV});function QV(n,e,t,s,r){const a=te(n,"shape","raggedTensorToTensor","int32"),i=te(e,"values","raggedTensorToTensor"),o=te(t,"defaultValue","raggedTensorToTensor",i.dtype),l=s.map((d,m)=>te(d,`tensors${m}`,"raggedTensorToTensor","int32")),c={shape:a,values:i,defaultValue:o,rowPartitionTensors:l},f={rowPartitionTypes:r};return me.runKernel(Dx,c,f)}const V$=ge({raggedTensorToTensor_:QV});function e9(n,e,t){Pi(n);const s=Be(n);let r=null;if(t==null||t==="float32")r=new Float32Array(s);else if(t==="int32")r=new Int32Array(s);else if(t==="bool")r=new Uint8Array(s);else throw new Error(`Unknown data type ${t}`);for(let a=0;a<s;a++)r[a]=e();return me.makeTensor(r,n,t)}const j$=ge({rand_:e9});var H2={exports:{}},t9=H2.exports,mI;function n9(){return mI||(mI=1,(function(n){(function(e,t,s){function r(l){var c=this,f=o();c.next=function(){var d=2091639*c.s0+c.c*23283064365386963e-26;return c.s0=c.s1,c.s1=c.s2,c.s2=d-(c.c=d|0)},c.c=1,c.s0=f(" "),c.s1=f(" "),c.s2=f(" "),c.s0-=f(l),c.s0<0&&(c.s0+=1),c.s1-=f(l),c.s1<0&&(c.s1+=1),c.s2-=f(l),c.s2<0&&(c.s2+=1),f=null}function a(l,c){return c.c=l.c,c.s0=l.s0,c.s1=l.s1,c.s2=l.s2,c}function i(l,c){var f=new r(l),d=c&&c.state,m=f.next;return m.int32=function(){return f.next()*4294967296|0},m.double=function(){return m()+(m()*2097152|0)*11102230246251565e-32},m.quick=m,d&&(typeof d=="object"&&a(d,f),m.state=function(){return a(f,{})}),m}function o(){var l=4022871197,c=function(f){f=String(f);for(var d=0;d<f.length;d++){l+=f.charCodeAt(d);var m=.02519603282416938*l;l=m>>>0,m-=l,m*=l,l=m>>>0,m-=l,l+=m*4294967296}return(l>>>0)*23283064365386963e-26};return c}t&&t.exports?t.exports=i:this.alea=i})(t9,n)})(H2)),H2.exports}var K2={exports:{}},s9=K2.exports,gI;function r9(){return gI||(gI=1,(function(n){(function(e,t,s){function r(o){var l=this,c="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var d=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^d^d>>>8},o===(o|0)?l.x=o:c+=o;for(var f=0;f<c.length+64;f++)l.x^=c.charCodeAt(f)|0,l.next()}function a(o,l){return l.x=o.x,l.y=o.y,l.z=o.z,l.w=o.w,l}function i(o,l){var c=new r(o),f=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var m=c.next()>>>11,g=(c.next()>>>0)/4294967296,b=(m+g)/(1<<21);while(b===0);return b},d.int32=c.next,d.quick=d,f&&(typeof f=="object"&&a(f,c),d.state=function(){return a(c,{})}),d}t&&t.exports?t.exports=i:this.xor128=i})(s9,n)})(K2)),K2.exports}var X2={exports:{}},a9=X2.exports,yI;function i9(){return yI||(yI=1,(function(n){(function(e,t,s){function r(o){var l=this,c="";l.next=function(){var d=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(d^d<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,o===(o|0)?l.x=o:c+=o;for(var f=0;f<c.length+64;f++)l.x^=c.charCodeAt(f)|0,f==c.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function a(o,l){return l.x=o.x,l.y=o.y,l.z=o.z,l.w=o.w,l.v=o.v,l.d=o.d,l}function i(o,l){var c=new r(o),f=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var m=c.next()>>>11,g=(c.next()>>>0)/4294967296,b=(m+g)/(1<<21);while(b===0);return b},d.int32=c.next,d.quick=d,f&&(typeof f=="object"&&a(f,c),d.state=function(){return a(c,{})}),d}t&&t.exports?t.exports=i:this.xorwow=i})(a9,n)})(X2)),X2.exports}var Y2={exports:{}},o9=Y2.exports,bI;function l9(){return bI||(bI=1,(function(n){(function(e,t,s){function r(o){var l=this;l.next=function(){var f=l.x,d=l.i,m,g;return m=f[d],m^=m>>>7,g=m^m<<24,m=f[d+1&7],g^=m^m>>>10,m=f[d+3&7],g^=m^m>>>3,m=f[d+4&7],g^=m^m<<7,m=f[d+7&7],m=m^m<<13,g^=m^m<<9,f[d]=g,l.i=d+1&7,g};function c(f,d){var m,g=[];if(d===(d|0))g[0]=d;else for(d=""+d,m=0;m<d.length;++m)g[m&7]=g[m&7]<<15^d.charCodeAt(m)+g[m+1&7]<<13;for(;g.length<8;)g.push(0);for(m=0;m<8&&g[m]===0;++m);for(m==8?g[7]=-1:g[m],f.x=g,f.i=0,m=256;m>0;--m)f.next()}c(l,o)}function a(o,l){return l.x=o.x.slice(),l.i=o.i,l}function i(o,l){o==null&&(o=+new Date);var c=new r(o),f=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var m=c.next()>>>11,g=(c.next()>>>0)/4294967296,b=(m+g)/(1<<21);while(b===0);return b},d.int32=c.next,d.quick=d,f&&(f.x&&a(f,c),d.state=function(){return a(c,{})}),d}t&&t.exports?t.exports=i:this.xorshift7=i})(o9,n)})(Y2)),Y2.exports}var Z2={exports:{}},u9=Z2.exports,xI;function c9(){return xI||(xI=1,(function(n){(function(e,t,s){function r(o){var l=this;l.next=function(){var f=l.w,d=l.X,m=l.i,g,b;return l.w=f=f+1640531527|0,b=d[m+34&127],g=d[m=m+1&127],b^=b<<13,g^=g<<17,b^=b>>>15,g^=g>>>12,b=d[m]=b^g,l.i=m,b+(f^f>>>16)|0};function c(f,d){var m,g,b,x,v,w=[],k=128;for(d===(d|0)?(g=d,d=null):(d=d+"\0",g=0,k=Math.max(k,d.length)),b=0,x=-32;x<k;++x)d&&(g^=d.charCodeAt((x+32)%d.length)),x===0&&(v=g),g^=g<<10,g^=g>>>15,g^=g<<4,g^=g>>>13,x>=0&&(v=v+1640531527|0,m=w[x&127]^=g+v,b=m==0?b+1:0);for(b>=128&&(w[(d&&d.length||0)&127]=-1),b=127,x=512;x>0;--x)g=w[b+34&127],m=w[b=b+1&127],g^=g<<13,m^=m<<17,g^=g>>>15,m^=m>>>12,w[b]=g^m;f.w=v,f.X=w,f.i=b}c(l,o)}function a(o,l){return l.i=o.i,l.w=o.w,l.X=o.X.slice(),l}function i(o,l){o==null&&(o=+new Date);var c=new r(o),f=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var m=c.next()>>>11,g=(c.next()>>>0)/4294967296,b=(m+g)/(1<<21);while(b===0);return b},d.int32=c.next,d.quick=d,f&&(f.X&&a(f,c),d.state=function(){return a(c,{})}),d}t&&t.exports?t.exports=i:this.xor4096=i})(u9,n)})(Z2)),Z2.exports}var J2={exports:{}},h9=J2.exports,vI;function f9(){return vI||(vI=1,(function(n){(function(e,t,s){function r(o){var l=this,c="";l.next=function(){var d=l.b,m=l.c,g=l.d,b=l.a;return d=d<<25^d>>>7^m,m=m-g|0,g=g<<24^g>>>8^b,b=b-d|0,l.b=d=d<<20^d>>>12^m,l.c=m=m-g|0,l.d=g<<16^m>>>16^b,l.a=b-d|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,o===Math.floor(o)?(l.a=o/4294967296|0,l.b=o|0):c+=o;for(var f=0;f<c.length+20;f++)l.b^=c.charCodeAt(f)|0,l.next()}function a(o,l){return l.a=o.a,l.b=o.b,l.c=o.c,l.d=o.d,l}function i(o,l){var c=new r(o),f=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var m=c.next()>>>11,g=(c.next()>>>0)/4294967296,b=(m+g)/(1<<21);while(b===0);return b},d.int32=c.next,d.quick=d,f&&(typeof f=="object"&&a(f,c),d.state=function(){return a(c,{})}),d}t&&t.exports?t.exports=i:this.tychei=i})(h9,n)})(J2)),J2.exports}var Q2={exports:{}};const d9={},p9=Object.freeze(Object.defineProperty({__proto__:null,default:d9},Symbol.toStringTag,{value:"Module"})),m9=OM(p9);var g9=Q2.exports,wI;function y9(){return wI||(wI=1,(function(n){(function(e,t,s){var r=256,a=6,i=52,o="random",l=s.pow(r,a),c=s.pow(2,i),f=c*2,d=r-1,m;function g(A,R,U){var V=[];R=R==!0?{entropy:!0}:R||{};var P=w(v(R.entropy?[A,I(t)]:A??k(),3),V),D=new b(V),B=function(){for(var E=D.g(a),M=l,K=0;E<c;)E=(E+K)*r,M*=r,K=D.g(1);for(;E>=f;)E/=2,M/=2,K>>>=1;return(E+K)/M};return B.int32=function(){return D.g(4)|0},B.quick=function(){return D.g(4)/4294967296},B.double=B,w(I(D.S),t),(R.pass||U||function(E,M,K,X){return X&&(X.S&&x(X,D),E.state=function(){return x(D,{})}),K?(s[o]=E,M):E})(B,P,"global"in R?R.global:this==s,R.state)}function b(A){var R,U=A.length,V=this,P=0,D=V.i=V.j=0,B=V.S=[];for(U||(A=[U++]);P<r;)B[P]=P++;for(P=0;P<r;P++)B[P]=B[D=d&D+A[P%U]+(R=B[P])],B[D]=R;(V.g=function(E){for(var M,K=0,X=V.i,ae=V.j,W=V.S;E--;)M=W[X=d&X+1],K=K*r+W[d&(W[X]=W[ae=d&ae+M])+(W[ae]=M)];return V.i=X,V.j=ae,K})(r)}function x(A,R){return R.i=A.i,R.j=A.j,R.S=A.S.slice(),R}function v(A,R){var U=[],V=typeof A,P;if(R&&V=="object")for(P in A)try{U.push(v(A[P],R-1))}catch{}return U.length?U:V=="string"?A:A+"\0"}function w(A,R){for(var U=A+"",V,P=0;P<U.length;)R[d&P]=d&(V^=R[d&P]*19)+U.charCodeAt(P++);return I(R)}function k(){try{var A;return m&&(A=m.randomBytes)?A=A(r):(A=new Uint8Array(r),(e.crypto||e.msCrypto).getRandomValues(A)),I(A)}catch{var R=e.navigator,U=R&&R.plugins;return[+new Date,e,U,e.screen,I(t)]}}function I(A){return String.fromCharCode.apply(0,A)}if(w(s.random(),t),n.exports){n.exports=g;try{m=m9}catch{}}else s["seed"+o]=g})(typeof self<"u"?self:g9,[],Math)})(Q2)),Q2.exports}var O5,SI;function b9(){if(SI)return O5;SI=1;var n=n9(),e=r9(),t=i9(),s=l9(),r=c9(),a=f9(),i=y9();return i.alea=n,i.xor128=e,i.xorwow=t,i.xorshift7=s,i.xor4096=r,i.tychei=a,O5=i,O5}var mv=b9();const x9=.001,W$=.1;function v9(n,e,t){return t==null&&(t=Fk()),MS(n,e,(s,r)=>Mk(s,r,t))}function Fk(){return me.backend.floatPrecision()===32?x9:W$}function MS(n,e,t){let s=!0;if((qr(n)||qr(e))&&(s=!1),qr(n)&&qr(e)&&(s=!0),s){const i=n.constructor.name,o=e.constructor.name;if(i!==o)throw new Error(`Arrays are of different type. Actual: ${i}. Expected: ${o}`)}if(Array.isArray(n)&&Array.isArray(e)){const i=ku(n),o=ku(e);if(!Nn(i,o))throw new Error(`Arrays have different shapes. Actual: [${i}]. Expected: [${o}]`)}const r=qr(n)?n:Nu(n),a=qr(e)?e:Nu(e);if(r.length!==a.length)throw new Error(`Arrays have different lengths actual: ${r.length} vs expected: ${a.length}.
Actual:   ${r}.
Expected: ${a}.`);for(let i=0;i<a.length;++i){const o=r[i],l=a[i];if(!t(o,l))throw new Error(`Arrays differ: actual[${i}] = ${o}, expected[${i}] = ${l}.
Actual:   ${r}.
Expected: ${a}.`)}typeof expect<"u"&&expect().nothing()}function w9(n,e){n().then(()=>e.fail(),()=>e()),typeof expect<"u"&&expect().nothing()}function S9(n,e){const t=typeof e=="string"||typeof e=="number"||typeof e=="boolean"?[e]:e;return mu(n)||mu(n[0])||mu(e)||mu(e[0])?MS(n,t,(s,r)=>s==r):MS(n,e,(s,r)=>Mk(s,r,0))}function N9(n,e,t){if(t==null&&(t=Fk()),!Mk(n,e,t))throw new Error(`Numbers differ: actual === ${n}, expected === ${e}`);typeof expect<"u"&&expect().nothing()}function Mk(n,e,t){return!isFinite(n)&&!isFinite(e)?!0:!(isNaN(n)||isNaN(e)||Math.abs(n-e)>t)}function k9(n,e,t){for(let s=0;s<n.length;s++)if(n[s]<e||n[s]>t)throw new Error(`Value out of range:${n[s]} low: ${e}, high: ${t}`)}function C9(n,e){const t=new Float32Array(n),s=new Float32Array(e);if(t.length!==s.length)throw new Error(`Expected ArrayBuffer to be of length ${s.length}, but it was ${t.length}`);for(let r=0;r<s.length;r++)if(t[r]!==s[r])throw new Error(`Expected ArrayBuffer value at ${r} to be ${s[r]} but got ${t[r]} instead`)}function G$(n){for(let e=0;e<n.length;e++){const t=n[e];Array.isArray(t)?G$(t):n[e]=bu(t)}return n}function T9(n){const e=document.createElement("video");return"playsInline"in e&&(e.playsInline=!0),e.muted=!0,e.loop=!0,e.style.position="fixed",e.style.left="0px",e.style.top="0px",e.preload="auto",e.appendChild(n),new Promise(t=>{e.addEventListener("loadeddata",s=>t(e)),e.load()})}async function A9(n){await n.play(),"requestVideoFrameCallback"in n&&await new Promise(e=>{n.requestVideoFrameCallback(e)})}const I9=Object.freeze(Object.defineProperty({__proto__:null,TEST_EPSILON_FLOAT16:W$,createVideoElement:T9,encodeStrings:G$,expectArrayBuffersEqual:C9,expectArraysClose:v9,expectArraysEqual:S9,expectNumbersClose:N9,expectPromiseToFail:w9,expectValuesInRange:k9,play:A9,testEpsilon:Fk},Symbol.toStringTag,{value:"Module"}));class zk{constructor(e,t,s,r,a){this.mean=e,this.stdDev=t,this.dtype=s,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const i=a||Math.random();this.random=mv.alea(i.toString())}nextValue(){if(!isNaN(this.nextVal)){const r=this.nextVal;return this.nextVal=NaN,r}let e,t,s=!1;for(;!s;){let r,a,i;do r=2*this.random()-1,a=2*this.random()-1,i=r*r+a*a;while(i>=1||i===0);const o=Math.sqrt(-2*Math.log(i)/i);e=this.mean+this.stdDev*r*o,t=this.mean+this.stdDev*a*o,(!this.truncated||this.isValidTruncated(e))&&(s=!0)}return(!this.truncated||this.isValidTruncated(t))&&(this.nextVal=this.convertValue(t)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class E9{constructor(e,t,s,r){this.alpha=e,this.beta=1/t,this.dtype=s;const a=r||Math.random();this.randu=mv.alea(a.toString()),this.randn=new zk(0,1,s,!1,this.randu()),e<1?this.d=e+2/3:this.d=e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,t,s,r,a,i;for(;;){do r=this.randn.nextValue(),i=1+this.c*r;while(i<=0);if(i*=i*i,e=r*r,t=1-.331*e*e,s=.5*e+this.d*(1-i+Math.log(i)),a=this.randu(),a<t||Math.log(a)<s)break}return i=1/this.beta*this.d*i,this.alpha<1&&(i*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(i)}convertValue(e){return this.dtype==="float32"?e:Math.round(e)}}class _9{constructor(e=0,t=1,s,r){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=t-e,this.dtype=s,r==null&&(r=Math.random()),typeof r=="number"&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${t} <= 1 and dtype is not float`);this.random=mv.alea(r)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}function $9(n,e,t=1,s="float32",r){if(Pi(n),t==null&&(t=1),s==null&&(s="float32"),s!=="float32"&&s!=="int32")throw new Error(`Unsupported data type ${s}`);const a=new E9(e,t,s,r),i=mn(n,s);for(let o=0;o<i.values.length;o++)i.values[o]=a.nextValue();return i.toTensor()}const q$=ge({randomGamma_:$9});function R9(n,e=0,t=1,s,r){if(Pi(n),s!=null&&s==="bool")throw new Error(`Unsupported data type ${s}`);const a=new zk(e,t,s,!1,r),i=mn(n,s);for(let o=0;o<i.values.length;o++)i.values[o]=a.nextValue();return i.toTensor()}const gv=ge({randomNormal_:R9});function D9(n,e,t){if(e!=null&&e==="bool")throw new Error(`Unsupported data type ${e}`);return gv(n,0,1,e,t)}const H$=ge({randomStandardNormal_:D9});function O9(n,e=0,t=1,s="float32",r){Pi(n);const a=mn(n,s),i=new _9(e,t,null,r);for(let o=0;o<a.values.length;o++)a.values[o]=i.nextValue();return a.toTensor()}const Wh=ge({randomUniform_:O9});function L9(n,e,t,s){return Wh(n,e,t,"int32",s)}const K$=ge({randomUniformInt_:L9});function sd(n,e,t=1,s="float32"){if(t===0)throw new Error("Cannot have a step of zero");const r={start:n,stop:e,step:t,dtype:s};return me.runKernel(Ox,{},r)}function F9(n){const t={input:te(n,"input","real")};return me.runKernel(Lx,t)}const Gp=ge({real_:F9});function M9(n){const t={x:te(n,"x","reciprocal")};return me.runKernel(Dm,t)}const Pk=ge({reciprocal_:M9});function z9(n){const t={x:te(n,"x","relu")};return me.runKernel(Om,t)}const Bl=ge({relu_:z9});function P9(n){const t={x:te(n,"x","relu6")};return me.runKernel(Lm,t)}const yv=ge({relu6_:P9});function B9(n,e){const s={x:te(n,"x","reverse")},r={dims:e};return me.runKernel(R0,s,r)}const po=ge({reverse_:B9});function U9(n){const e=te(n,"x","reverse");return Z(e.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${e.rank}.`),po(e,0)}const X$=ge({reverse1d_:U9});function V9(n,e){const t=te(n,"x","reverse");return Z(t.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${t.rank}.`),po(t,e)}const Y$=ge({reverse2d_:V9});function j9(n,e){const t=te(n,"x","reverse");return Z(t.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${t.rank}.`),po(t,e)}const Z$=ge({reverse3d_:j9});function W9(n,e){const t=te(n,"x","reverse");return Z(t.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${t.rank}.`),po(t,e)}const J$=ge({reverse4d_:W9});function G9(n){const t={x:te(n,"x","round")};return me.runKernel(Fm,t)}const bv=ge({round_:G9});function q9(n){const t={x:te(n,"x","rsqrt","float32")};return me.runKernel(Mm,t)}const xv=ge({rsqrt_:q9});function H9(n){const t={x:te(n,"x","selu")};return me.runKernel(zm,t)}const vv=ge({selu_:H9});function K9(n,e,t,s,r,a=[1,1],i="NHWC"){const o=te(n,"x","separableConv2d"),l=te(e,"depthwiseFilter","separableConv2d"),c=te(t,"pointwiseFilter","separableConv2d");let f=o,d=!1;if(o.rank===3&&(d=!0,f=we(o,[1,o.shape[0],o.shape[1],o.shape[2]])),i==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");Z(f.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${f.rank}.`),Z(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),Z(c.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),Z(c.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${c.shape[0]}.`),Z(c.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${c.shape[1]}.`);const m=l.shape[2],g=l.shape[3];Z(c.shape[2]===m*g,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${m*g}, but got ${c.shape[2]}.`);const b=Jm(f,l,s,r,i,a),v=vc(b,c,1,"valid",i);return d?we(v,[v.shape[1],v.shape[2],v.shape[3]]):v}const wv=ge({separableConv2d_:K9});async function X9(n,e){const t=te(n,"x","setdiff1d"),s=te(e,"y","setdiff1d");Z(t.dtype===s.dtype,()=>`x and y should have the same dtype, but got x (${t.dtype}) and y (${s.dtype}).`),Z(t.rank===1,()=>`x should be 1D tensor, but got x (${t.shape}).`),Z(s.rank===1,()=>`y should be 1D tensor, but got y (${s.shape}).`);const r=await t.data(),a=await s.data(),i=new Set(a);let o=0;for(let f=0;f<r.length;f++)i.has(r[f])||o++;const l=new Sr([o],t.dtype),c=new Sr([o],"int32");for(let f=0,d=0;f<r.length;f++)i.has(r[f])||(l.values[d]=r[f],c.values[d]=f,d++);return[l.toTensor(),c.toTensor()]}const Q$=X9;function Y9(n){const t={x:te(n,"x","sign")};return me.runKernel(Um,t)}const Bk=ge({sign_:Y9});function Z9(n){const t={x:te(n,"x","sin","float32")};return me.runKernel(Pm,t)}const Sv=ge({sin_:Z9});function J9(n){const t={x:te(n,"x","sinh")};return me.runKernel(Bm,t)}const Nv=ge({sinh_:J9});function Q9(n,e,t){const s=te(n,"x","slice1d");return Z(s.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${s.rank} tensor`),Tn(s,[e],[t])}const ry=ge({slice1d_:Q9});function ej(n,e,t){const s=te(n,"x","slice2d");return Z(s.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${s.rank} tensor`),Tn(s,e,t)}const kv=ge({slice2d_:ej});function tj(n,e,t){const s=te(n,"x","slice3d");return Z(s.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${s.rank} tensor`),Tn(s,e,t)}const ay=ge({slice3d_:tj});function nj(n,e,t){const s=te(n,"x","slice4d");return Z(s.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${s.rank} tensor`),Tn(s,e,t)}const qp=ge({slice4d_:nj});function sj(n,e=-1){const t=te(n,"logits","softmax","float32");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${t.rank} and dim was ${e}`);const s={logits:t},r={dim:e};return me.runKernel(z0,s,r)}const sg=ge({softmax_:sj});function rj(n){Z(n.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${n.dtype}.`);const e={input:n};return me.runKernel(gx,e)}const iy=ge({fft_:rj});function aj(n){Z(n.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${n.dtype}.`);const e={input:n};return me.runKernel(vx,e)}const Hp=ge({ifft_:aj});function ij(n){const e=n.shape[n.shape.length-1],t=n.size/e;let s;if(e<=2){const r=we(n,[t,e]);s=Hp(r)}else{const r=[t,2*(e-1)],a=we(Gp(n),[t,e]),i=we(X0(n),[t,e]),o=po(Tn(a,[0,1],[t,e-2]),1),l=xe(po(Tn(i,[0,1],[t,e-2]),1),Mt(-1)),c=ur([a,o],1),f=ur([i,l],1),d=we(xc(c,f),[r[0],r[1]]);s=Hp(d)}if(s=Gp(s),n.rank===3&&n.shape[0]!==0){const r=s,a=n.shape[0];s=we(s,[a,s.shape[0]/a,s.shape[1]]),r.dispose()}return s}const Cv=ge({irfft_:ij});function oj(n,e,t=0){const r={x:te(n,"x","split")},a={numOrSizeSplits:e,axis:t};return me.runKernel(M0,r,a)}const ri=ge({split_:oj});function lj(n,e){Z(n.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${n.dtype}`);let t=n.shape[n.shape.length-1];const s=n.size/t;let r;if(e!=null&&e<t){const b=n.shape.map(v=>0),x=n.shape.map(v=>v);x[n.shape.length-1]=e,r=Tn(n,b,x),t=e}else if(e!=null&&e>t){const b=n.shape.map(x=>x);b[n.shape.length-1]=e-t,r=ur([n,lr(b)],n.shape.length-1),t=e}else r=n;const a=$n(r),i=we(xc(r,a),[s,t]),o=iy(i),l=Math.floor(t/2)+1,c=Gp(o),f=X0(o),d=ri(c,[l,t-l],c.shape.length-1),m=ri(f,[l,t-l],f.shape.length-1),g=r.shape.slice();return g[r.shape.length-1]=l,we(xc(d[0],m[0]),g)}const oy=ge({rfft_:lj});function uj(n,e){let t=te(n,"a","squaredDifference"),s=te(e,"b","squaredDifference");[t,s]=Vs(t,s),on(t.shape,s.shape);const r={a:t,b:s},a={};return me.runKernel(Gm,r,a)}const Tv=ge({squaredDifference_:uj});function cj(n,e){const t=te(n,"x","squeeze","string_or_numeric");return we(t,Nc(t.shape,e).newShape)}const Ec=ge({squeeze_:cj});function hj(n,e=0){const t=S1(n,"tensors","stack","string_or_numeric");Z(t.length>=1,()=>"Pass at least one tensor to tf.stack"),t.length>0&&Z(e<=t[0].rank,()=>"Axis must be <= rank of the tensor");const s=t,r={axis:e};return me.runKernel(C0,s,r)}const ui=ge({stack_:hj});function fj(n,e=0){const s={x:te(n,"x","step")},r={alpha:e};return me.runKernel(Ym,s,r)}const xd=ge({step_:fj});function dj(n,e,t,s,r=0,a=0,i=0,o=0,l=0){const f={x:te(n,"x","stridedSlice","string_or_numeric")},d={begin:e,end:t,strides:s,beginMask:r,endMask:a,ellipsisMask:i,newAxisMask:o,shrinkAxisMask:l};return me.runKernel(Hx,f,d)}const Uk=ge({stridedSlice_:dj});function pj(n){const t={x:te(n,"x","tan","float32")};return me.runKernel(Hm,t)}const Vk=ge({tan_:pj});function Ta(n,e){dd(n);const t=ku(n,e);if(t.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Bh(n,null,t,e)}function Rp(n,e,t){if(dd(n),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const s=ku(n,t);if(s.length!==2&&s.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Bh(n,e,s,t)}function jk(n,e,t){if(dd(n),e!=null&&e.length!==3)throw new Error("tensor3d() requires shape to have three numbers");const s=ku(n,t);if(s.length!==3&&s.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Bh(n,e,s,t)}function eR(n,e,t){if(dd(n),e!=null&&e.length!==4)throw new Error("tensor4d() requires shape to have four numbers");const s=ku(n,t);if(s.length!==4&&s.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Bh(n,e,s,t)}function tR(n,e,t){if(dd(n),e!=null&&e.length!==5)throw new Error("tensor5d() requires shape to have five numbers");const s=ku(n,t);if(s.length!==5&&s.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Bh(n,e,s,t)}function nR(n,e,t){if(dd(n),e!=null&&e.length!==6)throw new Error("tensor6d() requires shape to have six numbers");const s=ku(n,t);if(s.length!==6&&s.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return e=e||s,Bh(n,e,s,t)}function Wk(n,e,t){const s=e.rank>1?e.shape[e.rank-1]:1,r=e.rank>1?e.rank-1:1,a=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${t.shape}, indices.shape: ${e.shape}, shape: ${n}, sliceDim: ${s}, and batchDim: ${r}.`;if(t.rank<r)throw new Error(a+` update.rank < ${r}. `);if(n.length<s+(t.rank-r))throw new Error(a+` Output shape length < ${s+(t.rank-r)}`);if(t.rank!==r+n.length-s)throw new Error(a+` update.rank != ${r+n.length-s}`);for(let i=0;i<r;++i)if(t.shape[i]!==e.shape[i])throw new Error(a+` updates.shape[${i}] (${t.shape[i]}) != indices.shape[${i}] (${e.shape[i]}).`);for(let i=0;i<t.rank-r;++i)if(t.shape[i+r]!==n[i+s])throw new Error(a+` updates.shape[${i+r}] (${t.shape[i+r]}) != shape[${i+r}] (${n[i+r]})`)}function Av(n,e,t){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(n.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${n.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(t.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${t}`);if(t.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(n.size===0)throw new Error(`Updates specified for empty output. updates shape: ${n.shape}`)}Wk(t,e,n)}function Gh(n,e,t){const s=e.shape.length,r=s>1?e.shape[s-1]:1,a=t.length;let i=1;for(let d=r;d<a;++d)i*=t[d];const o=r<1?1:r,l=Be(e.shape)/o,c=[...Ot(t.slice(0,r)),1],f=Be(t);return{sliceRank:r,numUpdates:l,sliceSize:i,strides:c,outputSize:f}}const mj=Object.freeze(Object.defineProperty({__proto__:null,calculateShapes:Gh,validateInput:Av,validateUpdateShape:Wk},Symbol.toStringTag,{value:"Module"}));function gj(n,e,t){const s=te(n,"tensor","tensorScatterupdate"),r=te(e,"indices","tensorScatterupdate","int32"),a=te(t,"updates","tensorScatterupdate");if(Av(a,r,s.shape),s.dtype!==a.dtype)throw new Error(`tensor and updates must have the same dtype, instead they are ${s.dtype} and ${a.dtype}.`);const i={tensor:s,indices:r,updates:a},o={};return me.runKernel(Px,i,o)}const sR=ge({tensorScatterUpdate_:gj});function yj(n,e=1,t=!0){const s=te(n,"x","topk");if(s.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const r=s.shape[s.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>r)throw new Error(`'k' passed to topk() must be <= the last dimension (${r}) but got ${e}`);const a={x:s},i={k:e,sorted:t},[o,l]=me.runKernel(Zx,a,i);return{values:o,indices:l}}const Gk=ge({topk_:yj});function bj(n,e=0,t=1,s,r){if(Pi(n),s!=null&&s==="bool")throw new Error("Unsupported data type $ { dtype }");const a=new zk(e,t,s,!0,r),i=mn(n,s);for(let o=0;o<i.values.length;o++)i.values[o]=a.nextValue();return i.toTensor()}const Iv=ge({truncatedNormal_:bj});function xj(n,e=0){const t=te(n,"x","unique","string_or_numeric");Z(t.rank>0,()=>"The input tensor must be at least 1D");const s={x:t},r={axis:e},[a,i]=me.runKernel(Qx,s,r);return{values:a,indices:i}}const qk=ge({unique_:xj});function vj(n,e,t){const s=te(n,"x","unsortedSegmentSum"),r=te(e,"segmentIds","unsortedSegmentSum","int32");Z(Xf(t),()=>"numSegments must be of dtype int");const a={x:s,segmentIds:r},i={numSegments:t};return me.runKernel(U0,a,i)}const Ev=ge({unsortedSegmentSum_:vj});function wj(n,e=0){const t=te(n,"x","unstack","string_or_numeric");Z(e>=-t.shape.length&&e<t.shape.length,()=>`Axis = ${e} is not in [-${t.shape.length}, ${t.shape.length})`);const s={value:t},r={axis:e};return me.runKernel(B0,s,r)}const mo=ge({unstack_:wj});function rR(n,e){return pv(n,e,"right")}function Hk(n,e=!0,t,s){return me.makeVariable(n,e,t,s)}function _v(n,e){const t=[];for(let a=0;a<e.length;a++)e[a]&&t.push(a);const s=mn(n,"int32"),r=mn([t.length,n.length],"int32");for(let a=0;a<t.length;a++){const i=s.indexToLoc(t[a]),o=a*n.length;r.values.set(i,o)}return r.toTensor()}async function Sj(n){const e=te(n,"condition","whereAsync","bool"),t=await e.data(),s=_v(e.shape,t);return n!==e&&e.dispose(),s}const Kk=Sj;async function Nj(n,e,t){const s=te(n,"tensor","boolMask"),r=te(e,"mask","boolMask","bool"),a=t??0,i=r.rank,o=s.shape;Z(i>0,()=>"mask cannot be scalar"),ha(o.slice(a,a+i),r.shape,"mask's shape must match the first K dimensions of tensor's shape,");let l=1;for(let x=a;x<a+i;x++)l*=o[x];const c=o.slice(0,a).concat([l],o.slice(a+i)),f=we(s,c),d=we(r,[-1]),m=await Kk(d),g=Ec(m,[1]),b=ng(f,g,a);return n!==s&&s.dispose(),e!==r&&r.dispose(),g.dispose(),f.dispose(),d.dispose(),m.dispose(),b}const aR=Nj;function kj(n,e,t){const s=te(n,"x","transpose");if(e==null&&(e=s.shape.map((i,o)=>o).reverse()),Z(s.rank===e.length,()=>`Error in transpose: rank of input ${s.rank} must match length of perm ${e}.`),e.forEach(i=>{Z(i>=0&&i<s.rank,()=>`All entries in 'perm' must be between 0 and ${s.rank-1} but got ${e}`)}),s.rank<=1)return s.clone();const r={x:s},a={perm:e};return s.dtype==="complex64"?_e(()=>{let i=Gp(s),o=X0(s);return i=me.runKernel(Wf,{x:i},a),o=me.runKernel(Wf,{x:o},a),t&&(o=ws(o)),xc(i,o)}):me.runKernel(Wf,r,a)}const An=ge({transpose_:kj});function Cj(n,e,t,s,r=!0){const a=te(n,"v","movingAverage"),i=te(e,"x","movingAverage"),o=te(t,"decay","movingAverage");e$(a,i),Z(Nn(a.shape,i.shape),()=>"Shape mismatch in v and x");const l=Mt(1),c=mt(l,o);let f=xe(mt(i,a),c);if(r){Z(s!=null,()=>"When using zeroDebias: true, step is required.");const d=te(s,"step","movingAverage");f=$t(f,mt(l,Cu(o,d)))}return et(a,f)}const iR=ge({movingAverage_:Cj});function Tj(n,e,t){Pi(t);const s=te(n,"indices","scatterND","int32"),r=te(e,"updates","scatterND");Av(r,s,t);const a={indices:s,updates:r},i={shape:t};return me.runKernel(zx,a,i)}const oR=ge({scatterND_:Tj});function Aj(n,e,t,s){if(n.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${n.dtype}.`);if(n.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${n.shape}.`);const r=n.rank>0?n.shape[0]:1,a=n.rank>1?n.shape[1]:1;if(t.length!==a)throw new Error(`outputShape has incorrect number of elements:, ${t.length}, should be: ${a}.`);const i=e.size;if(!(e.rank===0||e.rank===1&&i===r))throw new Error(`sparseValues has incorrect shape ${e.shape}, should be [] or [${r}]`);if(e.dtype!==s.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}function Ij(n,e,t,s=0){Pi(t);const r=te(n,"sparseIndices","sparseToDense","int32"),a=te(e,"sparseValues","sparseToDense","string_or_numeric"),i=te(s,"defaultValue","sparseToDense",a.dtype);Aj(r,a,t,i);const o={sparseIndices:r,sparseValues:a,defaultValue:i},l={outputShape:t};return me.runKernel(Gx,o,l)}const lR=ge({sparseToDense_:Ij});function Ej(n,e){const t=te(e,"indices","gatherND","int32"),r={params:te(n,"x","gatherND","string_or_numeric"),indices:t};return me.runKernel(xx,r)}const uR=ge({gatherND_:Ej});function _j(n,e){if(e==null)return n.shape.slice();if(Nn(n.shape,e))return e;if(n.shape.length===e.length){const t=[];for(let s=0;s<n.shape.length;s++)e[s]==null&&n.shape[s]!=null?t.push(n.shape[s]):t.push(e[s]);return t}return e}function $j(n,e,t,s){const r=te(n,"x","dropout");if(Z(r.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${r.dtype} tensor instead.`),Z(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return n instanceof Kn?r.clone():r;const a=_j(r,t),i=1-e,o=$t(tg(et(Wh(a,0,1,"float32",s),i)),i);return xe(r,o)}const Xk=ge({dropout_:$j});function Yk(n){return Math.floor(Math.pow(2,Math.ceil(Math.log(n)/Math.log(2))))}function $v(n,e,t){const s=1-n%2,r=new Float32Array(n);for(let a=0;a<n;++a){const i=2*Math.PI*a/(n+s-1);r[a]=e-t*Math.cos(i)}return Ta(r,"float32")}async function Rj(n,e,t=1){const s=te(n,"predictions","inTopK"),r=te(e,"targets","inTopK");Z(s.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${s.rank}`),Z(s.rank-1===r.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${s.rank} and targets rank ${r.rank}`),ha(s.shape.slice(0,s.shape.length-1),r.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const a=s.shape[s.shape.length-1];Z(t>0&&t<=a,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${a}), but got ${t}`);const i=await s.data(),o=await r.data(),[l,c]=[i.length/a,a],f=Kr("bool",l);for(let d=0;d<l;d++){const m=d*c,g=i.subarray(m,m+c),b=[];for(let x=0;x<g.length;x++)b.push({value:g[x],index:x});b.sort((x,v)=>v.value-x.value),f[d]=0;for(let x=0;x<t;x++)if(b[x].index===o[d]){f[d]=1;break}}return n!==s&&s.dispose(),e!==r&&r.dispose(),jo(f,r.shape,"bool")}const cR=Rj;function Dj(n,e,t,s,r,a="NHWC",i){let o=n;n.rank===3&&(o=we(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let l=e;l.rank===3&&(l=we(e,[1,e.shape[0],e.shape[1],e.shape[2]])),Z(o.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${o.shape}.`),Z(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),Z(t.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${t}.`);const c=a==="NHWC"?o.shape[3]:o.shape[1],f=a==="NHWC"?l.shape[3]:l.shape[1];Z(c===t[2],()=>`Error in conv2dDerFilter: depth of input ${c}) must match input depth in filter (${t[2]}.`),Z(f===t[3],()=>`Error in conv2dDerFilter: depth of dy (${f}) must match output depth for filter (${t[3]}).`),ja("conv2dDerFilter",r,i);const d={x:o,dy:l},m={strides:s,pad:r,dataFormat:a,dimRoundingMode:i,filterShape:t};return me.runKernel(sx,d,m)}const Zk=ge({conv2DBackpropFilter_:Dj});function Rv(n,e,t){if(t==null||t==="linear")return n;if(t==="relu")return xe(n,xd(e));throw new Error(`Cannot compute gradient for fused activation ${t}.`)}function Dv(n,e){let t=e;const s=Nr(n.shape,e.shape);return s.length>0&&(t=St(t,s)),we(t,n.shape)}function Ov(n,e,t,s){if(e==="linear")return n;if(e==="relu")return Bl(n);if(e==="elu")return Qm(n);if(e==="relu6")return yv(n);if(e==="prelu")return sy(n,t);if(e==="leakyrelu")return Y0(n,s);if(e==="sigmoid")return _l(n);throw new Error(`Unknown fused activation ${e}.`)}const Lv=(n,e)=>!(n>0)||e==="linear";function Oj({x:n,filter:e,strides:t,pad:s,dataFormat:r="NHWC",dilations:a=[1,1],dimRoundingMode:i,bias:o,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:f}){if(l=l||"linear",Lv(me.state.gradientDepth,l)===!1){Z(r==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${r} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let U=vc(n,e,t,s,r,a,i);return o!=null&&(U=et(U,o)),Ov(U,l,c,f)}const d=te(n,"x","conv2d","float32"),m=te(e,"filter","conv2d","float32");let g=d,b=!1;d.rank===3&&(b=!0,g=we(d,[1,d.shape[0],d.shape[1],d.shape[2]])),Z(g.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${g.rank}.`),Z(m.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${m.rank}.`),ja("fused conv2d",s,i);const x=r==="NHWC"?g.shape[3]:g.shape[1];Z(m.shape[2]===x,()=>`Error in conv2d: depth of input (${x}) must match input depth for filter ${m.shape[2]}.`),Z(fa(t,a),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${t} and dilations '${a}'`);const v=Yr(g.shape,m.shape,t,a,s,i);let w;o!=null&&(w=te(o,"bias","fused conv2d"),[w]=Vs(w,d),r==="NHWC"?on(v.outShape,w.shape):(Z(w.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${w.shape.length}.`),Z(w.shape.length===0||w.shape[0]===v.outChannels||w.shape[0]===1,()=>`Error in fused conv2d: bias shape (${w.shape}) is not compatible with the number of output channels (${v.outChannels})`)));let k;if(c!=null){const U=c.shape;if(Z(U.length<=1||U.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${U.length}.`),U.length===1)Z(U[0]===1||U[0]===v.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${U}) is not compatible with the number of output channels (${v.outChannels}).`);else if(U.length===3)try{on(U,v.outShape)}catch{const P=`Error in fused conv2d: PReLU activation weights (${U}) is not compatible with the output shape of the conv2d (${v.outShape}).`;throw Error(P)}k=te(c,"prelu weights","fused conv2d")}const I=(U,V)=>{Z(r==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${r} but only NHWC is currently supported.`);const[P,D,B,E]=V,M=Rv(U,B,l);Z(Eh(a),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${a}'`);const K=mk(D.shape,M,P,t,s),X=Zk(D,M,P.shape,t,s),ae=[K,X];if(E!=null){const W=Dv(E,M);ae.push(W)}return ae},A={x:g,filter:m,bias:w,preluActivationWeights:k},R={strides:t,pad:s,dataFormat:r,dilations:a,dimRoundingMode:i,activation:l,leakyreluAlpha:f};return o==null?Tu((V,P,D)=>{let B=me.runKernel(y1,A,R);return D([P,V,B]),b&&(B=we(B,[B.shape[1],B.shape[2],B.shape[3]])),{value:B,gradFunc:I}})(g,m):Tu((V,P,D,B)=>{let E=me.runKernel(y1,A,R);return B([P,V,E,D]),b&&(E=we(E,[E.shape[1],E.shape[2],E.shape[3]])),{value:E,gradFunc:I}})(g,m,w)}const hR=ge({fusedConv2d_:Oj});function Lj(n,e,t,s,r,a=[1,1],i){let o=n;n.rank===3&&(o=we(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let l=e;l.rank===3&&(l=we(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={x:o,dy:l},f={strides:s,pad:r,dimRoundingMode:i,dilations:a,filterShape:t};return me.runKernel(cx,c,f)}const fR=ge({depthwiseConv2dNativeBackpropFilter_:Lj});function Fj(n,e,t,s,r,a=[1,1],i){let o=e,l=!1;e.rank===3&&(l=!0,o=we(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={dy:o,filter:t},f={strides:s,pad:r,dimRoundingMode:i,dilations:a,inputShape:n},d=me.runKernel(hx,c,f);return l?we(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const dR=ge({depthwiseConv2dNativeBackpropInput_:Fj});function Mj({x:n,filter:e,strides:t,pad:s,dataFormat:r="NHWC",dilations:a=[1,1],dimRoundingMode:i,bias:o,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:f}){if(Lv(me.state.gradientDepth,l)===!1){let R=Jm(n,e,t,s,r,a,i);return o!=null&&(R=et(R,o)),Ov(R,l,c,f)}const d=te(n,"x","depthwiseConv2d","float32"),m=te(e,"filter","depthwiseConv2d","float32");let g=d,b=!1;d.rank===3&&(b=!0,g=we(d,[1,d.shape[0],d.shape[1],d.shape[2]])),Z(g.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${g.rank}.`),Z(m.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${m.rank}.`),Z(g.shape[3]===m.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${g.shape[3]}) must match the inChannels dimension in filter ${m.shape[2]}.`),a==null&&(a=[1,1]),Z(fa(t,a),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${t} and dilations '${a}'`),ja("fused depthwiseConv2d",s,i);const x=Yr(g.shape,m.shape,t,a,s,i,!0);let v;o!=null&&(v=te(o,"bias","fused conv2d"),[v]=Vs(v,d),on(x.outShape,v.shape));let w;c!=null&&(w=te(c,"prelu weights","fused depthwiseConv2d"));const k=(R,U)=>{Z(Eh(a),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);const[V,P,D,B]=U,E=Rv(R,D,l),M=dR(P.shape,E,V,t,s,a,i),K=fR(P,E,V.shape,t,s,a,i);if(B!=null){const X=Dv(v,E);return[M,K,X]}return[M,K]},I={x:g,filter:m,bias:v,preluActivationWeights:w},A={strides:t,pad:s,dataFormat:r,dilations:a,dimRoundingMode:i,activation:l,leakyreluAlpha:f};return o==null?Tu((U,V,P)=>{let D=me.runKernel(b1,I,A);return P([V,U,D]),b&&(D=we(D,[D.shape[1],D.shape[2],D.shape[3]])),{value:D,gradFunc:k}})(g,m):Tu((U,V,P,D)=>{let B=me.runKernel(b1,I,A);return D([V,U,B,P]),b&&(B=we(B,[B.shape[1],B.shape[2],B.shape[3]])),{value:B,gradFunc:k}})(g,m,v)}const zj=ge({fusedDepthwiseConv2d_:Mj});function Pj({a:n,b:e,transposeA:t=!1,transposeB:s=!1,bias:r,activation:a="linear",preluActivationWeights:i,leakyreluAlpha:o=.2}){if(Lv(me.state.gradientDepth,a)===!1){let E=bn(n,e,t,s);return r!=null&&(E=et(E,r)),Ov(E,a,i,o)}let l=te(n,"a","fused matMul"),c=te(e,"b","fused matMul");[l,c]=Vs(l,c);const f=t?l.shape[l.rank-2]:l.shape[l.rank-1],d=s?c.shape[c.rank-1]:c.shape[c.rank-2],m=t?l.shape[l.rank-1]:l.shape[l.rank-2],g=s?c.shape[c.rank-2]:c.shape[c.rank-1],b=l.shape.slice(0,-2),x=c.shape.slice(0,-2),v=Be(b),w=Be(x);Z(f===d,()=>`Error in fused matMul: inner shapes (${f}) and (${d}) of Tensors with shapes ${l.shape} and ${c.shape} and transposeA=${t} and transposeB=${s} must match.`);const I=on(l.shape.slice(0,-2),c.shape.slice(0,-2)).concat([m,g]),A=t?we(l,[v,f,m]):we(l,[v,m,f]),R=s?we(c,[w,g,d]):we(c,[w,d,g]);let U;r!=null&&(U=te(r,"bias","fused matMul"),[U]=Vs(U,l),on(I,U.shape));let V;i!=null&&(V=te(i,"prelu weights","fused matMul"));const P=(E,M)=>{const[K,X,ae,W]=M,se=Rv(we(E,ae.shape),ae,a);let ee,ce;if(!t&&!s?(ee=bn(se,X,!1,!0),ce=bn(K,se,!0,!1)):!t&&s?(ee=bn(se,X,!1,!1),ce=bn(se,K,!0,!1)):t&&!s?(ee=bn(X,se,!1,!0),ce=bn(K,se,!1,!1)):(ee=bn(X,se,!0,!0),ce=bn(se,K,!0,!0)),r!=null){const ye=Dv(W,se);return[ee,ce,ye]}else return[ee,ce]},D={a:A,b:R,bias:U,preluActivationWeights:V},B={transposeA:t,transposeB:s,activation:a,leakyreluAlpha:o};return r==null?Tu((M,K,X)=>{const ae=me.runKernel(g1,D,B);return X([M,K,ae]),{value:we(ae,I),gradFunc:P}})(A,R):Tu((M,K,X,ae)=>{const W=me.runKernel(g1,D,B);return ae([M,K,W,X]),{value:we(W,I),gradFunc:P}})(A,R,U)}const zS=ge({fusedMatMul_:Pj});const pR=Object.freeze(Object.defineProperty({__proto__:null,conv2d:hR,depthwiseConv2d:zj,matMul:zS},Symbol.toStringTag,{value:"Module"}));function Bj(n){return $v(n,.54,.46)}const Uj=ge({hammingWindow_:Bj});function Vj(n){return $v(n,.5,.5)}const mR=ge({hannWindow_:Vj});function jj(n,e,t,s=!1,r=0){let a=0;const i=[];for(;a+e<=n.size;)i.push(Tn(n,a,e)),a+=t;if(s)for(;a<n.size;){const o=a+e-n.size,l=ur([Tn(n,a,e-o),yd([o],r)]);i.push(l),a+=t}return i.length===0?Rp([],[0,e]):we(ur(i),[i.length,e])}const gR=ge({frame_:jj});function Wj(n,e,t,s,r=mR){s==null&&(s=Yk(e));const a=gR(n,e,t),i=xe(a,r(e));return oy(i,s)}const Gj=ge({stft_:Wj});function qj(n,e,t,s,r="bilinear",a=0){const i=te(n,"image","cropAndResize"),o=te(e,"boxes","cropAndResize","float32"),l=te(t,"boxInd","cropAndResize","int32"),c=o.shape[0];Z(i.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${i.rank}.`),Z(o.rank===2&&o.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${c},4] but had shape ${o.shape}.`),Z(l.rank===1&&l.shape[0]===c,()=>`Error in cropAndResize: boxInd must be have size [${c}] but had shape ${o.shape}.`),Z(s.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${s.length}.`),Z(s[0]>=1&&s[1]>=1,()=>`cropSize must be atleast [1,1], but was ${s}`),Z(r==="bilinear"||r==="nearest",()=>`method must be bilinear or nearest, but was ${r}`);const f={image:i,boxes:o,boxInd:l},d={method:r,extrapolationValue:a,cropSize:s};return me.runKernel(ox,f,d)}const Hj=ge({cropAndResize_:qj});function Kj(n){const e=te(n,"image","flipLeftRight","float32");Z(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const t={image:e};return me.runKernel(bx,t,{})}const Xj=ge({flipLeftRight_:Kj});function Yj(n){const e=te(n,"image","grayscaleToRGB"),t=e.rank-1,s=e.shape[t];Z(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),Z(s===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${s}.`);const r=new Array(e.rank);return r.fill(1,0,t),r[t]=3,lo(e,r)}const Zj=ge({grayscaleToRGB_:Yj});function Jj(n){const e=te(n,"image","RGBToGrayscale"),t=e.rank-1,s=e.shape[t];Z(e.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${e.rank}.`),Z(s===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${s}.`);const r=e.dtype,a=lt(e,"float32"),i=Ta([.2989,.587,.114]);let o;switch(e.rank){case 2:o=Lf("ij,j->i",a,i);break;case 3:o=Lf("ijk,k->ij",a,i);break;case 4:o=Lf("ijkl,l->ijk",a,i);break;case 5:o=Lf("ijklm,m->ijkl",a,i);break;case 6:o=Lf("ijklmn,n->ijklm",a,i);break;default:throw new Error("Not a valid tensor rank.")}return o=Ca(o,-1),lt(o,r)}const Qj=ge({rgbToGrayscale_:Jj});function eW(n,e,t=0,s=.5){const r=te(n,"image","rotateWithOffset","float32");Z(r.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${r.rank}.`);const a={image:r},i={radians:e,fillValue:t,center:s};return me.runKernel(ev,a,i)}const tW=ge({rotateWithOffset_:eW});function rg(n,e,t,s,r,a){s==null&&(s=.5),r==null&&(r=Number.NEGATIVE_INFINITY),a==null&&(a=0);const i=n.shape[0];return t=Math.min(t,i),Z(0<=s&&s<=1,()=>`iouThreshold must be in [0, 1], but was '${s}'`),Z(n.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${n.rank}'`),Z(n.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${n.shape[1]}`),Z(e.rank===1,()=>"scores must be a 1D tensor"),Z(e.shape[0]===i,()=>`scores has incompatible shape with boxes. Expected ${i}, but was ${e.shape[0]}`),Z(0<=a&&a<=1,()=>`softNmsSigma must be in [0, 1], but was '${a}'`),{maxOutputSize:t,iouThreshold:s,scoreThreshold:r,softNmsSigma:a}}function nW(n,e,t,s=.5,r=Number.NEGATIVE_INFINITY){const a=te(n,"boxes","nonMaxSuppression","float32"),i=te(e,"scores","nonMaxSuppression","float32"),o=rg(a,i,t,s,r);t=o.maxOutputSize,s=o.iouThreshold,r=o.scoreThreshold;const l={maxOutputSize:t,iouThreshold:s,scoreThreshold:r};return me.runKernel(Ix,{boxes:a,scores:i},l)}const sW=ge({nonMaxSuppression_:nW});function rW(n,e,t){const s=aW(n,e,t),r=s<0?-(s+1):s;n.splice(r,0,e)}function aW(n,e,t){return oW(n,e,t||iW)}function iW(n,e){return n>e?1:n<e?-1:0}function oW(n,e,t){let s=0,r=n.length,a=0,i=!1;for(;s<r;){a=s+(r-s>>>1);const o=t(e,n[a]);o>0?s=a+1:(r=a,i=!o)}return i?s:-s-1}function Fv(n,e,t,s,r){return Jk(n,e,t,s,r,0)}function Mv(n,e,t,s,r,a){return Jk(n,e,t,s,r,0,!1,a,!0)}function zv(n,e,t,s,r,a){return Jk(n,e,t,s,r,a,!0)}function Jk(n,e,t,s,r,a,i=!1,o=!1,l=!1){const c=[];for(let v=0;v<e.length;v++)e[v]>r&&c.push({score:e[v],boxIndex:v,suppressBeginIndex:0});c.sort(NI);const f=a>0?-.5/a:0,d=[],m=[];for(;d.length<t&&c.length>0;){const v=c.pop(),{score:w,boxIndex:k,suppressBeginIndex:I}=v;if(w<r)break;let A=!1;for(let R=d.length-1;R>=I;--R){const U=lW(n,k,d[R]);if(U>=s){A=!0;break}if(v.score=v.score*uW(s,f,U),v.score<=r)break}v.suppressBeginIndex=d.length,A||(v.score===w?(d.push(k),m.push(v.score)):v.score>r&&rW(c,v,NI))}const g=d.length,b=t-g;o&&b>0&&(d.push(...new Array(b).fill(0)),m.push(...new Array(b).fill(0)));const x={selectedIndices:d};return i&&(x.selectedScores=m),l&&(x.validOutputs=g),x}function lW(n,e,t){const s=n.subarray(e*4,e*4+4),r=n.subarray(t*4,t*4+4),a=Math.min(s[0],s[2]),i=Math.min(s[1],s[3]),o=Math.max(s[0],s[2]),l=Math.max(s[1],s[3]),c=Math.min(r[0],r[2]),f=Math.min(r[1],r[3]),d=Math.max(r[0],r[2]),m=Math.max(r[1],r[3]),g=(o-a)*(l-i),b=(d-c)*(m-f);if(g<=0||b<=0)return 0;const x=Math.max(a,c),v=Math.max(i,f),w=Math.min(o,d),k=Math.min(l,m),I=Math.max(w-x,0)*Math.max(k-v,0);return I/(g+b-I)}function uW(n,e,t){const s=Math.exp(e*t*t);return t<=n?s:0}function NI(n,e){return n.score-e.score||n.score===e.score&&e.boxIndex-n.boxIndex}async function cW(n,e,t,s=.5,r=Number.NEGATIVE_INFINITY){const a=te(n,"boxes","nonMaxSuppressionAsync"),i=te(e,"scores","nonMaxSuppressionAsync"),o=rg(a,i,t,s,r);t=o.maxOutputSize,s=o.iouThreshold,r=o.scoreThreshold;const l=await Promise.all([a.data(),i.data()]),c=l[0],f=l[1],{selectedIndices:d}=Fv(c,f,t,s,r);return a!==n&&a.dispose(),i!==e&&i.dispose(),Ta(d,"int32")}const hW=cW;function fW(n,e,t,s=.5,r=Number.NEGATIVE_INFINITY,a=0){const i=te(n,"boxes","nonMaxSuppression"),o=te(e,"scores","nonMaxSuppression"),l=rg(i,o,t,s,r,a);t=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold,a=l.softNmsSigma;const c={boxes:i,scores:o},f={maxOutputSize:t,iouThreshold:s,scoreThreshold:r,softNmsSigma:a},d=me.runKernel(_x,c,f);return{selectedIndices:d[0],selectedScores:d[1]}}const dW=ge({nonMaxSuppressionWithScore_:fW});async function pW(n,e,t,s=.5,r=Number.NEGATIVE_INFINITY,a=0){const i=te(n,"boxes","nonMaxSuppressionAsync"),o=te(e,"scores","nonMaxSuppressionAsync"),l=rg(i,o,t,s,r,a);t=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold,a=l.softNmsSigma;const c=await Promise.all([i.data(),o.data()]),f=c[0],d=c[1],{selectedIndices:m,selectedScores:g}=zv(f,d,t,s,r,a);return i!==n&&i.dispose(),o!==e&&o.dispose(),{selectedIndices:Ta(m,"int32"),selectedScores:Ta(g)}}const mW=pW;function gW(n,e,t,s=.5,r=Number.NEGATIVE_INFINITY,a=!1){const i=te(n,"boxes","nonMaxSuppression"),o=te(e,"scores","nonMaxSuppression"),l=rg(i,o,t,s,r,null),c=l.maxOutputSize,f=l.iouThreshold,d=l.scoreThreshold,m={boxes:i,scores:o},g={maxOutputSize:c,iouThreshold:f,scoreThreshold:d,padToMaxOutputSize:a},b=me.runKernel(Ex,m,g);return{selectedIndices:b[0],validOutputs:b[1]}}const yW=ge({nonMaxSuppressionPadded_:gW});async function bW(n,e,t,s=.5,r=Number.NEGATIVE_INFINITY,a=!1){const i=te(n,"boxes","nonMaxSuppressionAsync"),o=te(e,"scores","nonMaxSuppressionAsync"),l=rg(i,o,t,s,r,null),c=l.maxOutputSize,f=l.iouThreshold,d=l.scoreThreshold,[m,g]=await Promise.all([i.data(),o.data()]),{selectedIndices:b,validOutputs:x}=Mv(m,g,c,f,d,a);return i!==n&&i.dispose(),o!==e&&o.dispose(),{selectedIndices:Ta(b,"int32"),validOutputs:Mt(x,"int32")}}const xW=bW;function vW(n,e,t=!1,s=!1){const r=te(n,"images","resizeBilinear");Z(r.rank===3||r.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${r.rank}.`),Z(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),Z(s===!1||t===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let a=r,i=!1;r.rank===3&&(i=!0,a=we(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const o={images:a},l={alignCorners:t,halfPixelCenters:s,size:e},c=me.runKernel($0,o,l);return i?we(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const yR=ge({resizeBilinear_:vW});function wW(n,e,t=!1,s=!1){const r=te(n,"images","resizeNearestNeighbor");Z(r.rank===3||r.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${r.rank}.`),Z(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),Z(r.dtype==="float32"||r.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),Z(s===!1||t===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let a=r,i=!1;r.rank===3&&(i=!0,a=we(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const o={images:a},l={alignCorners:t,halfPixelCenters:s,size:e},c=me.runKernel(_0,o,l);return i?we(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const bR=ge({resizeNearestNeighbor_:wW});function SW(n,e="binary",t=!1,s=.5){const r=te(n,"image","threshold"),a=.2989,i=.587,o=.114,l=r.shape[0]*r.shape[1];let c=xe(Ta([s]),255),f,d,m,g;if(Z(r.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${r.rank}.`),Z(r.shape[2]===3||r.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${r.shape[2]}.`),Z(r.dtype==="int32"||r.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${r.dtype}.`),Z(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),r.shape[2]===3){[f,d,m]=ri(r,[1,1,1],-1);const v=xe(f,a),w=xe(d,i),k=xe(m,o);g=et(et(v,w),k)}else g=n;if(e==="otsu"){const v=uk(lt(bv(g),"int32"),jo([]),256);c=NW(v,l)}const b=t?jh(g,c):hi(g,c);return lt(xe(b,255),"int32")}function NW(n,e){let t=Ta([-1]),s=Ta([0]),r=Ta([0]),a,i,o,l,c,f;for(let d=0;d<n.size-1;d++){a=Tn(n,0,d+1),i=Tn(n,d+1),c=$t(St(a),e),f=$t(St(i),e);const m=St(xe(a,sd(0,a.size)));o=$t(m,St(a));const g=yd(i.shape,a.size),b=et(sd(0,i.size),g),x=xe(i,b);l=$t(St(x),St(i));const v=mt(o,l),w=mt(o,l),k=xe(c,f);r=xe(xe(k,v),w);const I=hi(r,s);s=ua(I,r,s),t=ua(I,Ta([d]),t)}return t}const kW=ge({threshold_:SW});function CW(n,e,t="nearest",s="constant",r=0,a){const i=te(n,"image","transform","float32"),o=te(e,"transforms","transform","float32");Z(i.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${i.rank}.`),Z(o.rank===2&&(o.shape[0]===i.shape[0]||o.shape[0]===1)&&o.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),Z(a==null||a.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${a}.`);const l={image:i,transforms:o},c={interpolation:t,fillMode:s,fillValue:r,outputShape:a};return me.runKernel(Jx,l,c)}const TW=ge({transform_:CW});function AW(n,e,t){const s=te(n,"a","bandPart");Z(s.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${s.rank}.`);const r=s.shape,[a,i]=s.shape.slice(-2);let o,l;typeof e=="number"?(Z(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),Z(e<=a,()=>`bandPart(): numLower (${e}) must not be greater than the number of rows (${a}).`),o=te(e<0?a:e,"numLower","bandPart")):(Z(e.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),o=ua(jp(e,0),a,$h(e,a))),typeof t=="number"?(Z(t%1===0,()=>`bandPart(): numUpper must be an integer, got ${t}.`),Z(t<=i,()=>`bandPart(): numUpper (${t}) must not be greater than the number of columns (${i}).`),l=te(t<0?i:t,"numUpper","bandPart")):(Z(t.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),l=ua(jp(t,0),i,$h(t,i)));const c=we(sd(0,a,1,"int32"),[-1,1]),f=sd(0,i,1,"int32"),d=mt(c,f),m=Dl(jh(d,o),Ac(d,ws(l))),g=lr([a,i],s.dtype);return we(ui(mo(we(s,[-1,a,i])).map(b=>ua(m,b,g))),r)}const IW=ge({bandPart_:AW});function EW(n){let e;if(Array.isArray(n)){e=!1,Z(n!=null&&n.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const r=n[0].shape[0];for(let a=1;a<n.length;++a)Z(n[a].shape[0]===r,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${n[a].shape[0]} vs. ${r})`)}else e=!0,n=ri(n,n.shape[0],0).map(r=>Ec(r,[0]));Z(n.length<=n[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${n.length}) exceeds number of dimensions (${n[0].shape[0]}).`);const t=[],s=n;for(let r=0;r<n.length;++r)t.push(me.tidy(()=>{let a=s[r];if(r>0)for(let i=0;i<r;++i){const o=xe(St(xe(t[i],a)),t[i]);a=mt(a,o)}return $t(a,eg(a,"euclidean"))}));return e?ui(t,0):t}const _W=ge({gramSchmidt_:EW});function $W(n,e=!1){if(Z(n.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${n.rank}`),n.rank===2)return kI(n,e);{const t=n.shape.slice(0,n.shape.length-2).reduce((l,c)=>l*c),s=mo(we(n,[t,n.shape[n.shape.length-2],n.shape[n.shape.length-1]]),0),r=[],a=[];s.forEach(l=>{const[c,f]=kI(l,e);r.push(c),a.push(f)});const i=we(ui(r,0),n.shape),o=we(ui(a,0),n.shape);return[i,o]}}function kI(n,e=!1){return me.tidy(()=>{Z(n.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${n.shape.length}D Tensor.`);const t=n.shape[0],s=n.shape[1];let r=cv(t),a=xu(n);const i=Rp([[1]],[1,1]);let o=xu(i);const l=t>=s?s:t;for(let c=0;c<l;++c){const f=a,d=o,m=r;[o,a,r]=me.tidy(()=>{const g=Tn(a,[c,c],[t-c,1]),b=eg(g),x=Tn(a,[c,c],[1,1]),v=ua(hi(x,0),Rp([[-1]]),Rp([[1]])),w=mt(x,xe(v,b)),k=$t(g,w);k.shape[0]===1?o=xu(i):o=ur([i,Tn(k,[1,0],[k.shape[0]-1,k.shape[1]])],0);const I=ws($t(bn(v,w),b)),A=Tn(a,[c,0],[t-c,s]),R=xe(I,o),U=An(o);if(c===0)a=mt(A,bn(R,bn(U,A)));else{const D=mt(A,bn(R,bn(U,A)));a=ur([Tn(a,[0,0],[c,s]),D],0)}const V=An(R),P=Tn(r,[0,c],[t,r.shape[1]-c]);if(c===0)r=mt(P,bn(bn(P,o),V));else{const D=mt(P,bn(bn(P,o),V));r=ur([Tn(r,[0,0],[t,c]),D],1)}return[o,a,r]}),xn([f,d,m])}return!e&&t>s&&(r=Tn(r,[0,0],[t,s]),a=Tn(a,[0,0],[s,s])),[r,a]})}const RW=ge({qr_:$W});var Ba;(function(n){n[n.NONE=0]="NONE",n[n.MEAN=1]="MEAN",n[n.SUM=2]="SUM",n[n.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(Ba||(Ba={}));function DW(n,e,t=Ba.SUM_BY_NONZERO_WEIGHTS){const s=te(n,"losses","computeWeightedLoss");let r=null;e!=null&&(r=te(e,"weights","computeWeightedLoss"));const a=r==null?s:xe(s,r);if(t===Ba.NONE)return a;if(t===Ba.SUM)return St(a);if(t===Ba.MEAN){if(r==null)return Bs(a);{const i=s.size/r.size,o=$t(St(a),St(r));return i>1?$t(o,Mt(i)):o}}if(t===Ba.SUM_BY_NONZERO_WEIGHTS){if(r==null)return $t(St(a),Mt(s.size));{const i=xe(r,si(s.shape)),o=lt(St(nd(i,Mt(0))),"float32");return $t(St(a),o)}}throw Error(`Unknown reduction: ${t}`)}const _c=ge({computeWeightedLoss_:DW});function OW(n,e,t,s=Ba.SUM_BY_NONZERO_WEIGHTS){const r=te(n,"labels","absoluteDifference"),a=te(e,"predictions","absoluteDifference");let i=null;t!=null&&(i=te(t,"weights","absoluteDifference")),ha(r.shape,a.shape,"Error in absoluteDifference: ");const o=br(mt(r,a));return _c(o,i,s)}const LW=ge({absoluteDifference_:OW});function FW(n,e,t,s,r=Ba.SUM_BY_NONZERO_WEIGHTS){const a=te(n,"labels","cosineDistance"),i=te(e,"predictions","cosineDistance");let o=null;s!=null&&(o=te(s,"weights","cosineDistance")),ha(a.shape,i.shape,"Error in cosineDistance: ");const l=Mt(1),c=mt(l,St(xe(a,i),t,!0));return _c(c,o,r)}const MW=ge({cosineDistance_:FW});function zW(n,e,t,s=Ba.SUM_BY_NONZERO_WEIGHTS){let r=te(n,"labels","hingeLoss");const a=te(e,"predictions","hingeLoss");let i=null;t!=null&&(i=te(t,"weights","hingeLoss")),ha(r.shape,a.shape,"Error in hingeLoss: ");const o=Mt(1);r=mt(xe(Mt(2),r),o);const l=Bl(mt(o,xe(r,a)));return _c(l,i,s)}const PW=ge({hingeLoss_:zW});function BW(n,e,t,s=1,r=Ba.SUM_BY_NONZERO_WEIGHTS){const a=te(n,"labels","huberLoss"),i=te(e,"predictions","huberLoss");let o=null;t!=null&&(o=te(t,"weights","huberLoss")),ha(a.shape,i.shape,"Error in huberLoss: ");const l=Mt(s),c=br(mt(i,a)),f=$h(c,l),d=mt(c,f),m=et(xe(Mt(.5),is(f)),xe(l,d));return _c(m,o,r)}const UW=ge({huberLoss_:BW});function VW(n,e,t,s=1e-7,r=Ba.SUM_BY_NONZERO_WEIGHTS){const a=te(n,"labels","logLoss"),i=te(e,"predictions","logLoss");let o=null;t!=null&&(o=te(t,"weights","logLoss")),ha(a.shape,i.shape,"Error in logLoss: ");const l=Mt(1),c=Mt(s),f=ws(xe(a,Li(et(i,c)))),d=xe(mt(l,a),Li(et(mt(l,i),c))),m=mt(f,d);return _c(m,o,r)}const jW=ge({logLoss_:VW});function WW(n,e,t,s=Ba.SUM_BY_NONZERO_WEIGHTS){const r=te(n,"labels","meanSquaredError"),a=te(e,"predictions","meanSquaredError");let i=null;t!=null&&(i=te(t,"weights","meanSquaredError")),ha(r.shape,a.shape,"Error in meanSquaredError: ");const o=Tv(r,a);return _c(o,i,s)}const GW=ge({meanSquaredError_:WW});function qW(n,e){const t=te(n,"labels","sigmoidCrossEntropyWithLogits"),s=te(e,"logits","sigmoidCrossEntropyWithLogits");ha(t.shape,s.shape,"Error in sigmoidCrossEntropyWithLogits: ");const r=Bl(s),a=xe(s,t),i=Z0(li(ws(br(s))));return et(mt(r,a),i)}function HW(n,e,t,s=0,r=Ba.SUM_BY_NONZERO_WEIGHTS){let a=te(n,"multiClassLabels","sigmoidCrossEntropy");const i=te(e,"logits","sigmoidCrossEntropy");let o=null;if(t!=null&&(o=te(t,"weights","sigmoidCrossEntropy")),ha(a.shape,i.shape,"Error in sigmoidCrossEntropy: "),s>0){const c=Mt(s),f=Mt(1),d=Mt(.5);a=et(xe(a,mt(f,c)),xe(d,c))}const l=qW(a,i);return _c(l,o,r)}const KW=ge({sigmoidCrossEntropy_:HW});function XW(n,e,t=-1){if(t===-1&&(t=e.rank-1),t!==e.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${e.rank} and dim was ${t}`);return Tu((r,a,i)=>{const l=J0(a,[t],!0),c=mt(lt(a,"float32"),l);i([r,c]);const f=ws(xe(c,r));return{value:St(f,[t]),gradFunc:(g,b)=>{const[x,v]=b,w=cr(g.shape,[t]);return[xe(we(g,w),mt(lt(x,"float32"),li(v))),xe(we(g,w),mt(li(v),lt(x,"float32")))]}}})(n,e)}function YW(n,e,t,s=0,r=Ba.SUM_BY_NONZERO_WEIGHTS){let a=te(n,"onehotLabels","softmaxCrossEntropy");const i=te(e,"logits","softmaxCrossEntropy");let o=null;if(t!=null&&(o=te(t,"weights","softmaxCrossEntropy")),ha(a.shape,i.shape,"Error in softmaxCrossEntropy: "),s>0){const c=Mt(s),f=Mt(1),d=Mt(a.shape[1]);a=et(xe(a,mt(f,c)),$t(c,d))}const l=XW(a,i);return _c(l,o,r)}const ZW=ge({softmaxCrossEntropy_:YW});function JW(n,e,t,s){const r=te(n,"indices","sparseFillEmptyRows","int32"),a=te(e,"values","sparseFillEmptyRows"),i=te(t,"denseShape","sparseFillEmptyRows","int32"),o=te(s,"defaultValue","sparseFillEmptyRows",a.dtype);if(r.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${r.shape}`);if(a.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${a.shape}`);if(i.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${i.shape}`);if(o.rank!==0)throw new Error(`Default value should be a scalar but received shape ${o.shape}`);const l={indices:r,values:a,denseShape:i,defaultValue:o},c=me.runKernel(Ux,l);return{outputIndices:c[0],outputValues:c[1],emptyRowIndicator:c[2],reverseIndexMap:c[3]}}const QW=ge({sparseFillEmptyRows_:JW});function eG(n,e,t){const s=te(n,"inputIndices","sparseReshape","int32"),r=te(e,"inputShape","sparseReshape","int32"),a=te(t,"newShape","sparseReshape","int32");if(s.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${s.shape}`);if(r.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${r.shape}`);if(a.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${a.shape}`);const i={inputIndices:s,inputShape:r,newShape:a},o=me.runKernel(Vx,i);return{outputIndices:o[0],outputShape:o[1]}}const tG=ge({sparseReshape_:eG});function nG(n,e,t){const s=te(n,"data","sparseSegmentMean"),r=te(e,"indices","sparseSegmentMean","int32"),a=te(t,"segmentIds","sparseSegmentMean","int32");if(s.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${r.shape}`);if(a.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${a.shape}`);const i={data:s,indices:r,segmentIds:a};return me.runKernel(jx,i)}const sG=ge({sparseSegmentMean_:nG});function rG(n,e,t){const s=te(n,"data","sparseSegmentSum"),r=te(e,"indices","sparseSegmentSum","int32"),a=te(t,"segmentIds","sparseSegmentSum","int32");if(s.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${r.shape}`);if(a.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${a.shape}`);const i={data:s,indices:r,segmentIds:a};return me.runKernel(Wx,i)}const aG=ge({sparseSegmentSum_:rG});function iG(n,e,t,s,r,a,i,o){const l=te(n,"data","stringNGrams","string");if(l.dtype!=="string")throw new Error("Data must be of datatype string");if(l.shape.length!==1)throw new Error(`Data must be a vector, saw: ${l.shape}`);const c=te(e,"dataSplits","stringNGrams");if(c.dtype!=="int32")throw new Error("Data splits must be of datatype int32");const f={separator:t,nGramWidths:s,leftPad:r,rightPad:a,padWidth:i,preserveShortSequences:o},d={data:l,dataSplits:c},m=me.runKernel(Kx,d,f);return{nGrams:m[0],nGramsSplits:m[1]}}const oG=ge({stringNGrams_:iG});function lG(n,e,t=!0){const s=te(n,"input","stringSplit","string"),r=te(e,"delimiter","stringSplit","string");if(s.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${s.shape}`);if(r.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${r.shape}`);const a={skipEmpty:t},i={input:s,delimiter:r},o=me.runKernel(Xx,i,a);return{indices:o[0],values:o[1],shape:o[2]}}const uG=ge({stringSplit_:lG});function cG(n,e){const t=te(n,"input","stringToHashBucketFast","string"),s={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");const r={input:t};return me.runKernel(Yx,r,s)}const hG=ge({stringToHashBucketFast_:cG});function fG(n,e,t,s=!0){const r=te(n,"input","staticRegexReplace","string"),a={pattern:e,rewrite:t,replaceGlobal:s};return me.runKernel(P0,{x:r},a)}const dG=ge({staticRegexReplace_:fG});const xR={fft:iy,ifft:Hp,rfft:oy,irfft:Cv},vR={hammingWindow:Uj,hannWindow:mR,frame:gR,stft:Gj},Bo={flipLeftRight:Xj,grayscaleToRGB:Zj,resizeNearestNeighbor:bR,resizeBilinear:yR,rgbToGrayscale:Qj,rotateWithOffset:tW,cropAndResize:Hj,nonMaxSuppression:sW,nonMaxSuppressionAsync:hW,nonMaxSuppressionWithScore:dW,nonMaxSuppressionWithScoreAsync:mW,nonMaxSuppressionPadded:yW,nonMaxSuppressionPaddedAsync:xW,threshold:kW,transform:TW},Qk={bandPart:IW,gramSchmidt:_W,qr:RW},wR={absoluteDifference:LW,computeWeightedLoss:_c,cosineDistance:MW,hingeLoss:PW,huberLoss:UW,logLoss:jW,meanSquaredError:GW,sigmoidCrossEntropy:KW,softmaxCrossEntropy:ZW},SR={sparseFillEmptyRows:QW,sparseReshape:tG,sparseSegmentMean:sG,sparseSegmentSum:aG},NR={stringNGrams:oG,stringSplit:uG,stringToHashBucketFast:hG,staticRegexReplace:dG};const pG=new Map,PS=new Map;class vd{getClassName(){return this.constructor.className}static fromConfig(e,t){return new e(t)}}class oo{constructor(){this.classNameMap={}}static getMap(){return oo.instance==null&&(oo.instance=new oo),oo.instance}static register(e){oo.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function st(n,e,t){Z(n.className!=null,()=>"Class being registered does not have the static className property defined."),Z(typeof n.className=="string",()=>"className is required to be a string, but got type "+typeof n.className),Z(n.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof e>"u"&&(e="Custom"),typeof t>"u"&&(t=n.className);const s=t,r=e+">"+s;return oo.register(n),pG.set(r,n),PS.set(n,r),n}function mG(n){return PS.has(n)?PS.get(n):n.className}const gG=Object.freeze(Object.defineProperty({__proto__:null,Serializable:vd,SerializationMap:oo,getRegisteredName:mG,registerClass:st},Symbol.toStringTag,{value:"Module"}));class $c extends vd{minimize(e,t=!1,s){const{value:r,grads:a}=this.computeGradients(e,s);if(s!=null){const i=s.map(o=>({name:o.name,tensor:a[o.name]}));this.applyGradients(i)}else this.applyGradients(a);return xn(a),t?r:(r.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,t){return E$(e,t)}dispose(){this.iterations_!=null&&xn(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:Mt(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty($c,Symbol.hasInstance,{value:n=>n.minimize!=null&&n.computeGradients!=null&&n.applyGradients!=null});class e3 extends $c{static get className(){return"Adadelta"}constructor(e,t,s=null){super(),this.learningRate=e,this.rho=t,this.epsilon=s,this.accumulatedGrads=[],this.accumulatedUpdates=[],s==null&&(this.epsilon=me.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const a=me.registeredVariables[s],i=!1;this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accum_grad`,variable:_e(()=>$n(a).variable(i))}),this.accumulatedUpdates[r]==null&&(this.accumulatedUpdates[r]={originalName:`${s}/accum_var`,variable:_e(()=>$n(a).variable(i))});const o=Array.isArray(e)?e[r].tensor:e[s];if(o==null)return;const l=this.accumulatedGrads[r].variable,c=this.accumulatedUpdates[r].variable;_e(()=>{const f=et(xe(l,this.rho),xe(is(o),1-this.rho)),d=xe($t(Xr(et(c,this.epsilon)),Xr(et(l,this.epsilon))),o),m=et(xe(c,this.rho),xe(is(d),1-this.rho));l.assign(f),c.assign(m);const g=et(xe(d,-this.learningRate),a);a.assign(g)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(xn(this.accumulatedGrads.map(e=>e.variable)),xn(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=e.length/2,s=!1;this.accumulatedGrads=e.slice(0,t).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedUpdates=e.slice(t,t*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.rho,t.epsilon)}}class t3 extends $c{static get className(){return"Adagrad"}constructor(e,t=.1){super(),this.learningRate=e,this.initialAccumulatorValue=t,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const a=me.registeredVariables[s];this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accumulator`,variable:_e(()=>yd(a.shape,this.initialAccumulatorValue).variable(!1))});const i=Array.isArray(e)?e[r].tensor:e[s];if(i==null)return;const o=this.accumulatedGrads[r].variable;_e(()=>{const l=et(o,is(i));o.assign(l);const c=et(xe($t(i,Xr(et(l,me.backend.epsilon()))),-this.learningRate),a);a.assign(c)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&xn(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=!1;this.accumulatedGrads=e.map(s=>({originalName:s.name,variable:s.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}}class n3 extends $c{static get className(){return"Adam"}constructor(e,t,s,r=null){super(),this.learningRate=e,this.beta1=t,this.beta2=s,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],_e(()=>{this.accBeta1=Mt(t).variable(),this.accBeta2=Mt(s).variable()}),r==null&&(this.epsilon=me.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);_e(()=>{const s=mt(1,this.accBeta1),r=mt(1,this.accBeta2);t.forEach((a,i)=>{const o=me.registeredVariables[a],l=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:`${a}/m`,variable:_e(()=>$n(o).variable(l))}),this.accumulatedSecondMoment[i]==null&&(this.accumulatedSecondMoment[i]={originalName:`${a}/v`,variable:_e(()=>$n(o).variable(l))});const c=Array.isArray(e)?e[i].tensor:e[a];if(c==null)return;const f=this.accumulatedFirstMoment[i].variable,d=this.accumulatedSecondMoment[i].variable,m=et(xe(f,this.beta1),xe(c,1-this.beta1)),g=et(xe(d,this.beta2),xe(is(c),1-this.beta2)),b=$t(m,s),x=$t(g,r);f.assign(m),d.assign(g);const v=et(xe($t(b,et(Xr(x),this.epsilon)),-this.learningRate),o);o.assign(v)}),this.accBeta1.assign(xe(this.accBeta1,this.beta1)),this.accBeta2.assign(xe(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&xn(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&xn(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e),_e(()=>{this.accBeta1.assign(Cu(this.beta1,this.iterations_+1)),this.accBeta2.assign(Cu(this.beta2,this.iterations_+1))});const t=e.length/2,s=!1;this.accumulatedFirstMoment=e.slice(0,t).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedSecondMoment=e.slice(t,t*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}}class s3 extends $c{static get className(){return"Adamax"}constructor(e,t,s,r=null,a=0){super(),this.learningRate=e,this.beta1=t,this.beta2=s,this.epsilon=r,this.decay=a,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],_e(()=>{this.iteration=Mt(0).variable(),this.accBeta1=Mt(t).variable()}),r==null&&(this.epsilon=me.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);_e(()=>{const s=mt(1,this.accBeta1),r=$t(-this.learningRate,et(xe(this.iteration,this.decay),1));t.forEach((a,i)=>{const o=me.registeredVariables[a],l=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:`${a}/m`,variable:$n(o).variable(l)}),this.accumulatedWeightedInfNorm[i]==null&&(this.accumulatedWeightedInfNorm[i]={originalName:`${a}/v`,variable:$n(o).variable(l)});const c=Array.isArray(e)?e[i].tensor:e[a];if(c==null)return;const f=this.accumulatedFirstMoment[i].variable,d=this.accumulatedWeightedInfNorm[i].variable,m=et(xe(f,this.beta1),xe(c,1-this.beta1)),g=xe(d,this.beta2),b=br(c),x=_u(g,b);f.assign(m),d.assign(x);const v=et(xe($t(r,s),$t(m,et(x,this.epsilon))),o);o.assign(v)}),this.iteration.assign(et(this.iteration,1)),this.accBeta1.assign(xe(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&xn(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&xn(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}}class Pv extends $c{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const a=Array.isArray(e)?e[r].tensor:e[s];if(a==null)return;const i=me.registeredVariables[s];_e(()=>{const o=et(xe(this.c,a),i);i.assign(o)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=_r(Mt(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,t){return new e(t.learningRate)}}class r3 extends Pv{static get className(){return"Momentum"}constructor(e,t,s=!1){super(e),this.learningRate=e,this.momentum=t,this.useNesterov=s,this.accumulations=[],this.m=Mt(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const a=me.registeredVariables[s];this.accumulations[r]==null&&(this.accumulations[r]={originalName:`${s}/momentum`,variable:_e(()=>$n(a).variable(!1))});const i=this.accumulations[r].variable,o=Array.isArray(e)?e[r].tensor:e[s];o!=null&&_e(()=>{let l;const c=et(xe(this.m,i),o);this.useNesterov?l=et(xe(this.c,et(o,xe(c,this.m))),a):l=et(xe(this.c,c),a),i.assign(c),a.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&xn(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=!1;this.accumulations=e.map(s=>({originalName:s.name,variable:s.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}}class a3 extends $c{static get className(){return"RMSProp"}constructor(e,t=.9,s=0,r=null,a=!1){if(super(),this.learningRate=e,this.decay=t,this.momentum=s,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=a,r==null&&(this.epsilon=me.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const a=me.registeredVariables[s],i=!1;this.accumulatedMeanSquares[r]==null&&(this.accumulatedMeanSquares[r]={originalName:`${s}/rms`,variable:_e(()=>$n(a).variable(i))}),this.accumulatedMoments[r]==null&&(this.accumulatedMoments[r]={originalName:`${s}/momentum`,variable:_e(()=>$n(a).variable(i))}),this.accumulatedMeanGrads[r]==null&&this.centered&&(this.accumulatedMeanGrads[r]={originalName:`${s}/mg`,variable:_e(()=>$n(a).variable(i))});const o=Array.isArray(e)?e[r].tensor:e[s];if(o==null)return;const l=this.accumulatedMeanSquares[r].variable,c=this.accumulatedMoments[r].variable;_e(()=>{const f=et(xe(l,this.decay),xe(is(o),1-this.decay));if(this.centered){const d=this.accumulatedMeanGrads[r].variable,m=et(xe(d,this.decay),xe(o,1-this.decay)),g=$t(xe(o,this.learningRate),Xr(mt(f,et(is(m),this.epsilon)))),b=et(xe(c,this.momentum),g);l.assign(f),d.assign(m),c.assign(b);const x=mt(a,b);a.assign(x)}else{const d=et(xe(l,this.decay),xe(is(o),1-this.decay)),m=et(xe(c,this.momentum),$t(xe(o,this.learningRate),Xr(et(d,this.epsilon))));l.assign(d),c.assign(m);const g=mt(a,m);a.assign(g)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&xn(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&xn(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&xn(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=this.centered?e.length/3:e.length/2,s=!1;this.accumulatedMeanSquares=e.slice(0,t).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedMoments=e.slice(t,t*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.centered&&(this.accumulatedMeanGrads=e.slice(t*2,t*3).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}}const yG=[e3,t3,n3,s3,r3,a3,Pv];function bG(){for(const n of yG)st(n)}const xG="model",vG=".json",wG=".weights.bin";function CI(n){return new Promise(e=>setTimeout(e)).then(n)}class rd{constructor(e){if(!De().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(rd.URL_SCHEME)&&(e=e.slice(rd.URL_SCHEME.length)),(e==null||e.length===0)&&(e=xG),this.modelJsonFileName=e+vG,this.weightDataFileName=e+wG}async save(e){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const t=Pl.join(e.weightData),s=window.URL.createObjectURL(new Blob([t],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const r=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],a=u$(e,r),i=window.URL.createObjectURL(new Blob([JSON.stringify(a)],{type:"application/json"})),o=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(o.download=this.modelJsonFileName,o.href=i,await CI(()=>o.dispatchEvent(new MouseEvent("click"))),e.weightData!=null){const l=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;l.download=this.weightDataFileName,l.href=s,await CI(()=>l.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:W0(e)}}}}rd.URL_SCHEME="downloads://";class SG{constructor(e){if(e==null||e.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${e}`);this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise((e,t)=>{const s=new FileReader;s.onload=r=>{const a=JSON.parse(r.target.result),i=a.modelTopology;if(i==null){t(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(a.weightsManifest==null){t(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(this.weightsFiles.length===0){e({modelTopology:i});return}const l=KN(a,c=>this.loadWeights(c));e(l)},s.onerror=r=>t(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),s.readAsText(this.jsonFile)})}loadWeights(e){const t=[],s=[];for(const i of e)t.push(...i.weights),s.push(...i.paths);const r=this.checkManifestAndWeightFiles(e),a=s.map(i=>this.loadWeightsFile(i,r[i]));return Promise.all(a).then(i=>[t,i])}loadWeightsFile(e,t){return new Promise((s,r)=>{const a=new FileReader;a.onload=i=>{const o=i.target.result;s(o)},a.onerror=i=>r(`Failed to weights data from file of path '${e}'.`),a.readAsArrayBuffer(t)})}checkManifestAndWeightFiles(e){const t=[],s=this.weightsFiles.map(a=>pI(a.name)),r={};for(const a of e)a.paths.forEach(i=>{const o=pI(i);if(t.indexOf(o)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${o}'`);if(t.push(o),s.indexOf(o)===-1)throw new Error(`Weight file with basename '${o}' is not provided.`);r[i]=this.weightsFiles[s.indexOf(o)]});if(t.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${t.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return r}}const NG=n=>De().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(rd.URL_SCHEME)?kG(n.slice(rd.URL_SCHEME.length)):null;Ps.registerSaveRouter(NG);function kG(n="model"){return new rd(n)}function CG(n){return new SG(n)}function TI(n,e,t,s){i(n),t=t??0,s=s??1,o(t,s);let r=0;const a=l=>(l.then(c=>{const f=t+ ++r/n.length*(s-t);return e(f),c}),l);function i(l){Z(l!=null&&Array.isArray(l)&&l.length>0,()=>"promises must be a none empty array")}function o(l,c){Z(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${l}`),Z(c>=0&&c<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${c}`),Z(c>=l,()=>`startFraction must be no more than endFraction, but got startFraction ${l} and endFraction ${c}`)}return Promise.all(n.map(a))}async function kR(n,e){e==null&&(e={});const t=e.fetchFunc==null?De().platform.fetch:e.fetchFunc,s=n.map(d=>t(d,e.requestInit,{isBinary:!0})),o=(e.onProgress==null?await Promise.all(s):await TI(s,e.onProgress,0,.5)).map(d=>d.arrayBuffer());return e.onProgress==null?await Promise.all(o):await TI(o,e.onProgress,.5,1)}function TG(n,e){var t;const s=e.fetchFunc==null?De().platform.fetch:e.fetchFunc;let r=0,a;return(t=e.onProgress)===null||t===void 0||t.call(e,0),new ReadableStream({pull:async i=>{for(var o;r<n.length;){a||(a=(await s(n[r],e.requestInit,{isBinary:!0})).body.getReader());const{done:l,value:c}=await a.read();if(l){r++,a=void 0,(o=e.onProgress)===null||o===void 0||o.call(e,r/n.length);continue}i.enqueue(c);return}i.close()}})}async function AG(n,e="",t,s){return CR(i=>kR(i,{requestInit:s}))(n,e,t)}function CR(n){return async(e,t="",s)=>{const r=e.map(()=>!1),a={},i=s!=null?s.map(()=>!1):[],o=[];if(e.forEach((g,b)=>{let x=0;g.weights.forEach(v=>{const w="quantization"in v?v.quantization.dtype:v.dtype,k=Yf[w]*Be(v.shape),I=()=>{r[b]=!0,a[b]==null&&(a[b]=[]),a[b].push({manifestEntry:v,groupOffset:x,sizeBytes:k})};s!=null?s.forEach((A,R)=>{A===v.name&&(I(),i[R]=!0)}):I(),o.push(v.name),x+=k})}),!i.every(g=>g)){const g=s.filter((b,x)=>!i[x]);throw new Error(`Could not find weights in manifest with names: ${g.join(", ")}. 
Manifest JSON has weights with names: ${o.join(", ")}.`)}const l=r.reduce((g,b,x)=>(b&&g.push(x),g),[]),c=[];l.forEach(g=>{e[g].paths.forEach(b=>{const x=t+(t.endsWith("/")?"":"/")+b;c.push(x)})});const f=await n(c),d={};let m=0;return l.forEach(g=>{const b=e[g].paths.length,x=new Pl(f.slice(m,m+b));a[g].forEach(w=>{const k=x.slice(w.groupOffset,w.groupOffset+w.sizeBytes),I=a$(k,[w.manifestEntry]);for(const A in I)d[A]=I[A]}),m+=b}),d}}const IG="application/octet-stream",EG="application/json";class i3{constructor(e,t){if(this.DEFAULT_METHOD="POST",t==null&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.weightUrlConverter=t.weightUrlConverter,t.fetchFunc!=null?(Z(typeof t.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=t.fetchFunc):this.fetch=De().platform.fetch,Z(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&Z(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,t.requestInit!=null&&t.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{},this.loadOptions=t}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);t.body=new FormData;const s=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],r=u$(e,s);if(t.body.append("model.json",new Blob([JSON.stringify(r)],{type:EG}),"model.json"),e.weightData!=null){const i=Pl.join(e.weightData);t.body.append("model.weights.bin",new Blob([i],{type:IG}),"model.weights.bin")}const a=await this.fetch(this.path,t);if(a.ok)return{modelArtifactsInfo:W0(e),responses:[a]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${a.status}.`)}async loadModelJSON(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let t;try{t=await e.json()}catch{let i=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?i+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":i+=" Please make sure the server is serving valid JSON for this request.",new Error(i)}const s=t.modelTopology,r=t.weightsManifest;if(s==null&&r==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return t}async load(){if(this.loadOptions.streamWeights)return this.loadStream();const e=await this.loadModelJSON();return KN(e,t=>this.loadWeights(t))}async loadStream(){const e=await this.loadModelJSON(),t=await this.getWeightUrls(e.weightsManifest),s=RS(e.weightsManifest),r=()=>TG(t,this.loadOptions);return Object.assign(Object.assign({},e),{weightSpecs:s,getWeightStream:r})}async getWeightUrls(e){const t=Array.isArray(this.path)?this.path[1]:this.path,[s,r]=_G(t),a=this.weightPathPrefix||s,i=[],o=[];for(const l of e)for(const c of l.paths)this.weightUrlConverter!=null?o.push(this.weightUrlConverter(c)):i.push(a+c+r);return this.weightUrlConverter&&i.push(...await Promise.all(o)),i}async loadWeights(e){const t=await this.getWeightUrls(e),s=RS(e),r=await kR(t,this.loadOptions);return[s,r]}}i3.URL_SCHEME_REGEX=/^https?:\/\//;function _G(n){const e=n.lastIndexOf("/"),t=n.lastIndexOf("?"),s=n.substring(0,e),r=t>e?n.substring(t):"";return[s+"/",r]}function BS(n){return n.match(i3.URL_SCHEME_REGEX)!=null}const TR=(n,e)=>{if(typeof fetch>"u"&&(e==null||e.fetchFunc==null))return null;{let t=!0;if(Array.isArray(n)?t=n.every(s=>BS(s)):t=BS(n),t)return o3(n,e)}return null};Ps.registerSaveRouter(TR);Ps.registerLoadRouter(TR);function o3(n,e){return new i3(n,e)}function $G(n,e){return o3(n,e)}class L5{constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}}class AR{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}}class RG{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=t=>Promise.resolve(e.save(t)))}}function DG(n,e,t,s){const r=arguments;return new RG(IR(...r))}function IR(n,e,t,s){return arguments.length===1?n.modelTopology!=null||n.weightSpecs!=null?new L5(n):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new L5({modelTopology:n})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new L5({modelTopology:n,weightSpecs:e,weightData:t,trainingConfig:s}))}function OG(n){return new AR(n)}function LG(n){return new AR(n)}const l3=Object.freeze(Object.defineProperty({__proto__:null,CompositeArrayBuffer:Pl,browserFiles:CG,browserHTTPRequest:$G,concatenateArrayBuffers:l$,copyModel:h7,decodeWeights:a$,decodeWeightsStream:o$,encodeWeights:$S,fromMemory:DG,fromMemorySync:IR,getLoadHandlers:ZB,getModelArtifactsForJSON:KN,getModelArtifactsForJSONSync:c$,getModelArtifactsInfoForJSON:W0,getSaveHandlers:h$,getWeightSpecs:RS,http:o3,isHTTPScheme:BS,listModels:u7,loadWeights:AG,moveModel:f7,registerLoadRouter:YB,registerSaveRouter:XB,removeModel:c7,weightsLoaderFactory:CR,withSaveHandler:OG,withSaveHandlerSync:LG},Symbol.toStringTag,{value:"Module"}));function FG(n,e,t){const s=te(n,"labels","confusionMatrix"),r=te(e,"predictions","confusionMatrix");Z(t==null||t>0&&Number.isInteger(t),()=>`If provided, numClasses must be a positive integer, but got ${t}`),Z(s.rank===1,()=>`Expected the rank of labels to be 1, but got ${s.rank}`),Z(r.rank===1,()=>`Expected the rank of predictions to be 1, but got ${r.rank}`),Z(s.shape[0]===r.shape[0],()=>`Mismatch in the number of examples: ${s.shape[0]} vs. ${r.shape[0]}. Labels and predictions should have the same number of elements.`),Z(t>0&&Number.isInteger(t),()=>`numClasses is required to be a positive integer, but got ${t}`);const a=Wp(lt(s,"int32"),t),i=Wp(lt(r,"int32"),t),o=An(a),l=bn(o,i);return lt(l,"int32")}const MG=ge({confusionMatrix_:FG});const zG=Object.freeze(Object.defineProperty({__proto__:null,confusionMatrix:MG},Symbol.toStringTag,{value:"Module"}));let If,AI=!1;function ER(n,e=3){if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(n==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let t=!1,s=!1,r=!1,a=!1,i=!1,o=!1;if(n.data instanceof Uint8Array)t=!0;else if(typeof ImageData<"u"&&n instanceof ImageData)s=!0;else if(typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement)r=!0;else if(typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement)a=!0;else if(n.getContext!=null)i=!0;else if(typeof ImageBitmap<"u"&&n instanceof ImageBitmap)o=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${n.constructor.name}`);if(v1(gb,me.backendName)!=null){const b={pixels:n},x={numChannels:e};return me.runKernel(gb,b,x)}const[c,f]=r?[n.videoWidth,n.videoHeight]:[n.width,n.height];let d;if(i)d=n.getContext("2d").getImageData(0,0,c,f).data;else if(s||t)d=n.data;else if(a||r||o){if(If==null)if(typeof document>"u")if(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u")If=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else If=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});If.canvas.width=c,If.canvas.height=f,If.drawImage(n,0,0,c,f),d=If.getImageData(0,0,c,f).data}let m;if(e===4)m=new Int32Array(d);else{const b=c*f;m=new Int32Array(b*e);for(let x=0;x<b;x++)for(let v=0;v<e;++v)m[x*e+v]=d[x*4+v]}return jk(m,[f,c,e],"int32")}function PG(n){return n!=null&&n.data instanceof Uint8Array}function BG(){return typeof window<"u"&&typeof ImageBitmap<"u"&&window.hasOwnProperty("createImageBitmap")}function UG(n){return n!=null&&n.width!==0&&n.height!==0}function VG(n){return BG()&&!(n instanceof ImageBitmap)&&UG(n)&&!PG(n)}async function jG(n,e=3){let t=null;if(De().getBool("WRAP_TO_IMAGEBITMAP")&&VG(n)){let s;try{s=await createImageBitmap(n,{premultiplyAlpha:"none"})}catch{s=null}s!=null&&s.width===n.width&&s.height===n.height?t=s:t=n}else t=n;return ER(t,e)}function _R(n){if(n.rank!==2&&n.rank!==3)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${n.rank}.`);const e=n.rank===2?1:n.shape[2];if(e>4||e===2)throw new Error(`toPixels only supports depth of size 1, 3 or 4 but got ${e}`);if(n.dtype!=="float32"&&n.dtype!=="int32")throw new Error(`Unsupported type for toPixels: ${n.dtype}. Please use float32 or int32 tensors.`)}function WG(n){const e=n?.alpha||1;if(e>1||e<0)throw new Error(`Alpha value ${e} is suppoed to be in range [0 - 1].`)}async function GG(n,e){let t=te(n,"img","toPixels");if(!(n instanceof Kn)){const c=t;t=lt(c,"int32"),c.dispose()}_R(t);const[s,r]=t.shape.slice(0,2),a=t.rank===2?1:t.shape[2],i=await t.data(),o=t.dtype==="float32"?255:1,l=new Uint8ClampedArray(r*s*4);for(let c=0;c<s*r;++c){const f=[0,0,0,255];for(let m=0;m<a;m++){const g=i[c*a+m];if(t.dtype==="float32"){if(g<0||g>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${g}.`)}else if(t.dtype==="int32"&&(g<0||g>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${g}.`);a===1?(f[0]=g*o,f[1]=g*o,f[2]=g*o):f[m]=g*o}const d=c*4;l[d+0]=Math.round(f[0]),l[d+1]=Math.round(f[1]),l[d+2]=Math.round(f[2]),l[d+3]=Math.round(f[3])}if(e!=null){AI||v1(dx,me.backendName)!=null&&(console.warn("tf.browser.toPixels is not efficient to draw tensor on canvas. Please try tf.browser.draw instead."),AI=!0),e.width=r,e.height=s;const c=e.getContext("2d"),f=new ImageData(l,r,s);c.putImageData(f,0,0)}return t!==n&&t.dispose(),l}function qG(n,e,t){let s=te(n,"img","draw");if(!(n instanceof Kn)){const i=s;s=lt(i,"int32"),i.dispose()}_R(s),WG(t?.imageOptions);const r={image:s},a={canvas:e,options:t};me.runKernel(dx,r,a)}const $R=ge({fromPixels_:ER}),HG=Object.freeze(Object.defineProperty({__proto__:null,draw:qG,fromPixels:$R,fromPixelsAsync:jG,toPixels:GG},Symbol.toStringTag,{value:"Module"}));function Bv(n,e){const t=n.shape.length,s=e.shape.length;if(t<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${t}.`);if(s<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${s}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[s-1]>t)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[s-1]} vs. ${t}`);if(Be(n.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${n.shape}.`);const r=e.shape,a=r[r.length-1];let i=1;for(let d=0;d<r.length-1;++d)i*=r[d];const o=n.shape,l=r.slice();l.pop();let c=1;for(let d=a;d<t;++d)c*=o[d],l.push(o[d]);const f=[...Ot(n.shape).map(d=>d/c),1].slice(0,a);return[l,i,c,f]}const KG=Object.freeze(Object.defineProperty({__proto__:null,prepareAndValidate:Bv},Symbol.toStringTag,{value:"Module"}));const US=-2,XG=-1;function u3(n,e,t){const s=n.shape.length;Z(s===e.length,()=>`Error in slice${s}D: Length of begin ${e} must match the rank of the array (${s}).`),Z(s===t.length,()=>`Error in slice${s}D: Length of size ${t} must match the rank of the array (${s}).`);for(let r=0;r<s;++r)Z(e[r]+t[r]<=n.shape[r],()=>`Error in slice${s}D: begin[${r}] + size[${r}] (${e[r]+t[r]}) would overflow input.shape[${r}] (${n.shape[r]})`)}function YG(n){const e=[];let t=0;for(;n>0;)n&1&&e.push(t),n/=2,t++;return e}function c3(n,e,t){const s=[];for(let r=0;r<n.length;r++)s[r]=Math.ceil((e[r]-n[r])/t[r]);return s}function RR(n,e,t,s){const r=[...n];for(let a=r.length;a<s.length;a++)r.push(1);for(let a=0;a<t;a++)a===0?r[e]=1:(r.splice(e,0,1),r.pop());return r}function DR(n,e,t){return t<=n?t:t-(e-1)}function OR(n,e){const t=[];for(let s=0;s<n;s++)t.push(e+s);return t}function ZG(n,e,t,s,r,a,i,o,l){const c=n.length;let f=new Array(c),d=new Array(c),m=new Array(c);if(e.length&&t>0){const g=e[0],b=t+1;f=LR(i,g,b,s,n),d=FR(o,g,b,r,n),m=RR(a,g,b,n)}else for(let g=0;g<c;g++)f[g]=zR(i,s,a,n,g,l),d[g]=PR(o,r,a,n,g,l),m[g]=MR(a,g,l);return{begin:f,end:d,strides:m}}function LR(n,e,t,s,r){const a=[...r],i=OR(t,e);for(let o=0;o<a.length;o++)if(i.indexOf(o)>-1)a[o]=0;else{const l=DR(e,t,o);let c=s[l];n&1<<l&&(c=0),a[o]=c}return a}function FR(n,e,t,s,r){const a=[...r],i=OR(t,e);for(let o=0;o<a.length;o++)if(i.indexOf(o)>-1)a[o]=Number.MAX_SAFE_INTEGER;else{const l=DR(e,t,o);let c=s[l];n&1<<l&&(c=Number.MAX_SAFE_INTEGER),a[o]=c}for(let o=0;o<a.length;o++){const l=r[o];a[o]<0&&(a[o]+=l),a[o]=Ch(0,a[o],r[o])}return a}function MR(n,e,t){let s=n[e];return(t&1<<e||s==null)&&(s=1),s}function zR(n,e,t,s,r,a){let i=e[r];const o=t[r]||1;(n&1<<r||a&1<<r||i==null)&&(o>0?i=Number.MIN_SAFE_INTEGER:i=Number.MAX_SAFE_INTEGER);const l=s[r];return i<0&&(i+=l),i=Ch(0,i,l-1),i}function PR(n,e,t,s,r,a){let i=e[r];const o=t[r]||1;(n&1<<r||a&1<<r||i==null)&&(o>0?i=Number.MAX_SAFE_INTEGER:i=Number.MIN_SAFE_INTEGER);const l=s[r];return i<0&&(i+=l),o>0?i=Ch(0,i,l):i=Ch(-1,i,l-1),i}function h3(n,e,t){let s=t.length;for(let r=0;r<t.length;r++)if(t[r]>1){s=r;break}for(let r=s+1;r<t.length;r++)if(e[r]>0||t[r]!==n[r])return!1;return!0}function f3(n,e){let t=n.length>0?n[n.length-1]:1;for(let s=0;s<n.length-1;s++)t+=n[s]*e[s];return t}function Uv(n,e,t){let s;const r=n.shape.length;typeof e=="number"?s=[e,...new Array(r-1).fill(0)]:e.length<r?s=e.concat(new Array(r-e.length).fill(0)):s=e.slice(),s.forEach(i=>{Z(i!==-1,()=>"slice() does not support negative begin indexing.")});let a;return t==null?a=new Array(r).fill(-1):typeof t=="number"?a=[t,...new Array(r-1).fill(-1)]:t.length<r?a=t.concat(new Array(r-t.length).fill(-1)):a=t,a=a.map((i,o)=>i>=0?i:(Z(i===-1,()=>`Negative size values should be exactly -1 but got ${i} for the slice() size at index ${o}.`),n.shape[o]-s[o])),[s,a]}function d3(n,e,t,s,r,a,i,o,l){let c;if(s==null?(c=new Array(e.length),c.fill(1)):c=s,i!=null&&(i&i-1)!==0)throw new Error("Multiple ellipses in slice is not allowed.");let f=!1;const d={dims:c.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:t.slice(),strides:c.slice(),beginMask:r,endMask:a,ellipsisMask:i,newAxisMask:o,shrinkAxisMask:l};for(let I=0;I<d.dims;I++)f&&(1<<I&o)!==0&&d.numAddAxisAfterEllipsis++,1<<I&i&&(f=!0);f||(d.ellipsisMask|=1<<d.dims,d.dims++);const m={dims:n.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};JG(d,m);let g=!0,b=!0,x=!0;const v=[],w=[];for(let I=0;I<n.length;++I){if(m.strides[I]===0)throw Error(`strides[${I}] must be non-zero`);const A=!!(m.shrinkAxisMask&1<<I),R=n[I];if(R===-1){v.push(A?1:-1);continue}const U=[m.beginMask&1<<I,m.endMask&1<<I],V=[m.strides[I]>0?0:-1,m.strides[I]>0?R:R-1];if(A&&m.strides[I]<=0)throw Error("only stride 1 allowed on non-range indexing.");x=x&&m.strides[I]===1;const P=!!(m.beginMask&1<<I&&m.endMask&1<<I);if(m.beginValid&&m.endValid){if(A){const M=m.begin[I]<0?R+m.begin[I]:m.begin[I];if(m.begin[I]=M,m.end[I]=m.begin[I]+1,M<0||M>=R)throw Error(`slice index ${m.begin[I]} of dimension ${I} out of bounds.`)}else m.begin[I]=II(m.begin[I],0,m.strides[I],R,U,V),m.end[I]=II(m.end[I],1,m.strides[I],R,U,V);const E=m.strides[I]===1&&m.begin[I]===0&&m.end[I]===R;g=g&&E,b=b&&(I===0&&m.strides[I]===1||E)}else g=g&&m.strides[I]===1&&P,b=b&&(I===0&&m.strides[I]===1||P);let D,B=!1;if(m.beginValid&&m.endValid?(D=m.end[I]-m.begin[I],B=!0):A?(D=1,B=!0):P&&R>=0&&(m.strides[I]<0?D=-R:D=R,B=!0),B){let E;D===0||D<0!=m.strides[I]<0?E=0:E=Math.trunc(D/m.strides[I])+(D%m.strides[I]!==0?1:0),v.push(E)}else v.push(-1)}for(let I=0;I<m.finalShapeGatherIndices.length;++I){const A=m.finalShapeGatherIndices[I];A>=0?w.push(v[A]):A===US&&w.push(1)}return{finalShapeSparse:w.filter((I,A)=>m.finalShapeGatherIndices[A]!==US),finalShape:w,isIdentity:g,sliceDim0:b,isSimpleSlice:x,begin:m.begin,end:m.end,strides:m.strides}}function JG(n,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let t=0;e.beginValid=n.begin!=null,e.endValid=n.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let s=0;s<n.dims;s++)if(1<<s&n.ellipsisMask){const r=Math.min(e.dims-(n.dims-s)+1+n.numAddAxisAfterEllipsis,e.dims);for(;t<r;t++)e.begin[t]=0,e.end[t]=0,e.strides[t]=1,e.beginMask|=1<<t,e.endMask|=1<<t,e.finalShapeGatherIndices.push(t),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[t]=s}else if(1<<s&n.newAxisMask)e.finalShapeGatherIndices.push(US),e.finalShapeGatherIndicesSparse.push(-1);else{if(t===e.begin.length)throw Error(`Index out of range using input dim ${t}; input has only ${e.dims} dims, ${e.begin.length}.`);n.begin!=null&&(e.begin[t]=n.begin[s]),n.end!=null&&(e.end[t]=n.end[s]),e.strides[t]=n.strides[s],n.beginMask&1<<s&&(e.beginMask|=1<<t),n.endMask&1<<s&&(e.endMask|=1<<t),n.shrinkAxisMask&1<<s?(e.finalShapeGatherIndices.push(XG),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<t):(e.finalShapeGatherIndices.push(t),e.finalShapeGatherIndicesSparse.push(s)),e.inputShapeGatherIndicesSparse[t]=s,t++}}function II(n,e,t,s,r,a){if(r[e])return t>0?a[e]:a[e+1&1];{const i=n<0?s+n:n;return i<a[0]?a[0]:i>a[1]?a[1]:i}}const BR=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:u3,computeFlatOffset:f3,computeOutShape:c3,getNormalizedAxes:ZG,isSliceContinous:h3,maskToAxes:YG,parseSliceParams:Uv,sliceInfo:d3,startForAxis:zR,startIndicesWithElidedDims:LR,stopForAxis:PR,stopIndicesWithElidedDims:FR,stridesForAxis:MR,stridesWithElidedDims:RR},Symbol.toStringTag,{value:"Module"}));const QG="4.22.0";class UR{static sgd(e){return new Pv(e)}static momentum(e,t,s=!1){return new r3(e,t,s)}static rmsprop(e,t=.9,s=0,r=null,a=!1){return new a3(e,t,s,r,a)}static adam(e=.001,t=.9,s=.999,r=null){return new n3(e,t,s,r)}static adadelta(e=.001,t=.95,s=null){return new e3(e,t,s)}static adamax(e=.002,t=.9,s=.999,r=null,a=0){return new s3(e,t,s,r,a)}static adagrad(e,t=.1){return new t3(e,t)}}const Rf=UR;const eq=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:n=>n();function p3(){return new Promise(n=>eq(()=>n()))}function m3(n,e){const t=n[0].length;n.forEach((r,a)=>{Z(r.length===t,()=>`Error in concat${t}D: rank of tensors[${a}] must be the same as the rank of the rest (${t})`)}),Z(e>=0&&e<t,()=>`Error in concat${t}D: axis must be between 0 and ${t-1}.`);const s=n[0];n.forEach((r,a)=>{for(let i=0;i<t;i++)Z(i===e||r[i]===s[i],()=>`Error in concat${t}D: Shape of tensors[${a}] (${r}) does not match the shape of the rest (${s}) along the non-concatenated axis ${a}.`)})}function vu(n,e){const t=n[0].slice();for(let s=1;s<n.length;s++)t[e]+=n[s][e];return t}var Il;(function(n){n[n.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",n[n.VALUE_ROWIDS=1]="VALUE_ROWIDS",n[n.ROW_LENGTHS=2]="ROW_LENGTHS",n[n.ROW_SPLITS=3]="ROW_SPLITS",n[n.ROW_LIMITS=4]="ROW_LIMITS",n[n.ROW_STARTS=5]="ROW_STARTS"})(Il||(Il={}));function VR(n,e,t){let s=new Array;if(t==null&&e==null)return s;if(e==null)for(;s.length<n+t.length;)s.push(-1);else s=e.slice();if(t==null)return s;if(n+t.length!==s.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${n+t.length}, but shape.rank = ${s.length}`);for(let r=1;r<t.length;++r){const a=t[r],i=s[s.length-t.length+r],o=s[i];if(a>=0)if(o>=0){if(o!==a)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${r+n}] = ${a} but shape[${r+n}] = ${o}`)}else s[i]=a}return s}function jR(n){const e={FIRST_DIM_SIZE:Il.FIRST_DIM_SIZE,VALUE_ROWIDS:Il.VALUE_ROWIDS,ROW_LENGTHS:Il.ROW_LENGTHS,ROW_SPLITS:Il.ROW_SPLITS,ROW_LIMITS:Il.ROW_LIMITS,ROW_STARTS:Il.ROW_STARTS},t=[];for(const s of n)if(s in e)t.push(e[s]);else break;return t}function WR(n){return n.length===0?0:n[0]===Il.FIRST_DIM_SIZE?n.length-1:n.length}function GR(n,e){if(n==null||e==null)return;const t=n.length,s=e.length;if(t>=s)throw new Error(`defaultValue.shape=${n} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${t} must be less than ragged tensor input flatValues.rank = ${s})`);for(let r=0;r<Math.min(t,s-1);++r){const a=n[r],i=e[r+1];if(a>=0&&i>=0&&a!==1&&a!==i)throw new Error(`defaultValue.shape=${n}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${r-n.length}] = ${a} but ragged tensor input.flatValues.shape[${r-n.length}] = ${i}`)}}const g3=30;function Vv(n){return n<=g3?n:db(n,Math.floor(Math.sqrt(n)))}function y3(n,e,t){const s=t*(typeof n=="number"?n:n[0]),r=e*(typeof n=="number"?n:n[1]);return[s,r]}function ly(n,e,t,s=!0){let r=[];if(s)r=r.concat(e.slice(0)),r.push(n[0]/t),r=r.concat(n.slice(1));else{r=r.concat(n[0]);const a=e.length;for(let i=0;i<a;++i)r=r.concat([n[i+1]/e[i],e[i]]);r=r.concat(n.slice(a+1))}return r}function uy(n,e,t=!0){const s=[];if(t){s.push(e);for(let r=e+1;r<n;++r)r<=2*e?(s.push(r),s.push(r-(e+1))):s.push(r)}else{const r=[],a=[];for(let i=1;i<n;++i)i>=e*2+1||i%2===1?a.push(i):r.push(i);s.push(...r),s.push(0),s.push(...a)}return s}function cy(n,e,t,s=!0){const r=[];s?r.push(n[0]/t):r.push(n[0]*t);for(let a=1;a<n.length;++a)a<=e.length?s?r.push(e[a-1]*n[a]):r.push(n[a]/e[a-1]):r.push(n[a]);return r}function b3(n,e){const t=[0];for(let s=0;s<e;++s)t.push(n[s][0]);return t}function x3(n,e,t){const s=n.slice(0,1);for(let r=0;r<t;++r)s.push(n[r+1]-e[r][0]-e[r][1]);return s}const jv=1.7580993408473768,Wv=1.0507009873554805;const v3=.3275911,w3=.254829592,S3=-.284496736,N3=1.421413741,k3=-1.453152027,C3=1.061405429;function wc(n,e){if(n.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${n.length}, imag: ${e.length}.`);const t=new Float32Array(n.length*2);for(let s=0;s<t.length;s+=2)t[s]=n[s/2],t[s+1]=e[s/2];return t}function qR(n){const e=new Float32Array(n.length/2),t=new Float32Array(n.length/2);for(let s=0;s<n.length;s+=2)e[s/2]=n[s],t[s/2]=n[s+1];return{real:e,imag:t}}function HR(n){const e=Math.ceil(n.length/4),t=new Float32Array(e),s=new Float32Array(e);for(let r=0;r<n.length;r+=4)t[Math.floor(r/4)]=n[r],s[Math.floor(r/4)]=n[r+1];return{real:t,imag:s}}function KR(n){const e=Math.floor(n.length/4),t=new Float32Array(e),s=new Float32Array(e);for(let r=2;r<n.length;r+=4)t[Math.floor(r/4)]=n[r],s[Math.floor(r/4)]=n[r+1];return{real:t,imag:s}}function T3(n,e){const t=n[e*2],s=n[e*2+1];return{real:t,imag:s}}function XR(n,e,t,s){n[s*2]=e,n[s*2+1]=t}function YR(n,e){const t=new Float32Array(n/2),s=new Float32Array(n/2);for(let r=0;r<Math.ceil(n/2);r++){const a=(e?2:-2)*Math.PI*(r/n);t[r]=Math.cos(a),s[r]=Math.sin(a)}return{real:t,imag:s}}function ZR(n,e,t){const s=(t?2:-2)*Math.PI*(n/e),r=Math.cos(s),a=Math.sin(s);return{real:r,imag:a}}const F5="->",tq=/->/g,EI=",",_I="...";function A3(n,e){n=n.replace(/\s/g,"");const t=(n.length-n.replace(tq,"").length)/F5.length;if(t<1)throw new Error("Equations without an arrow are not supported.");if(t>1)throw new Error(`Equation must contain exactly one arrow ("${F5}").`);const[s,r]=n.split(F5);Z(s.indexOf(_I)===-1,()=>`The ellipsis notation ("${_I}") is not supported yet.`);const a=s.split(EI),i=a.length;if(e!==i)throw new Error(`Expected ${i} input tensors, received ${e}`);if(i>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const o=[];for(let m=0;m<r.length;++m){const g=r[m];if(!a.some(b=>b.indexOf(g)!==-1))throw new Error(`Output subscripts contain the label ${g} not present in the input subscripts.`);o.indexOf(g)===-1&&o.push(g)}for(let m=0;m<s.length;++m){const g=s[m];o.indexOf(g)===-1&&g!==EI&&o.push(g)}const l=new Array(a.length);for(let m=0;m<i;++m){if(new Set(a[m].split("")).size!==a[m].length)throw new Error(`Found duplicate axes in input component ${a[m]}. Support for duplicate axes in input is not implemented yet.`);l[m]=[];for(let g=0;g<a[m].length;++g)l[m].push(o.indexOf(a[m][g]))}const c=o.length,f=r.length,d=[];for(let m=f;m<c;++m)d.push(m);return{allDims:o,summedDims:d,idDims:l}}function I3(n,e){let t=new Array(n);t.fill(-1);for(let r=0;r<e.length;++r)t[e[r]]=r;const s=[];for(let r=0;r<n;++r)t[r]===-1&&s.push(r);return t=t.filter(r=>r!==-1),{permutationIndices:t,expandDims:s}}function E3(n,e,t){const s=new Array(n);for(let r=0;r<t.length;++r){const a=t[r].shape;for(let i=0;i<e[r].length;++i)s[e[r][i]]===void 0?s[e[r][i]]=a[i]:Z(s[e[r][i]]===a[i],()=>`Expected dimension ${s[e[r][i]]} at axis ${i} of input shaped ${JSON.stringify(a)}, but got dimension ${a[i]}`)}}function _3(n,e){const t=n,s=[];let r=0;n.length===0&&t.push(-1),r=n.length+1;for(let i=0;i<r;++i)s.push([]);const a=[];for(let i=0;i<t.length;++i){const o=t[i],l=nq(e,o);for(const c of l)a.indexOf(c)===-1&&(s[i].push(c),a.push(c))}return{path:t,steps:s}}function $3(n){return n.every((e,t)=>e===t)}function nq(n,e){const t=[];for(let s=0;s<n.length;++s)(n[s].length===0||n[s].indexOf(e)!==-1||e===-1)&&t.push(s);return t}function R3(n,e,t=0){let s=[];if(typeof e=="number")Z(n.shape[t]%e===0,()=>"Number of splits must evenly divide the axis."),s=new Array(e).fill(n.shape[t]/e);else{const r=e.reduce((i,o)=>(o===-1&&(i+=1),i),0);Z(r<=1,()=>"There should be only one negative value in split array.");const a=e.indexOf(-1);if(a!==-1){const i=e.reduce((o,l)=>l>0?o+l:o);e[a]=n.shape[t]-i}Z(n.shape[t]===e.reduce((i,o)=>i+o),()=>"The sum of sizes must match the size of the axis dimension."),s=e}return s}function JR(n){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${n}`}function QR(n,e){return`indices(${n}, 0) is invalid: ${e} < 0`}function eD(n,e,t){return`indices(${n}, 0) is invalid: ${e} >= ${t}`}function tD(n,e){return`only one output dimension may be -1, not both ${n} and ${e}`}function nD(n,e){return`size ${n} must be non-negative, not ${e}`}function sD(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function rD(n,e){const t=Be(n),s=Be(e);return`Input to reshape is a SparseTensor with ${t}
  dense values, but the requested shape requires a multiple of ${s}. inputShape=${n} outputShape= ${e}`}function aD(n,e){const t=Be(n),s=Be(e);return`Input to reshape is a tensor with ${t} dense values, but the requested shape has ${s}. inputShape=${n} outputShape=${e}`}function VS(){return"segment ids must be >= 0"}function iD(){return"segment ids are not increasing"}function oD(n,e){return`Segment id ${n} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function lD(n,e,t){return`Bad: indices[${n}] == ${e} out of range [0, ${t})`}function uD(n,e){let t=!1,s;for(n<=g3?(s=n,t=!0):s=db(n,Math.floor(Math.sqrt(n)));!t;)s>e||s===n?t=!0:s=db(n,s+1);return s}function cD(n,e,t){const s=[],r=n.length;for(let a=0;a<r;a++)a!==e?s.push(n[a]):s.push(t);return s}function D3(n,e,t,s){const r=e.shape.length,a=n.shape.length;if(s!==0&&(s<-r||s>r))throw new Error(`Expect batchDims in the range of [-${r}, ${r}], but got ${s}`);if(s<0&&(s+=r),s>a)throw new Error(`batchDims (${s}) must be less than rank(x) (
    ${a}).`);if(t<s)throw new Error(`batchDims (${s}) must be less than or equal to axis (${t}).`);for(let d=0;d<s;++d)if(n.shape[d]!==e.shape[d])throw new Error(`x.shape[${d}]: ${n.shape[d]} should be equal to indices.shape[${d}]: ${e.shape[d]}.`);const i=n.shape[t],o=[];let l=1,c=1,f=1;for(let d=0;d<s;++d)o.push(n.shape[d]),l*=n.shape[d];for(let d=s;d<t;d++)o.push(n.shape[d]),c*=n.shape[d];for(let d=s;d<r;d++)o.push(e.shape[d]);for(let d=t+1;d<a;d++)o.push(n.shape[d]),f*=n.shape[d];return{batchSize:l,sliceSize:f,outerSize:c,dimSize:i,outputShape:o}}const sq=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:D3,computeOutShape:cD,segOpComputeOptimalWindowSize:uD},Symbol.toStringTag,{value:"Module"}));function Sc(n){try{return n.map(e=>bc(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function hD(n){return n.map(e=>bu(e))}const fD=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:w3,ERF_A2:S3,ERF_A3:N3,ERF_A4:k3,ERF_A5:C3,ERF_P:v3,PARALLELIZE_THRESHOLD:g3,get RowPartitionType(){return Il},SELU_SCALE:Wv,SELU_SCALEALPHA:jv,applyActivation:Ov,assertAndGetBroadcastShape:on,assertAxesAreInnerMostDims:da,assertParamsConsistent:m3,assignToTypedArray:XR,axesAreInnerMostDims:Sk,calculateShapes:Gh,checkEinsumDimSizes:E3,checkPadOnDimRoundingMode:ja,combineLocations:T$,combineRaggedTensorToTensorShapes:VR,complexWithEvenIndex:HR,complexWithOddIndex:KR,computeConv2DInfo:Yr,computeConv3DInfo:Uh,computeDefaultPad:rk,computeDilation2DInfo:G0,computeOptimalWindowSize:Vv,computeOutAndReduceShapes:Zr,computeOutShape:vu,computePool2DInfo:qo,computePool3DInfo:Cc,convertConv2DDataFormat:Tc,decodeEinsumEquation:A3,eitherStridesOrDilationsAreOne:fa,expandShapeToKeepDim:cr,exponent:ZR,exponents:YR,fromStringArrayToUint8:hD,fromUint8ToStringArray:Sc,getAxesPermutation:js,getBroadcastDims:td,getComplexWithIndex:T3,getEinsumComputePath:_3,getEinsumPermutation:I3,getFusedBiasGradient:Dv,getFusedDyActivation:Rv,getImageCenter:y3,getInnerMostAxes:hr,getPermuted:uy,getRaggedRank:WR,getReductionAxes:Nr,getReshaped:ly,getReshapedPermuted:cy,getRowPartitionTypesHelper:jR,getSliceBeginCoords:b3,getSliceSize:x3,getSparseFillEmptyRowsIndicesDenseShapeMismatch:JR,getSparseFillEmptyRowsNegativeIndexErrorMessage:QR,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:eD,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:sD,getSparseReshapeInputOutputMismatchErrorMessage:aD,getSparseReshapeInputOutputMultipleErrorMessage:rD,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:tD,getSparseReshapeNegativeOutputDimErrorMessage:nD,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:lD,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:VS,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:iD,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:oD,getUndoAxesPermutation:Vh,isIdentityPermutation:$3,log:KP,mergeRealAndImagArrays:wc,prepareAndValidate:Bv,prepareSplitSize:R3,segment_util:sq,shouldFuse:Lv,slice_util:BR,splitRealAndImagArrays:qR,stridesOrDilationsArePositive:ed,tupleValuesAreOne:Eh,upcastType:ai,validateDefaultValueShape:GR,validateInput:Av,validateUpdateShape:Wk,warn:io},Symbol.toStringTag,{value:"Module"}));const rq=Object.freeze(Object.defineProperty({__proto__:null,nonMaxSuppressionV3Impl:Fv,nonMaxSuppressionV4Impl:Mv,nonMaxSuppressionV5Impl:zv,whereImpl:_v},Symbol.toStringTag,{value:"Module"}));bG();const aq=Object.freeze(Object.defineProperty({__proto__:null,Abs:B1,Acos:nm,Acosh:sm,AdadeltaOptimizer:e3,AdagradOptimizer:t3,AdamOptimizer:n3,AdamaxOptimizer:s3,Add:gd,AddN:U1,All:Yb,Any:Zb,ArgMax:V1,ArgMin:j1,Asin:rm,Asinh:am,Atan:im,Atan2:lm,Atanh:om,AvgPool:W1,AvgPool3D:G1,AvgPool3DGrad:Qb,AvgPoolGrad:Jb,BatchMatMul:q1,BatchToSpaceND:H1,Bincount:ex,BitwiseAnd:K1,BroadcastArgs:tx,BroadcastTo:V_,Cast:um,Ceil:cm,ClipByValue:hm,Complex:nx,ComplexAbs:X1,Concat:Y1,Conv2D:Z1,Conv2DBackpropFilter:sx,Conv2DBackpropInput:J1,Conv3D:Q1,Conv3DBackpropFilterV2:rx,Conv3DBackpropInputV2:ax,Cos:fm,Cosh:dm,CropAndResize:ox,Cumprod:ix,Cumsum:e0,DataStorage:DN,DenseBincount:lx,DepthToSpace:ux,DepthwiseConv2dNative:t0,DepthwiseConv2dNativeBackpropFilter:cx,DepthwiseConv2dNativeBackpropInput:hx,Diag:fx,Dilation2D:n0,Dilation2DBackpropFilter:mb,Dilation2DBackpropInput:pb,Draw:dx,get ENV(){return zN},Einsum:px,Elu:mm,EluGrad:mx,Environment:B_,Equal:s0,Erf:gm,Exp:ym,ExpandDims:r0,Expm1:bm,FFT:gx,Fill:yx,FlipLeftRight:bx,Floor:xm,FloorDiv:vm,FromPixels:gb,FusedBatchNorm:a0,FusedConv2D:y1,FusedDepthwiseConv2D:b1,GatherNd:xx,GatherV2:i0,Greater:o0,GreaterEqual:wm,IFFT:vx,Identity:Sm,Imag:wx,IsFinite:Nm,IsInf:km,IsNan:Cm,KernelBackend:Hb,LRN:p0,LRNGrad:Nx,LeakyRelu:l0,Less:u0,LessEqual:c0,LinSpace:Sx,Log:Tm,Log1p:Am,LogSoftmax:j_,LogicalAnd:h0,LogicalNot:f0,LogicalOr:d0,LogicalXor:jP,LowerBound:WP,MatrixBandPart:GP,Max:m0,MaxPool:g0,MaxPool3D:y0,MaxPool3DGrad:Cx,MaxPoolGrad:kx,MaxPoolWithArgmax:Tx,Maximum:Im,Mean:b0,Min:x0,Minimum:Em,MirrorPad:v0,Mod:_m,MomentumOptimizer:r3,Multinomial:Ax,Multiply:$m,Neg:w0,NonMaxSuppressionV3:Ix,NonMaxSuppressionV4:Ex,NonMaxSuppressionV5:_x,NotEqual:S0,OP_SCOPE_SUFFIX:WN,OneHot:k0,OnesLike:N0,Optimizer:$c,OptimizerConstructors:UR,Pack:C0,PadV2:T0,Pool:qP,Pow:Rm,Prelu:A0,Prod:I0,RMSPropOptimizer:a3,RaggedGather:$x,RaggedRange:Rx,RaggedTensorToTensor:Dx,Range:Ox,get Rank(){return kS},Real:Lx,RealDiv:pm,Reciprocal:Dm,get Reduction(){return Ba},Relu:Om,Relu6:Lm,Reshape:E0,ResizeBilinear:$0,ResizeBilinearGrad:Mx,ResizeNearestNeighbor:_0,ResizeNearestNeighborGrad:Fx,Reverse:R0,RotateWithOffset:ev,Round:Fm,Rsqrt:Mm,SGDOptimizer:Pv,ScatterNd:zx,SearchSorted:Bx,Select:D0,Selu:zm,Sigmoid:Vm,Sign:Um,Sin:Pm,Sinh:Bm,Slice:O0,Softmax:z0,Softplus:jm,SpaceToBatchND:F0,SparseFillEmptyRows:Ux,SparseReshape:Vx,SparseSegmentMean:jx,SparseSegmentSum:Wx,SparseToDense:Gx,SplitV:M0,Sqrt:Wm,Square:qx,SquaredDifference:Gm,StaticRegexReplace:P0,Step:Ym,StridedSlice:Hx,StringNGrams:Kx,StringSplit:Xx,StringToHashBucketFast:Yx,Sub:qm,Sum:L0,Tan:Hm,Tanh:Km,Tensor:Kn,TensorBuffer:Sr,TensorScatterUpdate:Px,Tile:Xm,TopK:Zx,Transform:Jx,Transpose:Wf,Unique:Qx,Unpack:B0,UnsortedSegmentSum:U0,UpperBound:HP,Variable:w1,ZerosLike:V0,_FusedMatMul:g1,abs:br,acos:YN,acosh:ZN,add:et,addN:x$,all:rv,any:N1,argMax:Qf,argMin:JN,asin:QN,asinh:ek,atan:tk,atan2:nk,atanh:sk,avgPool:q0,avgPool3d:ak,backend:qN,backend_util:fD,basicLSTMCell:v$,batchNorm:Zm,batchNorm2d:ik,batchNorm3d:ok,batchNorm4d:lk,batchToSpaceND:H0,bincount:uk,bitwiseAnd:w$,booleanMaskAsync:aR,broadcastArgs:S$,broadcastTo:Gf,broadcast_util:AU,browser:HG,buffer:mn,cast:lt,ceil:ck,clipByValue:oi,clone:xu,complex:xc,concat:ur,concat1d:hk,concat2d:fk,concat3d:dk,concat4d:pk,conv1d:av,conv2d:vc,conv2dTranspose:iv,conv3d:gk,conv3dTranspose:yk,copyRegisteredKernels:ZP,cos:K0,cosh:ov,cosineWindow:$v,cumprod:T1,cumsum:lv,customGrad:Tu,denseBincount:bb,deprecationWarn:_B,depthToSpace:bk,depthwiseConv2d:Jm,device_util:kB,diag:k$,dilation2d:xk,disableDeprecationWarnings:EB,dispose:xn,disposeVariables:$B,div:$t,divNoNan:vk,dot:wk,dropout:Xk,einsum:Lf,elu:Qm,enableDebugMode:IB,enableProdMode:AB,enclosingPowerOfTwo:Yk,engine:Tl,ensureShape:C$,env:De,equal:Wo,erf:uv,euclideanNorm:Nk,exp:li,expandDims:Ca,expm1:kk,eye:cv,fft:iy,fill:yd,findBackend:MB,findBackendFactory:zB,floor:tg,floorDiv:sv,fused:pR,gather:ng,gatherND:uR,gather_util:KG,getBackend:r$,getGradient:SS,getKernel:v1,getKernelsForBackend:yb,grad:cV,grads:hV,greater:hi,greaterEqual:Ac,ifft:Hp,imag:X0,image:Bo,inTopKAsync:cR,io:l3,irfft:Cv,isFinite:Ck,isInf:Tk,isNaN:Ak,keep:_r,kernel_impls:rq,leakyRelu:Y0,less:jp,lessEqual:jh,linalg:Qk,linspace:I$,localResponseNormalization:Ik,log:Li,log1p:Z0,logSigmoid:Ek,logSoftmax:fv,logSumExp:J0,logicalAnd:Dl,logicalNot:Q0,logicalOr:dv,logicalXor:_k,losses:wR,lowerBound:_$,matMul:bn,math:zG,max:fo,maxPool:ey,maxPool3d:$k,maxPoolWithArgmax:$$,maximum:_u,mean:Bs,memory:_S,meshgrid:R$,min:Vp,minimum:$h,mirrorPad:Rk,mod:Dk,moments:ty,movingAverage:iR,mul:xe,multiRNNCell:D$,multinomial:O$,neg:ws,nextFrame:p3,norm:eg,notEqual:nd,oneHot:Wp,ones:si,onesLike:Fi,op:ge,outerProduct:L$,pad:Ic,pad1d:F$,pad2d:M$,pad3d:z$,pad4d:P$,pool:Ok,pow:Cu,prelu:sy,print:XN,prod:Lk,profile:RB,raggedGather:B$,raggedRange:U$,raggedTensorToTensor:V$,rand:j$,randomGamma:q$,randomNormal:gv,randomStandardNormal:H$,randomUniform:Wh,randomUniformInt:K$,range:sd,ready:LB,real:Gp,reciprocal:Pk,registerBackend:GN,registerGradient:W_,registerKernel:tv,relu:Bl,relu6:yv,removeBackend:FB,reshape:we,reverse:po,reverse1d:X$,reverse2d:Y$,reverse3d:Z$,reverse4d:J$,rfft:oy,round:bv,rsqrt:xv,scalar:Mt,scatterND:oR,scatter_util:mj,searchSorted:pv,selu:vv,separableConv2d:wv,serialization:gG,setBackend:OB,setPlatform:PB,setdiff1dAsync:Q$,sigmoid:_l,sign:Bk,signal:vR,sin:Sv,sinh:Nv,slice:Tn,slice1d:ry,slice2d:kv,slice3d:ay,slice4d:qp,slice_util:BR,softmax:sg,softplus:bd,spaceToBatchND:ny,sparse:SR,sparseToDense:lR,spectral:xR,split:ri,sqrt:Xr,square:is,squaredDifference:Tv,squeeze:Ec,stack:ui,step:xd,stridedSlice:Uk,string:NR,sub:mt,sum:St,sumOutType:nv,tan:Vk,tanh:_h,tensor:jo,tensor1d:Ta,tensor2d:Rp,tensor3d:jk,tensor4d:eR,tensor5d:tR,tensor6d:nR,tensorScatterUpdate:sR,tensor_util:xB,test_util:I9,tidy:_e,tile:lo,time:DB,topk:Gk,train:Rf,transpose:An,truncatedNormal:Iv,unique:qk,unregisterGradient:YP,unregisterKernel:XP,unsortedSegmentSum:Ev,unstack:mo,upcastType:ai,upperBound:rR,util:iB,valueAndGrad:fV,valueAndGrads:dV,variable:Hk,variableGrads:E$,version_core:QG,where:ua,whereAsync:Kk,zeros:lr,zerosLike:$n},Symbol.toStringTag,{value:"Module"}));const iq=De();iq.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,n=>{n&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});var Ri;(function(n){n[n.DT_INVALID=0]="DT_INVALID",n[n.DT_FLOAT=1]="DT_FLOAT",n[n.DT_DOUBLE=2]="DT_DOUBLE",n[n.DT_INT32=3]="DT_INT32",n[n.DT_UINT8=4]="DT_UINT8",n[n.DT_INT16=5]="DT_INT16",n[n.DT_INT8=6]="DT_INT8",n[n.DT_STRING=7]="DT_STRING",n[n.DT_COMPLEX64=8]="DT_COMPLEX64",n[n.DT_INT64=9]="DT_INT64",n[n.DT_BOOL=10]="DT_BOOL",n[n.DT_QINT8=11]="DT_QINT8",n[n.DT_QUINT8=12]="DT_QUINT8",n[n.DT_QINT32=13]="DT_QINT32",n[n.DT_BFLOAT16=14]="DT_BFLOAT16",n[n.DT_QINT16=15]="DT_QINT16",n[n.DT_QUINT16=16]="DT_QUINT16",n[n.DT_UINT16=17]="DT_UINT16",n[n.DT_COMPLEX128=18]="DT_COMPLEX128",n[n.DT_HALF=19]="DT_HALF",n[n.DT_RESOURCE=20]="DT_RESOURCE",n[n.DT_VARIANT=21]="DT_VARIANT",n[n.DT_UINT32=22]="DT_UINT32",n[n.DT_UINT64=23]="DT_UINT64",n[n.DT_FLOAT_REF=101]="DT_FLOAT_REF",n[n.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",n[n.DT_INT32_REF=103]="DT_INT32_REF",n[n.DT_UINT8_REF=104]="DT_UINT8_REF",n[n.DT_INT16_REF=105]="DT_INT16_REF",n[n.DT_INT8_REF=106]="DT_INT8_REF",n[n.DT_STRING_REF=107]="DT_STRING_REF",n[n.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",n[n.DT_INT64_REF=109]="DT_INT64_REF",n[n.DT_BOOL_REF=110]="DT_BOOL_REF",n[n.DT_QINT8_REF=111]="DT_QINT8_REF",n[n.DT_QUINT8_REF=112]="DT_QUINT8_REF",n[n.DT_QINT32_REF=113]="DT_QINT32_REF",n[n.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",n[n.DT_QINT16_REF=115]="DT_QINT16_REF",n[n.DT_QUINT16_REF=116]="DT_QUINT16_REF",n[n.DT_UINT16_REF=117]="DT_UINT16_REF",n[n.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",n[n.DT_HALF_REF=119]="DT_HALF_REF",n[n.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",n[n.DT_VARIANT_REF=121]="DT_VARIANT_REF",n[n.DT_UINT32_REF=122]="DT_UINT32_REF",n[n.DT_UINT64_REF=123]="DT_UINT64_REF"})(Ri||(Ri={}));var $I;(function(n){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(n.CheckpointFormatVersion||(n.CheckpointFormatVersion={}))})($I||($I={}));const oq={};function dD(n){return oq[n]}function L(n,e,t,s,r){const a=e.inputParams[n];if(a&&a.inputIndexStart!==void 0){const o=a.inputIndexStart,l=a.inputIndexEnd===0?void 0:a.inputIndexEnd===void 0?o+1:a.inputIndexEnd,c=o<0?e.inputNames.length+o:o;if(a.type==="tensor")return oa(e.inputNames[c],t,s,r);if(a.type==="tensors"){const m=e.inputs.slice(o,l);return e.inputNames.slice(o,l).filter((b,x)=>{var v;return((v=m[x])===null||v===void 0?void 0:v.op)!=="NoOp"}).map(b=>oa(b,t,s,r))}const f=oa(e.inputNames[c],t,s,r),d=f.dataSync();return a.type==="number"?d[0]:ho(f.shape,d)}const i=e.attrParams[n];return i&&i.value}function oa(n,e,t,s){const[r,a]=Di(n,t);if(s!=null){const o=s.getHashTableHandleByName(r);if(o!=null)return o}const i=t.currentContextIds.find(o=>!!e[xb(r,o)]);return i!==void 0?e[xb(r,i)][a]:void 0}function RI(n,e,t){return e[xb(n,t.currentContextId)]}function uc(n,e){const[t,s,r]=Di(n,e);return[xb(t,e&&e.currentContextId),s,r]}function xb(n,e){return e?`${n}-${e}`:n}function Di(n,e){if(n==="")return["",0,void 0];const t=e!=null&&e.parseNodeNameCache!=null;if(t){const a=e.parseNodeNameCache.get(n);if(a!=null)return a}const s=n.split(":");let r;if(s.length===1)r=[n,0,void 0];else{const a=s[0],i=s.length===3?s[1]:void 0,o=Number(s[s.length-1]);r=[a,o,i]}return t&&e.parseNodeNameCache.set(n,r),r}function eb(n,e,t){let s=L("pad",n,e,t);if(s==="explicit"){s=L("explicitPaddings",n,e,t);const r=[[0,0],[0,0],[0,0],[0,0]];for(let a=0;a<4;a++)r[a][0]=s[a*2],r[a][1]=s[a*2+1];return r}return s}function cc(n){return n.kept?n:xu(n)}const lq=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],uq=Object.freeze(Object.defineProperty({__proto__:null,json:lq},Symbol.toStringTag,{value:"Module"}));const cq=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],hq=Object.freeze(Object.defineProperty({__proto__:null,json:cq},Symbol.toStringTag,{value:"Module"}));const fq=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],dq=Object.freeze(Object.defineProperty({__proto__:null,json:fq},Symbol.toStringTag,{value:"Module"}));const pq=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],mq=Object.freeze(Object.defineProperty({__proto__:null,json:pq},Symbol.toStringTag,{value:"Module"}));const gq=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],yq=Object.freeze(Object.defineProperty({__proto__:null,json:gq},Symbol.toStringTag,{value:"Module"}));const bq=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],xq=Object.freeze(Object.defineProperty({__proto__:null,json:bq},Symbol.toStringTag,{value:"Module"}));const vq=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],wq=Object.freeze(Object.defineProperty({__proto__:null,json:vq},Symbol.toStringTag,{value:"Module"}));const Sq=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],Nq=Object.freeze(Object.defineProperty({__proto__:null,json:Sq},Symbol.toStringTag,{value:"Module"}));const kq=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],Cq=Object.freeze(Object.defineProperty({__proto__:null,json:kq},Symbol.toStringTag,{value:"Module"}));const Tq=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],Aq=Object.freeze(Object.defineProperty({__proto__:null,json:Tq},Symbol.toStringTag,{value:"Module"}));const Iq=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}],Eq=Object.freeze(Object.defineProperty({__proto__:null,json:Iq},Symbol.toStringTag,{value:"Module"}));const _q=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}],$q=Object.freeze(Object.defineProperty({__proto__:null,json:_q},Symbol.toStringTag,{value:"Module"}));const Rq=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}],Dq=Object.freeze(Object.defineProperty({__proto__:null,json:Rq},Symbol.toStringTag,{value:"Module"}));const Oq=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],Lq=Object.freeze(Object.defineProperty({__proto__:null,json:Oq},Symbol.toStringTag,{value:"Module"}));const Fq=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],Mq=Object.freeze(Object.defineProperty({__proto__:null,json:Fq},Symbol.toStringTag,{value:"Module"}));const zq=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],Pq=Object.freeze(Object.defineProperty({__proto__:null,json:zq},Symbol.toStringTag,{value:"Module"}));const Bq=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],Uq=Object.freeze(Object.defineProperty({__proto__:null,json:Bq},Symbol.toStringTag,{value:"Module"}));const Vq=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],jq=Object.freeze(Object.defineProperty({__proto__:null,json:Vq},Symbol.toStringTag,{value:"Module"}));const Wq=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],Gq=Object.freeze(Object.defineProperty({__proto__:null,json:Wq},Symbol.toStringTag,{value:"Module"}));class DI{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const e=[uq,hq,dq,mq,yq,xq,wq,Nq,Cq,Aq,Eq,$q,Dq,Lq,Mq,Pq,Uq,jq,Gq],t=[].concat(...e.map(s=>s.json));this.opMappers=t.reduce((s,r)=>(s[r.tfOpName]=r,s),{})}transformGraph(e,t={}){const s=e.node,r=[],a=[],i=[],o=s.reduce((x,v)=>(x[v.name]=this.mapNode(v),v.op.startsWith("Placeholder")?r.push(x[v.name]):v.op==="Const"?a.push(x[v.name]):(v.input==null||v.input.length===0)&&i.push(x[v.name]),x),{});let l=[];const c=[];let f={},d={};t!=null&&(f=this.mapSignatureEntries(t.inputs),d=this.mapSignatureEntries(t.outputs));const m=Object.keys(o);m.forEach(x=>{const v=o[x];v.inputNames.forEach((w,k)=>{const[I,,A]=uc(w),R=o[I];if(R.outputs!=null){const U=R.outputs.indexOf(A);if(U!==-1){const V=`${I}:${U}`;v.inputNames[k]=V}}v.inputs.push(R),R.children.push(v)})}),Object.keys(d).length===0?m.forEach(x=>{const v=o[x];v.children.length===0&&c.push(v)}):Object.keys(d).forEach(x=>{const[v]=uc(x),w=o[v];w!=null&&(w.signatureKey=d[x],c.push(w))}),Object.keys(f).length>0?Object.keys(f).forEach(x=>{const[v]=uc(x),w=o[v];w&&(w.signatureKey=f[x],l.push(w))}):l=r;let g={};e.library!=null&&e.library.function!=null&&(g=e.library.function.reduce((x,v)=>(x[v.signature.name]=this.mapFunction(v),x),{}));const b={nodes:o,inputs:l,outputs:c,weights:a,placeholders:r,signature:t,functions:g};return i.length>0&&(b.initNodes=i),b}mapSignatureEntries(e){return Object.keys(e||{}).reduce((t,s)=>(t[e[s].name]=s,t),{})}mapNode(e){const t=dD(e.op)||this.opMappers[e.op]||{};e.attr==null&&(e.attr={});const s={name:e.name,op:e.op,category:t.category,inputNames:(e.input||[]).map(r=>r.startsWith("^")?r.slice(1):r),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:t.outputs};return t.inputs!=null&&(s.inputParams=t.inputs.reduce((r,a)=>(r[a.name]={type:a.type,inputIndexStart:a.start,inputIndexEnd:a.end},r),{})),t.attrs!=null&&(s.attrParams=t.attrs.reduce((r,a)=>{const i=a.type;let o;switch(a.type){case"string":o=jS(e.attr,a.tfName,a.defaultValue),o===void 0&&a.tfDeprecatedName&&(o=jS(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"string[]":o=YS(e.attr,a.tfName,a.defaultValue),o===void 0&&a.tfDeprecatedName&&(o=YS(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"number":o=GS(e.attr,a.tfName,a.defaultValue||0),o===void 0&&a.tfDeprecatedName&&(o=GS(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"number[]":o=XS(e.attr,a.tfName,a.defaultValue),o===void 0&&a.tfDeprecatedName&&(o=XS(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"bool":o=WS(e.attr,a.tfName,a.defaultValue),o===void 0&&a.tfDeprecatedName&&(o=WS(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"bool[]":o=JS(e.attr,a.tfName,a.defaultValue),o===void 0&&a.tfDeprecatedName&&(o=JS(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"shape":o=KS(e.attr,a.tfName,a.defaultValue),o===void 0&&a.tfDeprecatedName&&(o=KS(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"shape[]":o=ZS(e.attr,a.tfName,a.defaultValue),o===void 0&&a.tfDeprecatedName&&(o=ZS(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"dtype":o=qS(e.attr,a.tfName,a.defaultValue),o===void 0&&a.tfDeprecatedName&&(o=qS(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"dtype[]":o=HS(e.attr,a.tfName,a.defaultValue),o===void 0&&a.tfDeprecatedName&&(o=HS(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"func":o=OI(e.attr,a.tfName,a.defaultValue),o===void 0&&a.tfDeprecatedName&&(o=OI(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${a.type} for op: ${e.op}`)}return r[a.name]={value:o,type:i},r},{})),s}mapFunction(e){const t=e.nodeDef,s=[],r=[];let a={};t!=null&&(a=t.reduce((d,m)=>(d[m.name]=this.mapNode(m),m.op==="Const"&&r.push(d[m.name]),d),{}));const i=[],o=[];e.signature.inputArg.forEach(d=>{const[m]=uc(d.name),g={name:m,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:O3(d.type),type:"dtype"}},children:[]};g.signatureKey=d.name,i.push(g),a[m]=g}),Object.keys(a).forEach(d=>{const m=a[d];m.inputNames.forEach((g,b)=>{const[x,,v]=uc(g),w=a[x];if(w.outputs!=null){const k=w.outputs.indexOf(v);if(k!==-1){const I=`${x}:${k}`;m.inputNames[b]=I}}m.inputs.push(w),w.children.push(m)})});const c=e.ret;e.signature.outputArg.forEach(d=>{const[m,g]=uc(c[d.name]),b=a[m];b!=null&&(b.defaultOutput=g,o.push(b))});const f=this.mapArgsToSignature(e);return{nodes:a,inputs:i,outputs:o,weights:r,placeholders:s,signature:f}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((t,s)=>(t[s.name]=this.mapArgToTensorInfo(s),t),{}),outputs:e.signature.outputArg.reduce((t,s)=>(t[s.name]=this.mapArgToTensorInfo(s,e.ret),t),{})}}mapArgToTensorInfo(e,t){let s=e.name;return t!=null&&(s=t[s]),{name:s,dtype:e.type}}}function qq(n){const e=De().global;if(typeof e.atob<"u")return e.atob(n);if(typeof Buffer<"u")return new Buffer(n,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function pD(n,e){const t=Array.isArray(n)?String.fromCharCode.apply(null,n):qq(n);return e?t:t.toLowerCase()}function jS(n,e,t,s=!1){const r=n[e];return r!=null?pD(r.s,s):t}function WS(n,e,t){const s=n[e];return s?s.b:t}function GS(n,e,t){const s=n[e]||{},r=s.i!=null?s.i:s.f!=null?s.f:t;return typeof r=="number"?r:parseInt(r,10)}function O3(n){switch(typeof n=="string"&&(n=Ri[n]),n){case Ri.DT_FLOAT:case Ri.DT_HALF:return"float32";case Ri.DT_INT32:case Ri.DT_INT64:case Ri.DT_INT8:case Ri.DT_UINT8:return"int32";case Ri.DT_BOOL:return"bool";case Ri.DT_DOUBLE:return"float32";case Ri.DT_STRING:return"string";case Ri.DT_COMPLEX64:case Ri.DT_COMPLEX128:return"complex64";default:return null}}function OI(n,e,t){const s=n[e];return s&&s.func?s.func.name:t}function qS(n,e,t){const s=n[e];return s&&s.type?O3(s.type):t}function HS(n,e,t){const s=n[e];return s&&s.list&&s.list.type?s.list.type.map(r=>O3(r)):t}function mD(n){if(!n.unknownRank)return n.dim!=null?n.dim.map(e=>typeof e.size=="number"?e.size:parseInt(e.size,10)):[]}function KS(n,e,t){const s=n[e];return s&&s.shape?mD(s.shape):t}function XS(n,e,t){const s=n[e];return s?((s.list.f&&s.list.f.length?s.list.f:s.list.i)||[]).map(r=>typeof r=="number"?r:parseInt(r,10)):t}function YS(n,e,t,s=!1){const r=n[e];return r&&r.list&&r.list.s?r.list.s.map(a=>pD(a,s)):t}function ZS(n,e,t){const s=n[e];return s&&s.list&&s.list.shape?s.list.shape.map(r=>mD(r)):t}function JS(n,e,t){const s=n[e];return s&&s.list&&s.list.b?s.list.b:t}class Hq{constructor(e,t,s){this.node=e,this.tensorMap=t,this.context=s,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map(r=>this.getInput(r)),e.rawAttrs!=null&&(this.attrs=Object.keys(e.rawAttrs).reduce((r,a)=>(r[a]=this.getAttr(a),r),{}))}getInput(e){return oa(e,this.tensorMap,this.context)}getAttr(e,t){const s=this.node.rawAttrs[e];if(s.tensor!=null)return oa(e,this.tensorMap,this.context);if(s.i!=null||s.f!=null)return GS(this.node.rawAttrs,e,t);if(s.s!=null)return jS(this.node.rawAttrs,e,t);if(s.b!=null)return WS(this.node.rawAttrs,e,t);if(s.shape!=null)return KS(this.node.rawAttrs,e,t);if(s.type!=null)return qS(this.node.rawAttrs,e,t);if(s.list!=null){if(s.list.i!=null||s.list.f!=null)return XS(this.node.rawAttrs,e,t);if(s.list.s!=null)return YS(this.node.rawAttrs,e,t);if(s.list.shape!=null)return ZS(this.node.rawAttrs,e,t);if(s.list.b!=null)return JS(this.node.rawAttrs,e,t);if(s.list.type!=null)return HS(this.node.rawAttrs,e,t)}return t}}const pa=Object.freeze(Object.defineProperty({__proto__:null,OP_SCOPE_SUFFIX:WN,abs:br,acos:YN,acosh:ZN,add:et,addN:x$,all:rv,any:N1,argMax:Qf,argMin:JN,asin:QN,asinh:ek,atan:tk,atan2:nk,atanh:sk,avgPool:q0,avgPool3d:ak,basicLSTMCell:v$,batchNorm:Zm,batchNorm2d:ik,batchNorm3d:ok,batchNorm4d:lk,batchToSpaceND:H0,bincount:uk,bitwiseAnd:w$,booleanMaskAsync:aR,broadcastArgs:S$,broadcastTo:Gf,buffer:mn,cast:lt,ceil:ck,clipByValue:oi,clone:xu,complex:xc,concat:ur,concat1d:hk,concat2d:fk,concat3d:dk,concat4d:pk,conv1d:av,conv2d:vc,conv2dTranspose:iv,conv3d:gk,conv3dTranspose:yk,cos:K0,cosh:ov,cosineWindow:$v,cumprod:T1,cumsum:lv,denseBincount:bb,depthToSpace:bk,depthwiseConv2d:Jm,diag:k$,dilation2d:xk,div:$t,divNoNan:vk,dot:wk,dropout:Xk,einsum:Lf,elu:Qm,enclosingPowerOfTwo:Yk,ensureShape:C$,equal:Wo,erf:uv,euclideanNorm:Nk,exp:li,expandDims:Ca,expm1:kk,eye:cv,fft:iy,fill:yd,floor:tg,floorDiv:sv,fused:pR,gather:ng,gatherND:uR,greater:hi,greaterEqual:Ac,ifft:Hp,imag:X0,image:Bo,inTopKAsync:cR,irfft:Cv,isFinite:Ck,isInf:Tk,isNaN:Ak,leakyRelu:Y0,less:jp,lessEqual:jh,linalg:Qk,linspace:I$,localResponseNormalization:Ik,log:Li,log1p:Z0,logSigmoid:Ek,logSoftmax:fv,logSumExp:J0,logicalAnd:Dl,logicalNot:Q0,logicalOr:dv,logicalXor:_k,losses:wR,lowerBound:_$,matMul:bn,max:fo,maxPool:ey,maxPool3d:$k,maxPoolWithArgmax:$$,maximum:_u,mean:Bs,meshgrid:R$,min:Vp,minimum:$h,mirrorPad:Rk,mod:Dk,moments:ty,movingAverage:iR,mul:xe,multiRNNCell:D$,multinomial:O$,neg:ws,norm:eg,notEqual:nd,oneHot:Wp,ones:si,onesLike:Fi,op:ge,outerProduct:L$,pad:Ic,pad1d:F$,pad2d:M$,pad3d:z$,pad4d:P$,pool:Ok,pow:Cu,prelu:sy,print:XN,prod:Lk,raggedGather:B$,raggedRange:U$,raggedTensorToTensor:V$,rand:j$,randomGamma:q$,randomNormal:gv,randomStandardNormal:H$,randomUniform:Wh,randomUniformInt:K$,range:sd,real:Gp,reciprocal:Pk,relu:Bl,relu6:yv,reshape:we,reverse:po,reverse1d:X$,reverse2d:Y$,reverse3d:Z$,reverse4d:J$,rfft:oy,round:bv,rsqrt:xv,scalar:Mt,scatterND:oR,searchSorted:pv,selu:vv,separableConv2d:wv,setdiff1dAsync:Q$,sigmoid:_l,sign:Bk,signal:vR,sin:Sv,sinh:Nv,slice:Tn,slice1d:ry,slice2d:kv,slice3d:ay,slice4d:qp,softmax:sg,softplus:bd,spaceToBatchND:ny,sparse:SR,sparseToDense:lR,spectral:xR,split:ri,sqrt:Xr,square:is,squaredDifference:Tv,squeeze:Ec,stack:ui,step:xd,stridedSlice:Uk,string:NR,sub:mt,sum:St,tan:Vk,tanh:_h,tensor:jo,tensor1d:Ta,tensor2d:Rp,tensor3d:jk,tensor4d:eR,tensor5d:tR,tensor6d:nR,tensorScatterUpdate:sR,tile:lo,topk:Gk,transpose:An,truncatedNormal:Iv,unique:qk,unsortedSegmentSum:Ev,unstack:mo,upperBound:rR,variable:Hk,where:ua,whereAsync:Kk,zeros:lr,zerosLike:$n},Symbol.toStringTag,{value:"Module"}));const Kq=(n,e,t,s=pa)=>{switch(n.op){case"BiasAdd":case"AddV2":case"Add":return[s.add(L("a",n,e,t),L("b",n,e,t))];case"AddN":return[s.addN(L("tensors",n,e,t))];case"FloorMod":case"Mod":return[s.mod(L("a",n,e,t),L("b",n,e,t))];case"Mul":return[s.mul(L("a",n,e,t),L("b",n,e,t))];case"RealDiv":case"Div":return[s.div(L("a",n,e,t),L("b",n,e,t))];case"DivNoNan":return[s.divNoNan(L("a",n,e,t),L("b",n,e,t))];case"FloorDiv":return[s.floorDiv(L("a",n,e,t),L("b",n,e,t))];case"Sub":return[s.sub(L("a",n,e,t),L("b",n,e,t))];case"Minimum":return[s.minimum(L("a",n,e,t),L("b",n,e,t))];case"Maximum":return[s.maximum(L("a",n,e,t),L("b",n,e,t))];case"Pow":return[s.pow(L("a",n,e,t),L("b",n,e,t))];case"SquaredDifference":return[s.squaredDifference(L("a",n,e,t),L("b",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};const Xq=(n,e,t,s=pa)=>{switch(n.op){case"Abs":case"ComplexAbs":return[s.abs(L("x",n,e,t))];case"Acos":return[s.acos(L("x",n,e,t))];case"Acosh":return[s.acosh(L("x",n,e,t))];case"Asin":return[s.asin(L("x",n,e,t))];case"Asinh":return[s.asinh(L("x",n,e,t))];case"Atan":return[s.atan(L("x",n,e,t))];case"Atan2":return[s.atan2(L("x",n,e,t),L("y",n,e,t))];case"Atanh":return[s.atanh(L("x",n,e,t))];case"Ceil":return[s.ceil(L("x",n,e,t))];case"Complex":return[s.complex(L("real",n,e,t),L("imag",n,e,t))];case"Cos":return[s.cos(L("x",n,e,t))];case"Cosh":return[s.cosh(L("x",n,e,t))];case"Elu":return[s.elu(L("x",n,e,t))];case"Erf":return[s.erf(L("x",n,e,t))];case"Exp":return[s.exp(L("x",n,e,t))];case"Expm1":return[s.expm1(L("x",n,e,t))];case"Floor":return[s.floor(L("x",n,e,t))];case"Log":return[s.log(L("x",n,e,t))];case"Log1p":return[s.log1p(L("x",n,e,t))];case"Imag":return[s.imag(L("x",n,e,t))];case"Neg":return[s.neg(L("x",n,e,t))];case"Reciprocal":return[s.reciprocal(L("x",n,e,t))];case"Real":return[s.real(L("x",n,e,t))];case"Relu":return[s.relu(L("x",n,e,t))];case"Round":return[s.round(L("x",n,e,t))];case"Selu":return[s.selu(L("x",n,e,t))];case"Sigmoid":return[s.sigmoid(L("x",n,e,t))];case"Sin":return[s.sin(L("x",n,e,t))];case"Sign":return[s.sign(L("x",n,e,t))];case"Sinh":return[s.sinh(L("x",n,e,t))];case"Softplus":return[s.softplus(L("x",n,e,t))];case"Sqrt":return[s.sqrt(L("x",n,e,t))];case"Square":return[s.square(L("x",n,e,t))];case"Tanh":return[s.tanh(L("x",n,e,t))];case"Tan":return[s.tan(L("x",n,e,t))];case"ClipByValue":return[s.clipByValue(L("x",n,e,t),L("clipValueMin",n,e,t),L("clipValueMax",n,e,t))];case"Relu6":return[s.relu6(L("x",n,e,t))];case"Rsqrt":return[s.rsqrt(oa(n.inputNames[0],e,t))];case"LeakyRelu":return[s.leakyRelu(L("x",n,e,t),L("alpha",n,e,t))];case"Prelu":return[s.prelu(L("x",n,e,t),L("alpha",n,e,t))];case"IsNan":return[s.isNaN(oa(n.inputNames[0],e,t))];case"IsInf":return[s.isInf(oa(n.inputNames[0],e,t))];case"IsFinite":return[s.isFinite(oa(n.inputNames[0],e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};function Po(n,e,t=""){if(!(typeof n=="number"||typeof e=="number")){Z(n.length===e.length,()=>t+` Shapes ${n} and ${e} must match`);for(let s=0;s<n.length;s++){const r=n[s],a=e[s];Z(r<0||a<0||r===a,()=>t+` Shapes ${n} and ${e} must match`)}}}function LI(n){return!(typeof n=="number"||n.some(e=>e<0))}function e1(n,e,t){let s=QS(n,t);const r=!LI(s);if(r&&e.length===0)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${s}`);if(r&&e.forEach(a=>{s=QS(a.shape,s)}),!LI(s))throw new Error(`Non-fully-defined elementShape: ${s}`);return s}function QS(n,e){if(typeof n=="number")return e;if(typeof e=="number")return n;if(n.length!==e.length)throw new Error(`Incompatible ranks during merge: ${n} vs. ${e}`);const t=[];for(let s=0;s<n.length;++s){const r=n[s],a=e[s];if(r>=0&&a>=0&&r!==a)throw new Error(`Incompatible shape during merge: ${n} vs. ${e}`);t[s]=r>=0?r:a}return t}class Yq{constructor(e,t,s,r,a,i,o){this.name=e,this.dtype=t,this.maxSize=s,this.elementShape=r,this.identicalElementShapes=a,this.dynamicSize=i,this.clearAfterRead=o,this.tensors=[],this.closed_=!1,this.idTensor=Mt(0),_r(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach(t=>{(e==null||!e.has(t.tensor.id))&&t.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||e>=this.size())throw new Error(`Tried to read from index ${e}, but array size is: ${this.size()}`);const t=this.tensors[e];if(t.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${e} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(t.cleared=!0),t.read=!0,t.tensor}readMany(e){return e.map(t=>this.read(t))}write(e,t){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error(`Tried to write to index ${e}, but array is not resizeable and size is: ${this.maxSize}`);const s=this.tensors[e]||{};if(t.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e},
          because the value dtype is ${t.dtype}, but TensorArray dtype is ${this.dtype}.`);if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=t.shape),Po(this.elementShape,t.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${e}.`),s.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been read.`);if(s.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been written.`);s.tensor=t,_r(t),s.written=!0,this.tensors[e]=s}writeMany(e,t){if(e.length!==t.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${e.length} is not the same as tensors size: ${t.length}.`);e.forEach((s,r)=>this.write(s,t[r]))}gather(e,t){if(t&&t!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${t}`);if(e)e=e.slice(0,this.size());else{e=[];for(let r=0;r<this.size();r++)e.push(r)}if(e.length===0)return jo([],[0].concat(this.elementShape));const s=this.readMany(e);return Po(this.elementShape,s[0].shape,"TensorArray shape mismatch: "),ui(s,0)}concat(e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${e}`);if(this.size()===0)return jo([],[0].concat(this.elementShape));const t=[];for(let r=0;r<this.size();r++)t.push(r);const s=this.readMany(t);return Po(this.elementShape,s[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${s[0].shape})`),ur(s,0)}scatter(e,t){if(t.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${t.dtype}`);if(e.length!==t.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${t.shape[0]}`);const s=Math.max(...e);if(!this.dynamicSize&&s>=this.maxSize)throw new Error(`Max index must be < array size (${s}  vs. ${this.maxSize})`);this.writeMany(e,mo(t,0))}split(e,t){if(t.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${t.dtype}`);let s=0;const r=e.map(l=>(s+=l,s));if(s!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${s}, and tensor's shape is: ${t.shape}`);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${e.length}), and the TensorArray is not marked as dynamically resizeable`);const a=s===0?0:t.size/s,i=[];_e(()=>{t=we(t,[1,s,a]);for(let l=0;l<e.length;++l){const f=[0,l===0?0:r[l-1],0],d=[1,e[l],a];i[l]=we(Tn(t,f,d),this.elementShape)}return i});const o=[];for(let l=0;l<e.length;l++)o[l]=l;this.writeMany(o,i)}}class ad{get id(){return this.idTensor.id}constructor(e,t,s,r=-1){this.tensors=e,this.elementShape=t,this.elementDtype=s,e?.forEach(a=>{if(s!==a.dtype)throw new Error(`Invalid data types; op elements ${s}, but list elements ${a.dtype}`);Po(t,a.shape,"TensorList shape mismatch: "),_r(a)}),this.idTensor=Mt(0),this.maxNumElements=r,_r(this.idTensor)}copy(){return new ad([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(e){this.tensors.forEach(t=>{(e==null||!e.has(t.id))&&t.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(e,t,s=-1){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);if(s!==-1&&this.tensors.length!==s)throw new Error(`Operation expected a list with ${s} elements but got a list with ${this.tensors.length} elements.`);Po(e,this.elementShape,"TensorList shape mismatch: ");const r=e1(this.elementShape,this.tensors,e);return _e(()=>{const a=this.tensors.map(i=>we(i,r));return ui(a,0)})}popBack(e,t){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);if(this.size()===0)throw new Error("Trying to pop from an empty list.");const s=e1(this.elementShape,this.tensors,e),r=this.tensors.pop();return r.kept=!1,Po(r.shape,e,"TensorList shape mismatch: "),we(r,s)}pushBack(e){if(e.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${this.elementDtype}`);if(Po(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");_r(e),this.tensors.push(e)}resize(e){if(e<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${e}`);if(this.maxNumElements!==-1&&e>this.maxNumElements)throw new Error(`TensorListResize input size ${e} is greater maxNumElement ${this.maxNumElements}.`);const t=new ad([],this.elementShape,this.elementDtype,this.maxNumElements);t.tensors.length=e;for(let s=0;s<Math.min(this.tensors.length,e);++s)t.tensors[s]=this.tensors[s];return t}getItem(e,t,s){if(s!==this.elementDtype)throw new Error(`Invalid data types; op elements ${s}, but list elements ${this.elementDtype}`);if(e<0||e>this.tensors.length)throw new Error(`Trying to access element ${e} in a list with ${this.tensors.length} elements.`);if(this.tensors[e]==null)throw new Error(`element at index ${e} is null.`);Po(this.tensors[e].shape,t,"TensorList shape mismatch: ");const r=e1(this.elementShape,this.tensors,t);return we(this.tensors[e],r)}setItem(e,t){if(t.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${this.elementDtype}`);if(e<0||this.maxNumElements!==-1&&e>=this.maxNumElements)throw new Error(`Trying to set element ${e} in a list with max ${this.maxNumElements} elements.`);Po(this.elementShape,t.shape,"TensorList shape mismatch: "),_r(t),this.tensors[e]!=null&&(this.tensors[e].kept=!1),this.tensors[e]=t}gather(e,t,s){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);Po(this.elementShape,s,"TensorList shape mismatch: "),e=e.slice(0,this.size());const r=e1(this.elementShape,this.tensors,s);return e.length===0?jo([],[0].concat(r)):_e(()=>{const a=e.map(i=>we(this.tensors[i],r));return ui(a,0)})}concat(e,t){if(e&&e!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${e}`);Po(this.elementShape,t,"TensorList shape mismatch: ");const s=e1(this.elementShape,this.tensors,t);return this.size()===0?jo([],[0].concat(s)):_e(()=>{const r=this.tensors.map(a=>we(a,s));return ur(r,0)})}}function Zq(n,e,t){const s=n.dtype;if(n.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${n.shape}`);if(n.dtype!==t)throw new Error(`Invalid data types; op elements ${n.dtype}, but list elements ${t}`);const r=n.shape.slice(1);Po(r,e,"TensorList shape mismatch: ");const a=mo(n);return new ad(a,e,s)}function Jq(n,e,t,s){return new ad([],n,e,s)}function Qq(n,e,t,s){if(e.length!==n.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${n.shape[0]}`);const r=Math.max(...e);if(s!=null&&s!==-1&&r>=s)throw new Error(`Max index must be < array size (${r}  vs. ${s})`);const a=new ad([],t,n.dtype,s),i=mo(n,0);return e.forEach((o,l)=>{a.setItem(o,i[l])}),a}function eH(n,e,t){let s=0;const r=e.map(f=>(s+=f,s));if(s!==n.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${s}, and tensor's shape is: ${n.shape}`);const a=n.shape.slice(1),i=QS(a,t),o=s===0?0:n.size/s,l=_e(()=>{const f=[];n=we(n,[1,s,o]);for(let d=0;d<e.length;++d){const g=[0,d===0?0:r[d-1],0],b=[1,e[d],o];f[d]=we(Tn(n,g,b),i)}return n.dispose(),f}),c=new ad([],t,n.dtype,e.length);for(let f=0;f<l.length;f++)c.setItem(f,l[f]);return c}const tH=async(n,e,t)=>{switch(n.op){case"If":case"StatelessIf":{const s=L("thenBranch",n,e,t),r=L("elseBranch",n,e,t),a=L("cond",n,e,t),i=L("args",n,e,t);return(await a.data())[0]?t.functionMap[s].executeFunctionAsync(i,t.tensorArrayMap,t.tensorListMap):t.functionMap[r].executeFunctionAsync(i,t.tensorArrayMap,t.tensorListMap)}case"While":case"StatelessWhile":{const s=L("body",n,e,t),r=L("cond",n,e,t),a=L("args",n,e,t),i=await t.functionMap[r].executeFunctionAsync(a,t.tensorArrayMap,t.tensorListMap),o=a.map(f=>f.id);let l=await i[0].data();i.forEach(f=>{!f.kept&&o.indexOf(f.id)===-1&&f.dispose()});let c=a;for(;l[0];){const f=c;c=await t.functionMap[s].executeFunctionAsync(c,t.tensorArrayMap,t.tensorListMap);const d=c.map(g=>g.id);f.forEach(g=>{!g.kept&&o.indexOf(g.id)===-1&&d.indexOf(g.id)===-1&&g.dispose()});const m=await t.functionMap[r].executeFunctionAsync(c,t.tensorArrayMap,t.tensorListMap);l=await m[0].data(),m.forEach(g=>{!g.kept&&o.indexOf(g.id)===-1&&d.indexOf(g.id)===-1&&g.dispose()})}return c}case"LoopCond":{const s=L("pred",n,e,t);return[cc(s)]}case"Switch":{const s=L("pred",n,e,t);let r=L("data",n,e,t);return r.kept||(r=cc(r)),(await s.data())[0]?[void 0,r]:[r,void 0]}case"Merge":{const s=n.inputNames.find(r=>oa(r,e,t)!==void 0);if(s){const r=oa(s,e,t);return[cc(r)]}return}case"Enter":{const s=L("frameName",n,e,t),r=L("tensor",n,e,t);return t.enterFrame(s),[cc(r)]}case"Exit":{const s=L("tensor",n,e,t);return t.exitFrame(),[cc(s)]}case"NextIteration":{const s=L("tensor",n,e,t);return t.nextIteration(),[cc(s)]}case"TensorArrayV3":{const s=L("size",n,e,t),r=L("dtype",n,e,t),a=L("elementShape",n,e,t),i=L("dynamicSize",n,e,t),o=L("clearAfterRead",n,e,t),l=L("identicalElementShapes",n,e,t),c=L("name",n,e,t),f=new Yq(c,r,s,a,l,i,o);return t.addTensorArray(f),[f.idTensor,Mt(1)]}case"TensorArrayWriteV3":{const s=L("tensorArrayId",n,e,t),r=L("index",n,e,t),a=L("tensor",n,e,t),i=t.getTensorArray(s.id);return i.write(r,a),[i.idTensor]}case"TensorArrayReadV3":{const s=L("tensorArrayId",n,e,t),r=L("index",n,e,t);return[t.getTensorArray(s.id).read(r)]}case"TensorArrayGatherV3":{const s=L("tensorArrayId",n,e,t),r=L("indices",n,e,t),a=L("dtype",n,e,t);return[t.getTensorArray(s.id).gather(r,a)]}case"TensorArrayScatterV3":{const s=L("tensorArrayId",n,e,t),r=L("indices",n,e,t),a=L("tensor",n,e,t),i=t.getTensorArray(s.id);return i.scatter(r,a),[i.idTensor]}case"TensorArrayConcatV3":{const s=L("tensorArrayId",n,e,t),r=t.getTensorArray(s.id),a=L("dtype",n,e,t);return[r.concat(a)]}case"TensorArraySplitV3":{const s=L("tensorArrayId",n,e,t),r=L("tensor",n,e,t),a=L("lengths",n,e,t),i=t.getTensorArray(s.id);return i.split(a,r),[i.idTensor]}case"TensorArraySizeV3":{const s=L("tensorArrayId",n,e,t),r=t.getTensorArray(s.id);return[Mt(r.size(),"int32")]}case"TensorArrayCloseV3":{const s=L("tensorArrayId",n,e,t),r=t.getTensorArray(s.id);return r.clearAndClose(),[r.idTensor]}case"TensorListSetItem":{const s=L("tensorListId",n,e,t),r=L("index",n,e,t),a=L("tensor",n,e,t),i=t.getTensorList(s.id);return i.setItem(r,a),[i.idTensor]}case"TensorListGetItem":{const s=L("tensorListId",n,e,t),r=L("index",n,e,t),a=L("elementShape",n,e,t),i=L("elementDType",n,e,t);return[t.getTensorList(s.id).getItem(r,a,i)]}case"TensorListScatterV2":case"TensorListScatter":{const s=L("indices",n,e,t),r=L("tensor",n,e,t),a=L("elementShape",n,e,t),i=L("numElements",n,e,t),o=Qq(r,s,a,i);return t.addTensorList(o),[o.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const s=L("elementShape",n,e,t),r=L("elementDType",n,e,t);let a;n.op==="TensorListReserve"?a="numElements":a="maxNumElements";const i=L(a,n,e,t),o=n.op==="TensorListReserve"?-1:i,l=Jq(s,r,i,o);return t.addTensorList(l),[l.idTensor]}case"TensorListGather":{const s=L("tensorListId",n,e,t),r=L("indices",n,e,t),a=L("elementShape",n,e,t),i=L("elementDType",n,e,t);return[t.getTensorList(s.id).gather(r,i,a)]}case"TensorListStack":{const s=L("tensorListId",n,e,t),r=L("elementShape",n,e,t),a=L("elementDType",n,e,t),i=L("numElements",n,e,t);return[t.getTensorList(s.id).stack(r,a,i)]}case"TensorListFromTensor":{const s=L("tensor",n,e,t),r=L("elementShape",n,e,t),a=L("elementDType",n,e,t),i=Zq(s,r,a);return t.addTensorList(i),[i.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const s=L("tensorListId",n,e,t),r=t.getTensorList(s.id),a=L("dtype",n,e,t),i=L("elementShape",n,e,t);return[r.concat(a,i)]}case"TensorListPushBack":{const s=L("tensorListId",n,e,t),r=L("tensor",n,e,t),a=t.getTensorList(s.id);return a.pushBack(r),[a.idTensor]}case"TensorListPopBack":{const s=L("tensorListId",n,e,t),r=L("elementShape",n,e,t),a=L("elementDType",n,e,t);return[t.getTensorList(s.id).popBack(r,a)]}case"TensorListSplit":{const s=L("tensor",n,e,t),r=L("elementShape",n,e,t),a=L("lengths",n,e,t),i=eH(s,a,r);return t.addTensorList(i),[i.idTensor]}case"TensorListLength":{const s=L("tensorListId",n,e,t),r=t.getTensorList(s.id);return[Mt(r.size(),"int32")]}case"TensorListResize":{const s=L("tensorListId",n,e,t),r=L("size",n,e,t),i=t.getTensorList(s.id).resize(r);return t.addTensorList(i),[i.idTensor]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};function FI(n,e,t){const[s,r]=L("fusedOps",n,e,t),a=s==="biasadd",i=!a,o=r==="prelu",l=s==="fusedbatchnorm",c=L("numArgs",n,e,t);if(a){if(o&&c!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!o&&a&&c!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(l)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const f=L("strides",n,e,t),d=eb(n,e,t),m=L("dataFormat",n,e,t).toUpperCase(),g=L("dilations",n,e,t);let[b,x]=L("args",n,e,t);i&&(x=b,b=void 0);const v=L("leakyreluAlpha",n,e,t);return{stride:f,pad:d,dataFormat:m,dilations:g,biasArg:b,preluArg:x,activationFunc:r,leakyreluAlpha:v}}const nH=(n,e,t,s=pa)=>{switch(n.op){case"Conv1D":{const r=L("stride",n,e,t),a=L("pad",n,e,t),i=L("dataFormat",n,e,t).toUpperCase(),o=L("dilation",n,e,t);return[s.conv1d(L("x",n,e,t),L("filter",n,e,t),r,a,i,o)]}case"Conv2D":{const r=L("strides",n,e,t),a=eb(n,e,t),i=L("dataFormat",n,e,t).toUpperCase(),o=L("dilations",n,e,t);return[s.conv2d(L("x",n,e,t),L("filter",n,e,t),[r[1],r[2]],a,i,[o[1],o[2]])]}case"_FusedConv2D":{const{stride:r,pad:a,dataFormat:i,dilations:o,biasArg:l,preluArg:c,activationFunc:f,leakyreluAlpha:d}=FI(n,e,t);return[s.fused.conv2d({x:L("x",n,e,t),filter:L("filter",n,e,t),strides:[r[1],r[2]],pad:a,dataFormat:i,dilations:[o[1],o[2]],bias:l,activation:f,preluActivationWeights:c,leakyreluAlpha:d})]}case"FusedDepthwiseConv2dNative":{const{stride:r,pad:a,dataFormat:i,dilations:o,biasArg:l,preluArg:c,activationFunc:f,leakyreluAlpha:d}=FI(n,e,t);return[s.fused.depthwiseConv2d({x:L("x",n,e,t),filter:L("filter",n,e,t),strides:[r[1],r[2]],pad:a,dataFormat:i,dilations:[o[1],o[2]],bias:l,activation:f,preluActivationWeights:c,leakyreluAlpha:d})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const r=L("outputShape",n,e,t),a=L("strides",n,e,t),i=eb(n,e,t);return[s.conv2dTranspose(L("x",n,e,t),L("filter",n,e,t),r,[a[1],a[2]],i)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const r=L("strides",n,e,t),a=eb(n,e,t),i=L("dilations",n,e,t),o=L("dataFormat",n,e,t).toUpperCase();return[s.depthwiseConv2d(L("input",n,e,t),L("filter",n,e,t),[r[1],r[2]],a,o,[i[1],i[2]])]}case"Conv3D":{const r=L("strides",n,e,t),a=L("pad",n,e,t),i=L("dataFormat",n,e,t).toUpperCase(),o=L("dilations",n,e,t);return[s.conv3d(L("x",n,e,t),L("filter",n,e,t),[r[1],r[2],r[3]],a,i,[o[1],o[2],o[3]])]}case"AvgPool":{const r=L("strides",n,e,t),a=L("pad",n,e,t),i=L("kernelSize",n,e,t);return[s.avgPool(L("x",n,e,t),[i[1],i[2]],[r[1],r[2]],a)]}case"MaxPool":{const r=L("strides",n,e,t),a=L("pad",n,e,t),i=L("kernelSize",n,e,t);return[s.maxPool(L("x",n,e,t),[i[1],i[2]],[r[1],r[2]],a)]}case"MaxPoolWithArgmax":{const r=L("strides",n,e,t),a=L("pad",n,e,t),i=L("kernelSize",n,e,t),o=L("includeBatchInIndex",n,e,t),{result:l,indexes:c}=s.maxPoolWithArgmax(L("x",n,e,t),[i[1],i[2]],[r[1],r[2]],a,o);return[l,c]}case"AvgPool3D":{const r=L("strides",n,e,t),a=L("pad",n,e,t),i=L("kernelSize",n,e,t);return[s.avgPool3d(L("x",n,e,t),[i[1],i[2],i[3]],[r[1],r[2],r[3]],a)]}case"MaxPool3D":{const r=L("strides",n,e,t),a=L("pad",n,e,t),i=L("kernelSize",n,e,t);return[s.maxPool3d(L("x",n,e,t),[i[1],i[2],i[3]],[r[1],r[2],r[3]],a)]}case"Dilation2D":{const r=L("strides",n,e,t),a=L("pad",n,e,t),i=L("dilations",n,e,t),o=r[1],l=r[2],c=i[1],f=i[2];return[s.dilation2d(L("x",n,e,t),L("filter",n,e,t),[o,l],a,[c,f],"NHWC")]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};const sH=(n,e,t,s=pa)=>{switch(n.op){case"Fill":{const r=L("shape",n,e,t),a=L("dtype",n,e,t),i=L("value",n,e,t);return[s.fill(r,i,a)]}case"LinSpace":{const r=L("start",n,e,t),a=L("stop",n,e,t),i=L("num",n,e,t);return[s.linspace(r,a,i)]}case"Multinomial":{const r=L("logits",n,e,t),a=L("numSamples",n,e,t),i=L("seed",n,e,t);return[s.multinomial(r,a,i)]}case"OneHot":{const r=L("indices",n,e,t),a=L("depth",n,e,t),i=L("onValue",n,e,t),o=L("offValue",n,e,t),l=L("dtype",n,e,t);return[s.oneHot(r,a,i,o,l)]}case"Ones":return[s.ones(L("shape",n,e,t),L("dtype",n,e,t))];case"OnesLike":return[s.onesLike(L("x",n,e,t))];case"RandomStandardNormal":return[s.randomStandardNormal(L("shape",n,e,t),L("dtype",n,e,t),L("seed",n,e,t))];case"RandomUniform":return[s.randomUniform(L("shape",n,e,t),L("minval",n,e,t),L("maxval",n,e,t),L("dtype",n,e,t))];case"RandomUniformInt":return[s.randomUniformInt(L("shape",n,e,t),L("minval",n,e,t),L("maxval",n,e,t),L("seed",n,e,t))];case"Range":{const r=L("start",n,e,t),a=L("stop",n,e,t),i=L("step",n,e,t);return[s.range(r,a,i,L("dtype",n,e,t))]}case"TruncatedNormal":{const r=L("shape",n,e,t),a=L("mean",n,e,t),i=L("stdDev",n,e,t),o=L("seed",n,e,t);return[s.truncatedNormal(r,a,i,L("dtype",n,e,t),o)]}case"Zeros":return[s.zeros(L("shape",n,e,t),L("dtype",n,e,t))];case"ZerosLike":return[s.zerosLike(L("x",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};function M5(n,e,t){const s=L("boxes",n,e,t),r=L("scores",n,e,t),a=L("maxOutputSize",n,e,t),i=L("iouThreshold",n,e,t),o=L("scoreThreshold",n,e,t),l=L("softNmsSigma",n,e,t);return{boxes:s,scores:r,maxOutputSize:a,iouThreshold:i,scoreThreshold:o,softNmsSigma:l}}const rH=async(n,e,t,s,r=pa)=>{switch(n.op){case"NonMaxSuppressionV5":{const{boxes:a,scores:i,maxOutputSize:o,iouThreshold:l,scoreThreshold:c,softNmsSigma:f}=M5(n,e,t),d=await r.image.nonMaxSuppressionWithScoreAsync(a,i,o,l,c,f);return[d.selectedIndices,d.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:a,scores:i,maxOutputSize:o,iouThreshold:l,scoreThreshold:c}=M5(n,e,t),f=L("padToMaxOutputSize",n,e,t),d=await r.image.nonMaxSuppressionPaddedAsync(a,i,o,l,c,f);return[d.selectedIndices,d.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:a,scores:i,maxOutputSize:o,iouThreshold:l,scoreThreshold:c}=M5(n,e,t);return[await r.image.nonMaxSuppressionAsync(a,i,o,l,c)]}case"Where":{const a=r.cast(L("condition",n,e,t),"bool"),i=[await r.whereAsync(a)];return a.dispose(),i}case"ListDiff":return r.setdiff1dAsync(L("x",n,e,t),L("y",n,e,t));default:throw TypeError(`Node type ${n.op} is not implemented`)}};const aH=(n,e,t,s=pa)=>{switch(n.op){case"LowerBound":{const r=L("sortedSequence",n,e,t),a=L("values",n,e,t);return[s.lowerBound(r,a)]}case"TopKV2":{const r=L("x",n,e,t),a=L("k",n,e,t),i=L("sorted",n,e,t),o=s.topk(r,a,i);return[o.values,o.indices]}case"UpperBound":{const r=L("sortedSequence",n,e,t),a=L("values",n,e,t);return[s.upperBound(r,a)]}case"Unique":{const r=L("x",n,e,t),a=s.unique(r);return[a.values,a.indices]}case"UniqueV2":{const r=L("x",n,e,t),a=L("axis",n,e,t),i=s.unique(r,a);return[i.values,i.indices]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};const iH=(n,e,t,s=pa)=>{switch(n.op){case"Const":return e[n.name];case"PlaceholderWithDefault":const r=L("default",n,e,t);return[oa(n.name,e,t)||r];case"Placeholder":return[oa(n.name,e,t)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{const f=L("x",n,e,t);return[cc(f)]}case"IdentityN":return L("x",n,e,t).map(f=>cc(f));case"Snapshot":const a=L("x",n,e,t);return[cc(a)];case"Shape":return[s.tensor1d(L("x",n,e,t).shape,"int32")];case"ShapeN":return L("x",n,e,t).map(f=>s.tensor1d(f.shape));case"Size":return[s.scalar(L("x",n,e,t).size,"int32")];case"Rank":return[s.scalar(L("x",n,e,t).rank,"int32")];case"NoOp":return[s.scalar(1)];case"Print":const i=L("x",n,e,t),o=L("data",n,e,t),l=L("message",n,e,t),c=L("summarize",n,e,t);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(l);for(let f=0;f<o.length;f++)console.log(Array.prototype.slice.call(o[f].dataSync()).slice(0,c));return[i];default:throw TypeError(`Node type ${n.op} is not implemented`)}};class oH{get id(){return this.handle.id}constructor(e,t){this.keyDType=e,this.valueDType=t,this.handle=Mt(0),this.tensorMap=new Map,_r(this.handle)}clearAndClose(){this.tensorMap.forEach(e=>e.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return Mt(this.size(),"int32")}async import(e,t){this.checkKeyAndValueTensor(e,t);const s=await e.data();return this.tensorMap.forEach(r=>r.dispose()),this.tensorMap.clear(),_e(()=>{const r=mo(t),a=s.length,i=r.length;Z(a===i,()=>`The number of elements doesn't match, keys has ${a} elements, the values has ${i} elements.`);for(let o=0;o<a;o++){const l=s[o],c=r[o];_r(c),this.tensorMap.set(l,c)}return this.handle})}async find(e,t){this.checkKeyAndValueTensor(e,t);const s=await e.data();return _e(()=>{const r=[];for(let a=0;a<s.length;a++){const i=s[a],o=this.findWithDefault(i,t);r.push(o)}return ui(r)})}findWithDefault(e,t){const s=this.tensorMap.get(e);return s??t}checkKeyAndValueTensor(e,t){if(e.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${e.dtype}`);if(t.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${t.dtype}`)}}const lH=async(n,e,t,s)=>{switch(n.op){case"HashTable":case"HashTableV2":{const r=s.getHashTableHandleByName(n.name);if(r!=null)return[r];{const a=L("keyDType",n,e,t),i=L("valueDType",n,e,t),o=new oH(a,i);return s.addHashTable(n.name,o),[o.handle]}}case"InitializeTable":case"InitializeTableV2":case"LookupTableImport":case"LookupTableImportV2":{const r=L("tableHandle",n,e,t,s),a=L("keys",n,e,t),i=L("values",n,e,t);return[await s.getHashTableById(r.id).import(a,i)]}case"LookupTableFind":case"LookupTableFindV2":{const r=L("tableHandle",n,e,t,s),a=L("keys",n,e,t),i=L("defaultValue",n,e,t);return[await s.getHashTableById(r.id).find(a,i)]}case"LookupTableSize":case"LookupTableSizeV2":{const r=L("tableHandle",n,e,t,s);return[s.getHashTableById(r.id).tensorSize()]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};const uH=(n,e,t,s=pa)=>{switch(n.op){case"ResizeBilinear":{const r=L("images",n,e,t),a=L("size",n,e,t),i=L("alignCorners",n,e,t),o=L("halfPixelCenters",n,e,t);return[s.image.resizeBilinear(r,[a[0],a[1]],i,o)]}case"ResizeNearestNeighbor":{const r=L("images",n,e,t),a=L("size",n,e,t),i=L("alignCorners",n,e,t),o=L("halfPixelCenters",n,e,t);return[s.image.resizeNearestNeighbor(r,[a[0],a[1]],i,o)]}case"CropAndResize":{const r=L("image",n,e,t),a=L("boxes",n,e,t),i=L("boxInd",n,e,t),o=L("cropSize",n,e,t),l=L("method",n,e,t),c=L("extrapolationValue",n,e,t);return[s.image.cropAndResize(r,a,i,o,l,c)]}case"ImageProjectiveTransformV3":{const r=L("images",n,e,t),a=L("transforms",n,e,t),i=L("outputShape",n,e,t),o=L("fillValue",n,e,t),l=L("interpolation",n,e,t),c=L("fillMode",n,e,t);return[s.image.transform(r,a,l.toLowerCase(),c.toLowerCase(),o,i)]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};const cH=(n,e,t,s=pa)=>{switch(n.op){case"Equal":return[s.equal(L("a",n,e,t),L("b",n,e,t))];case"NotEqual":return[s.notEqual(L("a",n,e,t),L("b",n,e,t))];case"Greater":return[s.greater(L("a",n,e,t),L("b",n,e,t))];case"GreaterEqual":return[s.greaterEqual(L("a",n,e,t),L("b",n,e,t))];case"Less":return[s.less(L("a",n,e,t),L("b",n,e,t))];case"LessEqual":return[s.lessEqual(L("a",n,e,t),L("b",n,e,t))];case"LogicalAnd":return[s.logicalAnd(L("a",n,e,t),L("b",n,e,t))];case"LogicalNot":return[s.logicalNot(L("a",n,e,t))];case"LogicalOr":return[s.logicalOr(L("a",n,e,t),L("b",n,e,t))];case"Select":case"SelectV2":return[s.where(L("condition",n,e,t),L("a",n,e,t),L("b",n,e,t))];case"BitwiseAnd":return[s.bitwiseAnd(L("a",n,e,t),L("b",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};const hH=(n,e,t,s=pa)=>{switch(n.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[s.matMul(L("a",n,e,t),L("b",n,e,t),L("transposeA",n,e,t),L("transposeB",n,e,t))];case"Einsum":return[s.einsum(L("equation",n,e,t),...L("tensors",n,e,t))];case"Transpose":return[s.transpose(L("x",n,e,t),L("perm",n,e,t))];case"_FusedMatMul":const[r,a]=L("fusedOps",n,e,t),i=r==="biasadd",o=a==="prelu",l=L("numArgs",n,e,t),c=L("leakyreluAlpha",n,e,t);if(i){if(o&&l!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!o&&l!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[f,d]=L("args",n,e,t);return[s.fused.matMul({a:L("a",n,e,t),b:L("b",n,e,t),transposeA:L("transposeA",n,e,t),transposeB:L("transposeB",n,e,t),bias:f,activation:a,preluActivationWeights:d,leakyreluAlpha:c})];case"MatrixBandPart":return[s.linalg.bandPart(L("a",n,e,t),L("numLower",n,e,t),L("numUpper",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};const fH=(n,e,t,s=pa)=>{switch(n.op){case"EuclideanNorm":return[s.euclideanNorm(L("x",n,e,t),L("axis",n,e,t),L("keepDims",n,e,t))];case"FusedBatchNorm":case"FusedBatchNormV2":return[s.batchNorm(L("x",n,e,t),L("mean",n,e,t),L("variance",n,e,t),L("offset",n,e,t),L("scale",n,e,t),L("epsilon",n,e,t))];case"FusedBatchNormV3":return[s.batchNorm(L("x",n,e,t),L("mean",n,e,t),L("variance",n,e,t),L("offset",n,e,t),L("scale",n,e,t),L("epsilon",n,e,t))];case"LRN":return[s.localResponseNormalization(L("x",n,e,t),L("radius",n,e,t),L("bias",n,e,t),L("alpha",n,e,t),L("beta",n,e,t))];case"Softmax":return[s.softmax(L("x",n,e,t))];case"LogSoftmax":return[s.logSoftmax(L("x",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};const dH=(n,e,t,s=pa)=>{switch(n.op){case"RaggedGather":{const{outputNestedSplits:r,outputDenseValues:a}=s.raggedGather(L("paramsNestedSplits",n,e,t),L("paramsDenseValues",n,e,t),L("indices",n,e,t),L("outputRaggedRank",n,e,t));return r.concat(a)}case"RaggedRange":{const{rtNestedSplits:r,rtDenseValues:a}=s.raggedRange(L("starts",n,e,t),L("limits",n,e,t),L("splits",n,e,t));return[r,a]}case"RaggedTensorToTensor":return[s.raggedTensorToTensor(L("shape",n,e,t),L("values",n,e,t),L("defaultValue",n,e,t),L("rowPartitionTensors",n,e,t),L("rowPartitionTypes",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};const pH=(n,e,t,s=pa)=>{switch(n.op){case"Max":{const o=L("axis",n,e,t),l=L("keepDims",n,e,t);return[s.max(L("x",n,e,t),o,l)]}case"Mean":{const o=L("axis",n,e,t),l=L("keepDims",n,e,t);return[s.mean(L("x",n,e,t),o,l)]}case"Min":{const o=L("axis",n,e,t),l=L("keepDims",n,e,t);return[s.min(L("x",n,e,t),o,l)]}case"Sum":{const o=L("axis",n,e,t),l=L("keepDims",n,e,t);return[s.sum(L("x",n,e,t),o,l)]}case"All":{const o=L("axis",n,e,t),l=L("keepDims",n,e,t);return[s.all(L("x",n,e,t),o,l)]}case"Any":{const o=L("axis",n,e,t),l=L("keepDims",n,e,t);return[s.any(L("x",n,e,t),o,l)]}case"ArgMax":{const o=L("axis",n,e,t);return[s.argMax(L("x",n,e,t),o)]}case"ArgMin":{const o=L("axis",n,e,t);return[s.argMin(L("x",n,e,t),o)]}case"Prod":{const o=L("axis",n,e,t),l=L("keepDims",n,e,t);return[s.prod(L("x",n,e,t),o,l)]}case"Cumprod":{const o=L("axis",n,e,t),l=L("exclusive",n,e,t),c=L("reverse",n,e,t);return[s.cumprod(L("x",n,e,t),o,l,c)]}case"Cumsum":{const o=L("axis",n,e,t),l=L("exclusive",n,e,t),c=L("reverse",n,e,t);return[s.cumsum(L("x",n,e,t),o,l,c)]}case"Bincount":const r=L("x",n,e,t),a=L("weights",n,e,t),i=L("size",n,e,t);return[s.bincount(r,a,i)];case"DenseBincount":{const o=L("x",n,e,t),l=L("weights",n,e,t),c=L("size",n,e,t),f=L("binaryOutput",n,e,t);return[s.denseBincount(o,l,c,f)]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};const mH=(n,e,t,s=pa)=>{switch(n.op){case"ConcatV2":case"Concat":{const r=L("n",n,e,t),a=L("axis",n,e,t);let i=L("tensors",n,e,t);return i=i.slice(0,r),[s.concat(i,a)]}case"Gather":{const r=L("x",n,e,t),a=L("indices",n,e,t);return[s.gather(r,s.cast(a,"int32"),0)]}case"GatherV2":{const r=L("axis",n,e,t),a=L("batchDims",n,e,t),i=L("x",n,e,t),o=L("indices",n,e,t);return[s.gather(i,s.cast(o,"int32"),r,a)]}case"Reverse":{const r=L("dims",n,e,t),a=[];for(let o=0;o<r.length;o++)r[o]&&a.push(o);const i=L("x",n,e,t);return[s.reverse(i,a)]}case"ReverseV2":{const r=L("axis",n,e,t),a=L("x",n,e,t);return[s.reverse(a,r)]}case"Slice":{const r=L("begin",n,e,t),a=L("size",n,e,t);return[s.slice(L("x",n,e,t),r,a)]}case"StridedSlice":{const r=L("begin",n,e,t),a=L("end",n,e,t),i=L("strides",n,e,t),o=L("beginMask",n,e,t),l=L("endMask",n,e,t),c=L("ellipsisMask",n,e,t),f=L("newAxisMask",n,e,t),d=L("shrinkAxisMask",n,e,t),m=L("x",n,e,t);return[s.stridedSlice(m,r,a,i,o,l,c,f,d)]}case"Pack":return _e(()=>{const r=L("axis",n,e,t),a=L("tensors",n,e,t),i=a[0].shape,o=s.squeeze(a[0]).shape,l=a.map(c=>{const f=Nn(c.shape,i);if(!f&&!Nn(s.squeeze(c).shape,o))throw new Error("the input tensors shape does not match");return f?c:s.reshape(c,i)});return[s.stack(l,r)]});case"Unpack":{const r=L("axis",n,e,t),a=L("tensor",n,e,t);return s.unstack(a,r)}case"Tile":{const r=L("reps",n,e,t);return[s.tile(L("x",n,e,t),r)]}case"Split":case"SplitV":{const r=L("axis",n,e,t),a=L("numOrSizeSplits",n,e,t),i=L("x",n,e,t);return s.split(i,a,r)}case"ScatterNd":{const r=L("indices",n,e,t),a=L("values",n,e,t),i=L("shape",n,e,t);return[s.scatterND(r,a,i)]}case"GatherNd":{const r=L("x",n,e,t),a=L("indices",n,e,t);return[s.gatherND(r,a)]}case"SparseToDense":{const r=L("sparseIndices",n,e,t),a=L("outputShape",n,e,t),i=L("sparseValues",n,e,t),o=L("defaultValue",n,e,t);return[s.sparseToDense(r,i,a,i.dtype===o.dtype?o:s.cast(o,i.dtype))]}case"TensorScatterUpdate":{const r=L("indices",n,e,t),a=L("values",n,e,t),i=L("tensor",n,e,t);return[s.tensorScatterUpdate(i,r,a)]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};const gH=(n,e,t,s=pa)=>{switch(n.op){case"SparseFillEmptyRows":{const{outputIndices:r,outputValues:a,emptyRowIndicator:i,reverseIndexMap:o}=s.sparse.sparseFillEmptyRows(L("indices",n,e,t),L("values",n,e,t),L("denseShape",n,e,t),L("defaultValue",n,e,t));return[r,a,i,o]}case"SparseReshape":{const{outputIndices:r,outputShape:a}=s.sparse.sparseReshape(L("inputIndices",n,e,t),L("inputShape",n,e,t),L("newShape",n,e,t));return[r,a]}case"SparseSegmentMean":return[s.sparse.sparseSegmentMean(L("data",n,e,t),L("indices",n,e,t),L("segmentIds",n,e,t))];case"SparseSegmentSum":return[s.sparse.sparseSegmentSum(L("data",n,e,t),L("indices",n,e,t),L("segmentIds",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};const yH=(n,e,t,s=pa)=>{switch(n.op){case"FFT":return[s.fft(L("x",n,e,t))];case"IFFT":return[s.ifft(L("x",n,e,t))];case"RFFT":return[s.rfft(L("x",n,e,t))];case"IRFFT":return[s.irfft(L("x",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};const bH=(n,e,t,s=pa)=>{switch(n.op){case"StaticRegexReplace":return[s.string.staticRegexReplace(L("input",n,e,t),L("pattern",n,e,t),L("rewrite",n,e,t),L("replaceGlobal",n,e,t))];case"StringNGrams":{const{nGrams:r,nGramsSplits:a}=s.string.stringNGrams(L("data",n,e,t),L("dataSplits",n,e,t),L("separator",n,e,t),L("nGramWidths",n,e,t),L("leftPad",n,e,t),L("rightPad",n,e,t),L("padWidth",n,e,t),L("preserveShortSequences",n,e,t));return[r,a]}case"StringSplit":{const{indices:r,values:a,shape:i}=s.string.stringSplit(L("input",n,e,t),L("delimiter",n,e,t),L("skipEmpty",n,e,t));return[r,a,i]}case"StringToHashBucketFast":return[s.string.stringToHashBucketFast(L("input",n,e,t),L("numBuckets",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};const xH=(n,e,t,s=pa)=>{switch(n.op){case"Cast":return[s.cast(L("x",n,e,t),L("dtype",n,e,t))];case"ExpandDims":{const r=L("axis",n,e,t);return[s.expandDims(L("x",n,e,t),r)]}case"Squeeze":{const r=L("axis",n,e,t);return[s.squeeze(L("x",n,e,t),r)]}case"Reshape":return[s.reshape(L("x",n,e,t),L("shape",n,e,t))];case"EnsureShape":return[s.ensureShape(L("x",n,e,t),L("shape",n,e,t))];case"MirrorPad":return[s.mirrorPad(L("x",n,e,t),L("padding",n,e,t),L("mode",n,e,t))];case"PadV2":case"Pad":return[s.pad(L("x",n,e,t),L("padding",n,e,t),L("constantValue",n,e,t))];case"SpaceToBatchND":{const r=L("blockShape",n,e,t),a=L("paddings",n,e,t);return[s.spaceToBatchND(L("x",n,e,t),r,a)]}case"BatchToSpaceND":{const r=L("blockShape",n,e,t),a=L("crops",n,e,t);return[s.batchToSpaceND(L("x",n,e,t),r,a)]}case"DepthToSpace":{const r=L("blockSize",n,e,t),a=L("dataFormat",n,e,t).toUpperCase();return[s.depthToSpace(L("x",n,e,t),r,a)]}case"BroadcastTo":return[s.broadcastTo(L("x",n,e,t),L("shape",n,e,t))];case"BroadcastArgs":return[s.broadcastArgs(L("s0",n,e,t),L("s1",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};function MI(n,e,t,s,r=_e){const a=((i,o,l)=>{switch(i.category){case"arithmetic":return r(()=>Kq(i,o,l));case"basic_math":return r(()=>Xq(i,o,l));case"control":return tH(i,o,l);case"convolution":return r(()=>nH(i,o,l));case"creation":return r(()=>sH(i,o,l));case"dynamic":return rH(i,o,l);case"evaluation":return r(()=>aH(i,o,l));case"image":return r(()=>uH(i,o,l));case"graph":return r(()=>iH(i,o,l));case"logical":return r(()=>cH(i,o,l));case"matrices":return r(()=>hH(i,o,l));case"normalization":return r(()=>fH(i,o,l));case"ragged":return r(()=>dH(i,o,l));case"reduction":return r(()=>pH(i,o,l));case"slice_join":return r(()=>mH(i,o,l));case"sparse":return r(()=>gH(i,o,l));case"spectral":return r(()=>yH(i,o,l));case"string":return r(()=>bH(i,o,l));case"transformation":return r(()=>xH(i,o,l));case"hash_table":return lH(i,o,l,s);case"custom":const c=dD(i.op);if(c&&c.customExecutor)return c.customExecutor(new Hq(i,o,l));throw TypeError(`Custom op ${i.op} is not registered.`);default:throw TypeError(`Unknown op '${i.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(n,e,t);return Ah(a)?a.then(i=>[].concat(i)):[].concat(a)}class zI{constructor(e={},t={},s={},r={},a){this.weightMap=e,this.tensorArrayMap=t,this.tensorListMap=s,this.functionMap=r,this.parseNodeNameCache=a,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,t){return{id:e,frameName:t,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const e=[];for(let t=0;t<this.contexts.length-1;t++){const s=this.contexts.slice(0,this.contexts.length-t);e.push(this.contextIdforContexts(s))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map(t=>t.id===0&&t.iterationId===0?"":`${t.frameName}-${t.iterationId}`).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;const e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(const t in this.tensorArrayMap)this.tensorArrayMap[t].clearAndClose(e);for(const t in this.tensorListMap)this.tensorListMap[t].clearAndClose(e)}}function PI(n,e,t,s){const r=new Set,a=[];let i=null,o=null;const l=new Set,c=new Set(Object.keys(n).map(m=>Di(m)[0]));s=s||[];const f=new Set(s.map(m=>Di(m.name)[0])),d=[...e];for(;d.length>0;){const m=d.pop();if((Ff(m)||AH(m)||IH(m))&&i==null&&(i=m,o=i.children.map(g=>g.name).filter(g=>r.has(g))),r.add(m.name),t[m.name]==null&&!c.has(m.name)&&!f.has(m.name)){if(m.inputs.length===0){a.push(m.name);continue}m.inputs.forEach(g=>{l.has(g.name)||(l.add(g.name),d.push(g))})}}return{inputs:n,outputs:e,usedNodes:r,missingInputs:a,dynamicNode:i,syncInputs:o}}function vH(n,e){const{usedNodes:t,inputs:s}=e,r=Object.keys(s).map(v=>Di(v)[0]).map(v=>n.nodes[v]),a=n.initNodes||[],i=v=>t.has(typeof v=="string"?v:v.name);function o(v){return[...new Map(v.map(w=>[w.name,w])).values()]}const l=o([...r,...n.weights,...a]).filter(i),c=o([...l,...Object.values(n.nodes)]).filter(i),f=new Map(c.map(v=>[v.name,v])),d={};for(const v of c){d[v.name]=d[v.name]||0;for(const w of v.children)i(w)||(d[w.name]=Number.POSITIVE_INFINITY),d[w.name]=(d[w.name]||0)+1}const m=Object.entries(d).filter(([,v])=>v===0).map(([v])=>v),g=[...m];for(;m.length>0;){const v=m.pop(),w=f.get(v);for(const k of w.children.filter(i))--d[k.name]===0&&(g.push(k.name),m.push(k.name))}const b=g.map(v=>f.get(v)),x=wH(b,l);return SH(x,l),x}function wH(n,e){const t=new Map(n.map(i=>[i.name,i])),s=e.map(i=>i.name),r=new Set(s);for(;s.length>0;){const i=s.pop(),o=t.get(i);for(const l of o.children)!t.has(l.name)||r.has(l.name)||(r.add(l.name),s.push(l.name))}return n.filter(i=>r.has(i.name))}class w2 extends Error{constructor(e){super(`NodesExecutionOrderError: ${e}`)}}function SH(n,e){const t=new Map(n.map((o,l)=>[o.name,l])),s=new Set(e.map(o=>o.name)),r=o=>s.has(typeof o=="string"?o:o.name),a=new Set(n.map(o=>o.name)),i=o=>a.has(typeof o=="string"?o:o.name);for(const o of n){for(const l of o.children.filter(i)){if(!t.has(l.name))throw new w2(`Child ${l.name} of node ${o.name} is unreachable.`);if(t.get(o.name)>t.get(l.name))throw new w2(`Node ${o.name} is scheduled to run after its child ${l.name}.`)}if(!r(o))for(const l of o.inputs){if(!t.has(l.name))throw new w2(`Input ${l.name} of node ${o.name} is unreachable.`);if(t.get(l.name)>t.get(o.name))throw new w2(`Node ${o.name} is scheduled to run before its input ${l.name}.`)}}}function NH(n){const e=new Map(n.map((o,l)=>[o.name,l])),t=Number.MAX_SAFE_INTEGER,s=n.map((o,l)=>Ff(o)?t:l),r=o=>{const l=s[e.get(o.name)];return l??-1},a=n.map((o,l)=>o.children.map(r).reduce((c,f)=>Math.max(c,f),s[l])),i=new Map;for(let o=0;o<n.length;++o){const l=a[o];if(l===t)continue;const c=n[o],f=n[l];i.has(f.name)||i.set(f.name,[]),i.get(f.name).push(c)}return i}const kH=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),CH=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),TH=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function Ff(n){return kH.has(n.op)}function AH(n){return CH.has(n.op)}function IH(n){return TH.has(n.op)}class vb{get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(e){const t=Object.keys(e).map(s=>e[s].map(r=>r.id));this._weightIds=[].concat(...t),this._weightMap=e}set resourceManager(e){this._resourceManager=e}get inputs(){return this._inputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(e=>e.signatureKey||e.name)}get outputNodes(){return this._outputs.map(e=>{const t=e.signatureKey||e.name;return e.defaultOutput?`${t}:${e.defaultOutput}`:t})}get functions(){return Object.keys(this._functions).reduce((e,t)=>(e[t]=this._functions[t].signature,e),{})}constructor(e,t){this.graph=e,this.parent=t,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,e.functions!=null&&Object.keys(e.functions).forEach(s=>{this._functionExecutorMap[s]=new vb(e.functions[s],this)})}getCompilationKey(e,t){const s=e.map(a=>a.name).sort(),r=t.map(a=>a.name).sort();return s.join(this.SEPARATOR)+"--"+r.join(this.SEPARATOR)}compile(e,t){const s=PI(e,t,this.weightMap,this._initNodes),{missingInputs:r,dynamicNode:a,syncInputs:i}=s;if(a!=null)throw new Error(`This execution contains the node '${a.name}', which has the dynamic op '${a.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${i}]`);if(r.length>0){const c=t.map(d=>d.name),f=Object.keys(e);throw new Error(`Cannot compute the outputs [${c}] from the provided inputs [${f}]. Missing the following inputs: [${r}]`)}const o=vH(this.graph,s),l=NH(o);return{orderedNodes:o,nodeLiveUntilMap:l}}cloneAndKeepTensor(e){if(e==null)return null;const t=e.clone();return _r(t),t}cloneTensorList(e){return e?e.map(s=>this.cloneAndKeepTensor(s)):null}cloneTensorMap(e){return Object.fromEntries(Object.entries(e).map(([t,s])=>[t,this.cloneTensorList(s)]))}execute(e,t){this.disposeIntermediateTensors(),e=this.mapInputs(e);const s=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t);const r=s.map(m=>this.graph.nodes[Di(m)[0]]),a=t.map(m=>Di(m)[0]),i=new Set(a);let o=a.map(m=>this.graph.nodes[m]);o.length===0&&(o=this._outputs);const l=this.getCompilationKey(r,o);let c=this.compiledMap.get(l);c==null&&(c=this.compile(e,o),this.compiledMap.set(l,c));try{this.keepIntermediateTensors=De().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(m){this.keepIntermediateTensors=!1,console.warn(m.message)}const f={},d={};return _e(()=>{const m=new zI(this.weightMap,f,d,this.functionExecutorMap,this.parseNodeNameCache),g=Object.assign({},this.weightMap);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),Object.keys(e).forEach(w=>{const[k,I]=Di(w,m),A=[];A[I]=e[w],g[k]=A,this.keepIntermediateTensors&&(this.clonedTensorsMap[k]=this.cloneTensorList(A))});const b=this.getFrozenTensorIds(g),{orderedNodes:x,nodeLiveUntilMap:v}=c;for(const w of x){if(g[w.name])continue;const k=MI(w,g,m,this._resourceManager);if(Ah(k))throw new Error(`The execution of the op '${w.op}' returned a promise. Please use model.executeAsync() instead.`);g[w.name]=k,this.keepIntermediateTensors&&(this.clonedTensorsMap[w.name]=this.cloneTensorList(k)),this.checkTensorForDisposalWithNodeLiveUntilInfo(w,g,m,b,i,v.get(w.name))}return this.parent==null&&m.dispose(b),t.map(w=>oa(w,g,m))})}getFrozenTensorIds(e){const t=[].concat.apply([],Object.keys(e).map(s=>e[s]).map(s=>s.map(r=>r.id)));return new Set(t)}checkTensorForDisposal(e,t,s,r,a,i,o){if(!(Ff(t)||i.has(e))){for(const l of s[e])l!=null&&(o[l.id]=(o[l.id]||0)+t.children.length);for(const l of t.inputs){if(Ff(l))continue;const c=RI(l.name,s,r);if(c!=null)for(const f of c){if(!f||f.kept||a.has(f.id))continue;const d=o[f.id];d===1?(f.dispose(),delete o[f.id]):d!=null&&o[f.id]--}}}}checkTensorForDisposalWithNodeLiveUntilInfo(e,t,s,r,a,i){function o(l){return Ff(l)||a.has(l.name)}if(!(Ff(e)||i==null))for(const l of i){if(o(l))continue;const c=RI(l.name,t,s);for(const f of c)!f||f.kept||r.has(f.id)||f.dispose()}}async executeAsync(e,t){return this._executeAsync(e,t)}disposeIntermediateTensors(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach(e=>{for(const t of e)t&&!t.isDisposed&&t.dispose()}),this.clonedTensorsMap=null)}getIntermediateTensors(){return this.clonedTensorsMap}async _executeAsync(e,t,s=!1,r={},a={}){this.disposeIntermediateTensors(),s||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t));try{this.keepIntermediateTensors=De().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(m){this.keepIntermediateTensors=!1,console.warn(m.message)}const i=new zI(this.weightMap,r,a,this.functionExecutorMap,this.parseNodeNameCache);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap));const o=await this.executeWithControlFlow(e,i,t,s),l=t.map(m=>oa(m,o,i)),c=l.map(m=>m.id),f=Object.keys(e).map(m=>e[m].id),d=new Set([...c,...f,...this.weightIds]);return Object.values(o).forEach(m=>{m.forEach(g=>{g&&!g.isDisposed&&!d.has(g.id)&&g.dispose()})}),this.parent==null&&i.dispose(d),l}async executeFunctionAsync(e,t,s){const r=e.reduce((a,i,o)=>(a[this.inputs[o].name]=i,a),{});return this._executeAsync(r,this.outputNodes,!0,t,s)}async executeWithControlFlow(e,t,s,r){const a=Object.keys(e),i=a.map(A=>this.graph.nodes[Di(A)[0]]),o=s.map(A=>Di(A)[0]),l=new Set(o);let c=o.map(A=>this.graph.nodes[A]);c.length===0&&(c=this._outputs);const{usedNodes:f,missingInputs:d,dynamicNode:m,syncInputs:g}=PI(e,c,this.weightMap,this._initNodes),b=[...i,...this.graph.weights,...this._initNodes||[]].map(A=>({node:A,contexts:t.currentContext})),x=Object.assign({},this.weightMap);Object.keys(e).forEach(A=>{const[R,U]=Di(A),V=[];V[U]=e[A],x[R]=V});const v={},w=this.getFrozenTensorIds(x),k={};for(;b.length>0;){const A=this.processStack(i,b,t,x,k,w,l,v,f);await Promise.all(A)}m==null&&!r&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const I=c.filter(A=>!Ff(A)&&!oa(A.name,x,t)).map(A=>A.name);if(I.length>0){let A="";throw m!=null&&(A=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${g}]`),new Error(`Cannot compute the outputs [${I}] from the provided inputs [${a}]. Consider providing the following inputs: [${d}]. ${A}`)}return x}processStack(e,t,s,r,a,i,o,l,c){const f=[];for(;t.length>0;){const d=t.pop();s.currentContext=d.contexts;let m="";if(d.node.op==="Enter"&&L("isConstant",d.node,r,s)&&([m]=uc(d.node.name,s)),r[d.node.name]==null){const g=MI(d.node,r,s,this._resourceManager);m||([m]=uc(d.node.name,s));const b=s.currentContext;Ah(g)?f.push(g.then(x=>(r[m]=x,this.keepIntermediateTensors&&(this.clonedTensorsMap[m]=this.cloneTensorList(x)),s.currentContext=b,this.checkTensorForDisposal(m,d.node,r,s,i,o,l),this.processChildNodes(d.node,t,s,r,a,c),x))):(r[m]=g,this.keepIntermediateTensors&&(this.clonedTensorsMap[m]=this.cloneTensorList(g)),this.checkTensorForDisposal(m,d.node,r,s,i,o,l),this.processChildNodes(d.node,t,s,r,a,c))}else this.processChildNodes(d.node,t,s,r,a,c)}return f}processChildNodes(e,t,s,r,a,i){e.children.forEach(o=>{const[l]=uc(o.name,s);a[l]||!i.has(o.name)||(o.op==="Merge"?o.inputNames.some(c=>!!oa(c,r,s))&&(a[l]=!0,t.push({contexts:s.currentContext,node:o})):o.inputNames.every(c=>!!oa(c,r,s))&&(a[l]=!0,t.push({contexts:s.currentContext,node:o})))})}dispose(){Object.keys(this.weightMap).forEach(e=>this.weightMap[e].forEach(t=>t.dispose()))}checkInputShapeAndType(e){Object.keys(e).forEach(t=>{const s=e[t],[r]=Di(t),a=this.graph.nodes[r];if(a.attrParams.shape&&a.attrParams.shape.value){const i=a.attrParams.shape.value,o=i.length===s.shape.length&&s.shape.every((l,c)=>i[c]===-1||i[c]===l);Z(o,()=>`The shape of dict['${a.name}'] provided in model.execute(dict) must be [${i}], but was [${s.shape}]`)}a.attrParams.dtype&&a.attrParams.dtype.value&&Z(s.dtype===a.attrParams.dtype.value,()=>`The dtype of dict['${a.name}'] provided in model.execute(dict) must be ${a.attrParams.dtype.value}, but was ${s.dtype}`)})}mapInputs(e){var t,s;const r={};for(const a in e){const i=(s=(t=this._signature)===null||t===void 0?void 0:t.inputs)===null||s===void 0?void 0:s[a];i!=null?r[i.name]=e[a]:r[a]=e[a]}return r}checkInputs(e){const t=Object.keys(e).filter(s=>{const[r]=Di(s);return this.graph.nodes[r]==null});if(t.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${t}] that are not part of graph`)}mapOutputs(e){return e.map(t=>{var s,r;const a=(r=(s=this._signature)===null||s===void 0?void 0:s.outputs)===null||r===void 0?void 0:r[t];return a!=null?a.name:t},{})}checkOutputs(e){e.forEach(t=>{const[s]=Di(t);if(!this.graph.nodes[s])throw new Error(`The output '${t}' is not found in the graph`)})}}class EH{constructor(e={},t={}){this.hashTableNameToHandle=e,this.hashTableMap=t}addHashTable(e,t){this.hashTableNameToHandle[e]=t.handle,this.hashTableMap[t.id]=t}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(const e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(const e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}}const _H="?tfjs-format=file",$H="model.json";class RH{get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}constructor(e,t={},s=l3){this.modelUrl=e,this.loadOptions=t,this.version="n/a",this.io=s,t==null&&(this.loadOptions={}),this.resourceManager=new EH}findIOHandler(){const e=this.modelUrl;if(e.load!=null)this.handler=e;else if(this.loadOptions.requestInit!=null)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{const t=this.io.getLoadHandlers(e,this.loadOptions);if(t.length===0)t.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(t.length>1)throw new Error(`Found more than one (${t.length}) load handlers for URL '${[e]}'`);this.handler=t[0]}}load(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const e=this.handler.load();return Ah(e)?e.then(t=>t.getWeightStream==null?this.loadSync(t):this.loadStreaming(t)):this.loadSync(e)}loadSync(e){const t=this.io.decodeWeights(e.weightData,e.weightSpecs);return this.loadWithWeightMap(e,t)}async loadStreaming(e){if(e.getWeightStream==null)throw new Error("Model artifacts missing streamWeights function");const t=await o$(e.getWeightStream(),e.weightSpecs);return this.loadWithWeightMap(e,t)}loadWithWeightMap(e,t){this.artifacts=e;const s=this.artifacts.modelTopology;let r=this.artifacts.signature;if(this.artifacts.userDefinedMetadata!=null){const a=this.artifacts.userDefinedMetadata;a.signature!=null&&(r=a.signature),a.structuredOutputKeys!=null&&(this.structuredOutputKeys=a.structuredOutputKeys)}if(this.signature=r,this.version=`${s.versions.producer}.${s.versions.minConsumer}`,this.executor=new vb(DI.Instance.transformGraph(s,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(t),this.executor.resourceManager=this.resourceManager,e.modelInitializer!=null&&e.modelInitializer.node!=null){const a=DI.Instance.transformGraph(e.modelInitializer);this.initializer=new vb(a),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=e.initializerSignature}return!0}async save(e,t){if(typeof e=="string"){const s=this.io.getSaveHandlers(e);if(s.length===0)throw new Error(`Cannot find any save handlers for URL '${e}'`);if(s.length>1)throw new Error(`Found more than one (${s.length}) save handlers for URL '${e}'`);e=s[0]}if(e.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}addStructuredOutputNames(e){if(this.structuredOutputKeys){const t=e instanceof Kn?[e]:e,s={};return t.forEach((r,a)=>s[this.structuredOutputKeys[a]]=r),s}return e}predict(e,t){const s=this.execute(e,this.outputNodes);return this.addStructuredOutputNames(s)}async predictAsync(e,t){const s=await this.executeAsync(e,this.outputNodes);return this.addStructuredOutputNames(s)}normalizeInputs(e){var t;if(!(e instanceof Kn)&&!Array.isArray(e)){const a=(t=this.signature)===null||t===void 0?void 0:t.inputs;if(a!=null)for(const i in a){const o=a[i];o.resourceId!=null&&(e[i]=this.resourceIdToCapturedInput[o.resourceId])}return e}e=Array.isArray(e)?e:[e];const s=Object.keys(this.resourceIdToCapturedInput).length;if(e.length+s!==this.inputNodes.length)throw new Error(`Input tensor count mismatch, the graph model has ${this.inputNodes.length-s} non-resource placeholders, while there are ${e.length} input tensors provided.`);let r=0;return this.inputNodes.reduce((a,i)=>{var o,l,c;const f=(c=(l=(o=this.signature)===null||o===void 0?void 0:o.inputs)===null||l===void 0?void 0:l[i])===null||c===void 0?void 0:c.resourceId;return f!=null?a[i]=this.resourceIdToCapturedInput[f]:a[i]=e[r++],a},{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}executeInitializerGraph(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}async executeInitializerGraphAsync(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.executeAsync({},[]):this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs))}setResourceIdToCapturedInput(e){if(this.resourceIdToCapturedInput={},this.initializerSignature){const t=this.initializerSignature.outputs,s=Object.keys(t);for(let r=0;r<s.length;r++){const a=s[r],i=t[a];this.resourceIdToCapturedInput[i.resourceId]=e[r]}}}execute(e,t){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),e=this.normalizeInputs(e),t=this.normalizeOutputs(t);const s=this.executor.execute(e,t);return s.length>1?s:s[0]}async executeAsync(e,t){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(await this.executeInitializerGraphAsync()),e=this.normalizeInputs(e),t=this.normalizeOutputs(t);const s=await this.executor.executeAsync(e,t);return s.length>1?s:s[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce((t,s)=>(t[s]=[e[s]],t),{})}dispose(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&xn(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}}async function BI(n,e={},t=l3){if(n==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");e==null&&(e={}),e.fromTFHub&&typeof n=="string"&&(n=DH(n));const s=new RH(n,e,t);return await s.load(),s}function DH(n){return n.endsWith("/")||(n=n+"/"),`${n}${$H}${_H}`}function wb(n,e,t,s){return new(t||(t=Promise))(function(r,a){function i(c){try{l(s.next(c))}catch(f){a(f)}}function o(c){try{l(s.throw(c))}catch(f){a(f)}}function l(c){var f;c.done?r(c.value):(f=c.value,f instanceof t?f:new t(function(d){d(f)})).then(i,o)}l((s=s.apply(n,[])).next())})}function Sb(n,e){var t,s,r,a,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function o(l){return function(c){return(function(f){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,s&&(r=2&f[0]?s.return:f[0]?s.throw||((r=s.return)&&r.call(s),0):s.next)&&!(r=r.call(s,f[1])).done)return r;switch(s=0,r&&(f=[2&f[0],r.value]),f[0]){case 0:case 1:r=f;break;case 4:return i.label++,{value:f[1],done:!1};case 5:i.label++,s=f[1],f=[0];continue;case 7:f=i.ops.pop(),i.trys.pop();continue;default:if(!(r=(r=i.trys).length>0&&r[r.length-1])&&(f[0]===6||f[0]===2)){i=0;continue}if(f[0]===3&&(!r||f[1]>r[0]&&f[1]<r[3])){i.label=f[1];break}if(f[0]===6&&i.label<r[1]){i.label=r[1],r=f;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(f);break}r[2]&&i.ops.pop(),i.trys.pop();continue}f=e.call(n,i)}catch(d){f=[6,d],s=0}finally{t=r=0}if(5&f[0])throw f[1];return{value:f[0]?f[1]:void 0,done:!0}})([l,c])}}}var OH={0:"tench, Tinca tinca",1:"goldfish, Carassius auratus",2:"great white shark, white shark, man-eater, man-eating shark, Carcharodon carcharias",3:"tiger shark, Galeocerdo cuvieri",4:"hammerhead, hammerhead shark",5:"electric ray, crampfish, numbfish, torpedo",6:"stingray",7:"cock",8:"hen",9:"ostrich, Struthio camelus",10:"brambling, Fringilla montifringilla",11:"goldfinch, Carduelis carduelis",12:"house finch, linnet, Carpodacus mexicanus",13:"junco, snowbird",14:"indigo bunting, indigo finch, indigo bird, Passerina cyanea",15:"robin, American robin, Turdus migratorius",16:"bulbul",17:"jay",18:"magpie",19:"chickadee",20:"water ouzel, dipper",21:"kite",22:"bald eagle, American eagle, Haliaeetus leucocephalus",23:"vulture",24:"great grey owl, great gray owl, Strix nebulosa",25:"European fire salamander, Salamandra salamandra",26:"common newt, Triturus vulgaris",27:"eft",28:"spotted salamander, Ambystoma maculatum",29:"axolotl, mud puppy, Ambystoma mexicanum",30:"bullfrog, Rana catesbeiana",31:"tree frog, tree-frog",32:"tailed frog, bell toad, ribbed toad, tailed toad, Ascaphus trui",33:"loggerhead, loggerhead turtle, Caretta caretta",34:"leatherback turtle, leatherback, leathery turtle, Dermochelys coriacea",35:"mud turtle",36:"terrapin",37:"box turtle, box tortoise",38:"banded gecko",39:"common iguana, iguana, Iguana iguana",40:"American chameleon, anole, Anolis carolinensis",41:"whiptail, whiptail lizard",42:"agama",43:"frilled lizard, Chlamydosaurus kingi",44:"alligator lizard",45:"Gila monster, Heloderma suspectum",46:"green lizard, Lacerta viridis",47:"African chameleon, Chamaeleo chamaeleon",48:"Komodo dragon, Komodo lizard, dragon lizard, giant lizard, Varanus komodoensis",49:"African crocodile, Nile crocodile, Crocodylus niloticus",50:"American alligator, Alligator mississipiensis",51:"triceratops",52:"thunder snake, worm snake, Carphophis amoenus",53:"ringneck snake, ring-necked snake, ring snake",54:"hognose snake, puff adder, sand viper",55:"green snake, grass snake",56:"king snake, kingsnake",57:"garter snake, grass snake",58:"water snake",59:"vine snake",60:"night snake, Hypsiglena torquata",61:"boa constrictor, Constrictor constrictor",62:"rock python, rock snake, Python sebae",63:"Indian cobra, Naja naja",64:"green mamba",65:"sea snake",66:"horned viper, cerastes, sand viper, horned asp, Cerastes cornutus",67:"diamondback, diamondback rattlesnake, Crotalus adamanteus",68:"sidewinder, horned rattlesnake, Crotalus cerastes",69:"trilobite",70:"harvestman, daddy longlegs, Phalangium opilio",71:"scorpion",72:"black and gold garden spider, Argiope aurantia",73:"barn spider, Araneus cavaticus",74:"garden spider, Aranea diademata",75:"black widow, Latrodectus mactans",76:"tarantula",77:"wolf spider, hunting spider",78:"tick",79:"centipede",80:"black grouse",81:"ptarmigan",82:"ruffed grouse, partridge, Bonasa umbellus",83:"prairie chicken, prairie grouse, prairie fowl",84:"peacock",85:"quail",86:"partridge",87:"African grey, African gray, Psittacus erithacus",88:"macaw",89:"sulphur-crested cockatoo, Kakatoe galerita, Cacatua galerita",90:"lorikeet",91:"coucal",92:"bee eater",93:"hornbill",94:"hummingbird",95:"jacamar",96:"toucan",97:"drake",98:"red-breasted merganser, Mergus serrator",99:"goose",100:"black swan, Cygnus atratus",101:"tusker",102:"echidna, spiny anteater, anteater",103:"platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus",104:"wallaby, brush kangaroo",105:"koala, koala bear, kangaroo bear, native bear, Phascolarctos cinereus",106:"wombat",107:"jelly fish",108:"sea anemone, anemone",109:"brain coral",110:"flatworm, platyhelminth",111:"nematode, nematode worm, roundworm",112:"conch",113:"snail",114:"slug",115:"sea slug, nudibranch",116:"chiton, coat-of-mail shell, sea cradle, polyplacophore",117:"chambered nautilus, pearly nautilus, nautilus",118:"Dungeness crab, Cancer magister",119:"rock crab, Cancer irroratus",120:"fiddler crab",121:"king crab, Alaska crab, Alaskan king crab, Alaska king crab, Paralithodes camtschatica",122:"American lobster, Northern lobster, Maine lobster, Homarus americanus",123:"spiny lobster, langouste, rock lobster, crawfish, crayfish, sea crawfish",124:"crayfish, crawfish, crawdad, crawdaddy",125:"hermit crab",126:"isopod",127:"white stork, Ciconia ciconia",128:"black stork, Ciconia nigra",129:"spoonbill",130:"flamingo",131:"little blue heron, Egretta caerulea",132:"American egret, great white heron, Egretta albus",133:"bittern",134:"crane",135:"limpkin, Aramus pictus",136:"European gallinule, Porphyrio porphyrio",137:"American coot, marsh hen, mud hen, water hen, Fulica americana",138:"bustard",139:"ruddy turnstone, Arenaria interpres",140:"red-backed sandpiper, dunlin, Erolia alpina",141:"redshank, Tringa totanus",142:"dowitcher",143:"oystercatcher, oyster catcher",144:"pelican",145:"king penguin, Aptenodytes patagonica",146:"albatross, mollymawk",147:"grey whale, gray whale, devilfish, Eschrichtius gibbosus, Eschrichtius robustus",148:"killer whale, killer, orca, grampus, sea wolf, Orcinus orca",149:"dugong, Dugong dugon",150:"sea lion",151:"Chihuahua",152:"Japanese spaniel",153:"Maltese dog, Maltese terrier, Maltese",154:"Pekinese, Pekingese, Peke",155:"Shih-Tzu",156:"Blenheim spaniel",157:"papillon",158:"toy terrier",159:"Rhodesian ridgeback",160:"Afghan hound, Afghan",161:"basset, basset hound",162:"beagle",163:"bloodhound, sleuthhound",164:"bluetick",165:"black-and-tan coonhound",166:"Walker hound, Walker foxhound",167:"English foxhound",168:"redbone",169:"borzoi, Russian wolfhound",170:"Irish wolfhound",171:"Italian greyhound",172:"whippet",173:"Ibizan hound, Ibizan Podenco",174:"Norwegian elkhound, elkhound",175:"otterhound, otter hound",176:"Saluki, gazelle hound",177:"Scottish deerhound, deerhound",178:"Weimaraner",179:"Staffordshire bullterrier, Staffordshire bull terrier",180:"American Staffordshire terrier, Staffordshire terrier, American pit bull terrier, pit bull terrier",181:"Bedlington terrier",182:"Border terrier",183:"Kerry blue terrier",184:"Irish terrier",185:"Norfolk terrier",186:"Norwich terrier",187:"Yorkshire terrier",188:"wire-haired fox terrier",189:"Lakeland terrier",190:"Sealyham terrier, Sealyham",191:"Airedale, Airedale terrier",192:"cairn, cairn terrier",193:"Australian terrier",194:"Dandie Dinmont, Dandie Dinmont terrier",195:"Boston bull, Boston terrier",196:"miniature schnauzer",197:"giant schnauzer",198:"standard schnauzer",199:"Scotch terrier, Scottish terrier, Scottie",200:"Tibetan terrier, chrysanthemum dog",201:"silky terrier, Sydney silky",202:"soft-coated wheaten terrier",203:"West Highland white terrier",204:"Lhasa, Lhasa apso",205:"flat-coated retriever",206:"curly-coated retriever",207:"golden retriever",208:"Labrador retriever",209:"Chesapeake Bay retriever",210:"German short-haired pointer",211:"vizsla, Hungarian pointer",212:"English setter",213:"Irish setter, red setter",214:"Gordon setter",215:"Brittany spaniel",216:"clumber, clumber spaniel",217:"English springer, English springer spaniel",218:"Welsh springer spaniel",219:"cocker spaniel, English cocker spaniel, cocker",220:"Sussex spaniel",221:"Irish water spaniel",222:"kuvasz",223:"schipperke",224:"groenendael",225:"malinois",226:"briard",227:"kelpie",228:"komondor",229:"Old English sheepdog, bobtail",230:"Shetland sheepdog, Shetland sheep dog, Shetland",231:"collie",232:"Border collie",233:"Bouvier des Flandres, Bouviers des Flandres",234:"Rottweiler",235:"German shepherd, German shepherd dog, German police dog, alsatian",236:"Doberman, Doberman pinscher",237:"miniature pinscher",238:"Greater Swiss Mountain dog",239:"Bernese mountain dog",240:"Appenzeller",241:"EntleBucher",242:"boxer",243:"bull mastiff",244:"Tibetan mastiff",245:"French bulldog",246:"Great Dane",247:"Saint Bernard, St Bernard",248:"Eskimo dog, husky",249:"malamute, malemute, Alaskan malamute",250:"Siberian husky",251:"dalmatian, coach dog, carriage dog",252:"affenpinscher, monkey pinscher, monkey dog",253:"basenji",254:"pug, pug-dog",255:"Leonberg",256:"Newfoundland, Newfoundland dog",257:"Great Pyrenees",258:"Samoyed, Samoyede",259:"Pomeranian",260:"chow, chow chow",261:"keeshond",262:"Brabancon griffon",263:"Pembroke, Pembroke Welsh corgi",264:"Cardigan, Cardigan Welsh corgi",265:"toy poodle",266:"miniature poodle",267:"standard poodle",268:"Mexican hairless",269:"timber wolf, grey wolf, gray wolf, Canis lupus",270:"white wolf, Arctic wolf, Canis lupus tundrarum",271:"red wolf, maned wolf, Canis rufus, Canis niger",272:"coyote, prairie wolf, brush wolf, Canis latrans",273:"dingo, warrigal, warragal, Canis dingo",274:"dhole, Cuon alpinus",275:"African hunting dog, hyena dog, Cape hunting dog, Lycaon pictus",276:"hyena, hyaena",277:"red fox, Vulpes vulpes",278:"kit fox, Vulpes macrotis",279:"Arctic fox, white fox, Alopex lagopus",280:"grey fox, gray fox, Urocyon cinereoargenteus",281:"tabby, tabby cat",282:"tiger cat",283:"Persian cat",284:"Siamese cat, Siamese",285:"Egyptian cat",286:"cougar, puma, catamount, mountain lion, painter, panther, Felis concolor",287:"lynx, catamount",288:"leopard, Panthera pardus",289:"snow leopard, ounce, Panthera uncia",290:"jaguar, panther, Panthera onca, Felis onca",291:"lion, king of beasts, Panthera leo",292:"tiger, Panthera tigris",293:"cheetah, chetah, Acinonyx jubatus",294:"brown bear, bruin, Ursus arctos",295:"American black bear, black bear, Ursus americanus, Euarctos americanus",296:"ice bear, polar bear, Ursus Maritimus, Thalarctos maritimus",297:"sloth bear, Melursus ursinus, Ursus ursinus",298:"mongoose",299:"meerkat, mierkat",300:"tiger beetle",301:"ladybug, ladybeetle, lady beetle, ladybird, ladybird beetle",302:"ground beetle, carabid beetle",303:"long-horned beetle, longicorn, longicorn beetle",304:"leaf beetle, chrysomelid",305:"dung beetle",306:"rhinoceros beetle",307:"weevil",308:"fly",309:"bee",310:"ant, emmet, pismire",311:"grasshopper, hopper",312:"cricket",313:"walking stick, walkingstick, stick insect",314:"cockroach, roach",315:"mantis, mantid",316:"cicada, cicala",317:"leafhopper",318:"lacewing, lacewing fly",319:"dragonfly, darning needle, devil's darning needle, sewing needle, snake feeder, snake doctor, mosquito hawk, skeeter hawk",320:"damselfly",321:"admiral",322:"ringlet, ringlet butterfly",323:"monarch, monarch butterfly, milkweed butterfly, Danaus plexippus",324:"cabbage butterfly",325:"sulphur butterfly, sulfur butterfly",326:"lycaenid, lycaenid butterfly",327:"starfish, sea star",328:"sea urchin",329:"sea cucumber, holothurian",330:"wood rabbit, cottontail, cottontail rabbit",331:"hare",332:"Angora, Angora rabbit",333:"hamster",334:"porcupine, hedgehog",335:"fox squirrel, eastern fox squirrel, Sciurus niger",336:"marmot",337:"beaver",338:"guinea pig, Cavia cobaya",339:"sorrel",340:"zebra",341:"hog, pig, grunter, squealer, Sus scrofa",342:"wild boar, boar, Sus scrofa",343:"warthog",344:"hippopotamus, hippo, river horse, Hippopotamus amphibius",345:"ox",346:"water buffalo, water ox, Asiatic buffalo, Bubalus bubalis",347:"bison",348:"ram, tup",349:"bighorn, bighorn sheep, cimarron, Rocky Mountain bighorn, Rocky Mountain sheep, Ovis canadensis",350:"ibex, Capra ibex",351:"hartebeest",352:"impala, Aepyceros melampus",353:"gazelle",354:"Arabian camel, dromedary, Camelus dromedarius",355:"llama",356:"weasel",357:"mink",358:"polecat, fitch, foulmart, foumart, Mustela putorius",359:"black-footed ferret, ferret, Mustela nigripes",360:"otter",361:"skunk, polecat, wood pussy",362:"badger",363:"armadillo",364:"three-toed sloth, ai, Bradypus tridactylus",365:"orangutan, orang, orangutang, Pongo pygmaeus",366:"gorilla, Gorilla gorilla",367:"chimpanzee, chimp, Pan troglodytes",368:"gibbon, Hylobates lar",369:"siamang, Hylobates syndactylus, Symphalangus syndactylus",370:"guenon, guenon monkey",371:"patas, hussar monkey, Erythrocebus patas",372:"baboon",373:"macaque",374:"langur",375:"colobus, colobus monkey",376:"proboscis monkey, Nasalis larvatus",377:"marmoset",378:"capuchin, ringtail, Cebus capucinus",379:"howler monkey, howler",380:"titi, titi monkey",381:"spider monkey, Ateles geoffroyi",382:"squirrel monkey, Saimiri sciureus",383:"Madagascar cat, ring-tailed lemur, Lemur catta",384:"indri, indris, Indri indri, Indri brevicaudatus",385:"Indian elephant, Elephas maximus",386:"African elephant, Loxodonta africana",387:"lesser panda, red panda, panda, bear cat, cat bear, Ailurus fulgens",388:"giant panda, panda, panda bear, coon bear, Ailuropoda melanoleuca",389:"barracouta, snoek",390:"eel",391:"coho, cohoe, coho salmon, blue jack, silver salmon, Oncorhynchus kisutch",392:"rock beauty, Holocanthus tricolor",393:"anemone fish",394:"sturgeon",395:"gar, garfish, garpike, billfish, Lepisosteus osseus",396:"lionfish",397:"puffer, pufferfish, blowfish, globefish",398:"abacus",399:"abaya",400:"academic gown, academic robe, judge's robe",401:"accordion, piano accordion, squeeze box",402:"acoustic guitar",403:"aircraft carrier, carrier, flattop, attack aircraft carrier",404:"airliner",405:"airship, dirigible",406:"altar",407:"ambulance",408:"amphibian, amphibious vehicle",409:"analog clock",410:"apiary, bee house",411:"apron",412:"ashcan, trash can, garbage can, wastebin, ash bin, ash-bin, ashbin, dustbin, trash barrel, trash bin",413:"assault rifle, assault gun",414:"backpack, back pack, knapsack, packsack, rucksack, haversack",415:"bakery, bakeshop, bakehouse",416:"balance beam, beam",417:"balloon",418:"ballpoint, ballpoint pen, ballpen, Biro",419:"Band Aid",420:"banjo",421:"bannister, banister, balustrade, balusters, handrail",422:"barbell",423:"barber chair",424:"barbershop",425:"barn",426:"barometer",427:"barrel, cask",428:"barrow, garden cart, lawn cart, wheelbarrow",429:"baseball",430:"basketball",431:"bassinet",432:"bassoon",433:"bathing cap, swimming cap",434:"bath towel",435:"bathtub, bathing tub, bath, tub",436:"beach wagon, station wagon, wagon, estate car, beach waggon, station waggon, waggon",437:"beacon, lighthouse, beacon light, pharos",438:"beaker",439:"bearskin, busby, shako",440:"beer bottle",441:"beer glass",442:"bell cote, bell cot",443:"bib",444:"bicycle-built-for-two, tandem bicycle, tandem",445:"bikini, two-piece",446:"binder, ring-binder",447:"binoculars, field glasses, opera glasses",448:"birdhouse",449:"boathouse",450:"bobsled, bobsleigh, bob",451:"bolo tie, bolo, bola tie, bola",452:"bonnet, poke bonnet",453:"bookcase",454:"bookshop, bookstore, bookstall",455:"bottlecap",456:"bow",457:"bow tie, bow-tie, bowtie",458:"brass, memorial tablet, plaque",459:"brassiere, bra, bandeau",460:"breakwater, groin, groyne, mole, bulwark, seawall, jetty",461:"breastplate, aegis, egis",462:"broom",463:"bucket, pail",464:"buckle",465:"bulletproof vest",466:"bullet train, bullet",467:"butcher shop, meat market",468:"cab, hack, taxi, taxicab",469:"caldron, cauldron",470:"candle, taper, wax light",471:"cannon",472:"canoe",473:"can opener, tin opener",474:"cardigan",475:"car mirror",476:"carousel, carrousel, merry-go-round, roundabout, whirligig",477:"carpenter's kit, tool kit",478:"carton",479:"car wheel",480:"cash machine, cash dispenser, automated teller machine, automatic teller machine, automated teller, automatic teller, ATM",481:"cassette",482:"cassette player",483:"castle",484:"catamaran",485:"CD player",486:"cello, violoncello",487:"cellular telephone, cellular phone, cellphone, cell, mobile phone",488:"chain",489:"chainlink fence",490:"chain mail, ring mail, mail, chain armor, chain armour, ring armor, ring armour",491:"chain saw, chainsaw",492:"chest",493:"chiffonier, commode",494:"chime, bell, gong",495:"china cabinet, china closet",496:"Christmas stocking",497:"church, church building",498:"cinema, movie theater, movie theatre, movie house, picture palace",499:"cleaver, meat cleaver, chopper",500:"cliff dwelling",501:"cloak",502:"clog, geta, patten, sabot",503:"cocktail shaker",504:"coffee mug",505:"coffeepot",506:"coil, spiral, volute, whorl, helix",507:"combination lock",508:"computer keyboard, keypad",509:"confectionery, confectionary, candy store",510:"container ship, containership, container vessel",511:"convertible",512:"corkscrew, bottle screw",513:"cornet, horn, trumpet, trump",514:"cowboy boot",515:"cowboy hat, ten-gallon hat",516:"cradle",517:"crane",518:"crash helmet",519:"crate",520:"crib, cot",521:"Crock Pot",522:"croquet ball",523:"crutch",524:"cuirass",525:"dam, dike, dyke",526:"desk",527:"desktop computer",528:"dial telephone, dial phone",529:"diaper, nappy, napkin",530:"digital clock",531:"digital watch",532:"dining table, board",533:"dishrag, dishcloth",534:"dishwasher, dish washer, dishwashing machine",535:"disk brake, disc brake",536:"dock, dockage, docking facility",537:"dogsled, dog sled, dog sleigh",538:"dome",539:"doormat, welcome mat",540:"drilling platform, offshore rig",541:"drum, membranophone, tympan",542:"drumstick",543:"dumbbell",544:"Dutch oven",545:"electric fan, blower",546:"electric guitar",547:"electric locomotive",548:"entertainment center",549:"envelope",550:"espresso maker",551:"face powder",552:"feather boa, boa",553:"file, file cabinet, filing cabinet",554:"fireboat",555:"fire engine, fire truck",556:"fire screen, fireguard",557:"flagpole, flagstaff",558:"flute, transverse flute",559:"folding chair",560:"football helmet",561:"forklift",562:"fountain",563:"fountain pen",564:"four-poster",565:"freight car",566:"French horn, horn",567:"frying pan, frypan, skillet",568:"fur coat",569:"garbage truck, dustcart",570:"gasmask, respirator, gas helmet",571:"gas pump, gasoline pump, petrol pump, island dispenser",572:"goblet",573:"go-kart",574:"golf ball",575:"golfcart, golf cart",576:"gondola",577:"gong, tam-tam",578:"gown",579:"grand piano, grand",580:"greenhouse, nursery, glasshouse",581:"grille, radiator grille",582:"grocery store, grocery, food market, market",583:"guillotine",584:"hair slide",585:"hair spray",586:"half track",587:"hammer",588:"hamper",589:"hand blower, blow dryer, blow drier, hair dryer, hair drier",590:"hand-held computer, hand-held microcomputer",591:"handkerchief, hankie, hanky, hankey",592:"hard disc, hard disk, fixed disk",593:"harmonica, mouth organ, harp, mouth harp",594:"harp",595:"harvester, reaper",596:"hatchet",597:"holster",598:"home theater, home theatre",599:"honeycomb",600:"hook, claw",601:"hoopskirt, crinoline",602:"horizontal bar, high bar",603:"horse cart, horse-cart",604:"hourglass",605:"iPod",606:"iron, smoothing iron",607:"jack-o'-lantern",608:"jean, blue jean, denim",609:"jeep, landrover",610:"jersey, T-shirt, tee shirt",611:"jigsaw puzzle",612:"jinrikisha, ricksha, rickshaw",613:"joystick",614:"kimono",615:"knee pad",616:"knot",617:"lab coat, laboratory coat",618:"ladle",619:"lampshade, lamp shade",620:"laptop, laptop computer",621:"lawn mower, mower",622:"lens cap, lens cover",623:"letter opener, paper knife, paperknife",624:"library",625:"lifeboat",626:"lighter, light, igniter, ignitor",627:"limousine, limo",628:"liner, ocean liner",629:"lipstick, lip rouge",630:"Loafer",631:"lotion",632:"loudspeaker, speaker, speaker unit, loudspeaker system, speaker system",633:"loupe, jeweler's loupe",634:"lumbermill, sawmill",635:"magnetic compass",636:"mailbag, postbag",637:"mailbox, letter box",638:"maillot",639:"maillot, tank suit",640:"manhole cover",641:"maraca",642:"marimba, xylophone",643:"mask",644:"matchstick",645:"maypole",646:"maze, labyrinth",647:"measuring cup",648:"medicine chest, medicine cabinet",649:"megalith, megalithic structure",650:"microphone, mike",651:"microwave, microwave oven",652:"military uniform",653:"milk can",654:"minibus",655:"miniskirt, mini",656:"minivan",657:"missile",658:"mitten",659:"mixing bowl",660:"mobile home, manufactured home",661:"Model T",662:"modem",663:"monastery",664:"monitor",665:"moped",666:"mortar",667:"mortarboard",668:"mosque",669:"mosquito net",670:"motor scooter, scooter",671:"mountain bike, all-terrain bike, off-roader",672:"mountain tent",673:"mouse, computer mouse",674:"mousetrap",675:"moving van",676:"muzzle",677:"nail",678:"neck brace",679:"necklace",680:"nipple",681:"notebook, notebook computer",682:"obelisk",683:"oboe, hautboy, hautbois",684:"ocarina, sweet potato",685:"odometer, hodometer, mileometer, milometer",686:"oil filter",687:"organ, pipe organ",688:"oscilloscope, scope, cathode-ray oscilloscope, CRO",689:"overskirt",690:"oxcart",691:"oxygen mask",692:"packet",693:"paddle, boat paddle",694:"paddlewheel, paddle wheel",695:"padlock",696:"paintbrush",697:"pajama, pyjama, pj's, jammies",698:"palace",699:"panpipe, pandean pipe, syrinx",700:"paper towel",701:"parachute, chute",702:"parallel bars, bars",703:"park bench",704:"parking meter",705:"passenger car, coach, carriage",706:"patio, terrace",707:"pay-phone, pay-station",708:"pedestal, plinth, footstall",709:"pencil box, pencil case",710:"pencil sharpener",711:"perfume, essence",712:"Petri dish",713:"photocopier",714:"pick, plectrum, plectron",715:"pickelhaube",716:"picket fence, paling",717:"pickup, pickup truck",718:"pier",719:"piggy bank, penny bank",720:"pill bottle",721:"pillow",722:"ping-pong ball",723:"pinwheel",724:"pirate, pirate ship",725:"pitcher, ewer",726:"plane, carpenter's plane, woodworking plane",727:"planetarium",728:"plastic bag",729:"plate rack",730:"plow, plough",731:"plunger, plumber's helper",732:"Polaroid camera, Polaroid Land camera",733:"pole",734:"police van, police wagon, paddy wagon, patrol wagon, wagon, black Maria",735:"poncho",736:"pool table, billiard table, snooker table",737:"pop bottle, soda bottle",738:"pot, flowerpot",739:"potter's wheel",740:"power drill",741:"prayer rug, prayer mat",742:"printer",743:"prison, prison house",744:"projectile, missile",745:"projector",746:"puck, hockey puck",747:"punching bag, punch bag, punching ball, punchball",748:"purse",749:"quill, quill pen",750:"quilt, comforter, comfort, puff",751:"racer, race car, racing car",752:"racket, racquet",753:"radiator",754:"radio, wireless",755:"radio telescope, radio reflector",756:"rain barrel",757:"recreational vehicle, RV, R.V.",758:"reel",759:"reflex camera",760:"refrigerator, icebox",761:"remote control, remote",762:"restaurant, eating house, eating place, eatery",763:"revolver, six-gun, six-shooter",764:"rifle",765:"rocking chair, rocker",766:"rotisserie",767:"rubber eraser, rubber, pencil eraser",768:"rugby ball",769:"rule, ruler",770:"running shoe",771:"safe",772:"safety pin",773:"saltshaker, salt shaker",774:"sandal",775:"sarong",776:"sax, saxophone",777:"scabbard",778:"scale, weighing machine",779:"school bus",780:"schooner",781:"scoreboard",782:"screen, CRT screen",783:"screw",784:"screwdriver",785:"seat belt, seatbelt",786:"sewing machine",787:"shield, buckler",788:"shoe shop, shoe-shop, shoe store",789:"shoji",790:"shopping basket",791:"shopping cart",792:"shovel",793:"shower cap",794:"shower curtain",795:"ski",796:"ski mask",797:"sleeping bag",798:"slide rule, slipstick",799:"sliding door",800:"slot, one-armed bandit",801:"snorkel",802:"snowmobile",803:"snowplow, snowplough",804:"soap dispenser",805:"soccer ball",806:"sock",807:"solar dish, solar collector, solar furnace",808:"sombrero",809:"soup bowl",810:"space bar",811:"space heater",812:"space shuttle",813:"spatula",814:"speedboat",815:"spider web, spider's web",816:"spindle",817:"sports car, sport car",818:"spotlight, spot",819:"stage",820:"steam locomotive",821:"steel arch bridge",822:"steel drum",823:"stethoscope",824:"stole",825:"stone wall",826:"stopwatch, stop watch",827:"stove",828:"strainer",829:"streetcar, tram, tramcar, trolley, trolley car",830:"stretcher",831:"studio couch, day bed",832:"stupa, tope",833:"submarine, pigboat, sub, U-boat",834:"suit, suit of clothes",835:"sundial",836:"sunglass",837:"sunglasses, dark glasses, shades",838:"sunscreen, sunblock, sun blocker",839:"suspension bridge",840:"swab, swob, mop",841:"sweatshirt",842:"swimming trunks, bathing trunks",843:"swing",844:"switch, electric switch, electrical switch",845:"syringe",846:"table lamp",847:"tank, army tank, armored combat vehicle, armoured combat vehicle",848:"tape player",849:"teapot",850:"teddy, teddy bear",851:"television, television system",852:"tennis ball",853:"thatch, thatched roof",854:"theater curtain, theatre curtain",855:"thimble",856:"thresher, thrasher, threshing machine",857:"throne",858:"tile roof",859:"toaster",860:"tobacco shop, tobacconist shop, tobacconist",861:"toilet seat",862:"torch",863:"totem pole",864:"tow truck, tow car, wrecker",865:"toyshop",866:"tractor",867:"trailer truck, tractor trailer, trucking rig, rig, articulated lorry, semi",868:"tray",869:"trench coat",870:"tricycle, trike, velocipede",871:"trimaran",872:"tripod",873:"triumphal arch",874:"trolleybus, trolley coach, trackless trolley",875:"trombone",876:"tub, vat",877:"turnstile",878:"typewriter keyboard",879:"umbrella",880:"unicycle, monocycle",881:"upright, upright piano",882:"vacuum, vacuum cleaner",883:"vase",884:"vault",885:"velvet",886:"vending machine",887:"vestment",888:"viaduct",889:"violin, fiddle",890:"volleyball",891:"waffle iron",892:"wall clock",893:"wallet, billfold, notecase, pocketbook",894:"wardrobe, closet, press",895:"warplane, military plane",896:"washbasin, handbasin, washbowl, lavabo, wash-hand basin",897:"washer, automatic washer, washing machine",898:"water bottle",899:"water jug",900:"water tower",901:"whiskey jug",902:"whistle",903:"wig",904:"window screen",905:"window shade",906:"Windsor tie",907:"wine bottle",908:"wing",909:"wok",910:"wooden spoon",911:"wool, woolen, woollen",912:"worm fence, snake fence, snake-rail fence, Virginia fence",913:"wreck",914:"yawl",915:"yurt",916:"web site, website, internet site, site",917:"comic book",918:"crossword puzzle, crossword",919:"street sign",920:"traffic light, traffic signal, stoplight",921:"book jacket, dust cover, dust jacket, dust wrapper",922:"menu",923:"plate",924:"guacamole",925:"consomme",926:"hot pot, hotpot",927:"trifle",928:"ice cream, icecream",929:"ice lolly, lolly, lollipop, popsicle",930:"French loaf",931:"bagel, beigel",932:"pretzel",933:"cheeseburger",934:"hotdog, hot dog, red hot",935:"mashed potato",936:"head cabbage",937:"broccoli",938:"cauliflower",939:"zucchini, courgette",940:"spaghetti squash",941:"acorn squash",942:"butternut squash",943:"cucumber, cuke",944:"artichoke, globe artichoke",945:"bell pepper",946:"cardoon",947:"mushroom",948:"Granny Smith",949:"strawberry",950:"orange",951:"lemon",952:"fig",953:"pineapple, ananas",954:"banana",955:"jackfruit, jak, jack",956:"custard apple",957:"pomegranate",958:"hay",959:"carbonara",960:"chocolate sauce, chocolate syrup",961:"dough",962:"meat loaf, meatloaf",963:"pizza, pizza pie",964:"potpie",965:"burrito",966:"red wine",967:"espresso",968:"cup",969:"eggnog",970:"alp",971:"bubble",972:"cliff, drop, drop-off",973:"coral reef",974:"geyser",975:"lakeside, lakeshore",976:"promontory, headland, head, foreland",977:"sandbar, sand bar",978:"seashore, coast, seacoast, sea-coast",979:"valley, vale",980:"volcano",981:"ballplayer, baseball player",982:"groom, bridegroom",983:"scuba diver",984:"rapeseed",985:"daisy",986:"yellow lady's slipper, yellow lady-slipper, Cypripedium calceolus, Cypripedium parviflorum",987:"corn",988:"acorn",989:"hip, rose hip, rosehip",990:"buckeye, horse chestnut, conker",991:"coral fungus",992:"agaric",993:"gyromitra",994:"stinkhorn, carrion fungus",995:"earthstar",996:"hen-of-the-woods, hen of the woods, Polyporus frondosus, Grifola frondosa",997:"bolete",998:"ear, spike, capitulum",999:"toilet tissue, toilet paper, bathroom tissue"},dh=224,LH={"1.00":"module_apply_default/MobilenetV1/Logits/global_pool","2.00":"module_apply_default/MobilenetV2/Logits/AvgPool"},Tp={"1.00":{.25:{url:"https://tfhub.dev/google/imagenet/mobilenet_v1_025_224/classification/1",inputRange:[0,1]},"0.50":{url:"https://tfhub.dev/google/imagenet/mobilenet_v1_050_224/classification/1",inputRange:[0,1]},.75:{url:"https://tfhub.dev/google/imagenet/mobilenet_v1_075_224/classification/1",inputRange:[0,1]},"1.00":{url:"https://tfhub.dev/google/imagenet/mobilenet_v1_100_224/classification/1",inputRange:[0,1]}},"2.00":{"0.50":{url:"https://tfhub.dev/google/imagenet/mobilenet_v2_050_224/classification/2",inputRange:[0,1]},.75:{url:"https://tfhub.dev/google/imagenet/mobilenet_v2_075_224/classification/2",inputRange:[0,1]},"1.00":{url:"https://tfhub.dev/google/imagenet/mobilenet_v2_100_224/classification/2",inputRange:[0,1]}}};function FH(n){return n===void 0&&(n={version:1,alpha:1}),wb(this,void 0,void 0,function(){var e,t,s,r,a,i,o;return Sb(this,function(l){switch(l.label){case 0:if(aq==null)throw new Error("Cannot find TensorFlow.js. If you are using a <script> tag, please also include @tensorflow/tfjs on the page before using this model.");if(e=n.version.toFixed(2),t=n.alpha?n.alpha.toFixed(2):"",s=-1,r=1,n.modelUrl==null){if(!(e in Tp))throw new Error("Invalid version of MobileNet. Valid versions are: "+Object.keys(Tp));if(!(t in Tp[e]))throw new Error("MobileNet constructed with invalid alpha "+n.alpha+". Valid multipliers for this version are: "+Object.keys(Tp[e])+".");i=Tp[e][t].inputRange,s=i[0],r=i[1]}return n.inputRange!=null&&(o=n.inputRange,s=o[0],r=o[1]),[4,(a=new MH(e,t,n.modelUrl,s,r)).load()];case 1:return l.sent(),[2,a]}})})}var MH=(function(){function n(e,t,s,r,a){r===void 0&&(r=-1),a===void 0&&(a=1),this.version=e,this.alpha=t,this.modelUrl=s,this.inputMin=r,this.inputMax=a,this.normalizationConstant=(a-r)/255}return n.prototype.load=function(){return wb(this,void 0,void 0,function(){var e,t,s,r,a=this;return Sb(this,function(i){switch(i.label){case 0:return this.modelUrl?(e=this,[4,BI(this.modelUrl)]):[3,2];case 1:return e.model=i.sent(),[3,4];case 2:return t=Tp[this.version][this.alpha].url,s=this,[4,BI(t,{fromTFHub:!0})];case 3:s.model=i.sent(),i.label=4;case 4:return[4,(r=_e(function(){return a.model.predict(lr([1,dh,dh,3]))})).data()];case 5:return i.sent(),r.dispose(),[2]}})})},n.prototype.infer=function(e,t){var s=this;return t===void 0&&(t=!1),_e(function(){e instanceof Kn||(e=$R(e));var r=et(xe(lt(e,"float32"),s.normalizationConstant),s.inputMin),a=r;(e.shape[0]!==dh||e.shape[1]!==dh)&&(a=Bo.resizeBilinear(r,[dh,dh],!0));var i,o=we(a,[-1,dh,dh,3]);if(t){var l=LH[s.version],c=s.model.execute(o,l);i=Ec(c,[1,2])}else{var f=s.model.predict(o);i=Tn(f,[0,1],[-1,1e3])}return i})},n.prototype.classify=function(e,t){return t===void 0&&(t=3),wb(this,void 0,void 0,function(){var s,r;return Sb(this,function(a){switch(a.label){case 0:return[4,zH(s=this.infer(e),t)];case 1:return r=a.sent(),s.dispose(),[2,r]}})})},n})();function zH(n,e){return wb(this,void 0,void 0,function(){var t,s,r,a,i,o,l;return Sb(this,function(c){switch(c.label){case 0:return[4,(t=sg(n)).data()];case 1:for(s=c.sent(),t.dispose(),r=[],l=0;l<s.length;l++)r.push({value:s[l],index:l});for(r.sort(function(f,d){return d.value-f.value}),a=new Float32Array(e),i=new Int32Array(e),l=0;l<e;l++)a[l]=r[l].value,i[l]=r[l].index;for(o=[],l=0;l<i.length;l++)o.push({className:OH[i[l]],probability:a[l]});return[2,o]}})})}const gD={kernelName:B1,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>xe(n,xd(lt(t,"float32"),-1))}}};const PH={kernelName:nm,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>{const s=is(lt(t,"float32")),r=Xr(mt(Mt(1),s));return ws($t(n,r))}}}};const BH={kernelName:sm,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>{const s=Xr(mt(is(lt(t,"float32")),1));return $t(n,s)}}}};const UH={kernelName:gd,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,r=on(t.shape,s.shape);return{a:()=>{let o=n;const l=Nr(t.shape,r);return l.length>0&&(o=St(o,l)),we(o,t.shape)},b:()=>{let o=n;const l=Nr(s.shape,r);return l.length>0&&(o=St(o,l)),we(o,s.shape)}}}};const VH={kernelName:U1,saveAllInputs:!0,gradFunc:(n,e)=>{const t={};return e.forEach((s,r)=>{t[r]=()=>n.clone()}),t}};const jH={kernelName:V1,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>$n(t)}}};const WH={kernelName:j1,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>$n(t)}}};const GH={kernelName:rm,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>$t(n,Xr(mt(Mt(1),is(lt(t,"float32")))))}}};const qH={kernelName:am,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>{const s=Xr(et(Mt(1),is(lt(t,"float32"))));return $t(n,s)}}}};const HH={kernelName:lm,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,r=on(t.shape,s.shape);return{a:()=>{const o=et(is(t),is(s));let l=xe(n,$t(s,o));const c=Nr(t.shape,r);return c.length>0&&(l=St(l,c)),we(l,t.shape)},b:()=>{const o=et(is(t),is(s));let l=ws(xe(n,$t(t,o)));const c=Nr(s.shape,r);return c.length>0&&(l=St(l,c)),we(l,s.shape)}}}};const KH={kernelName:im,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>$t(n,et(is(lt(t,"float32")),1))}}};const XH={kernelName:om,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>$t(n,mt(Mt(1),is(lt(t,"float32"))))}}};function YH(n,e,t,s,r,a){const i=te(n,"dy","avgPool3dGrad"),o=te(e,"input","avgPool3dGrad");let l=i,c=o,f=!1;o.rank===4&&(f=!0,l=we(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]]),c=we(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),Z(l.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`),Z(c.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${c.rank}.`),ja("avgPool3dGrad",r,a);const d={dy:l,input:c},m={filterSize:t,strides:s,pad:r,dimRoundingMode:a},g=me.runKernel(Qb,d,m);return f?we(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}const ZH=ge({avgPool3dGrad_:YH});const JH={kernelName:G1,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{filterSize:r,strides:a,pad:i,dimRoundingMode:o}=t;return{x:()=>ZH(n,s,r,a,i,o)}}};function QH(n,e,t,s,r){const a=te(n,"dy","avgPoolGrad"),i=te(e,"input","avgPoolGrad");Z(i.rank===a.rank,()=>`Rank of input (${i.rank}) does not match rank of dy (${a.rank})`);let o=i,l=a,c=!1;i.rank===3&&(c=!0,o=we(i,[1,i.shape[0],i.shape[1],i.shape[2]]),l=we(a,[1,a.shape[0],a.shape[1],a.shape[2]])),Z(l.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),Z(o.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${o.rank}.`);const f={dy:l,input:o},d={filterSize:t,strides:s,pad:r},m=me.runKernel(Jb,f,d);return c?we(m,[m.shape[1],m.shape[2],m.shape[3]]):m}const eK=ge({avgPoolGrad_:QH});const tK={kernelName:W1,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{filterSize:r,strides:a,pad:i}=t;return{x:()=>eK(n,s,r,a,i)}}};const nK={kernelName:q1,inputsToSave:["a","b"],gradFunc:(n,e,t)=>{const[s,r]=e,{transposeA:a,transposeB:i}=t;return!a&&!i?{a:()=>bn(n,r,!1,!0),b:()=>bn(s,n,!0,!1)}:!a&&i?{a:()=>bn(n,r,!1,!1),b:()=>bn(n,s,!0,!1)}:a&&!i?{a:()=>bn(r,n,!1,!0),b:()=>bn(s,n,!1,!1)}:{a:()=>bn(r,n,!0,!0),b:()=>bn(n,s,!0,!0)}}};const sK={kernelName:H1,gradFunc:(n,e,t)=>{const{blockShape:s,crops:r}=t;return{x:()=>ny(n,s,r)}}};const rK={kernelName:V_,gradFunc:(n,e,t)=>{const s=t,r=s.inputShape,a=s.shape,i=Array.from(a);for(let l=r.length-1;l>=0;l--)if(r[l]===a[l])i[l]=1;else if(r[l]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${a}].`);const o=[];for(let l=0;l<i.length;l++)i[l]>1&&o.push(l);return{x:()=>St(n,o,!0)}}};const aK={kernelName:um,gradFunc:n=>({x:()=>n.clone()})};const iK={kernelName:cm,gradFunc:n=>({x:()=>$n(n)})};const oK={kernelName:hm,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{clipValueMin:r,clipValueMax:a}=t;return{x:()=>ua(Dl(Ac(s,r),jh(s,a)),n,$n(n))}}};const lK={kernelName:X1,inputsToSave:["x"],gradFunc:gD.gradFunc};const uK={kernelName:Y1,saveAllInputs:!0,gradFunc:(n,e,t)=>{const s=e.map(l=>l.shape),{axis:r}=t,a=vn(r,e[0].shape)[0],i=s.map(l=>l[a]);return ri(n,i,a).map(l=>()=>l)}};const cK={kernelName:Z1,inputsToSave:["x","filter"],gradFunc:(n,e,t)=>{const[s,r]=e,{dilations:a,strides:i,pad:o,dataFormat:l}=t;return Z(Eh(a),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${a}'`),{x:()=>mk(s.shape,n,r,i,o,l),filter:()=>Zk(s,n,r.shape,i,o,l)}}};const hK={kernelName:J1,inputsToSave:["dy","filter"],gradFunc:(n,e,t)=>{const[s,r]=e,{strides:a,pad:i,dataFormat:o,dimRoundingMode:l}=t;return{dy:()=>vc(n,r,a,i,o,1,l),filter:()=>Zk(n,s,r.shape,a,i,o,l)}}};function fK(n,e,t,s,r){let a=n;n.rank===4&&(a=we(n,[1,n.shape[0],n.shape[1],n.shape[2],n.shape[3]]));let i=e;i.rank===4&&(i=we(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),Z(a.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${a.shape}.`),Z(i.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${i.shape}.`),Z(t.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${t}.`),Z(a.shape[4]===t[3],()=>`Error in conv3dDerFilter: depth of input ${a.shape[4]}) must match input depth in filter (${t[3]}.`),Z(i.shape[4]===t[4],()=>`Error in conv3dDerFilter: depth of dy (${i.shape[4]}) must match output depth for filter (${t[4]}).`);const o={x:a,dy:i},l={strides:s,pad:r,filterShape:t};return me.runKernel(rx,o,l)}const dK=ge({conv3DBackpropFilter_:fK});const pK={kernelName:Q1,inputsToSave:["x","filter"],gradFunc:(n,e,t)=>{const{dilations:s,strides:r,pad:a}=t;Z(Eh(s),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`);const[i,o]=e;return{x:()=>N$(i.shape,n,o,r,a),filter:()=>dK(i,n,o.shape,r,a)}}};const mK={kernelName:fm,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>xe(ws(Sv(lt(t,"float32"))),n)}}};const gK={kernelName:dm,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>xe(Nv(lt(t,"float32")),n)}}};const yK={kernelName:e0,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{axis:r,exclusive:a,reverse:i}=t;return{x:()=>{const o=js([r],s.rank);let l=lv(n,r,a,!i);return o!=null&&(l=An(l,o)),l}}}};const bK={kernelName:t0,inputsToSave:["x","filter"],gradFunc:(n,e,t)=>{const{dilations:s,strides:r,pad:a,dimRoundingMode:i}=t,o=s??[1,1];Z(Eh(o),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${o}'`);const[l,c]=e;return Z(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),Z(c.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${c.rank}.`),Z(l.shape[3]===c.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${c.shape[2]}.`),Z(fa(r,o),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${r} and dilations '${o}'.`),ja("depthwiseConv2d",a,i),{x:()=>dR(l.shape,n,c,r,a,o,i),filter:()=>fR(l,n,c.shape,r,a,o,i)}}};const xK={kernelName:n0,inputsToSave:["x","filter"],gradFunc:(n,e,t)=>{const[s,r]=e,a={x:s,filter:r,dy:n},i={x:s,filter:r,dy:n};return{x:()=>me.runKernel(pb,a,t),filter:()=>me.runKernel(mb,i,t)}}};const vK={kernelName:mm,outputsToSave:[!0],gradFunc:(n,e)=>{const[t]=e,s={dy:n,y:t};return{x:()=>me.runKernel(mx,s)}}};const wK={kernelName:gm,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e,s=xe(li(ws(is(t))),2/Math.sqrt(Math.PI));return{x:()=>xe(n,s)}}};const SK={kernelName:ym,outputsToSave:[!0],gradFunc:(n,e)=>{const[t]=e;return{x:()=>xe(n,t)}}};const NK={kernelName:r0,inputsToSave:["input"],gradFunc:(n,e)=>{const[t]=e;return{input:()=>we(n,t.shape)}}};const kK={kernelName:bm,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>xe(n,li(t))}}};const CK={kernelName:xm,gradFunc:n=>({x:()=>$n(n)})};const TK={kernelName:vm,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,r=on(t.shape,s.shape);return{a:()=>{const o=$t(n,lt(s,"float32")),l=Nr(t.shape,r);return l.length>0?we(St(o,l),t.shape):o},b:()=>{let o=xe(n,lt(t,"float32"));const l=Nr(s.shape,r);l.length>0&&(o=we(St(o,l),s.shape));const c=is(s);return ws($t(o,lt(c,"float32")))}}}};const AK={kernelName:a0,inputsToSave:["x","mean","variance","scale"],gradFunc:(n,e,t)=>{const{varianceEpsilon:s}=t,[r,a,i,o]=e,l=o??Mt(1),c=Nr(a.shape,r.shape),f=[];if(a.rank===1){for(let A=0;A<r.shape.length-1;++A)f.push(r.shape[A]);f.push(1)}const d=mt(r,a),m=xe(n,l),g=xv(et(i,Mt(s))),b=xe(xe(xe(g,g),g),Mt(-.5));return{x:()=>a.rank===1?we(xe(xe(n,lo(we(g,[1,1,1,a.shape[0]]),f)),l),r.shape):we(xe(xe(n,g),l),r.shape),mean:()=>{let A=xe(xe(g,Mt(-1)),m);return a.rank===1&&(A=St(A,c)),we(A,a.shape)},variance:()=>{let A=xe(xe(b,d),m);return a.rank===1&&(A=St(A,c)),we(A,a.shape)},scale:()=>{const A=xe(d,g);let R=xe(n,A);return a.rank===1&&(R=St(R,c)),we(R,a.shape)},offset:()=>{let A=n;return a.rank===1&&(A=St(A,c)),we(A,a.shape)}}}};const IK={kernelName:i0,inputsToSave:["x","indices"],gradFunc:(n,e,t)=>{const[s,r]=e,{axis:a,batchDims:i}=t,o=vn(a,s.shape)[0],l=(c,f,d)=>()=>{const m=c.shape,g=f.size,b=m.slice(0,o),x=b.length,v=m.slice(a,m.length).slice(1),w=v.length,k=UI(0,x),I=UI(x+1,x+1+w),A=VI([b,[g],v]),R=we(d,A),U=we(f,[g]),V=VI([[x],k,I]),P=An(R,V);let D=Ev(P,U,c.shape[o]);const B=Vh(V);return D=An(D,B),D};if(i===1){const c=s.shape[0],f=s.split(c,0);return{x:()=>ui(f.map((g,b)=>l(g,r.slice(b,1),n.slice(b,1))())).reshape(s.shape),indices:()=>r}}else return{x:l(s,r,n),indices:()=>r}}};function UI(n,e){const t=[];for(let s=n;s<e;++s)t.push(s);return t}function VI(n){const e=[];for(let t=0;t<n.length;++t)for(let s=0;s<n[t].length;++s)e.push(n[t][s]);return e}const EK={kernelName:wm,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e;return{a:()=>$n(t),b:()=>$n(s)}}};const _K={kernelName:Sm,gradFunc:n=>({x:()=>lt(n,"float32")})};const $K={kernelName:Nm,gradFunc:n=>({x:()=>$n(n)})};const RK={kernelName:km,gradFunc:n=>({x:()=>$n(n)})};const DK={kernelName:Cm,gradFunc:n=>({x:()=>$n(n)})};const OK={kernelName:l0,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{alpha:r}=t,a=hi(s,0);return{x:()=>ua(a,n,xe(n,r))}}};const LK={kernelName:Am,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>$t(n,et(t,1))}}};const FK={kernelName:Tm,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>$t(n,lt(t,"float32"))}}};const MK={kernelName:j_,inputsToSave:[],outputsToSave:[!0],gradFunc:(n,e,t)=>{const[s]=e,{axis:r}=t;return{logits:()=>{const i=li(s);return mt(n,xe(St(n,r,!0),i))}}}};function zK(n,e,t,s=5,r=1,a=1,i=.5){const o={x:n,y:e,dy:t},l={depthRadius:s,bias:r,alpha:a,beta:i};return me.runKernel(Nx,o,l)}const PK=ge({localResponseNormalizationBackprop_:zK});const BK={kernelName:p0,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const[s,r]=e,{depthRadius:a,bias:i,alpha:o,beta:l}=t;return{x:()=>PK(s,r,n,a,i,o,l)}}};function yD(n,e,t,s){return e.rank<t.rank&&(e=we(e,cr(e.shape,s))),n.rank<t.rank&&(n=we(n,cr(n.shape,s))),{x:()=>xe(n,lt(Wo(t,e),n.dtype))}}const jI={kernelName:m0,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const s=t,{reductionIndices:r}=s,a=e[0],i=e[1],o=vn(r,a.shape),l=yD(n,i,a,o);return{x:()=>l.x()}}};const UK={kernelName:Im,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e;return{a:()=>xe(n,lt(Ac(t,s),"float32")),b:()=>xe(n,lt(jp(t,s),"float32"))}}};function VK(n,e,t,s,r,a,i){const o=te(n,"dy","maxPool3dGrad"),l=te(e,"input","maxPool3dGrad"),c=te(t,"output","maxPool3dGrad");let f=o,d=l,m=c,g=!1;l.rank===4&&(g=!0,f=we(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),d=we(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),m=we(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),Z(f.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${f.rank}.`),Z(d.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${d.rank}.`),Z(m.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${m.rank}.`),ja("maxPool3dGrad",a,i);const b={dy:f,input:d,output:m},x={filterSize:s,strides:r,pad:a,dimRoundingMode:i},v=me.runKernel(Cx,b,x);return g?we(v,[v.shape[1],v.shape[2],v.shape[3],v.shape[4]]):v}const jK=ge({maxPool3dGrad_:VK});const WK={kernelName:y0,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const[s,r]=e,{filterSize:a,strides:i,pad:o,dimRoundingMode:l}=t;return{x:()=>jK(n,s,r,a,i,o,l)}}};function GK(n,e,t,s,r,a,i){const o=te(n,"dy","maxPoolGrad"),l=te(e,"input","maxPoolGrad"),c=te(t,"output","maxPoolGrad");Z(l.rank===o.rank,()=>`Rank of input (${l.rank}) does not match rank of dy (${o.rank})`),Z(o.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${o.rank}.`),Z(l.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`),ja("maxPoolGrad",a,i);const f={dy:o,input:l,output:c},d={filterSize:s,strides:r,pad:a,dimRoundingMode:i};return me.runKernel(kx,f,d)}const qK=ge({maxPoolGrad_:GK});const HK={kernelName:g0,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const[s,r]=e,{filterSize:a,strides:i,pad:o}=t;return{x:()=>qK(n,s,r,a,i,o)}}};const KK={kernelName:b0,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{axis:r}=t,a=vn(r,s.shape),o=Zr(s.shape,a)[1],l=Be(o);return{x:()=>{const f=s.shape.slice();a.forEach(g=>{f[g]=1});const d=we(n,f);return $t(xe(d,si(s.shape,"float32")),l)}}}};const XK={kernelName:x0,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const s=t,{axis:r}=s,[a,i]=e,o=vn(r,a.shape),l=yD(n,i,a,o);return{x:()=>l.x()}}};const YK={kernelName:Em,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e;return{a:()=>xe(n,lt(jh(t,s),"float32")),b:()=>xe(n,lt(hi(t,s),"float32"))}}};const ZK={kernelName:v0,inputsToSave:["x"],gradFunc:(n,e,t)=>{const s=e[0],{paddings:r}=t,a=r.map(i=>i[0]);return{x:()=>Tn(n,a,s.shape)}}};const JK={kernelName:_m,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,r=on(t.shape,s.shape);return{a:()=>{const o=Nr(t.shape,r);return o.length>0?we(St(n,o),t.shape):n},b:()=>{const o=xe(n,ws(tg($t(t,s)))),l=Nr(s.shape,r);return l.length>0?we(St(o,l),s.shape):o}}}};const QK={kernelName:$m,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,r=on(t.shape,s.shape);return{a:()=>{const o=xe(n,lt(s,"float32")),l=Nr(t.shape,r);return l.length>0?we(St(o,l),t.shape):o},b:()=>{const o=xe(n,lt(t,"float32")),l=Nr(s.shape,r);return l.length>0?we(St(o,l),s.shape):o}}}};const eX={kernelName:w0,gradFunc:n=>({x:()=>ws(n)})};const tX={kernelName:k0,inputsToSave:["indices"],gradFunc:(n,e)=>{const t=e[0];return{indices:()=>lr(t.shape,"float32")}}};const nX={kernelName:N0,gradFunc:n=>({x:()=>$n(n)})};const sX={kernelName:C0,saveAllInputs:!0,gradFunc:(n,e,t)=>{const{axis:s}=t;return mo(n,s).map(a=>()=>a)}};const WI={kernelName:T0,inputsToSave:["x"],gradFunc:(n,e,t)=>{const s=e[0],{paddings:r}=t,a=r.map(i=>i[0]);return{x:()=>Tn(n,a,s.shape)}}};const rX={kernelName:Rm,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(n,e)=>{const[t,s,r]=e,a=t,i=s,o=on(a.shape,i.shape);return{a:()=>{const f=lt(i,"float32");let d=xe(n,xe(f,Cu(a,mt(f,Mt(1)))));const m=Nr(a.shape,o);return m.length>0&&(d=St(d,m)),we(d,a.shape)},b:()=>{const f=hi(a,0),d=ua(f,Li(a),$n(a));let m=xe(n,xe(r,d));const g=Nr(i.shape,o);return g.length>0&&(m=St(m,g)),we(m,i.shape)}}}};const aX={kernelName:A0,inputsToSave:["x","alpha"],gradFunc:(n,e)=>{const[t,s]=e,r=hi(t,0);return{x:()=>ua(r,n,xe(n,s)),alpha:()=>{let a=ua(r,$n(n),xe(n,t));const i=Nr(s.shape,n.shape);return i.length>0&&(a=St(a,i)),we(a,s.shape)}}}};function iX(n,e,t){const s=n.shape.slice();s[t]=1;const r=we(e,s),a=T1(n,t,!0,!1),i=T1(n,t,!0,!0),o=xe(a,i);return xe(r,o)}function oX(n,e,t){const s=n.shape.length,r=s-t.length,a=js(t,s);let i=n;a!=null&&(i=An(n,a));const o=i.shape.slice(),c=o.splice(s-t.length,t.length).reduce((m,g)=>m*g,1);o.push(c);const f=i.reshape(o);let d=iX(f,e,r);if(d=d.reshape(i.shape),a!=null){const m=Vh(a);d=An(d,m)}return d}const lX={kernelName:I0,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{axis:r}=t;let a=[];return r==null?a=s.shape.map((i,o)=>o):typeof r=="number"?a=[r]:a=r,{x:()=>oX(s,n,a)}}};const uX={kernelName:pm,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,r=on(t.shape,s.shape);return{a:()=>{const o=$t(n,lt(s,"float32")),l=Nr(t.shape,r);return l.length>0?we(St(o,l),t.shape):o},b:()=>{let o=xe(n,lt(t,"float32"));const l=Nr(s.shape,r);l.length>0&&(o=we(St(o,l),s.shape));const c=is(s);return ws($t(o,lt(c,"float32")))}}}};const cX={kernelName:Dm,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>$t(n,ws(is(t)))}}};const hX={kernelName:Lm,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e,s=xe(jh(t,6),xd(t));return{x:()=>xe(n,lt(s,"float32"))}}};const fX={kernelName:Om,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>xe(n,lt(xd(t),"float32"))}}};const dX={kernelName:E0,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>we(n,t.shape)}}};const pX={kernelName:$0,inputsToSave:["images"],gradFunc:(n,e,t)=>{const[s]=e,r={dy:n,images:s};return{images:()=>me.runKernel(Mx,r,t)}}};const mX={kernelName:_0,inputsToSave:["images"],gradFunc:(n,e,t)=>{const[s]=e,r={dy:n,images:s};return{images:()=>me.runKernel(Fx,r,t)}}};const gX={kernelName:R0,gradFunc:(n,e,t)=>{const{dims:s}=t,r=vn(s,n.shape);return{x:()=>po(n,r)}}};const yX={kernelName:Fm,gradFunc:n=>({x:()=>$n(n)})};const bX={kernelName:Mm,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>ws($t(n,xe(Cu(t,1.5),2)))}}};const xX={kernelName:D0,inputsToSave:["condition"],gradFunc:(n,e)=>{const[t]=e;return{condition:()=>lt($n(t),"float32"),t:()=>xe(n,lt(t,n.dtype)),e:()=>xe(n,lt(Q0(t),n.dtype))}}};const vX={kernelName:zm,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>{const s=hi(t,Mt(0)),r=Mt(jv),a=Mt(Wv),i=xe(n,a),o=xe(xe(n,r),li(lt(t,"float32")));return ua(s,i,o)}}}};const wX={kernelName:Vm,outputsToSave:[!0],gradFunc:(n,e)=>{const[t]=e;return{x:()=>xe(n,xe(t,mt(Mt(1),t)))}}};const SX={kernelName:Um,gradFunc:n=>({x:()=>$n(n)})};const NX={kernelName:Pm,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>xe(K0(lt(t,"float32")),n)}}};const kX={kernelName:Bm,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>xe(ov(lt(t,"float32")),n)}}};const CX={kernelName:O0,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{begin:r,size:a}=t,i=s.shape,[o,l]=Uv(s,r,a),c=[];for(let f=0;f<n.rank;f++)c.push([o[f],i[f]-o[f]-l[f]]);return{x:()=>Ic(n,c)}}};const TX={kernelName:z0,outputsToSave:[!0],gradFunc:(n,e,t)=>{const[s]=e,{dim:r}=t,a=!0,i=xe(n,s);return{logits:()=>mt(i,xe(St(i,[r],a),s))}}};const AX={kernelName:jm,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>xe(n,_l(t))}}};const GI={kernelName:F0,gradFunc:(n,e,t)=>{const{blockShape:s,paddings:r}=t;return{x:()=>H0(n,s,r)}}};const qI={kernelName:M0,gradFunc:(n,e,t)=>{const{axis:s}=t;return{x:()=>ur(n,s)}}};const IX={kernelName:Wm,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>$t(n,xe(Xr(lt(t,"float32")),2))}}};const EX={kernelName:qx,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>xe(n,xe(lt(t,"float32"),2))}}};const _X={kernelName:Gm,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,r=Mt(2);return{a:()=>xe(n,xe(r,mt(t,s))),b:()=>xe(n,xe(r,mt(s,t)))}}};const $X={kernelName:Ym,gradFunc:n=>({x:()=>$n(n)})};const RX={kernelName:qm,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,r=on(t.shape,s.shape);return{a:()=>{let o=n;const l=Nr(t.shape,r);return l.length>0&&(o=St(o,l)),we(o,t.shape)},b:()=>{let o=n;const l=Nr(s.shape,r);return l.length>0&&(o=St(o,l)),we(ws(o),s.shape)}}}};const DX={kernelName:L0,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,r=s.shape.slice(),{axis:a}=t;vn(a,s.shape).forEach(c=>{r[c]=1});const o=we(n,r),l=xe(o,si(s.shape,"float32"));return{x:()=>l}}};const OX={kernelName:Hm,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>$t(n,is(K0(t)))}}};const LX={kernelName:Km,outputsToSave:[!0],gradFunc:(n,e)=>{const[t]=e;return{x:()=>xe(mt(Mt(1),is(t)),n)}}};const FX={kernelName:Xm,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{reps:r}=t;return{x:()=>{let i=$n(s);if(s.rank===1)for(let o=0;o<r[0];++o)i=et(i,Tn(n,[o*s.shape[0]],[s.shape[0]]));else if(s.rank===2)for(let o=0;o<r[0];++o)for(let l=0;l<r[1];++l)i=et(i,Tn(n,[o*s.shape[0],l*s.shape[1]],[s.shape[0],s.shape[1]]));else if(s.rank===3)for(let o=0;o<r[0];++o)for(let l=0;l<r[1];++l)for(let c=0;c<r[2];++c)i=et(i,Tn(n,[o*s.shape[0],l*s.shape[1],c*s.shape[2]],[s.shape[0],s.shape[1],s.shape[2]]));else if(s.rank===4)for(let o=0;o<r[0];++o)for(let l=0;l<r[1];++l)for(let c=0;c<r[2];++c)for(let f=0;f<r[3];++f)i=et(i,Tn(n,[o*s.shape[0],l*s.shape[1],c*s.shape[2],f*s.shape[3]],[s.shape[0],s.shape[1],s.shape[2],s.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${s.rank} tensors yet.`);return i}}}};const MX={kernelName:Wf,gradFunc:(n,e,t)=>{const s=t,{perm:r}=s,a=Vh(r);return{x:()=>An(n,a)}}};const zX={kernelName:B0,gradFunc:(n,e,t)=>{const s=t,{axis:r}=s;return{value:()=>ui(n,r)}}};const PX={kernelName:U0,inputsToSave:["segmentIds"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>BX(n,t)}}};function BX(n,e){const t=_u(e,$n(e)),s=ng(n,t);let r=Ac(e,Mt(0,"int32"));const a=s.rank-r.rank;for(let o=0;o<a;++o)r=Ca(r,o+1);r=Dl(r,si(s.shape,"bool"));const i=$n(s);return ua(r,s,i)}const UX={kernelName:V0,gradFunc:n=>({x:()=>$n(n)})};const VX=[gD,PH,BH,UH,VH,jH,WH,GH,qH,HH,KH,XH,JH,tK,nK,sK,rK,aK,iK,oK,lK,uK,hK,cK,pK,mK,gK,yK,bK,xK,uX,vK,wK,SK,NK,kK,TK,CK,AK,IK,EK,_K,$K,RK,DK,OK,LK,FK,MK,BK,jI,jI,UK,WK,HK,KK,XK,YK,ZK,JK,QK,eX,tX,nX,sX,WI,WI,rX,aX,lX,cX,hX,fX,dX,pX,mX,gX,yX,bX,xX,vX,wX,SX,NX,kX,CX,TX,AX,GI,GI,qI,qI,IX,_X,EX,$X,RX,DX,OX,LX,FX,MX,zX,PX,UX];for(const n of VX)W_(n);je().prototype.abs=function(){return this.throwIfDisposed(),br(this)};je().prototype.acos=function(){return this.throwIfDisposed(),YN(this)};je().prototype.acosh=function(){return this.throwIfDisposed(),ZN(this)};je().prototype.add=function(n){return this.throwIfDisposed(),et(this,n)};je().prototype.all=function(n,e){return this.throwIfDisposed(),rv(this,n,e)};je().prototype.any=function(n,e){return this.throwIfDisposed(),N1(this,n,e)};je().prototype.argMax=function(n){return this.throwIfDisposed(),Qf(this,n)};je().prototype.argMin=function(n){return this.throwIfDisposed(),JN(this,n)};je().prototype.asScalar=function(){return this.throwIfDisposed(),Z(this.size===1,()=>"The array must have only 1 element."),we(this,[])};je().prototype.asType=function(n){return this.throwIfDisposed(),lt(this,n)};je().prototype.as1D=function(){return this.throwIfDisposed(),we(this,[this.size])};je().prototype.as2D=function(n,e){return this.throwIfDisposed(),we(this,[n,e])};je().prototype.as3D=function(n,e,t){return this.throwIfDisposed(),we(this,[n,e,t])};je().prototype.as4D=function(n,e,t,s){return this.throwIfDisposed(),we(this,[n,e,t,s])};je().prototype.as5D=function(n,e,t,s,r){return this.throwIfDisposed(),we(this,[n,e,t,s,r])};je().prototype.asin=function(){return this.throwIfDisposed(),QN(this)};je().prototype.asinh=function(){return this.throwIfDisposed(),ek(this)};je().prototype.atan=function(){return this.throwIfDisposed(),tk(this)};je().prototype.atan2=function(n){return this.throwIfDisposed(),nk(this,n)};je().prototype.atanh=function(){return this.throwIfDisposed(),sk(this)};je().prototype.avgPool=function(n,e,t,s){return this.throwIfDisposed(),q0(this,n,e,t,s)};je().prototype.batchToSpaceND=function(n,e){return this.throwIfDisposed(),H0(this,n,e)};je().prototype.batchNorm=function(n,e,t,s,r){return this.throwIfDisposed(),Zm(this,n,e,t,s,r)};je().prototype.broadcastTo=function(n){return this.throwIfDisposed(),Gf(this,n)};je().prototype.cast=function(n){return this.throwIfDisposed(),lt(this,n)};je().prototype.ceil=function(){return this.throwIfDisposed(),ck(this)};je().prototype.clipByValue=function(n,e){return this.throwIfDisposed(),oi(this,n,e)};je().prototype.concat=function(n,e){return this.throwIfDisposed(),n instanceof Kn&&(n=[n]),ur([this,...n],e)};je().prototype.conv1d=function(n,e,t,s,r,a){return this.throwIfDisposed(),av(this,n,e,t,s,r,a)};je().prototype.conv2dTranspose=function(n,e,t,s,r){return this.throwIfDisposed(),iv(this,n,e,t,s,r)};je().prototype.conv2d=function(n,e,t,s,r,a){return this.throwIfDisposed(),vc(this,n,e,t,s,r,a)};je().prototype.cos=function(){return this.throwIfDisposed(),K0(this)};je().prototype.cosh=function(){return this.throwIfDisposed(),ov(this)};je().prototype.cumprod=function(n,e,t){return this.throwIfDisposed(),T1(this,n,e,t)};je().prototype.cumsum=function(n,e,t){return this.throwIfDisposed(),lv(this,n,e,t)};je().prototype.depthToSpace=function(n,e){return this.throwIfDisposed(),bk(this,n,e)};je().prototype.depthwiseConv2d=function(n,e,t,s,r,a){return this.throwIfDisposed(),Jm(this,n,e,t,s,r,a)};je().prototype.dilation2d=function(n,e,t,s,r){return this.throwIfDisposed(),xk(this,n,e,t,s,r)};je().prototype.divNoNan=function(n){return this.throwIfDisposed(),vk(this,n)};je().prototype.div=function(n){return this.throwIfDisposed(),$t(this,n)};je().prototype.dot=function(n){return this.throwIfDisposed(),wk(this,n)};je().prototype.elu=function(){return this.throwIfDisposed(),Qm(this)};je().prototype.equal=function(n){return this.throwIfDisposed(),Wo(this,n)};je().prototype.erf=function(){return this.throwIfDisposed(),uv(this)};je().prototype.euclideanNorm=function(n,e){return this.throwIfDisposed(),Nk(this,n,e)};je().prototype.exp=function(){return this.throwIfDisposed(),li(this)};je().prototype.expandDims=function(n){return this.throwIfDisposed(),Ca(this,n)};je().prototype.expm1=function(){return this.throwIfDisposed(),kk(this)};je().prototype.fft=function(){return this.throwIfDisposed(),iy(this)};je().prototype.flatten=function(){return this.throwIfDisposed(),we(this,[this.size])};je().prototype.floor=function(){return this.throwIfDisposed(),tg(this)};je().prototype.floorDiv=function(n){return this.throwIfDisposed(),sv(this,n)};je().prototype.gather=function(n,e,t){return this.throwIfDisposed(),ng(this,n,e,t)};je().prototype.greaterEqual=function(n){return this.throwIfDisposed(),Ac(this,n)};je().prototype.greater=function(n){return this.throwIfDisposed(),hi(this,n)};je().prototype.ifft=function(){return this.throwIfDisposed(),Hp(this)};je().prototype.irfft=function(){return this.throwIfDisposed(),Cv(this)};je().prototype.isFinite=function(){return this.throwIfDisposed(),Ck(this)};je().prototype.isInf=function(){return this.throwIfDisposed(),Tk(this)};je().prototype.isNaN=function(){return this.throwIfDisposed(),Ak(this)};je().prototype.leakyRelu=function(n){return this.throwIfDisposed(),Y0(this,n)};je().prototype.lessEqual=function(n){return this.throwIfDisposed(),jh(this,n)};je().prototype.less=function(n){return this.throwIfDisposed(),jp(this,n)};je().prototype.localResponseNormalization=function(n,e,t,s){return this.throwIfDisposed(),Ik(this,n,e,t,s)};je().prototype.logSigmoid=function(){return this.throwIfDisposed(),Ek(this)};je().prototype.logSoftmax=function(n){return this.throwIfDisposed(),fv(this,n)};je().prototype.logSumExp=function(n,e){return this.throwIfDisposed(),J0(this,n,e)};je().prototype.log=function(){return this.throwIfDisposed(),Li(this)};je().prototype.log1p=function(){return this.throwIfDisposed(),Z0(this)};je().prototype.logicalAnd=function(n){return this.throwIfDisposed(),Dl(this,n)};je().prototype.logicalNot=function(){return this.throwIfDisposed(),Q0(this)};je().prototype.logicalOr=function(n){return this.throwIfDisposed(),dv(this,n)};je().prototype.logicalXor=function(n){return this.throwIfDisposed(),_k(this,n)};je().prototype.matMul=function(n,e,t){return this.throwIfDisposed(),bn(this,n,e,t)};je().prototype.maxPool=function(n,e,t,s){return this.throwIfDisposed(),ey(this,n,e,t,s)};je().prototype.max=function(n,e){return this.throwIfDisposed(),fo(this,n,e)};je().prototype.maximum=function(n){return this.throwIfDisposed(),_u(this,n)};je().prototype.mean=function(n,e){return this.throwIfDisposed(),Bs(this,n,e)};je().prototype.min=function(n,e){return this.throwIfDisposed(),Vp(this,n,e)};je().prototype.minimum=function(n){return this.throwIfDisposed(),$h(this,n)};je().prototype.mirrorPad=function(n,e){return this.throwIfDisposed(),Rk(this,n,e)};je().prototype.mod=function(n){return this.throwIfDisposed(),Dk(this,n)};je().prototype.mul=function(n){return this.throwIfDisposed(),xe(this,n)};je().prototype.neg=function(){return this.throwIfDisposed(),ws(this)};je().prototype.norm=function(n,e,t){return this.throwIfDisposed(),eg(this,n,e,t)};je().prototype.notEqual=function(n){return this.throwIfDisposed(),nd(this,n)};je().prototype.oneHot=function(n,e=1,t=0){return this.throwIfDisposed(),Wp(this,n,e,t)};je().prototype.onesLike=function(){return this.throwIfDisposed(),Fi(this)};je().prototype.pad=function(n,e){return this.throwIfDisposed(),Ic(this,n,e)};je().prototype.pool=function(n,e,t,s,r,a){return this.throwIfDisposed(),Ok(this,n,e,t,s,r,a)};je().prototype.pow=function(n){return this.throwIfDisposed(),Cu(this,n)};je().prototype.prelu=function(n){return this.throwIfDisposed(),sy(this,n)};je().prototype.prod=function(n,e){return this.throwIfDisposed(),Lk(this,n,e)};je().prototype.reciprocal=function(){return this.throwIfDisposed(),Pk(this)};je().prototype.relu=function(){return this.throwIfDisposed(),Bl(this)};je().prototype.relu6=function(){return this.throwIfDisposed(),yv(this)};je().prototype.reshapeAs=function(n){return this.throwIfDisposed(),we(this,n.shape)};je().prototype.reshape=function(n){return this.throwIfDisposed(),we(this,n)};je().prototype.resizeBilinear=function(n,e,t){return this.throwIfDisposed(),yR(this,n,e,t)};je().prototype.resizeNearestNeighbor=function(n,e,t){return this.throwIfDisposed(),bR(this,n,e,t)};je().prototype.reverse=function(n){return this.throwIfDisposed(),po(this,n)};je().prototype.rfft=function(){return this.throwIfDisposed(),oy(this)};je().prototype.round=function(){return this.throwIfDisposed(),bv(this)};je().prototype.rsqrt=function(){return this.throwIfDisposed(),xv(this)};je().prototype.selu=function(){return this.throwIfDisposed(),vv(this)};je().prototype.separableConv2d=function(n,e,t,s,r,a){return this.throwIfDisposed(),wv(this,n,e,t,s,r,a)};je().prototype.sigmoid=function(){return this.throwIfDisposed(),_l(this)};je().prototype.sign=function(){return this.throwIfDisposed(),Bk(this)};je().prototype.sin=function(){return this.throwIfDisposed(),Sv(this)};je().prototype.sinh=function(){return this.throwIfDisposed(),Nv(this)};je().prototype.slice=function(n,e){return this.throwIfDisposed(),Tn(this,n,e)};je().prototype.softmax=function(n){return this.throwIfDisposed(),sg(this,n)};je().prototype.softplus=function(){return this.throwIfDisposed(),bd(this)};je().prototype.spaceToBatchND=function(n,e){return this.throwIfDisposed(),ny(this,n,e)};je().prototype.split=function(n,e){return this.throwIfDisposed(),ri(this,n,e)};je().prototype.sqrt=function(){return this.throwIfDisposed(),Xr(this)};je().prototype.square=function(){return this.throwIfDisposed(),is(this)};je().prototype.squaredDifference=function(n){return this.throwIfDisposed(),Tv(this,n)};je().prototype.squeeze=function(n){return this.throwIfDisposed(),Ec(this,n)};je().prototype.stack=function(n,e){this.throwIfDisposed();const t=n instanceof Kn?[this,n]:[this,...n];return ui(t,e)};je().prototype.step=function(n){return this.throwIfDisposed(),xd(this,n)};je().prototype.stridedSlice=function(n,e,t,s,r,a,i,o){return this.throwIfDisposed(),Uk(this,n,e,t,s,r,a,i,o)};je().prototype.sub=function(n){return this.throwIfDisposed(),mt(this,n)};je().prototype.sum=function(n,e){return this.throwIfDisposed(),St(this,n,e)};je().prototype.tan=function(){return this.throwIfDisposed(),Vk(this)};je().prototype.tanh=function(){return this.throwIfDisposed(),_h(this)};je().prototype.tile=function(n){return this.throwIfDisposed(),lo(this,n)};je().prototype.toBool=function(){return this.throwIfDisposed(),lt(this,"bool")};je().prototype.toFloat=function(){return this.throwIfDisposed(),lt(this,"float32")};je().prototype.toInt=function(){return this.throwIfDisposed(),lt(this,"int32")};je().prototype.topk=function(n,e){return this.throwIfDisposed(),Gk(this,n,e)};je().prototype.transpose=function(n){return this.throwIfDisposed(),An(this,n)};je().prototype.unique=function(n){return this.throwIfDisposed(),qk(this,n)};je().prototype.unsortedSegmentSum=function(n,e){return this.throwIfDisposed(),Ev(this,n,e)};je().prototype.unstack=function(n){return this.throwIfDisposed(),mo(this,n)};je().prototype.where=function(n,e){return this.throwIfDisposed(),ua(n,this,e)};je().prototype.zerosLike=function(){return this.throwIfDisposed(),$n(this)};class fu extends Error{constructor(e){super(e),Object.setPrototypeOf(this,fu.prototype)}}class Uo extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Uo.prototype)}}class ke extends Error{constructor(e){super(e),Object.setPrototypeOf(this,ke.prototype)}}class gn extends Error{constructor(e){super(e),Object.setPrototypeOf(this,gn.prototype)}}class L3 extends Error{constructor(e){super(e),Object.setPrototypeOf(this,L3.prototype)}}class bD{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let t;return this.cache.has(e)&&(t=this.cache.get(e),this.cache.delete(e),this.cache.set(e,t)),t}put(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){const s=this.cache.keys().next().value;this.cache.delete(s)}this.cache.set(e,t)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${e}.`);if(this.maxEntries>e)for(let t=0;t<this.maxEntries-e;t++){const s=this.cache.keys().next().value;this.cache.delete(s)}this.maxEntries=e}}function id(n,e){if(Array.isArray(n)){let t=[];for(let s=0;s<e;s++)t=t.concat(n);return t}else{const t=new Array(e);return t.fill(n),t}}function du(n,e){if(!n)throw new L3(e)}function HI(n,e){let t=0;for(const s of n)s===e&&t++;return t}function ni(n){return n.length===1?n[0]:n}function Jn(n){return Array.isArray(n)?n:[n]}function hc(n){const t=n.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return t[0]!=="_"?t:"private"+t}function Mf(n){return n.length<=1||n.indexOf("_")===-1?n:n.replace(/[_]+(\w|$)/g,(e,t)=>t.toUpperCase())}let Fo={};function F3(n){if(n==null)return null;const e={};return e.className=n.getClassName(),e.config=n.getConfig(),e}function eN(n){if(!(n==null||typeof n!="object"))if(Array.isArray(n))n.forEach(e=>eN(e));else{const e=Object.keys(n);for(const t of e){const s=n[t];s!=null&&typeof s=="object"&&(!Array.isArray(s)&&s.type==="ndarray"&&typeof s.value=="number"?n[t]=s.value:eN(s))}}}function hy(n,e={},t={},s="object",r=!1){if(typeof n=="string"){const a=n;let i;if(a in t)i=t[a];else if(a in Fo)i=Fo[a];else if(i=e[a],i==null)throw new ke(`Unknown ${s}: ${n}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return i}else{const a=n;if(a.className==null||a.config==null)throw new ke(`${s}: Improper config format: ${JSON.stringify(a)}.
'className' and 'config' must set.`);const i=a.className;let o,l;if(i in t?[o,l]=t[i]:i in Fo?[o,l]=Fo.className:i in e&&([o,l]=e[i]),o==null)throw new ke(`Unknown ${s}: ${i}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(l!=null){const c={};for(const g of Object.keys(Fo))c[g]=Fo[g];for(const g of Object.keys(t))c[g]=t[g];const f=a.config;f.customObjects=c;const d=Object.assign({},Fo);for(const g of Object.keys(t))Fo[g]=t[g];eN(a.config);const m=l(o,a.config,t,r);return Fo=Object.assign({},d),m}else{const c=Object.assign({},Fo);for(const d of Object.keys(t))Fo[d]=t[d];const f=new o(a.config);return Fo=Object.assign({},c),f}}}function jX(n,e){return n<e?-1:n>e?1:0}function S2(n,e){return-1*jX(n,e)}function Nh(n){if(n==null)return n;const e=[];for(const t of n)e.indexOf(t)===-1&&e.push(t);return e}function WX(n){if(n==null)throw new ke(`Invalid value in obj: ${JSON.stringify(n)}`);for(const e in n)if(n.hasOwnProperty(e))return!1;return!0}function wd(n,e,t){if(t!=null&&n.indexOf(t)<0)throw new ke(`${t} is not a valid ${e}.  Valid values are ${n} or null/undefined.`)}function M3(n,e,t=0,s=1/0){return du(t>=0),du(s>=t),Array.isArray(n)&&n.length>=t&&n.length<=s&&n.every(r=>typeof r===e)}function Hr(n,e){Array.isArray(n)?(Z(n.length>0,()=>`${e} is unexpectedly an empty array.`),n.forEach((t,s)=>Hr(t,`element ${s+1} of ${e}`))):Z(Number.isInteger(n)&&n>0,()=>`Expected ${e} to be a positive integer, but got ${xD(n)}.`)}function xD(n){return n===null?"null":Array.isArray(n)?"["+n.map(e=>xD(e)).join(",")+"]":typeof n=="string"?`"${n}"`:`${n}`}function GX(n,e,t){let s=t!=null?t():Ma(),r;return(...i)=>{const o=t!=null?t():Ma();return o-s<e||(s=o,r=n(...i)),r}}function vD(n){return n==="relu"?"relu":n==="linear"?"linear":n==="elu"?"elu":null}let qX=0;function wD(){return qX++}const N2={};function Gv(n=""){return n in N2||(N2[n]=0),N2[n]+=1,n+N2[n].toString()}const HX=["channelsFirst","channelsLast"],KX=["nearest","bilinear"],XX=["valid","same","causal"],YX=["max","avg"],ZX=["sum","mul","concat","ave"];const xp=new Map;function fr(n){wd(HX,"DataFormat",n)}function JX(n){wd(KX,"InterpolationFormat",n)}function go(n){wd(XX,"PaddingMode",n)}function SD(n){wd(YX,"PoolMode",n)}const h1=[],KI="/";function qf(n,e){h1.push(n);try{const t=e();return h1.pop(),t}catch(t){throw h1.pop(),t}}function QX(){return h1.length===0?"":h1.join(KI)+KI}function ND(n){if(!CD(n))throw new Error("Not a valid tensor name: '"+n+"'");return QX()+n}function kD(n){if(!CD(n))throw new Error("Not a valid tensor name: '"+n+"'");xp.has(n)||xp.set(n,0);const e=xp.get(n);if(xp.set(n,xp.get(n)+1),e>0){const t=`${n}_${e}`;return xp.set(t,1),t}else return n}const eY=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function CD(n){return!!n.match(eY)}function tY(n){return n===parseInt(n.toString(),10)}function kh(n,e,t){e==null&&(e=0),t==null&&(t=n.length);let s=1;for(let r=e;r<t;++r)s*=n[r];return s}function Kp(n){if(n.length===0)return Number.NaN;let e=Number.POSITIVE_INFINITY;for(let t=0;t<n.length;t++){const s=n[t];s<e&&(e=s)}return e}function Rh(n){if(n.length===0)return Number.NaN;let e=Number.NEGATIVE_INFINITY;for(let t=0;t<n.length;t++){const s=n[t];s>e&&(e=s)}return e}function Ol(n,e){if(e<n)throw new ke(`end (${e}) < begin (${n}) is forbidden.`);const t=[];for(let s=n;s<e;++s)t.push(s);return t}let z5;function $r(){return z5==null&&(z5=qN().epsilon()),z5}function Ll(){return"channelsLast"}function wu(n,e){return lt(n,e)}function fy(n,e=-1){const t=n.shape.slice();return e<0&&(e=t.length+e+1),t.splice(e,0,1),we(n,t)}function nY(n,e){return _e(()=>{if(n.shape.length!==2)throw new ke(`repeat() expects a rank-2 tensor, but received a rank-${n.shape.length} tensor.`);const t=fy(n,1);return tN(t,[1,e,1])})}function sY(n){const e=[kh(n.shape)];return we(n,e)}function rY(n){if(n.rank<=1)throw new ke(`batchFlatten requires a minimum rank of 2. Got rank: ${n.rank}.`);const e=[n.shape[0],kh(n.shape,1)];return we(n,e)}function Hf(n,e,t){return _e(()=>{switch(n.rank){case 1:return ry(n,e,t);case 2:return kv(n,[e,0],[t,n.shape[1]]);case 3:return ay(n,[e,0,0],[t,n.shape[1],n.shape[2]]);case 4:return qp(n,[e,0,0,0],[t,n.shape[1],n.shape[2],n.shape[3]]);case 5:return Tn(n,[e,0,0,0,0],[t,n.shape[1],n.shape[2],n.shape[3],n.shape[4]]);case 6:return Tn(n,[e,0,0,0,0,0],[t,n.shape[1],n.shape[2],n.shape[3],n.shape[4],n.shape[5]]);default:throw new ke(`sliceAlongFirstAxis() received an unsupported tensor rank: ${n.rank}`)}})}function P5(n,e,t){return _e(()=>{switch(n.rank){case 1:return ry(n,e,t);case 2:return kv(n,[0,e],[n.shape[0],t]);case 3:return ay(n,[0,0,e],[n.shape[0],n.shape[1],t]);case 4:return qp(n,[0,0,0,e],[n.shape[0],n.shape[1],n.shape[2],t]);default:throw new ke(`sliceAlongLastAxis() received an unsupported tensor rank: ${n.rank}`)}})}function k2(n,e,t,s){return _e(()=>{switch(n.rank){case 1:return ry(n,e,t);case 2:switch(s){case 1:return Hf(n,e,t);case 2:return P5(n,e,t);default:throw new ke(`The axis is not within the rank of the tensor ${s}`)}case 3:switch(s){case 1:return Hf(n,e,t);case 2:return ay(n,[0,e,0],[n.shape[0],t,n.shape[2]]);case 3:return P5(n,e,t);default:throw new ke(`The axis is not within the rank of the tensor ${s}`)}case 4:switch(s){case 1:return Hf(n,e,t);case 2:return qp(n,[0,e,0,0],[n.shape[0],t,n.shape[2],n.shape[3]]);case 3:return qp(n,[0,0,e,0],[n.shape[0],n.shape[1],t,n.shape[3]]);case 4:return P5(n,e,t);default:throw new ke(`The axis is not within the rank of the tensor ${s}`)}default:throw new ke(`sliceAlongLastAxis() received an unsupported tensor rank: ${n.rank}`)}})}function z3(n,e=-1){let t;return e<0&&(t=n[0].rank,t!==0?e=t:e=0),e===n[0].rank&&(e=-1),ur(n,e)}function XI(n,e){switch(n.rank){case 1:return hk([n,e]);case 2:return fk([n,e],0);case 3:return dk([n,e],0);case 4:return pk([n,e],0);default:throw new ke(`concatAlongFirstAxis() received an unsupported tensor rank: ${n.rank}`)}}function tN(n,e){if(Array.isArray(e)||(e=[e]),n.rank!==e.length)throw new ke(`The length of input n (${e.length}) does not match the number of dimensions in input x (${n.rank})`);return lo(n,e)}function qv(n,e=0,t=1,s,r){return gv(n,e,t,s,r)}function Su(n,e,t,s){if(n.rank<2||e.rank<2)throw new gn(`dot requires both inputs to be rank >= 2 but got x shape = ${n.shape} and y shape = ${e.shape}`);if(e.rank>=3){const r=n.shape.slice(-1)[0],a=e.shape.slice(-2)[0];if(r!==a)throw new gn(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${n.shape} and  y shape = ${e.shape}`)}if(n.rank===2&&e.rank===2)return zS({a:n,b:e,transposeA:!1,transposeB:!1,bias:s?nN(n.rank,s,Ll()):null,activation:t});{const r=n.shape.slice(),a=r.pop();n=we(n,[-1,a]);const i=e.shape.slice(),o=i.pop(),l=i.pop(),c=[...i,o],f=Array.from({length:e.rank},(b,x)=>x===0?e.rank-2:x<=e.rank-2?x-1:x);e=we(An(e,f),[l,-1]);const d=[...r,...c];return we(zS({a:n,b:e,transposeA:!1,transposeB:!1,bias:s?nN(n.rank,s,Ll()):null,activation:t}),d)}}function TD(n,e,t){return _e(()=>(Array.isArray(e)?e=Ta(e,"int32"):e=lt(e,"int32"),ng(n,e,t)))}function dy(n){return xe(n,n)}function nN(n,e,t){const s=e.shape;if(e.rank!==1&&e.rank!==n)throw new ke(`Unexpected bias dimensions: ${e.rank}; expected it to be 1 or ${n}`);if(n===5){if(t==="channelsFirst")return s.length===1?we(e,[1,s[0],1,1,1]):we(e,[1,s[3],s[0],s[1],s[2]]);if(t==="channelsLast")return s.length===1?we(e,[1,1,1,1,s[0]]):we(e,[1].concat(s))}else if(n===4){if(t==="channelsFirst")return s.length===1?we(e,[1,s[0],1,1]):we(e,[1,s[2],s[0],s[1]]);if(t==="channelsLast")return s.length===1?we(e,[1,1,1,s[0]]):we(e,[1].concat(s))}else if(n===3){if(t==="channelsFirst")return s.length===1?we(e,[1,s[0],1]):we(e,[1,s[1],s[0]]);if(t==="channelsLast")return s.length===1?we(e,[1,1,s[0]]):we(e,[1].concat(s))}else if(n<3)return e;throw new ke(`Unsupported input rank by biasAdd: ${e.rank}`)}function Ul(n,e,t){return _e(()=>(t==null&&(t=Ll()),fr(t),et(n,nN(n.rank,e,t))))}function aY(n,e=1){if(e!==1)throw new gn(`Support for alpha values other than 1 (${e}) is not implemented yet.`);return Qm(n)}function iY(n){return _e(()=>$t(n,et(br(n),1)))}function AD(n,e,t,s){return _e(()=>Xk(n,e,t,s))}function oY(n){return _e(()=>{const e=et(.5,xe(.2,n));return oi(e,0,1)})}function py(n,e,t=!1){return t?n():e()}const lY=["fanIn","fanOut","fanAvg"],uY=["normal","uniform","truncatedNormal"];function cY(n){wd(lY,"FanMode",n)}function hY(n){wd(uY,"Distribution",n)}class Ho extends vd{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class ID extends Ho{apply(e,t){return lr(e,t)}}ID.className="Zeros";st(ID);class P3 extends Ho{apply(e,t){return si(e,t)}}P3.className="Ones";st(P3);class ED extends Ho{constructor(e){if(super(),typeof e!="object")throw new ke(`Expected argument of type ConstantConfig but got ${e}`);if(e.value===void 0)throw new ke(`config must have value set but got ${e}`);this.value=e.value}apply(e,t){return _e(()=>xe(Mt(this.value),si(e,t)))}getConfig(){return{value:this.value}}}ED.className="Constant";st(ED);class _D extends Ho{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,t){return Wh(e,this.minval,this.maxval,t,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}_D.className="RandomUniform";st(_D);class $D extends Ho{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if(t=t||"float32",t!=="float32"&&t!=="int32")throw new gn(`randomNormal does not support dType ${t}.`);return qv(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}$D.className="RandomNormal";st($D);class RD extends Ho{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if(t=t||"float32",t!=="float32"&&t!=="int32")throw new gn(`truncatedNormal does not support dType ${t}.`);return Iv(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}RD.className="TruncatedNormal";st(RD);class DD extends Ho{constructor(e){super(),this.gain=e.gain!=null?e.gain:1}apply(e,t){return _e(()=>{if(e.length!==2||e[0]!==e[1])throw new ke("Identity matrix initializer can only be used for 2D square matrices.");return xe(this.gain,cv(e[0]))})}getConfig(){return{gain:this.gain}}}DD.className="Identity";st(DD);function fY(n,e="channelsLast"){let t,s;if(fr(e),n.length===2)t=n[0],s=n[1];else if([3,4,5].indexOf(n.length)!==-1){if(e==="channelsFirst"){const r=kh(n,2);t=n[1]*r,s=n[0]*r}else if(e==="channelsLast"){const r=kh(n,0,n.length-2);t=n[n.length-2]*r,s=n[n.length-1]*r}}else{const r=kh(n);t=Math.sqrt(r),s=Math.sqrt(r)}return[t,s]}class Mi extends Ho{constructor(e){if(super(),e.scale<0)throw new ke(`scale must be a positive float. Got: ${e.scale}`);this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?"fanIn":e.mode,cY(this.mode),this.distribution=e.distribution==null?"normal":e.distribution,hY(this.distribution),this.seed=e.seed}apply(e,t){const s=fY(e),r=s[0],a=s[1];let i=this.scale;if(this.mode==="fanIn"?i/=Math.max(1,r):this.mode==="fanOut"?i/=Math.max(1,a):i/=Math.max(1,(r+a)/2),this.distribution==="normal"){const o=Math.sqrt(i);if(t=t||"float32",t!=="float32"&&t!=="int32")throw new gn(`${this.getClassName()} does not support dType ${t}.`);return Iv(e,0,o,t,this.seed)}else{const o=Math.sqrt(3*i);return Wh(e,-o,o,t,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}Mi.className="VarianceScaling";st(Mi);class B3 extends Mi{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Mi.className}}B3.className="GlorotUniform";st(B3);class U3 extends Mi{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Mi.className}}U3.className="GlorotNormal";st(U3);class V3 extends Mi{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Mi.className}}V3.className="HeNormal";st(V3);class j3 extends Mi{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Mi.className}}j3.className="HeUniform";st(j3);class W3 extends Mi{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Mi.className}}W3.className="LeCunNormal";st(W3);class G3 extends Mi{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Mi.className}}G3.className="LeCunUniform";st(G3);class OD extends Ho{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,t){return _e(()=>{if(e.length<2)throw new gn("Shape must be at least 2D.");if(t!=="int32"&&t!=="float32"&&t!==void 0)throw new TypeError(`Unsupported data type ${t}.`);t=t;const s=Be(e.slice(0,-1)),r=e[e.length-1],a=s*r;a>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${a}) elements: Slowness may result.`);const i=[Math.max(r,s),Math.min(r,s)],o=qv(i,0,1,t,this.seed),l=Qk.qr(o,!1);let c=l[0];const d=l[1].flatten().stridedSlice([0],[Math.min(r,s)*Math.min(r,s)],[Math.min(r,s)+1]);return c=xe(c,d.sign()),s<r&&(c=c.transpose()),xe(Mt(this.gain),c.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}}OD.className="Orthogonal";st(OD);const YI={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function ZI(n,e={}){return hy(n,oo.getMap().classNameMap,e,"initializer")}function Us(n){return F3(n)}function Rs(n){if(typeof n=="string"){const e=n in YI?YI[n]:n;if(e==="GlorotNormal")return new U3;if(e==="GlorotUniform")return new B3;if(e==="HeNormal")return new V3;if(e==="HeUniform")return new j3;if(e==="LeCunNormal")return new W3;if(e==="LeCunUniform")return new G3;{const t={};return t.className=e,t.config={},ZI(t)}}else return n instanceof Ho?n:ZI(n)}function sN(n){return Array.isArray(n)&&Array.isArray(n[0])}function Nb(n){return n.length===0?[]:Array.isArray(n[0])?n:[n]}function Qt(n){let e;if(Array.isArray(n)){if(n.length!==1)throw new ke(`Expected Tensor length to be 1; got ${n.length}`);e=n[0]}else e=n;return e}function Vn(n){if(Array.isArray(n)&&Array.isArray(n[0])){if(n.length===1)return n=n,n[0];throw new ke(`Expected exactly 1 Shape; got ${n.length}`)}else return n}function kb(n){let e=0;for(const t of n)t.shape.length===0?e+=1:e+=t.shape.reduce((s,r)=>s*r);return e}const JI="Variable";class dY{constructor(e,t="float32",s=JI,r=!0,a=null){this.dtype=t??"float32",this.shape=e.shape,this.id=wD(),s=s??JI,this.originalName=ND(s),this.name=kD(this.originalName),this.trainable_=r,this.constraint=a,this.val=Hk(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),pY(this.val,e),this.val.id!==e.id&&(this.val.assign(e),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}}function pY(n,e){if(n.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(n.shape)+" vs. "+JSON.stringify(e.shape))}function rN(n){return n.map(e=>e.read())}function q3(n){n.forEach(e=>{e[0].write(e[1])})}class Rr{constructor(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class Au{constructor(e,t,s,r,a,i,o){this.dtype=e,this.shape=t,this.sourceLayer=s,this.inputs=r,this.callArgs=a,this.outputTensorIndex=o,this.id=wD(),i!=null&&(this.originalName=ND(i),this.name=kD(this.originalName)),this.rank=t.length}}let mY=0;class Hv{constructor(e,t){this.callArgs=t,this.id=mY++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(const s of e.inboundLayers)s?.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){const e=[];for(const t of this.inboundLayers)t!=null?e.push(t.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let gY=0;class Sn extends vd{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=gY++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let t=e.name;if(!t){const s=this.getClassName();t=hc(s)+"_"+Gv(s)}if(this.name=t,this.trainable_=e.trainable==null?!0:e.trainable,e.inputShape!=null||e.batchInputShape!=null){let s;if(e.batchInputShape!=null)s=e.batchInputShape;else if(e.inputShape!=null){let a=null;e.batchSize!=null&&(a=e.batchSize),s=[a].concat(e.inputShape)}this.batchInputShape=s;let r=e.dtype;r==null&&(r=e.inputDType),r==null&&(r="float32"),this.dtype=r}e.weights!=null?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,t){return e.name+"_ib-"+t.toString()}getNodeAtIndex(e,t){if(this.inboundNodes.length===0)throw new Uo(`The layer has never been called and thus has no defined ${t}.`);if(this.inboundNodes.length<=e)throw new ke(`Asked to get ${t} at node ${e}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[e]}getInputAt(e){return ni(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return ni(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new fu(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new fu(`Layer ${this.name} is not connected, no input to return.`);return ni(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new fu(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new fu(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return ni(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(t=>t.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){const t=Jn(e);if(this.inputSpec==null||this.inputSpec.length===0)return;const s=Jn(this.inputSpec);if(t.length!==s.length)throw new ke(`Layer ${this.name} expects ${s.length} inputs, but it received ${t.length} input tensors. Input received: ${e}`);for(let r=0;r<t.length;r++){const a=t[r],i=s[r];if(i==null)continue;const o=a.rank;if(i.ndim!=null&&o!==i.ndim)throw new ke(`Input ${r} is incompatible with layer ${this.name}: expected ndim=${i.ndim}, found ndim=${o}`);if(i.maxNDim!=null&&o>i.maxNDim)throw new ke(`Input ${r} is incompatible with layer ${this.name}: expected max_ndim=${i.maxNDim}, found ndim=${o}`);if(i.minNDim!=null&&o<i.minNDim)throw new ke(`Input ${r} is incompatible with layer ${this.name}: expected min_ndim=${i.minNDim}, found ndim=${o}.`);if(i.dtype!=null&&a.dtype!==i.dtype)throw new ke(`Input ${r} is incompatible with layer ${this.name} : expected dtype=${i.dtype}, found dtype=${a.dtype}.`);if(i.axes){const l=a.shape;for(const c in i.axes){const f=Number(c),d=i.axes[c],m=f>=0?l[f]:l[l.length+f];if(d!=null&&[d,null].indexOf(m)===-1)throw new ke(`Input ${r} is incompatible with layer ${this.name}: expected axis ${f} of input shape to have value ${d} but got shape ${l}.`)}}if(i.shape!=null)for(let l=0;l<i.shape.length;++l){const c=i.shape[l],f=a.shape[l];if(c!=null&&f!=null&&c!==f)throw new ke(`Input ${r} is incompatible with layer ${this.name}: expected shape=${i.shape}, found shape=${a.shape}.`)}}}call(e,t){return e}invokeCallHook(e,t){this._callHook!=null&&this._callHook(e,t)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,t){t=t||{},this.assertNotDisposed();const s=Jn(e),r=xY(e),a=vY(e);if(r===a)throw new ke("Arguments to apply() must be all SymbolicTensors or all Tensors");return qf(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);const i=[];for(const o of Jn(e))i.push(o.shape);this.build(ni(i)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&a&&(this._refCount=1)}if(this.assertInputCompatibility(e),a){let i=this.call(e,t);this.supportsMasking&&this.setMaskMetadata(e,i);const o=Jn(i),l=[];for(let c of o)s.indexOf(c)!==-1&&(c=c.clone()),l.push(c);if(i=ni(l),this.activityRegularizer!=null)throw new gn("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return i}else{const i=yY(e),o=this.computeOutputShape(i);let l;const c=bY(e);if(this.warnOnIncompatibleInputShape(Array.isArray(e)?i[0]:i),o!=null&&o.length>0&&Array.isArray(o[0])?l=o.map((f,d)=>new Au(c,f,this,Jn(e),t,this.name,d)):l=new Au(c,o,this,Jn(e),t,this.name),this.addInboundNode(e,l,null,null,i,o,t),this._refCount++,this.activityRegularizer!=null)throw new gn("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return l}})}warnOnIncompatibleInputShape(e){if(this.batchInputShape!=null)if(e.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(e)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let t=!1;this.batchInputShape.forEach((s,r)=>{s!=null&&e[r]!=null&&e[r]!==s&&(t=!0)}),t&&console.warn(`The shape of the input tensor (${JSON.stringify(e)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new fu(`The layer ${this.name} has never been called and thus has no defined output shape.`);const e=[];for(const t of this.inboundNodes){const s=JSON.stringify(t.outputShapes);e.indexOf(s)===-1&&e.push(s)}if(e.length===1){const t=this.inboundNodes[0].outputShapes;return Array.isArray(t)&&Array.isArray(t[0])&&t.length===1?t[0]:t}else throw new fu(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new Uo(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return kb(this.weights)}build(e){this.built=!0}getWeights(e=!1){return rN(e?this.trainableWeights:this.weights)}setWeights(e){_e(()=>{const t=this.weights;if(t.length!==e.length)throw new ke(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${e.length}, but the layer was expecting ${t.length} weights. Provided weights: ${e}...`);if(t.length===0)return;const s=[],r=rN(t);for(let a=0;a<r.length;++a){const i=r[a],o=t[a],l=e[a];if(!Nn(i.shape,l.shape))throw new ke(`Layer weight shape ${i.shape} not compatible with provided weight shape ${l.shape}`);s.push([o,l])}q3(s)})}addWeight(e,t,s,r,a,i,o,l){if(this._addedWeightNames.indexOf(e)!==-1)throw new ke(`Duplicate weight name ${e} for layer ${this.name}`);this._addedWeightNames.push(e),s==null&&(s="float32"),this.fastWeightInitDuringBuild&&(r=l!=null?l():Rs("zeros"));const c=r.apply(t,s),f=new dY(c,s,e,i,o);return c.dispose(),a!=null&&this.addLoss(()=>a.apply(f.read())),i==null&&(i=!0),i?this._trainableWeights.push(f):this._nonTrainableWeights.push(f),f}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){e==null||Array.isArray(e)&&e.length===0||(e=Jn(e),this._losses!==void 0&&this._losses!==null&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,t){if(!this.supportsMasking){if(t!=null)if(Array.isArray(t))t.forEach(s=>{if(s!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return t}setMaskMetadata(e,t,s){if(!this.supportsMasking)return;const r=this.computeMask(e,s),a=Jn(t),i=Jn(r);if(a.length!==i.length)throw new Error(`${this.name} outputs ${a.length} tensors but ${a.length} masks for those tensors`);for(let o=0;o<a.length;o++)a[o].kerasMask=i[o]}addInboundNode(e,t,s,r,a,i,o=null){const l=Jn(e);t=Jn(t),s=Jn(s),r=Jn(r),a=Nb(a),i=Nb(i);const c=[],f=[],d=[];for(const m of l)c.push(m.sourceLayer),f.push(m.nodeIndex),d.push(m.tensorIndex);new Hv({outboundLayer:this,inboundLayers:c,nodeIndices:f,tensorIndices:d,inputTensors:l,outputTensors:t,inputMasks:s,outputMasks:r,inputShapes:a,outputShapes:i},o);for(let m=0;m<t.length;m++)t[m].sourceLayer=this,t[m].nodeIndex=this.inboundNodes.length-1,t[m].tensorIndex=m}getConfig(){const e={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(e.batchInputShape=this.batchInputShape),this.dtype!=null&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let e=0;return--this._refCount===0&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}function yY(n){n=Jn(n);const e=[];for(const t of n)e.push(t.shape);return ni(e)}function bY(n){return"float32"}function LD(n,e,t){if((e==null||t!=null&&t>0)&&(e=n.sourceLayer,t=n.nodeIndex),e.inboundNodes.length===0)return[n];{const s=e.inboundNodes[t];if(s.inboundLayers.length===0)return s.inputTensors;{const r=[];for(let a=0;a<s.inboundLayers.length;a++){const i=s.inputTensors[a],o=s.inboundLayers[a],l=s.nodeIndices[a],c=LD(i,o,l);for(const f of c)r.indexOf(f)===-1&&r.push(f)}return r}}}function xY(n){let e=!0;for(const t of Jn(n))if(!(t instanceof Au)){e=!1;break}return e}function vY(n){let e=!0;for(const t of Jn(n))if(t instanceof Au){e=!1;break}return e}class my extends Sn{constructor(e){if(super({dtype:e.dtype,name:e.name!=null?e.name:Gv("input").toString()}),e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new ke("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let t=e.batchInputShape;if(t==null){if(e.inputShape==null)throw new ke("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");t=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new ke("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const s=e.dtype||"float32";this.batchInputShape=t,this.dtype=s,this.inputSpec=[{shape:t}];const r=new Au(this.dtype,this.batchInputShape,this,[],{},this.name);r.nodeIndex=0,r.tensorIndex=0,new Hv({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[r],outputTensors:[r],inputMasks:[null],outputMasks:[null],inputShapes:[t],outputShapes:[t]})}apply(e,t){throw new ke(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}my.className="InputLayer";st(my);function wY(n){if(n.batchShape==null&&n.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(n.batchShape!=null&&n.shape!=null)throw new ke("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=n.batchShape;n.shape!=null&&e==null&&(e=[null].concat(n.shape));let t=n.dtype;return t==null&&(t="float32"),new my({batchInputShape:e,name:n.name,dtype:t,sparse:n.sparse}).inboundNodes[0].outputTensors[0]}function SY(n,e){if(n.dtype==null||n.dtype===e.dtype)return e;try{return lt(e,n.dtype)}catch{throw new ke(`The dtype of the feed (${e.dtype}) can not be cast to the dtype of the key '${n.name}' (${n.dtype}).`)}}class xh{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof xh)for(const t in e.id2Value)this.id2Value[t]=e.id2Value[t],t in e.id2Mask&&(this.id2Mask[t]=e.id2Mask[t]);else{if(e==null)return;for(const t of e)this.add(t.key,t.value)}}add(e,t,s){if(this.id2Value[e.id]==null)this.id2Value[e.id]=SY(e,t),this.name2Id[e.name]=e.id,s!=null&&(this.id2Mask[e.id]=s);else throw new ke(`Duplicate key: name=${e.name}, id=${e.id}`);return this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return this.id2Value[e.id]!=null}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof Au){if(this.id2Value[e.id]==null)throw new ke(`Nonexistent key: ${e.name}`);return this.id2Value[e.id]}else{const t=this.name2Id[e];if(t==null)throw new ke(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Value[t]}}getMask(e){if(e instanceof Au){if(this.id2Value[e.id]==null)throw new ke(`Nonexistent key: ${e.name}`);return this.id2Mask[e.id]}else{const t=this.name2Id[e];if(t==null)throw new ke(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Mask[t]}}disposeMasks(){this.id2Mask!=null&&xn(this.id2Mask)}}const Cb=new bD,Tb=new bD;function NY(n){Cb?.setMaxEntries(n),Tb?.setMaxEntries(n)}function o1(n,e,t,s){const r=t==null?!1:t.training,a=Array.isArray(n),i=a?n:[n],o=i.map(b=>b.name),l=[],c=e.names();for(const b of o)c.indexOf(b)!==-1?l.push(e.getValue(b)):l.push(null);const f=o.join(",")+"|"+e.names().sort().join(",");let d=Cb.get(f),m;if(d==null){const b=kY(i,e);d=b.sorted,m=b.recipientCounts,Cb.put(f,d),Tb.put(f,m)}m={},r||Object.assign(m,Tb.get(f));const g=new xh(e);for(let b=0;b<d.length;++b){const x=d[b],v=x.sourceLayer;if(v instanceof my)continue;const w=[],k=[],I=[];let A=!1;for(const D of x.inputs){const B=g.getValue(D),E=g.getMask(D);w.push(B),k.push(E),E!=null&&(A=!0),r||(m[D.name]--,m[D.name]===0&&!e.hasKey(D)&&o.indexOf(D.name)===-1&&!B.isDisposed&&D.sourceLayer.stateful!==!0&&I.push(B))}A&&(t=t||{},t.mask=k[0]);const R=Jn(v.apply(w,t));let U=null;v.supportsMasking&&(U=v.computeMask(w,k));const V=TY(x),P=Array.isArray(V)?V:[V];for(let D=0;D<P.length;++D){g.hasKey(P[D])||g.add(P[D],R[D],Array.isArray(U)?U[0]:U);const B=o.indexOf(P[D].name);B!==-1&&(l[B]=R[D])}r||xn(I)}return g.disposeMasks(),a?l:l[0]}function kY(n,e){Z(n!=null&&n.length>0,()=>"Expected at least one fetch, got none");let t=[],s={};if(n.length===1){const r=QI(n[0],e);t=r.sorted,s=r.recipientMap}else{const r=new Set;for(const a of n){const{sorted:i,recipientMap:o}=QI(a,e);for(const l of i)r.has(l.name)||(t.push(l),r.add(l.name));for(const l in o)s[l]==null&&(s[l]=new Set),o[l].forEach(c=>s[l].add(c))}}return{sorted:t,recipientCounts:CY(s)}}function CY(n){const e={};for(const t in n)e[t]=n[t].size;return e}function QI(n,e){const t=new Set,s=[],r={};for(const o of e.names())t.add(o);const a=[],i=[];for(a.push(n);a.length>0;){const o=a[a.length-1];if(t.has(o.name)){a.pop();continue}const l=i[i.length-1]===a.length-1;if(o.inputs.length===0||l)a.pop(),s.push(o),t.add(o.name),l&&i.pop();else{i.push(a.length-1);for(const c of o.inputs)r[c.name]==null&&(r[c.name]=new Set),r[c.name].add(o.name),!t.has(c.name)&&a.push(c)}}return{sorted:s,recipientMap:r}}function TY(n){let e;if(n.sourceLayer.inboundNodes.length===1)e=n.sourceLayer.output;else{let t=null;for(let s=0;s<n.sourceLayer.inboundNodes.length;++s)for(const r of n.sourceLayer.inboundNodes[s].outputTensors)if(r.id===n.id){t=s;break}e=n.sourceLayer.getOutputAt(t)}return e}const AY=De();AY.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,NY);function H3(n,e){return _e(()=>Xr(St(xe(n,n),e,!0)))}class gy extends vd{getConfig(){return{}}}class FD extends gy{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return _e(()=>{const t=H3(e,this.axis),s=oi(t,0,this.maxValue);return xe(e,$t(s,et($r(),t)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}FD.className="MaxNorm";st(FD);class MD extends gy{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return _e(()=>$t(e,et($r(),H3(e,this.axis))))}getConfig(){return{axis:this.axis}}}MD.className="UnitNorm";st(MD);class zD extends gy{apply(e){return Bl(e)}}zD.className="NonNeg";st(zD);class PD extends gy{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue!=null?e.minValue:this.defaultMinValue,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.rate=e.rate!=null?e.rate:this.defaultRate,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return _e(()=>{const t=H3(e,this.axis),s=et(xe(this.rate,oi(t,this.minValue,this.maxValue)),xe(1-this.rate,t));return xe(e,$t(s,et($r(),t)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}PD.className="MinMaxNorm";st(PD);const eE={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function Dr(n){return F3(n)}function tE(n,e={}){return hy(n,oo.getMap().classNameMap,e,"constraint")}function Or(n){if(n==null)return null;if(typeof n=="string"){const t={className:n in eE?eE[n]:n,config:{}};return tE(t)}else return n instanceof gy?n:tE(n)}async function Ef(n){if(n==null)return;const e=[],t=[],s=[];for(const r in n){const a=n[r];if(typeof a!="number"){const i=a;e.push(i.data()),t.push(r),s.push(i)}}if(e.length>0){const r=await Promise.all(e);for(let a=0;a<r.length;++a)n[t[a]]=r[a][0];xn(s)}}function BD(n){if(n!=null)for(const e in n){const t=n[e];typeof t!="number"&&t.dispose()}}var nE;(function(n){n[n.SILENT=0]="SILENT",n[n.VERBOSE=1]="VERBOSE"})(nE||(nE={}));const IY=125;class A1{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,t){}async onEpochEnd(e,t){}async onBatchBegin(e,t){}async onBatchEnd(e,t){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}}class EY{constructor(e,t=10){e==null&&(e=[]),this.callbacks=e,this.queueLength=t}append(e){this.callbacks.push(e)}setParams(e){for(const t of this.callbacks)t.setParams(e)}setModel(e){for(const t of this.callbacks)t.setModel(e)}async onEpochBegin(e,t){t==null&&(t={});for(const s of this.callbacks)await s.onEpochBegin(e,t)}async onEpochEnd(e,t){t==null&&(t={});for(const s of this.callbacks)await s.onEpochEnd(e,t)}async onBatchBegin(e,t){t==null&&(t={});for(const s of this.callbacks)await s.onBatchBegin(e,t)}async onBatchEnd(e,t){t==null&&(t={});for(const s of this.callbacks)await s.onBatchEnd(e,t)}async onTrainBegin(e){e==null&&(e={});for(const t of this.callbacks)await t.onTrainBegin(e)}async onTrainEnd(e){e==null&&(e={});for(const t of this.callbacks)await t.onTrainEnd(e)}}class _Y extends A1{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,t){t==null&&(t={});const s=t.size==null?0:t.size;this.seen+=s;for(const r in t){const a=t[r];if(typeof a=="number")this.totals.hasOwnProperty(r)||(this.totals[r]=0),this.totals[r]=this.totals[r]+a*s;else{let i;r in this.totals?i=this.totals[r]:this.totals[r]=0;const o=_e(()=>et(this.totals[r],xe(a,s)));this.totals[r]=o,i?.dispose()}}}async onEpochEnd(e,t){if(t!=null)for(const s of this.params.metrics)this.totals[s]!=null&&(typeof this.totals[s]=="number"?t[s]=this.totals[s]/this.seen:_e(()=>{const r=xe($t(1,this.seen),this.totals[s]);t[s]=r,this.totals[s].dispose(),_r(t[s])}))}}class $Y extends A1{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,t){t==null&&(t={}),this.epoch.push(e);for(const s in t)this.history[s]==null&&(this.history[s]=[]),this.history[s].push(t[s])}async syncData(){const e=[],t=[],s=[];for(const a in this.history){const i=this.history[a];for(let o=0;o<i.length;++o)if(typeof i[o]!="number"){const l=i[o];e.push(l.data()),t.push(a),s.push(o)}}const r=await Promise.all(e);for(let a=0;a<r.length;++a)this.history[t[a]][s[a]].dispose(),this.history[t[a]][s[a]]=r[a][0]}}class RY extends A1{constructor(e,t){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||p3,this.yieldEvery=t||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=IY),this.yieldEvery==="never"&&e.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");fb(this.yieldEvery)&&(this.maybeWait=GX(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,t,s){const r=[];this.yield!=null&&(await Ef(s),r.push(this.yield(e,t,s))),r.push(this.nextFrameFunc()),await Promise.all(r)}async onEpochBegin(e,t){this.currentEpoch=e,this.epochBegin!=null&&(await Ef(t),await this.epochBegin(e,t))}async onEpochEnd(e,t){const s=[];this.epochEnd!=null&&(await Ef(t),s.push(this.epochEnd(e,t))),this.yieldEvery==="epoch"&&s.push(this.nextFrameFunc()),await Promise.all(s)}async onBatchBegin(e,t){this.batchBegin!=null&&(await Ef(t),await this.batchBegin(e,t))}async onBatchEnd(e,t){const s=[];this.batchEnd!=null&&(await Ef(t),s.push(this.batchEnd(e,t))),this.yieldEvery==="batch"?s.push(this.nextFrameFunc()):fb(this.yieldEvery)&&s.push(this.maybeWait(this.currentEpoch,e,t)),await Promise.all(s)}async onTrainBegin(e){this.trainBegin!=null&&(await Ef(e),await this.trainBegin(e))}async onTrainEnd(e){this.trainEnd!=null&&(await Ef(e),await this.trainEnd(e))}}function UD(n,e){return n==null&&(n={}),n instanceof A1?[n]:Array.isArray(n)&&n[0]instanceof A1?n:Jn(n).map(s=>new RY(s,e))}class zo{constructor(){}static registerCallbackConstructor(e,t){Z(e>=0&&Number.isInteger(e),()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`),zo.checkForDuplicate(t),zo.constructors[e]==null&&(zo.constructors[e]=[]),zo.constructors[e].push(t)}static checkForDuplicate(e){for(const t in zo.constructors)zo.constructors[+t].forEach(r=>{if(r===e)throw new ke("Duplicate callback constructor.")})}static clear(){zo.constructors={}}static createCallbacks(e){const t=[];for(const s in zo.constructors){const r=+s;e>=r&&t.push(...zo.constructors[r])}return t.map(s=>new s)}}zo.constructors={};function VD(n,e,t,s,r,a,i,o,l){const c=new $Y,f=[new _Y,...zo.createCallbacks(e)];n!=null&&f.push(...n),f.push(c);const d=new EY(f);return d.setParams({epochs:t,initialEpoch:s,samples:r,steps:a,batchSize:i,verbose:e,doValidation:o,metrics:l}),{callbackList:d,history:c}}function gc(n,e={},t=!1){return hy(n,oo.getMap().classNameMap,e,"layer",t)}function Ab(n,e){return _e(()=>{n.dtype!=="float32"&&(n=lt(n,"float32"));const t=St(dy(n),e,!0),s=yd(t.shape,$r()),r=Xr(_u(t,s));return $t(n,r)})}function Kv(n,e){return _e(()=>Bs(dy(mt(e,n)),-1))}function K3(n,e){return _e(()=>Bs(br(mt(e,n)),-1))}function X3(n,e){return _e(()=>{const t=mt(n,e),s=oi(br(n),$r(),Number.MAX_VALUE),r=br($t(t,s));return xe(100,Bs(r,-1))})}function DY(n,e){return _e(()=>{const t=oi(e,$r(),Number.MAX_VALUE),s=Li(et(1,t)),r=oi(n,$r(),Number.MAX_VALUE),a=Li(et(1,r));return Bs(dy(mt(s,a)),-1)})}function OY(n,e){return _e(()=>{const t=_u(0,mt(1,xe(n,e)));return Bs(dy(t),-1)})}function LY(n,e){return _e(()=>{const t=_u(0,mt(1,xe(n,e)));return Bs(t,-1)})}function FY(n,e){return _e(()=>{const t=St(xe(n,e),-1),s=fo(xe(mt(1,n),e),-1);return _u(0,et(1,mt(s,t)))})}function MY(n,e){return _e(()=>{const t=Math.log(2),s=mt(e,n),r=mt(et(s,bd(xe(-2,s))),t);return Bs(r,-1)})}function I1(n,e,t=!1){return _e(()=>{if(t)e=sg(e);else{const s=St(e,e.shape.length-1,!0);e=$t(e,s)}return e=oi(e,$r(),1-$r()),ws(St(xe(lt(n,"float32"),Li(e)),e.shape.length-1))})}function Ib(n,e,t=!1){return _e(()=>{const s=lt(tg(sY(n)),"int32");e=oi(e,$r(),1-$r());const r=e.shape,a=we(Wp(s,r[r.length-1]),r);return I1(a,e,t)})}function zY(n,e){if(!Nn(n.shape,e.shape))throw new ke(`logits and labels must have the same shape, but got shapes ${JSON.stringify(n.shape)} and ${JSON.stringify(e.shape)}`);return _e(()=>{const t=Bl(e),s=ws(br(e));return et(mt(t,xe(e,n)),Z0(li(s)))})}function Xv(n,e){return _e(()=>{let t;return t=oi(e,$r(),1-$r()),t=Li($t(t,mt(1,t))),Bs(zY(n,t),-1)})}function PY(n,e){return _e(()=>{const t=oi(n,$r(),1),s=oi(e,$r(),1);return St(xe(n,Li($t(t,s))),-1)})}function BY(n,e){return _e(()=>{const t=Li(et($r(),e));return Bs(mt(e,xe(n,t)),-1)})}function jD(n,e){return _e(()=>{const t=Ab(n,-1),s=Ab(e,-1),r=xe(t,s);return ws(St(r,-1))})}const Eb={meanSquaredError:Kv,meanAbsoluteError:K3,meanAbsolutePercentageError:X3,meanSquaredLogarithmicError:DY,squaredHinge:OY,hinge:LY,categoricalHinge:FY,logcosh:MY,categoricalCrossentropy:I1,sparseCategoricalCrossentropy:Ib,binaryCrossentropy:Xv,kullbackLeiblerDivergence:PY,poisson:BY,cosineProximity:jD};function B5(n){if(typeof n=="string"){if(n in Eb)return Eb[n];let e=`Unknown loss ${n}`;throw n.toLowerCase().includes("softmaxcrossentropy")&&(e=`Unknown loss ${n}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new ke(e)}else return n}function WD(n,e){return _e(()=>{const t=xe(.5,Fi(e)),s=wu(hi(e,t),n.dtype);return Bs(Wo(n,s),-1)})}function GD(n,e){return _e(()=>wu(Wo(Qf(n,-1),Qf(e,-1)),"float32"))}function UY(n,e){return _e(()=>lt(St(Dl(Wo(n,1),Wo(e,1))),"float32"))}function VY(n,e){return _e(()=>lt(St(Dl(Wo(n,0),Wo(e,1))),"float32"))}function jY(n,e){return _e(()=>{const t=UY(n,e),s=VY(n,e),r=et(t,s);return lt(ua(hi(r,0),$t(t,r),0),"float32")})}function WY(n,e){return Xv(n,e)}function GY(n,e){return n.rank===e.rank&&(n=Ec(n,[n.rank-1])),e=Qf(e,-1),e.dtype!==n.dtype&&(e=lt(e,n.dtype)),lt(Wo(n,e),"float32")}const qY=Kv,HY=Kv,KY=K3,XY=K3,YY=X3,ZY=X3,qD=I1,JY=jD,HD=Ib,_b={binaryAccuracy:WD,categoricalAccuracy:GD,precision:jY,categoricalCrossentropy:qD,sparseCategoricalCrossentropy:HD,mse:qY,MSE:HY,mae:KY,MAE:XY,mape:YY,MAPE:ZY,cosine:JY};function QY(n){if(typeof n=="string"&&n in _b)return _b[n];if(typeof n!="string"&&n!=null)return n;throw new ke(`Unknown metric ${n}`)}function C2(n){if(du(n!==null,`Unknown LossOrMetricFn ${n}`),typeof n=="string")return n;{let e;for(const t of Object.keys(Eb))if(Eb[t]===n){e=t;break}if(e!==void 0)return e;for(const t of Object.keys(_b))if(_b[t]===n){e=t;break}return e!==void 0?e:n.name}}function eZ(n){const e={Adagrad:()=>Rf.adagrad(.01),Adadelta:()=>Rf.adadelta(1,.95,$r()),Adam:()=>Rf.adam(.001,.9,.999,$r()),Adamax:()=>Rf.adamax(.002,.9,.999,$r(),0),RMSProp:()=>Rf.rmsprop(.001,.9,0,$r()),SGD:()=>Rf.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,n in e)return e[n]();throw new ke(`Unknown Optimizer ${n}`)}const sE=1*1024*1024;function rE(n,e,t=!1){if(n==null||typeof n!="object"||Object.getPrototypeOf(n)!==Object.prototype||!aN(n))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(t){const s=JSON.stringify(n);s.length>sE&&console.warn(`User-defined metadata of model "${e}" is too large in size (length=${s.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${sE}.`)}}function aN(n){if(n===null)return!0;if(typeof n=="object")if(Object.getPrototypeOf(n)===Object.prototype){const e=Object.keys(n);for(const t of e)if(typeof t!="string"||!aN(n[t]))return!1;return!0}else if(Array.isArray(n)){for(const e of n)if(!aN(e))return!1;return!0}else return!1;else{const e=typeof n;return e==="string"||e==="number"||e==="boolean"}}function tZ(n,e,t,s=console.log){const r=sZ(n),a=["Layer (type)","Input Shape","Output shape","Param #"];r?(e=e||90,t=t||[.32,.61,.89,1]):(e=e||115,t=t||[.24,.48,.7,.8,1]),t[t.length-1]<=1&&(t=t.map(f=>Math.floor(e*f)));let i;if(!r){a.push("Receives inputs"),i=[];for(const f in n.nodesByDepth)i.push(...n.nodesByDepth[f])}s("_".repeat(e)),$b(a,t,s),s("=".repeat(e));const o=n.layers;for(let f=0;f<o.length;++f)r?rZ(o[f],t,s):aZ(o[f],t,i,s),s((f===o.length-1?"=":"_").repeat(e));n.checkTrainableWeightsConsistency();const l=nZ(n),c=kb(n.nonTrainableWeights);s(`Total params: ${l+c}`),s(`Trainable params: ${l}`),s(`Non-trainable params: ${c}`),s("_".repeat(e))}function nZ(n){let e;return n.collectedTrainableWeights!=null?e=kb(n.collectedTrainableWeights):e=kb(n.trainableWeights),e}function sZ(n){let e=!0;const t=[],s=[];for(const r in n.nodesByDepth)t.push(n.nodesByDepth[r]);for(const r of t){if(r.length>1||r.length===1&&r[0].inboundLayers.length>1){e=!1;break}s.push(...r)}if(e)for(const r of n.layers){let a=!1;for(const i of r.inboundNodes)if(s.indexOf(i)!==-1)if(a){e=!1;break}else a=!0;if(!e)break}return e}function $b(n,e,t=console.log){let s="";for(let r=0;r<n.length;++r)r>0&&(s=s.slice(0,s.length-1)+" "),s+=n[r],s=s.slice(0,e[r]),s+=" ".repeat(e[r]-s.length);t(s)}function rZ(n,e,t){let s,r;try{r=n.inboundNodes.map(l=>JSON.stringify(l.inputShapes)).join(",")}catch{r="multiple"}try{s=JSON.stringify(n.outputShape)}catch{s="multiple"}const a=n.name,i=n.getClassName(),o=[`${a} (${i})`,r,s,n.countParams().toString()];$b(o,e,t)}function aZ(n,e,t,s){let r,a;try{a=n.inboundNodes.map(d=>JSON.stringify(d.inputShapes)).join(",")}catch{a="multiple"}try{r=JSON.stringify(n.outputShape)}catch{r="multiple"}const i=[];for(const d of n.inboundNodes)if(!(t!=null&&t.length>0&&t.indexOf(d)===-1))for(let m=0;m<d.inboundLayers.length;++m){const g=d.inboundLayers[m].name,b=d.nodeIndices[m],x=d.tensorIndices[m];i.push(`${g}[${b}][${x}]`)}const o=n.name,l=n.getClassName(),c=i.length===0?"":i[0],f=[`${o} (${l})`,a,r,n.countParams().toString(),c];$b(f,e,s);for(let d=1;d<i.length;++d)$b(["","","","",i[d]],e,s)}function KD(n,e,t){return(n==="inboundNodes"||n==="outputLayers"||n==="inputLayers")&&e===0&&typeof t=="string"}function iN(n,e){if(n===null)return null;if(typeof n=="string")return Mf(n);if(typeof n=="number"||typeof n=="boolean")return n;if(n instanceof Array){const t=[],s=n.length;for(let r=0;r<s;++r){const a=n[r];KD(e,r,a)?t.push(a):t.push(iN(a,e))}return t}else{const t={};for(const s of Object.keys(n)){const r=n[s];if(s==="name"&&typeof r=="string")t[s]=r;else{const a=Mf(s);t[a]=iN(r,a)}}return t}}function oN(n,e){if(n==null)return null;if(typeof n=="string")return hc(n);if(typeof n=="number"||typeof n=="boolean")return n;if(n instanceof Array){const t=[],s=n.length;for(let r=0;r<s;++r){const a=n[r];KD(e,r,a)?t.push(a):t.push(oN(a,e))}return t}else{const t={};for(const s of Object.keys(n)){const r=n[s],a=hc(s);(s==="name"||s==="className")&&typeof r=="string"?t[a]=r:t[a]=oN(r,s)}return t}}const XD="4.22.0";const iZ=n=>{const e=Object.keys(n);if(e.length===0)return!1;const t=e[0].split("/");return!isNaN(parseInt(t[t.length-1],10))};class Cl extends Sn{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,this.name==null){const k=this.getClassName().toLowerCase();this.name=Gv(k)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],Nh(this.inputs).length!==this.inputs.length)throw new ke(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(k=>k.name)}`);Nh(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(k=>k.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const k of this.outputs){const I=k.sourceLayer,A=k.nodeIndex,R=k.tensorIndex;this.outputLayers.push(I),this.outputLayersNodeIndices.push(A),this.outputLayersTensorIndices.push(R)}for(const k of this.inputs){const I=k.sourceLayer,A=k.nodeIndex,R=k.tensorIndex;du(A===0,"input layer has >1 nodes"),du(R===0,"input layer has >1 tensors"),this.inputLayers.push(I),this.inputLayersNodeIndices.push(A),this.inputLayersTensorIndices.push(R)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let k=0;k<this.inputLayers.length;k++){const I=this.inputLayers[k];if(!(I instanceof my))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${e.inputs}. Input ${k} (0-based) originates from layer type ${I.getClassName()}.`);this.inputNames.push(I.name),this.feedInputShapes.push(I.batchInputShape),this.feedInputNames.push(I.name)}for(const k of this.outputLayers)this.outputNames.push(k.name);this.internalInputShapes=this.inputs.map(k=>k.shape),this.internalOutputShapes=this.outputs.map(k=>k.shape);const t={},s={},r={},a={},i={},o=[],l=(k,I,A,R,U,V)=>{(R==null||U==null||V==null)&&(R=k.sourceLayer,U=k.nodeIndex,V=k.tensorIndex);const P=R.inboundNodes[U];if(A.indexOf(P)!==-1)throw new Uo(`The tensor ${k.name} at layer "${R.name}" is part of a cycle.`);if(I.indexOf(P)!==-1)return;this.containerNodes.add(Cl.nodeKey(R,U)),R.id in i||(i[R.id]=Object.keys(i).length),A.indexOf(P)===-1&&A.push(P);const D=P.inboundLayers.length;for(let B=0;B<D;B++){const E=P.inputTensors[B],M=P.inboundLayers[B],K=P.nodeIndices[B],X=P.tensorIndices[B];l(E,I,A,M,K,X)}for(I.push(P);A.indexOf(P)>=0;)A.splice(A.indexOf(P),1);o.push(P)},c=[],f=[];for(const k of this.outputs)l(k,c,f);const d=o.slice().reverse();for(const k of d){s[k.id]=k,k.id in t||(t[k.id]=0);let I=t[k.id];const A=r[k.outboundLayer.id]==null?0:r[k.outboundLayer.id];I=Math.max(I,A),r[k.outboundLayer.id]=I,a[k.outboundLayer.id]=k.outboundLayer,t[k.id]=I;for(let R=0;R<k.inboundLayers.length;R++){const U=k.inboundLayers[R],V=k.nodeIndices[R],P=U.inboundNodes[V],D=t[P.id]==null?0:t[P.id];t[P.id]=Math.max(I+1,D),s[P.id]=P}}const m={};for(const k in t){const I=t[k];I in m||(m[I]=[]),m[I].push(s[k])}const g={};for(const k in r){const I=r[k];I in g||(g[I]=[]),g[I].push(a[k])}let b=Object.keys(g).map(k=>parseInt(k,10)).sort(S2);this.layers=[];for(const k of b){const I=g[k];I.sort((A,R)=>{const U=i[A.id],V=i[R.id];return U<V?-1:U>V?1:0});for(const A of I)A instanceof Cl&&this.internalContainerRefs.push(A),this.layers.push(A)}this.layersByDepth=g,b=Object.keys(m).map(k=>parseInt(k,10)).sort(S2);const x=this.inputs.slice(),v=[];for(const k of b)for(const I of m[k]){const A=I.outboundLayer;if(A!=null){for(const R of I.inputTensors)if(x.indexOf(R)===-1)throw new Uo(`Graph disconnected: cannot obtain value for tensor ${R} at layer "${A.name}". The following previous layers were accessed without issue: ${v}`);for(const R of I.outputTensors)x.push(R);v.push(A.name)}}this.nodesByDepth=m;const w=this.layers.map(k=>k.name);for(const k of w){const I=w.filter(A=>A===k).length;if(I!==1)throw new Uo(`The name "${k}" is used ${I} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(w))}this.outboundNodes=[],this.inboundNodes=[],new Hv({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(k=>null),outputMasks:this.outputs.map(k=>null),inputShapes:this.inputs.map(k=>k.shape),outputShapes:this.outputs.map(k=>k.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const e={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const t of this.layers)e.numDisposedVariables+=t.dispose().numDisposedVariables;for(const t of this.internalContainerRefs)e.numDisposedVariables+=t.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach(t=>{t._trainableWeights.forEach(s=>s.trainable=e)}),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new ke("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(const t of this.layers)e=e.concat(t.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const t of this.layers)e.push(...t.nonTrainableWeights);if(!this.trainable){const t=[];for(const s of this.layers)t.push(...s.trainableWeights);return t.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e,t=!0){const s={};let r=0;const a=iZ(e);a&&this.parseWeights(e);for(const o of this.layers)for(const[l,c]of o.weights.entries()){const f=a?`${c.name.split("/").slice(0,-1).join("/")+"/"}${l}`:c.originalName;if(s[f]!=null)throw new ke(`Duplicate weight name: ${f}`);s[f]=c,r++}const i=[];for(const o in e){let l=o;if(s[o]==null){const c=o.split("/");l=c.slice(0,-2).concat([c[c.length-1]]).join("/")}if(s[l]!=null)i.push([s[l],e[o]]);else if(t)throw new ke(`Provided weight data has no target variable: ${o}`);delete s[l]}if(t){const o=[];for(const l in s)o.push(l);if(o.length>0)throw new ke(`${o.length} of ${r} weights are not set: ${o}`)}q3(i)}parseWeights(e){for(const t in Object.keys(e)){const s=t.split("/"),r=["vars","layer_checkpoint_dependencies"],a=s.map(i=>i.startsWith("_")?i.slice(1):i).filter(i=>!r.includes(i)).join("/");a!==t&&(e[a]=e[t],delete e[t])}}updatedConfig(){const e=this.getConfig(),t={};return t.className=this.getClassName(),t.config=e,t.kerasVersion=`tfjs-layers ${XD}`,t.backend="TensorFlow.js",t}toJSON(e,t=!0){const s=oN(this.updatedConfig());return t?JSON.stringify(s):s}call(e,t){return _e(()=>{e=Jn(e);const s=new xh;for(let r=0;r<this.inputs.length;++r)s.add(this.inputs[r],e[r]);return o1(this.outputs,s,t)})}computeMask(e,t){return _e(()=>{e=Jn(e);let s;return t==null?s=id(null,e.length):s=Jn(t),this.runInternalGraph(e,s)[1]})}computeOutputShape(e){const t=Nb(e);if(t.length!==this.inputLayers.length)throw new ke(`Invalid inputShape argument ${e}: model has ${this.inputLayers.length} tensor inputs.`);const s={};for(let o=0;o<t.length;o++){const l=this.inputLayers[o],c=t[o],f=l.name+"_0_0";s[f]=c}const r=Object.keys(this.nodesByDepth).map(o=>parseInt(o,10)).sort(S2);if(r.length>1)for(const o of r){const l=this.nodesByDepth[o];for(const c of l){const f=c.outboundLayer;if(this.inputLayers.map(x=>x.id).indexOf(f.id)!==-1)continue;const d=[];for(let x=0;x<c.inboundLayers.length;x++){const v=c.inboundLayers[x],w=c.nodeIndices[x],k=c.tensorIndices[x],I=`${v.name}_${w}_${k}`,A=s[I];d.push(A)}const m=f.computeOutputShape(ni(d)),g=Nb(m),b=f.inboundNodes.indexOf(c);for(let x=0;x<g.length;x++){const v=`${f.name}_${b}_${x}`;s[v]=g[x]}}}const a=[],i=[];for(let o=0;o<this.outputLayers.length;o++){const l=this.outputLayers[o],c=this.outputLayersNodeIndices[o],f=this.outputLayersTensorIndices[o],d=`${l.name}_${c}_${f}`;i.push(d)}for(let o=0;o<i.length;o++){const l=i[o];du(l in s),a.push(s[l])}return ni(a)}runInternalGraph(e,t){t==null&&(t=id(null,e.length));const s={};for(let l=0;l<this.inputs.length;++l){const c=this.inputs[l],f=e[l],d=t[l];s[c.id]=[f,d]}const r=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(S2);for(const l of r){const c=this.nodesByDepth[l];for(const f of c){const d=f.outboundLayer,m=f.inputTensors,g=f.outputTensors,b=new Array;for(const x of m)x.id in s&&b.push(s[x.id]);if(b.length===m.length){let x={},v,w,k,I;if(f.callArgs!=null&&(x=f.callArgs),b.length===1){const[A,R]=b[0];x.mask==null&&(x.mask=R),k=Jn(d.call(A,x)),I=Jn(d.computeMask(A,R)),v=[A],w=[R]}else v=b.map(A=>A[0]),w=b.map(A=>A[1]),x.mask==null&&(x.mask=w),k=Jn(d.call(v,x)),I=Jn(d.computeMask(v,w));if(d.activityRegularizer)throw new gn("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let A=0;A<g.length;++A){const R=g[A],U=k[A],V=I[A];s[R.id]=[U,V]}}}}const a=[],i=[],o=[];for(const l of this.outputs){du(l.id in s,`Could not compute output ${l.name} : ${l.id}`);const[c,f]=s[l.id];o.push(c.shape),a.push(c),i.push(f)}return[a,i,o]}buildNodeConversionMap(e){const t={};let s;for(const r of this.layers){s=r instanceof Cl?1:0;for(let a=0;a<r.inboundNodes.length;a++){const i=Cl.nodeKey(r,a);this.containerNodes.has(i)&&(t[i]=s,s+=1)}}return t}getLayer(e,t){if(t!=null)return this.findLayer(t);if(e==null)throw new ke("Provide either a layer name or layer index");if(typeof e=="number")return this.findLayer(e);for(const s of this.layers)if(s.name===e)return s;throw new ke(`No such layer: ${e}`)}findLayer(e){if(this.layers.length<=e)throw new ke(`Was asked to retrieve layer at index ${e}, but model only has ${this.layers.length} layer(s).`);return this.layers[e]}calculateLosses(){return _e(()=>{const e=[];for(const t of this.layers)for(let s=0;s<t.inboundNodes.length;++s){const r=Cl.nodeKey(t,s);this.containerNodes.has(r)&&e.push(...t.calculateLosses())}return e})}getConfig(){const e={name:this.name},t=this.buildNodeConversionMap(this.layers),s=[];for(const i of this.layers){const o=i.getClassName(),l=i.getConfig(),c=[];for(let d=0;d<i.inboundNodes.length;d++){const m=i.inboundNodes[d],g=Cl.nodeKey(i,d);let b={};if(this.containerNodes.has(g)){if(m.callArgs)try{JSON.stringify(m.callArgs),b=m.callArgs}catch{console.warn(`Layer ${i.name} was passed non-serializable keyword arguments: ${m.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),b={}}if(m.inboundLayers.length>0){const x=[];for(let v=0;v<m.inboundLayers.length;v++){const w=m.inboundLayers[v],k=m.nodeIndices[v],I=m.tensorIndices[v],A=Cl.nodeKey(w,k);let R=t[A];R==null&&(R=0),x.push([w.name,R,I,b])}c.push(x)}}}const f={};f.name=i.name,f.className=o,f.config=l,f.inboundNodes=c,s.push(f)}e.layers=s;const r=[];for(let i=0;i<this.inputLayers.length;i++){const o=this.inputLayers[i],l=this.inputLayersNodeIndices[i],c=Cl.nodeKey(o,l);if(!this.containerNodes.has(c))continue;let f=t[c];f==null&&(f=0);const d=this.inputLayersTensorIndices[i];r.push([o.name,f,d])}e.inputLayers=r;const a=[];for(let i=0;i<this.outputLayers.length;i++){const o=this.outputLayers[i],l=this.outputLayersNodeIndices[i],c=Cl.nodeKey(o,l);if(!this.containerNodes.has(c))continue;let f=t[c];f==null&&(f=0);const d=this.outputLayersTensorIndices[i];a.push([o.name,f,d])}return e.outputLayers=a,e}static fromConfig(e,t,s={},r=!1){const a={},i={};function o(v,w){v.name in i?i[v.name].push(w):i[v.name]=[w]}function l(v,w){const k=[];let I;for(const A of w){const R=A[0],U=A[1],V=A[2];if(I=A[3]==null?{}:A[3],!(R in a)){o(v,w);return}const P=a[R];if(P.inboundNodes.length<=U){o(v,w);return}const D=P.inboundNodes[U];k.push(D.outputTensors[V])}k.length>0&&v.apply(ni(k),I)}function c(v){const w=v.name,k=gc(v,t.customObjects!=null?t.customObjects:{});k.setFastWeightInitDuringBuild(r),a[w]=k,v.inboundNodes.forEach(A=>{if(!(A instanceof Array))throw new ke(`Corrupted configuration, expected array for nodeData: ${A}`);o(k,A)})}const f=t.name,d=t.layers;for(const v of d)c(v);for(;!WX(i);)for(const v of d){const w=a[v.name];if(w.name in i){const k=i[w.name];delete i[w.name];for(const I of k)l(w,I)}}const m=[],g=[],b=t.inputLayers;for(const v of b){const w=v[0],k=v[1],I=v[2];du(w in a);const R=a[w].inboundNodes[k].outputTensors;m.push(R[I])}const x=t.outputLayers;for(const v of x){const w=v[0],k=v[1],I=v[2];du(w in a);const R=a[w].inboundNodes[k].outputTensors;g.push(R[I])}return new e({inputs:m,outputs:g,name:f})}get stateful(){if(this._stateful)throw new ke("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const e of this.layers)if(e.stateful)return!0;return!1}resetStates(){_e(()=>{this.layers.forEach(e=>{e.stateful&&e.resetStates()})})}}function oZ(n,e,t){const s=e.length;if(n==null||Array.isArray(n)&&n.length===0)return e.map(r=>null);if(s===1)return Array.isArray(n)&&n.length===1?n:typeof n=="object"&&e[0]in n?[n[e[0]]]:[n];if(Array.isArray(n)){if(n.length!==s)throw new Error(`Provided ${t} is an array of ${n.length} element(s), but the model has ${s} outputs. Make sure a set of weights is provided for each model output.`);return n}else if(typeof n=="object"&&Object.keys(n).length>0&&typeof n[Object.keys(n)[0]]=="object"){const r=[];return e.forEach(a=>{a in n?r.push(n[a]):r.push(null)}),r}else throw new Error(`The model has multiple (${s}) outputs, so ${t} must be either an array with ${s} elements or an object with ${e} keys. Provided ${t} not understood: ${JSON.stringify(n)}`)}function YD(n,e){return oZ(n,e,"classWeight")}async function ZD(n,e,t,s){if(t!=null){const r=_e(()=>{if(n.shape.length===1)return xu(n);if(n.shape.length===2){if(n.shape[1]>1)return Qf(n,1);if(n.shape[1]===1)return we(n,[n.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${n.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${n.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),a=Array.from(await r.data());xn(r);const i=[];return a.forEach(o=>{if(t[o]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${o} exists in the data but not in classWeight`);i.push(t[o])}),Ta(i,"float32")}else return null}function lZ(n,e){return xe(n,e)}const uZ=32;function JD(n,e){let t,s;const r=e;t=r.xs,s=r.ys,Z(t!=null&&s!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${e}`);const a=aE("input",n.inputNames,t),i=aE("output",n.outputNames,s),o=a[0].shape[0];Z(a.length===n.inputs.length,()=>`LayersModel has ${n.inputs.length} inputs, but the dataset provides ${a.length} inputs.  (Expected input keys: ${JSON.stringify(n.inputNames)})`),Z(i.length===n.outputs.length,()=>`LayersModel has ${n.outputs.length} outputs, but the dataset provides ${i.length} outputs.  (Expected output keys: ${JSON.stringify(n.outputNames)})`);for(let l=0;l<a.length;l++)Z(a[l].shape[0]===o,()=>`Batch size mismatch: input ${n.inputNames[l]} has ${a[l].shape[0]}; expected  ${o} based on input ${n.inputNames[0]}.`);for(let l=0;l<i.length;l++)Z(i[l].shape[0]===o,()=>`Batch size mismatch: output ${n.outputNames[l]} has ${i[l].shape[0]}; expected  ${o} based on input ${n.inputNames[0]}.`);return{xs:a,ys:i}}function aE(n,e,t){if(t instanceof Kn)return[t];if(Array.isArray(t))return Z(t.length===e.length,()=>`Received an array of ${t.length} Tensors, but expected ${e.length} to match the ${n} keys ${e}.`),t;{const s=[];for(const r of e){if(t[r]==null)throw new ke(`The feature data generated by the dataset lacks the required ${n} key '${r}'.`);s.push(t[r])}return s}}function cZ(n){if(n.length===3)throw new gn("Validation with sample weights is not implemented yet.");return{xs:n[0],ys:n[1]}}async function hZ(n,e,t){const s=t.batchesPerEpoch!=null;if(Z(n.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),Z(t!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),Z(t.epochs!=null&&t.epochs>0&&Number.isInteger(t.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${t.epochs}`),Z(!s||t.batchesPerEpoch>0&&Number.isInteger(t.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${t.batchesPerEpoch}`),Z(t.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),n.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");n.isTraining=!0;try{const r=t.validationData!=null;let a,i;if(r)if(iE(t.validationData))Z(t.validationBatches==null||t.validationBatches>0&&Number.isInteger(t.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${t.validationBatches}`);else{const v=cZ(t.validationData);a=v.xs,i=v.ys}const o=n.makeTrainFunction(),l=n.getDedupedMetricsNames();let c;r?c=l.slice().concat(l.map(v=>"val_"+v)):c=l.slice();const f=UD(t.callbacks,t.yieldEvery),d=t.verbose==null?1:t.verbose,{callbackList:m,history:g}=VD(f,d,t.epochs,null,null,fZ(e,t),null,r,c);m.setModel(n),n.history=g,await m.onTrainBegin(),n.stopTraining_=!1;let b=t.initialEpoch==null?0:t.initialEpoch,x=await e.iterator();for(;b<t.epochs;){const v={};await m.onEpochBegin(b);let w=0,k=0;for(s||(x=await e.iterator());!s||w<t.batchesPerEpoch;){const I=await x.next();if(s&&I.done){console.warn(`You provided \`batchesPerEpoch\` as ${t.batchesPerEpoch}, but your dataset iterator ran out of data after ${w} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${t.batchesPerEpoch*t.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(I.value!=null){const{xs:A,ys:R}=JD(n,I.value),U={};U.batch=k,U.size=A[0].shape[0],await m.onBatchBegin(k,U);const V=[];if(t.classWeight!=null){const B=YD(t.classWeight,n.outputNames);for(let E=0;E<B.length;++E)V.push(await ZD(R[E],null,B[E]))}const P=A.concat(R).concat(V),D=o(P);xn(P);for(let B=0;B<l.length;++B){const E=l[B],M=D[B];U[E]=M,_r(M)}await m.onBatchEnd(k,U),BD(U),k++,w++}if(s?w>=t.batchesPerEpoch:I.done){if(r){let A;iE(t.validationData)?A=Jn(await n.evaluateDataset(t.validationData,{batches:t.validationBatches})):A=Jn(n.evaluate(a,i,{batchSize:t.validationBatchSize==null?uZ:t.validationBatchSize,verbose:0}));for(let R=0;R<n.metricsNames.length;++R)v[`val_${n.metricsNames[R]}`]=A[R]}break}if(n.stopTraining_)break}if(await m.onEpochEnd(b,v),b++,n.stopTraining_)break}return await m.onTrainEnd(),await n.history.syncData(),n.history}finally{n.isTraining=!1}}function fZ(n,e){let t=null;return e.batchesPerEpoch!=null?t=e.batchesPerEpoch:Number.isFinite(n.size)&&(t=n.size),t}function iE(n){return typeof n.iterator=="function"}function dZ(n){return typeof n.next=="function"}async function pZ(n,e,t){t=t||{};const s=t.batches!=null,r=n.testFunction;let a=[];if(t.verbose>0)throw new gn("Verbose mode is not implemented yet.");Z(!s||t.batches>0&&Number.isInteger(t.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(t.batches)}`);const i=dZ(e)?e:await e.iterator();let o=0,l=0;for(;!s||l<t.batches;){const c=await i.next();if(a=_e(()=>{if(c.value){const{xs:f,ys:d}=JD(n,c.value),m=f.concat(d),g=_e(()=>r(m));if(xn(m),l===0)for(let x=0;x<g.length;++x)a.push(Mt(0));const b=m[0].shape[0];for(let x=0;x<g.length;++x){const v=g[x],w=a[x];a[x]=_e(()=>et(a[x],xe(b,v))),l>0&&xn(w)}xn(g),o+=b,++l}return a}),c.done){s&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${t.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let c=0;c<a.length;++c){const f=a[c];a[c]=$t(a[c],o),xn(f)}return ni(a)}function U5(n){Z(n>0&&Number.isInteger(n),()=>`batchSize is required to be a positive integer, but got ${n}`)}function t1(n,e,t){return n==null?[null]:Array.isArray(n)?n.map(s=>Hf(s,e,t-e)):Hf(n,e,t-e)}function lN(n,e){return _e(()=>n==null?null:Array.isArray(n)?n.map(t=>lN(t,e)):TD(n,e.dtype==="int32"?e:lt(e,"int32")))}function V5(n,e){const t=[];let s=0,r=null;for(;s<n;)r=s+e,r>=n&&(r=n),t.push([s,r]),s=r;return t}function QD(n){const e=[];n instanceof Kn&&(n=[n]);for(let t=0;t<n.length;++t){const s=n[t];if(s.rank===1)e.push(fy(s,1));else{if(s.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(s)}}return e}function Nl(n,e){if(n==null)return;const t=[];if(e instanceof Kn)t.push(e.id);else if(Array.isArray(e))e.forEach(r=>t.push(r.id));else if(e!=null)for(const r in e){const a=e[r];t.push(a.id)}const s=[];if(n instanceof Kn)t.indexOf(n.id)===-1&&s.push(n);else if(Array.isArray(n))n.forEach(r=>{t.indexOf(r.id)===-1&&s.push(r)});else if(n!=null)for(const r in n){const a=n[r];t.indexOf(a.id)===-1&&s.push(a)}s.forEach(r=>{r.isDisposed||r.dispose()})}function mZ(n){return n instanceof Kn}function uN(n){return Array.isArray(n)}function oE(n){return!mZ(n)&&!uN(n)}function lE(n,e,t,s=!0,r=""){if(e==null||e.length===0){if(n!=null){let i=!1;if(uN(n)&&n.length>0)i=!0;else if(oE(n)){for(const o in n)if(n.hasOwnProperty(o)){i=!0;break}}else i=!0;if(i)throw new ke(`Error when checking model ${r} expected no data, but got ${n}`)}return[]}if(n==null)return e.map(i=>null);let a;if(oE(n)){n=n,a=[];for(const i of e){if(n[i]==null)throw new ke(`No data provided for "${i}". Need data for each key in: ${e}`);a.push(n[i])}}else if(uN(n)){if(n=n,n.length!==e.length)throw new ke(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${e.length} Tensor(s), but instead got the following list of Tensor(s): ${n}`);a=n}else{if(n=n,e.length>1)throw new ke(`The model ${r} expects ${e.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${n.shape}`);a=[n]}if(a=QD(a),t!=null)for(let i=0;i<e.length;++i){if(t[i]==null)continue;const o=a[i];if(o.shape.length!==t[i].length)throw new ke(`Error when checking ${r}: expected ${e[i]} to have ${t[i].length} dimension(s). but got array with shape ${o.shape}`);for(let l=0;l<t[i].length;++l){if(l===0&&!s)continue;const c=o.shape[l],f=t[i][l];if(f!=null&&f>=0&&c!==f)throw new ke(`${r} expected a batch of elements where each example has shape [${t[i].slice(1,t[i].length)}] (i.e.,tensor shape [*,${t[i].slice(1,t[i].length)}]) but the ${r} received an input with ${o.shape[0]} examples, each with shape [${o.shape.slice(1,o.shape.length)}] (tensor shape [${o.shape}])`)}}return a}function gZ(n,e,t){const s=Nh(n.map(a=>a.shape[0]));s.sort();const r=Nh(e.map(a=>a.shape[0]));if(r.sort(),s.length>1)throw new ke(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(n.map(a=>a.shape))}`);if(r.length>1)throw new ke(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(a=>a.shape))}`);if(s.length>0&&r.length>0&&!Nn(s,r))throw new ke(`Input Tensors should have the same number of samples as target Tensors. Found ${s[0]} input sample(s) and ${r[0]} target sample(s).`)}function yZ(n,e,t){const s=[Kv,Xv,I1];for(let r=0;r<n.length;++r){const a=n[r],i=e[r],o=t[r];if(i!=null){if(i===I1&&a.shape[a.shape.length-1]===1)throw new ke(`You are passing a target array of shape ${a.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(s.indexOf(i)!==-1){const l=a.shape.slice(1),c=o.slice(1);for(let f=0;f<l.length;++f){const d=l[f],m=c[f];if(m!=null&&d!==m)throw new ke(`A target Tensor with shape ${a.shape} was passed for an output of shape ${o}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function uE(n,e,t,s=!0,r=""){let a;if(Array.isArray(n)){if(n.length!==e.length)throw new ke(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${e.length} Tensor(s), but instead got ${n.length} Tensors(s).`);a=n}else{if(e.length>1)throw new ke(`The model expects ${e.length} ${r} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(n.shape)}.`);a=[n]}if(t!=null)for(let i=0;i<e.length;++i){if(t[i]==null)continue;const o=a[i];if(o.shape.length!==t[i].length)throw new ke(`Error when checking ${r}: expected ${e[i]} to have ${t[i].length} dimension(s), but got array with shape ${JSON.stringify(o.shape)}`);for(let l=0;l<t[i].length;++l){if(l===0&&!s)continue;const c=o.shape[l],f=t[i][l];if(f!=null&&f!==c)throw new ke(`Error when checking ${r}: expected ${e[i]} to have shape ${JSON.stringify(t[i])} but got array with shape ${JSON.stringify(o.shape)}.`)}}}function bZ(n,e){if(n==null||Array.isArray(n)&&n.length===0)return e.map(s=>[]);let t;if(typeof n=="string"||typeof n=="function")t=[n];else if(Array.isArray(n)||typeof n=="object")t=n;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${n}`);if(Array.isArray(t))return e.map(s=>t);{const s=[];for(const r of e){let a=t.hasOwnProperty(r)?t[r]:[];Array.isArray(a)||(a=[a]),s.push(a)}return s}}const xZ="layers-model";class Dp extends Cl{constructor(e){super(e),this.isTraining=!1}summary(e,t,s=console.log){if(!this.built)throw new ke("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");tZ(this,e,t,s)}compile(e){if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=eZ(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof $c))throw new ke("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let t=[];if(!Array.isArray(e.loss)&&typeof e.loss!="string"&&typeof e.loss!="function"){e.loss=e.loss;for(const i in e.loss)if(this.outputNames.indexOf(i)===-1)throw new ke(`Unknown entry in loss dictionary: "${i}". Only expected the following keys: ${this.outputNames}`);for(const i of this.outputNames)e.loss[i]==null&&console.warn(`Output "${i}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${i} during training`),t.push(B5(e.loss[i]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new ke(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);t=e.loss.map(o=>B5(o))}else{const i=B5(e.loss);this.outputs.forEach(o=>{t.push(i)})}this.lossFunctions=t,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let i=0;i<this.outputs.length;++i){const o=this.internalOutputShapes[i],l=this.outputNames[i];this.feedOutputNames.push(l),this.feedOutputShapes.push(o),this.feedLossFns.push(this.lossFunctions[i])}const s=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],qf("loss",()=>{for(let i=0;i<this.outputs.length;++i){if(s.indexOf(i)!==-1)continue;const o=this.lossFunctions[i];this.outputs.length>1&&(this.metricsTensors.push([o,i]),this.metricsNames.push(this.outputNames[i]+"_loss"))}});const r=bZ(e.metrics,this.outputNames),a=(i,o,l)=>{this.outputNames.length>1&&(o=this.outputNames[i]+"_"+o),this.metricsNames.push(o),this.metricsTensors.push([l,i])};qf("metric",()=>{for(let i=0;i<this.outputs.length;++i){if(s.indexOf(i)!==-1)continue;const o=r[i];(c=>{let d,m,g;for(const b of c){if(typeof b=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(b)!==-1){const v=this.internalOutputShapes[i];v[v.length-1]===1||this.lossFunctions[i]===Xv?["accuracy","acc"].indexOf(b)!==-1?m=WD:["crossentropy","ce"].indexOf(b)!==-1&&(m=WY):this.lossFunctions[i]===Ib?["accuracy","acc"].indexOf(b)!==-1?m=GY:["crossentropy","ce"].indexOf(b)!==-1&&(m=HD):["accuracy","acc"].indexOf(b)!==-1?m=GD:["crossentropy","ce"].indexOf(b)!==-1&&(m=qD);let w;["accuracy","acc"].indexOf(b)!==-1?w="acc":["crossentropy","ce"].indexOf(b)!==-1&&(w="ce"),g=m,d=""+w}else g=QY(b),d=""+C2(b);let x;qf(d,()=>{x=g}),a(i,d,x)}})(o)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,t,s={}){const r=s.batchSize==null?32:s.batchSize;U5(r);const i=this.standardizeUserDataXY(e,t,!0,r);try{const o=i[0].concat(i[1]);this.makeTestFunction();const l=this.testFunction,c=this.testLoop(l,o,r,s.verbose,s.steps);return ni(c)}finally{Nl(i[0],e),Nl(i[1],t)}}async evaluateDataset(e,t){return this.makeTestFunction(),pZ(this,e,t)}checkNumSamples(e,t,s,r="steps"){let a;if(s!=null){if(a=null,t!=null)throw new ke(`If ${r} is set, batchSize must be null or undefined.Got batchSize = ${t}`)}else if(e!=null)Array.isArray(e)?a=e[0].shape[0]:a=e.shape[0];else throw new ke(`Either the input data should have a defined shape, or ${r} shoud be specified.`);return a}execute(e,t){if(Array.isArray(t)&&t.length===0)throw new ke("`outputs` is an empty Array, which is not allowed.");const s=Array.isArray(t),r=s?t:[t],a=this.retrieveSymbolicTensors(r),i=new xh;if(e instanceof Kn&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new ke(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let l=0;l<this.inputs.length;++l)i.add(this.inputs[l],e[l])}else for(const l of this.inputs){const c=e[l.name];if(c==null)throw new ke(`No value is provided for the model's input ${l.name}`);i.add(l,c)}const o=o1(a,i);return s?o:o[0]}retrieveSymbolicTensors(e){const t=id(null,e.length);let s=e.length;for(const r of this.layers){const a=Array.isArray(r.output)?r.output:[r.output],i=a.map(o=>o.name);for(let o=0;o<e.length;++o){const l=i.indexOf(e[o]);if(l!==-1&&(t[o]=a[l],s--),s===0)break}if(s===0)break}if(s>0){const r=[];throw t.forEach((a,i)=>{a==null&&r.push(e[i])}),new ke(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(r)}`)}return t}predictLoop(e,t=32,s=!1){return _e(()=>{const r=this.checkNumSamples(e);if(s)throw new gn("Verbose predictLoop() is not implemented yet.");const a=V5(r,t),i=this.outputs.map(o=>[]);for(let o=0;o<a.length;++o)_e(()=>{const c=a[o][0],f=a[o][1],d=t1(e,c,f),m=[];if(Array.isArray(d))for(let b=0;b<d.length;++b)m.push({key:this.inputs[b],value:d[b]});else m.push({key:this.inputs[0],value:d});const g=new xh(m);return o1(this.outputs,g)}).forEach((c,f)=>i[f].push(c));return ni(i.map(o=>ur(o,0)))})}predict(e,t={}){const s=QD(e);uE(s,this.inputNames,this.feedInputShapes,!1);try{const r=t.batchSize==null?32:t.batchSize;return U5(r),this.predictLoop(s,r)}finally{Nl(s,e)}}predictOnBatch(e){uE(e,this.inputNames,this.feedInputShapes,!0);const t=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,t)}standardizeUserDataXY(e,t,s=!0,r){if(this.optimizer_==null)throw new Uo("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const a=[];for(let i=0;i<this.feedOutputShapes.length;++i){const o=this.feedOutputShapes[i];this.feedLossFns[i]===Ib?a.push(o.slice(0,o.length-1).concat([1])):a.push(o)}if(e=lE(e,this.feedInputNames,this.feedInputShapes,!1,"input"),t=lE(t,this.feedOutputNames,a,!1,"target"),gZ(e,t),yZ(t,this.feedLossFns,this.feedOutputShapes),this.stateful&&r!=null&&r>0&&e[0].shape[0]%r!==0)throw new ke(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${r}. Found: ${e[0].shape[0]} sample(s).`);return[e,t]}async standardizeUserData(e,t,s,r,a=!0,i){const[o,l]=this.standardizeUserDataXY(e,t,a,i);if(s!=null)throw new Error("sample weight is not supported yet.");let c=null;if(r!=null){const f=YD(r,this.outputNames);c=[];for(let d=0;d<f.length;++d)c.push(await ZD(l[d],null,f[d]))}return[o,l,c]}testLoop(e,t,s,r=0,a){return _e(()=>{const i=this.checkNumSamples(t,s,a,"steps"),o=[];if(r>0)throw new gn("Verbose mode is not implemented yet.");if(a!=null)throw new gn("steps mode in testLoop() is not implemented yet");{const l=V5(i,s),c=Ta(Ol(0,i));for(let f=0;f<l.length;++f){const d=l[f][0],m=l[f][1],g=Hf(c,d,m-d),b=lN(t,g),x=e(b);if(f===0)for(let v=0;v<x.length;++v)o.push(Mt(0));for(let v=0;v<x.length;++v){const w=x[v];o[v]=et(o[v],xe(m-d,w))}}for(let f=0;f<o.length;++f)o[f]=$t(o[f],i)}return o})}getDedupedMetricsNames(){const e=this.metricsNames,t=[];for(let s=0;s<e.length;++s){const r=e[s];let a=r;if(HI(e,r)>1){const i=HI(e.slice(0,s),r);a+=`_${i}`}t.push(a)}return t}makeTrainFunction(){return e=>{const t=[],s=e.slice(0,this.inputs.length),r=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),a=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),i=[],o=()=>{const d=[];for(let x=0;x<this.inputs.length;++x)d.push({key:this.inputs[x],value:s[x]});const m=new xh(d),g=o1(this.outputs,m,{training:!0});let b;for(let x=0;x<this.lossFunctions.length;++x){const v=this.lossFunctions[x];let w=v(r[x],g[x]);a[x]!=null&&(w=lZ(w,a[x]));const k=Bs(w);t.push(k),x===0?b=w:b=et(b,w)}for(let x=0;x<this.metricsTensors.length;++x){let v;if(this.outputs.length>1&&x<this.outputs.length)v=t[x];else{const w=this.metricsTensors[x][0],k=this.metricsTensors[x][1];v=Bs(w(r[k],g[k]))}_r(v),i.push(v)}return b=Bs(b),this.calculateLosses().forEach(x=>{b=et(b,x)}),b},l=this.collectedTrainableWeights.map(d=>d.read());return[this.optimizer_.minimize(o,!0,l)].concat(i)}}makeTestFunction(){this.testFunction=e=>_e(()=>{const t=[];let s;const r=e.slice(0,this.inputs.length),a=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=[];for(let c=0;c<this.inputs.length;++c)i.push({key:this.inputs[c],value:r[c]});const o=new xh(i),l=o1(this.outputs,o);for(let c=0;c<this.lossFunctions.length;++c){const f=this.lossFunctions[c],d=Bs(f(a[c],l[c]));c===0?s=d:s=et(s,d),t.push(s)}for(let c=0;c<this.metricsTensors.length;++c){const f=this.metricsTensors[c][0],d=this.metricsTensors[c][1],m=Bs(f(a[d],l[d]));t.push(m)}return t})}async fit(e,t,s={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let r,a,i,o,l,c,f,d,m;try{const g=s.batchSize==null?32:s.batchSize;U5(g);const x=await this.standardizeUserData(e,t,s.sampleWeight,s.classWeight,!1,g);r=x[0],a=x[1],m=x[2];let v=!1,w;if(s.validationData!=null&&s.validationData.length>0){if(v=!0,s.validationData.length===2)l=s.validationData[0],c=s.validationData[1];else throw s.validationData.length===3?new gn("validationData including sample weights is not supported yet."):new ke(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${s.validationData} is invalid.`);const B=await this.standardizeUserData(l,c,null,null,!0,g);f=B[0],d=B[1],w=f.concat(d)}else if(s.validationSplit!=null&&s.validationSplit>0&&s.validationSplit<1){v=!0;const D=Math.floor(r[0].shape[0]*(1-s.validationSplit)),B=r[0].shape[0];f=t1(r,D,B),i=r,r=t1(r,0,D),d=t1(a,D,B),o=a,a=t1(a,0,D),w=f.concat(d)}else s.validationSteps!=null&&(v=!0);const k=r.concat(a).concat(m);this.checkTrainableWeightsConsistency();const I=this.makeTrainFunction(),A=this.getDedupedMetricsNames();let R,U;v?(this.makeTestFunction(),R=this.testFunction,U=A.slice().concat(A.map(D=>"val_"+D))):(R=null,w=[],U=A.slice());const V=UD(s.callbacks,s.yieldEvery);return await this.fitLoop(I,k,A,g,s.epochs,s.verbose,V,R,w,s.shuffle,U,s.initialEpoch,null,null)}finally{this.isTraining=!1,Nl(r,e),Nl(a,t),Nl(i,e),Nl(o,t),Nl(f,l),Nl(d,c),m!=null&&xn(m)}}async fitLoop(e,t,s,r,a,i,o,l,c,f,d,m,g,b){r==null&&(r=32),a==null&&(a=1),f==null&&(f=!0),m==null&&(m=0);let x=!1;if(l!=null&&c!=null&&(x=!0),b!=null&&(x=!0,g==null))throw new ke("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const v=this.checkNumSamples(t,r,g,"steps_per_epoch");let w;v!=null&&(w=Ol(0,v)),i==null&&(i=1);const{callbackList:k,history:I}=VD(o,i,a,m,v,g,r,x,d);k.setModel(this),this.history=I,await k.onTrainBegin(),this.stopTraining_=!1;for(let A=m;A<a;++A){await k.onEpochBegin(A);const R={};if(g!=null)throw new gn("stepsPerEpoch mode is not implemented yet.");{if(f==="batch")throw new gn("batch shuffling is not implemneted yet");f&&ON(w);const U=Ta(w),V=V5(v,r);for(let P=0;P<V.length;++P){const D={};if(await k.onBatchBegin(P,D),_e(()=>{const B=V[P][0],E=V[P][1],M=Hf(U,B,E-B);D.batch=P,D.size=E-B;const K=lN(t,M),X=e(K);for(let ae=0;ae<s.length;++ae){const W=s[ae],se=X[ae];D[W]=se,_r(se)}if(P===V.length-1&&x){const ae=this.testLoop(l,c,r);for(let W=0;W<s.length;++W){const se=s[W],ee=ae[W];_r(ee),R["val_"+se]=ee}}}),await k.onBatchEnd(P,D),BD(D),this.stopTraining_)break}U.dispose()}if(await k.onEpochEnd(A,R),this.stopTraining_)break}return await k.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,t){return hZ(this,e,t)}async trainOnBatch(e,t){const s=await this.standardizeUserData(e,t),r=s[0],a=s[1],o=this.makeTrainFunction()(r.concat(a)),l=[];for(const c of o){const f=await c.data();l.push(f[0])}return xn(o),Nl(s[0],e),Nl(s[1],t),ni(l)}getNamedWeights(e){const t=[],s=e!=null&&e.trainableOnly,r=s?this.trainableWeights:this.weights,a=this.getWeights(s);for(let i=0;i<r.length;++i)s&&!r[i].trainable||t.push({name:r[i].originalName,tensor:a[i]});return t}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const t=_S().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=t-_S().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss=="string")e=hc(this.loss);else if(Array.isArray(this.loss)){for(const t of this.loss)if(typeof t!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(t=>hc(t))}else{const t=Object.keys(this.loss);e={};const s=this.loss;for(const r of t)if(typeof s[r]=="string")e[r]=hc(s[r]);else throw new Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[hc(C2(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>hc(C2(e)));{const e={};for(const t in this.metrics)e[t]=hc(C2(this.metrics[t]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const t=iN(e.optimizer_config),s=gc(t);let r;if(typeof e.loss=="string")r=Mf(e.loss);else if(Array.isArray(e.loss))r=e.loss.map(i=>Mf(i));else if(e.loss!=null){r={};for(const i in e.loss)r[i]=Mf(e.loss[i])}let a;if(Array.isArray(e.metrics))a=e.metrics.map(i=>Mf(i));else if(e.metrics!=null){a={};for(const i in e.metrics)a[i]=Mf(e.metrics[i])}this.compile({loss:r,metrics:a,optimizer:s})}async save(e,t){if(typeof e=="string"){const c=h$(e);if(c.length===0)throw new ke(`Cannot find any save handlers for URL '${e}'`);if(c.length>1)throw new ke(`Found more than one (${c.length}) save handlers for URL '${e}'`);e=c[0]}if(e.save==null)throw new ke("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const s=await $S(this.getNamedWeights(t)),o={modelTopology:this.toJSON(null,!1),format:xZ,generatedBy:`TensorFlow.js tfjs-layers v${XD}`,convertedBy:null};if((t==null?!1:t.includeOptimizer)&&this.optimizer!=null){o.trainingConfig=this.getTrainingConfig();const c="optimizer",{data:f,specs:d}=await $S(await this.optimizer.getWeights(),c);s.specs.push(...d),s.data=l$([s.data,f])}return this.userDefinedMetadata!=null&&(rE(this.userDefinedMetadata,this.name,!0),o.userDefinedMetadata=this.userDefinedMetadata),o.weightData=s.data,o.weightSpecs=s.specs,e.save(o)}setUserDefinedMetadata(e){rE(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}Dp.className="Model";st(Dp);class eO extends Dp{}eO.className="Functional";st(eO);class E1 extends Dp{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=e.name!=null?e.name:Gv("sequential_"),e.layers!=null)for(const t of e.layers)this.add(t)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(s=>s<0))throw new ke(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){const t=e instanceof E1||e instanceof Dp;let s;if(t){if(s=e,s.outputs.length!==1)throw new ke("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(s.inputs.length!==1)throw new ke("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(e.inboundNodes.length===0){if(e.batchInputShape==null)throw new ke("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const r=wY({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(r)}if(t)this.outputs=s.outputs,this.inputs=s.inputs;else{if(e.inboundNodes.length!==1)throw new ke(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(e.inboundNodes[0].outputTensors.length!==1)throw new ke("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=LD(this.outputs[0])}this.inboundNodes=[],new Hv({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:id(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(r=>r.shape),outputShapes:this.outputs[0].shape})}else{const r=e.apply(this.outputs[0]);if(Array.isArray(r))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[r],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,t){return this.model==null&&this.build(),this.model.call(e,t)}build(e){if(Vn(e),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new Dp({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,t,s=console.log){this.built||this.build(),super.summary(e,t,s)}setWeights(e){this.model==null&&this.build(),this.model.setWeights(e)}evaluate(e,t,s={}){if(!this.built)throw new Uo("The model needs to be compiled before being used.");return this.model.evaluate(e,t,s)}async evaluateDataset(e,t){if(!this.built)throw new Uo("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,t)}predict(e,t={}){return this.model==null&&this.build(),this.model.predict(e,t)}predictOnBatch(e){return this.model==null&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,t,s={}){if(!this.built)throw new Uo("The model needs to be compiled before being used.");return this.model.fit(e,t,s)}async fitDataset(e,t){if(!this.built)throw new Uo("The model needs to be compiled before being used.");return this.model.fitDataset(e,t)}async trainOnBatch(e,t){return this.model.trainOnBatch(e,t)}static fromConfig(e,t,s={},r=!1){let a,i={};if(t instanceof Array){if(t[0].className==null||t[0].className==="Merge")throw new ke("Legacy serialization format not supported yet.");a=t}else Z(t.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),a=t.layers,delete t.layers,i=t;const o=new e(i);if(!(o instanceof E1))throw new gn(`Sequential.fromConfig called on non-Sequential input: ${o}`);for(const l of a){const f=gc(l,void 0,r);r&&f.setFastWeightInitDuringBuild(!0),o.add(f)}return o}set stopTraining(e){if(this.model==null)throw new ke("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(this.model==null)throw new ke("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const t of this.layers){const s={};s.className=t.getClassName(),s.config=t.getConfig(),e.push(s)}return{name:this.name,layers:e}}}E1.className="Sequential";st(E1);let Aa=class extends vd{getConfig(){return{}}};class tO extends Aa{apply(e,t=1){return aY(e,t)}}tO.className="elu";st(tO);class nO extends Aa{apply(e){return vv(e)}}nO.className="selu";st(nO);class sO extends Aa{apply(e){return Bl(e)}}sO.className="relu";st(sO);class rO extends Aa{apply(e){return _e(()=>$h(6,Bl(e)))}}rO.className="relu6";st(rO);class aO extends Aa{apply(e){return e}}aO.className="linear";st(aO);class iO extends Aa{apply(e){return _l(e)}}iO.className="sigmoid";st(iO);class oO extends Aa{apply(e){return oY(e)}}oO.className="hardSigmoid";st(oO);class lO extends Aa{apply(e){return bd(e)}}lO.className="softplus";st(lO);class uO extends Aa{apply(e){return iY(e)}}uO.className="softsign";st(uO);class cO extends Aa{apply(e){return _h(e)}}cO.className="tanh";st(cO);let Y3=class extends Aa{apply(e,t=-1){return sg(e,t)}};Y3.className="softmax";st(Y3);class hO extends Aa{apply(e,t=-1){return fv(e,t)}}hO.className="logSoftmax";st(hO);class fO extends Aa{apply(e){return _e(()=>_e(()=>{const t=Math.sqrt(2),s=xe(.5,et(1,uv($t(e,t))));return xe(e,s)}))}}fO.className="gelu";st(fO);class dO extends Aa{apply(e){return _e(()=>xe(.5,xe(e,et(1,_h(xe(Xr($t(2,Math.PI)),et(e,xe(.044715,Cu(e,3)))))))))}}dO.className="gelu_new";st(dO);class pO extends Aa{apply(e){return _e(()=>xe(e,_h(bd(e))))}}pO.className="mish";st(pO);class mO extends Aa{apply(e,t=1){return _e(()=>xe(_l(xe(e,t)),e))}}mO.className="swish";st(mO);function Dh(n){return n.getClassName()}function j5(n,e={}){return hy(n,oo.getMap().classNameMap,e,"activation")}function Oh(n){if(n==null){const e={};return e.className="linear",e.config={},j5(e)}if(typeof n=="string"){const e={};return e.className=n,e.config={},j5(e)}else return n instanceof Aa?n:j5(n)}function vZ(n){if(n!=null&&typeof n!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${n}`)}class gO extends vd{}class yO extends gO{constructor(e){super(),vZ(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return _e(()=>{let t=lr([1]);return this.hasL1&&(t=et(t,St(xe(this.l1,br(e))))),this.hasL2&&(t=et(t,St(xe(this.l2,dy(e))))),we(t,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,t){return new e({l1:t.l1,l2:t.l2})}}yO.className="L1L2";st(yO);const cE={l1l2:"L1L2"};function ms(n){return F3(n)}function hE(n,e={}){return hy(n,oo.getMap().classNameMap,e,"regularizer")}function Ds(n){if(n==null)return null;if(typeof n=="string"){const t={className:n in cE?cE[n]:n,config:{}};return hE(t)}else return n instanceof gO?n:hE(n)}class bO extends Sn{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,t){e=Qt(e);let s=Bl(e);return this.maxValue!=null&&(s=oi(s,0,this.maxValue)),s}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},t=super.getConfig();return Object.assign(e,t),e}}bO.className="ReLU";st(bO);class xO extends Sn{constructor(e){super(e??{}),this.DEFAULT_ALPHA=.3,e==null&&(e={}),this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,t){const s=Qt(e);return Y0(s,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}}xO.className="LeakyReLU";st(xO);class vO extends Sn{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),this.supportsMasking=!0,this.alphaInitializer=Rs(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=Ds(e.alphaRegularizer),this.alphaConstraint=Or(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes=="number")this.sharedAxes=[e.sharedAxes];else throw new ke(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`)}build(e){e=Vn(e);const t=e.slice(1);if(this.sharedAxes!=null)for(const r of this.sharedAxes)t[r-1]=1;this.alpha=this.addWeight("alpha",t,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const s={};if(this.sharedAxes!=null)for(let r=1;r<e.length;++r)s[r]=e[r];this.inputSpec=[new Rr({ndim:e.length,axes:s})],this.built=!0}call(e,t){return e=Qt(e),sy(e,this.alpha.read())}getConfig(){const e={alphaInitializer:Us(this.alphaInitializer),alphaRegularizer:ms(this.alphaRegularizer),alphaConstraint:Dr(this.alphaConstraint),sharedAxes:this.sharedAxes},t=super.getConfig();return Object.assign(e,t),e}}vO.className="PReLU";st(vO);let wO=class extends Sn{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new gn(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,t){const s=Qt(e);return Qm(s)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}};wO.className="ELU";st(wO);class SO extends Sn{constructor(e){super(e??{}),this.DEFAULT_THETA=1,e==null&&(e={}),this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,t){const s=Qt(e);return xe(s,lt(hi(s,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},t=super.getConfig();return Object.assign(e,t),e}}SO.className="ThresholdedReLU";st(SO);class NO extends Sn{constructor(e){super(e??{}),this.DEFAULT_AXIS=1,e==null&&(e={}),this.softmax=new Y3().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,t){return _e(()=>{let s=Qt(e);const r=t.mask;if(r!=null){const a=xe(mt(si(s.shape),lt(r,s.dtype)),Mt(-1e9));s=et(s,a)}return this.axis instanceof Array?this.axis.length>1?li(mt(s,J0(s,this.axis,!0))):this.softmax(s,this.axis[0]):this.softmax(s,this.axis)})}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}}NO.className="Softmax";st(NO);function Op(n,e,t){if(typeof n=="number")return id(n,e);if(n.length!==e)throw new ke(`The ${t} argument must be an integer or tuple of ${e} integers. Received: ${n.length} elements.`);for(let s=0;s<e;++s){const r=n[s];if(!tY(r))throw new ke(`The ${t} argument must be an integer or tuple of ${e} integers. Received: ${JSON.stringify(n)} including a non-integer number ${r}`)}return n}function $l(n,e,t,s,r=1){if(n==null)return n;const a=e+(e-1)*(r-1);let i;return t==="same"?i=n:i=n-a+1,Math.floor((i+s-1)/s)}function pu(n,e,t,s){if(n==null)return null;if(s==="valid")n=n*e+Rh([t-e,0]);else if(s==="same")n=n*e;else throw new ke(`Unsupport padding mode: ${s}.`);return n}function Z3(n,e){return _e(()=>(fr(e),e==="channelsFirst"?An(n,[0,2,3,1]):n))}function kO(n,e){return _e(()=>(fr(e),e==="channelsFirst"?An(n,[0,2,3,4,1]):n))}function wZ(n,e,t,s=1,r="valid",a,i=1){return _e(()=>{if(a==null&&(a=Ll()),fr(a),n.shape.length!==3)throw new ke(`The input of a conv1dWithBias operation should be 3, but is ${n.shape.length} instead.`);if(e.shape.length!==3)throw new ke(`The kernel for a conv1dWithBias operation should be 3, but is ${e.shape.length} instead`);if(t!=null&&t.shape.length!==1)throw new ke(`The bias for a conv1dWithBias operation should be 1, but is ${t.shape.length} instead`);if(a==="channelsFirst"&&(n=An(n,[0,2,1])),r==="causal")throw new gn("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let o=av(n,e,s,r==="same"?"same":"valid","NWC",i);return t!=null&&(o=Ul(o,t)),o})}function fE(n,e,t,s=[1,1],r="valid",a,i,o=null){return _e(()=>{if(a==null&&(a=Ll()),fr(a),n.rank!==3&&n.rank!==4)throw new ke(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${n.rank}.`);if(e.rank!==3&&e.rank!==4)throw new ke(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${n.rank}.`);let l=Z3(n,a);if(r==="causal")throw new gn("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=hR({x:l,filter:e,strides:s,pad:r==="same"?"same":"valid",dilations:i,dataFormat:"NHWC",bias:t,activation:o}),a==="channelsFirst"&&(l=An(l,[0,3,1,2])),l})}function SZ(n,e,t,s=[1,1,1],r="valid",a,i){return _e(()=>{if(a==null&&(a=Ll()),fr(a),n.rank!==4&&n.rank!==5)throw new ke(`conv3dWithBias expects input to be of rank 4 or 5, but received ${n.rank}.`);if(e.rank!==4&&e.rank!==5)throw new ke(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${n.rank}.`);let o=kO(n,a);if(r==="causal")throw new gn("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return o=gk(o,e,s,r==="same"?"same":"valid","NDHWC",i),t!=null&&(o=Ul(o,t)),a==="channelsFirst"&&(o=An(o,[0,4,1,2,3])),o})}class Yv extends Sn{constructor(e,t){if(super(t),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",Yv.verifyArgs(t),this.rank=e,Hr(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new gn(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=Op(t.kernelSize,e,"kernelSize"),this.strides=Op(t.strides==null?1:t.strides,e,"strides"),this.padding=t.padding==null?"valid":t.padding,go(this.padding),this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,fr(this.dataFormat),this.activation=Oh(t.activation),this.useBias=t.useBias==null?!0:t.useBias,this.biasInitializer=Rs(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=Or(t.biasConstraint),this.biasRegularizer=Ds(t.biasRegularizer),this.activityRegularizer=Ds(t.activityRegularizer),this.dilationRate=Op(t.dilationRate==null?1:t.dilationRate,e,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new ke(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new ke(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new ke(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(e){if(du("kernelSize"in e,"required key 'kernelSize' not in config"),typeof e.kernelSize!="number"&&!M3(e.kernelSize,"number",1,3))throw new ke(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(e.kernelSize)}.`)}getConfig(){const e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:Dh(this.activation),useBias:this.useBias,biasInitializer:Us(this.biasInitializer),biasRegularizer:ms(this.biasRegularizer),activityRegularizer:ms(this.activityRegularizer),biasConstraint:Dr(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}}class ag extends Yv{constructor(e,t){super(e,t),this.kernel=null,ag.verifyArgs(t),this.filters=t.filters,Hr(this.filters,"filters"),this.kernelInitializer=Rs(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=Or(t.kernelConstraint),this.kernelRegularizer=Ds(t.kernelRegularizer)}build(e){e=Vn(e);const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new ke(`The channel dimension of the input should be defined. Found ${e[t]}`);const s=e[t],r=this.kernelSize.concat([s,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[t]:s}}],this.built=!0}call(e,t){return _e(()=>{e=Qt(e);let s;const r=this.bias==null?null:this.bias.read(),a=vD(this.activation.getClassName());if(a!=null&&this.rank===2)s=fE(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate,a);else{if(this.rank===1)s=wZ(e,this.kernel.read(),r,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)s=fE(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)s=SZ(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new gn("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(s=this.activation.apply(s))}return s})}computeOutputShape(e){e=Vn(e);const t=[],s=this.dataFormat==="channelsLast"?e.slice(1,e.length-1):e.slice(2);for(let a=0;a<s.length;++a){const i=$l(s[a],this.kernelSize[a],this.padding,this.strides[a],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[a]);t.push(i)}let r=[e[0]];return this.dataFormat==="channelsLast"?(r=r.concat(t),r.push(this.filters)):(r.push(this.filters),r=r.concat(t)),r}getConfig(){const e={filters:this.filters,kernelInitializer:Us(this.kernelInitializer),kernelRegularizer:ms(this.kernelRegularizer),kernelConstraint:Dr(this.kernelConstraint)},t=super.getConfig();return Object.assign(e,t),e}static verifyArgs(e){if(!("filters"in e)||typeof e.filters!="number"||e.filters<1)throw new ke(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(e.filters)}`)}}class yy extends ag{constructor(e){super(2,e),yy.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!M3(e.kernelSize,"number",1,2))throw new ke(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}}yy.className="Conv2D";st(yy);class by extends ag{constructor(e){super(3,e),by.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!(Array.isArray(e.kernelSize)&&(e.kernelSize.length===1||e.kernelSize.length===3)))throw new ke(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}}by.className="Conv3D";st(by);class CO extends yy{constructor(e){if(super(e),this.inputSpec=[new Rr({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new ke(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=Vn(e),e.length!==4)throw new ke("Input should have rank 4; Received input shape: "+JSON.stringify(e));const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new ke("The channel dimension of the inputs should be defined. Found `None`.");const s=e[t],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Rr({ndim:4,axes:{[t]:s}})],this.built=!0}call(e,t){return _e(()=>{let s=Qt(e);if(s.shape.length!==4)throw new ke(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape,a=r[0];let i,o;this.dataFormat==="channelsFirst"?(i=2,o=3):(i=1,o=2);const l=r[i],c=r[o],f=this.kernelSize[0],d=this.kernelSize[1],m=this.strides[0],g=this.strides[1],b=pu(l,m,f,this.padding),x=pu(c,g,d,this.padding),v=[a,b,x,this.filters];this.dataFormat!=="channelsLast"&&(s=An(s,[0,2,3,1]));let w=iv(s,this.kernel.read(),v,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(w=An(w,[0,3,1,2])),this.bias!=null&&(w=Ul(w,this.bias.read(),this.dataFormat)),this.activation!=null&&(w=this.activation.apply(w)),w})}computeOutputShape(e){e=Vn(e);const t=e.slice();let s,r,a;this.dataFormat==="channelsFirst"?(s=1,r=2,a=3):(s=3,r=1,a=2);const i=this.kernelSize[0],o=this.kernelSize[1],l=this.strides[0],c=this.strides[1];return t[s]=this.filters,t[r]=pu(t[r],l,i,this.padding),t[a]=pu(t[a],c,o,this.padding),t}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}CO.className="Conv2DTranspose";st(CO);class TO extends by{constructor(e){if(super(e),this.inputSpec=[new Rr({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new ke(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=Vn(e),e.length!==5)throw new ke("Input should have rank 5; Received input shape: "+JSON.stringify(e));const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new ke("The channel dimension of the inputs should be defined. Found `None`.");const s=e[t],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Rr({ndim:5,axes:{[t]:s}})],this.built=!0}call(e,t){return _e(()=>{let s=Qt(e);if(s.shape.length!==5)throw new ke(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape,a=r[0];let i,o,l;this.dataFormat==="channelsFirst"?(l=2,i=3,o=4):(l=1,i=2,o=3);const c=r[l],f=r[i],d=r[o],m=this.kernelSize[0],g=this.kernelSize[1],b=this.kernelSize[2],x=this.strides[0],v=this.strides[1],w=this.strides[2],k=pu(c,x,m,this.padding),I=pu(f,v,g,this.padding),A=pu(d,w,b,this.padding),R=[a,k,I,A,this.filters];this.dataFormat!=="channelsLast"&&(s=An(s,[0,2,3,4,1]));let U=yk(s,this.kernel.read(),R,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(U=An(U,[0,4,1,2,3])),this.bias!==null&&(U=Ul(U,this.bias.read(),this.dataFormat)),this.activation!==null&&(U=this.activation.apply(U)),U})}computeOutputShape(e){e=Vn(e);const t=e.slice();let s,r,a,i;this.dataFormat==="channelsFirst"?(s=1,r=2,a=3,i=4):(s=4,r=1,a=2,i=3);const o=this.kernelSize[0],l=this.kernelSize[1],c=this.kernelSize[2],f=this.strides[0],d=this.strides[1],m=this.strides[2];return t[s]=this.filters,t[r]=pu(t[r],f,o,this.padding),t[a]=pu(t[a],d,l,this.padding),t[i]=pu(t[i],m,c,this.padding),t}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}TO.className="Conv3DTranspose";st(TO);class AO extends ag{constructor(e,t){if(super(e,t),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,t.filters==null)throw new ke("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(t.kernelInitializer!=null||t.kernelRegularizer!=null||t.kernelConstraint!=null)throw new ke("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(t.padding!=null&&t.padding!=="same"&&t.padding!=="valid")throw new ke(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(t.padding)}`);this.depthMultiplier=t.depthMultiplier==null?1:t.depthMultiplier,this.depthwiseInitializer=Rs(t.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=Ds(t.depthwiseRegularizer),this.depthwiseConstraint=Or(t.depthwiseConstraint),this.pointwiseInitializer=Rs(t.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=Ds(t.pointwiseRegularizer),this.pointwiseConstraint=Or(t.pointwiseConstraint)}build(e){if(e=Vn(e),e.length<this.rank+2)throw new ke(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null||e[t]<0)throw new ke(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[t])}`);const s=e[t],r=this.kernelSize.concat([s,this.depthMultiplier]),a=[];for(let o=0;o<this.rank;++o)a.push(1);a.push(s*this.depthMultiplier,this.filters);const i=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,i,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",a,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,i,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,i,this.biasConstraint):this.bias=null,this.inputSpec=[new Rr({ndim:this.rank+2,axes:{[t]:s}})],this.built=!0}call(e,t){return _e(()=>{e=Qt(e);let s;if(this.rank===1)throw new gn("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(e=An(e,[0,2,3,1])),s=wv(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(s=Ul(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),this.dataFormat==="channelsFirst"&&(s=An(s,[0,3,1,2])),s})}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=Us(this.depthwiseInitializer),e.pointwiseInitializer=Us(this.pointwiseInitializer),e.depthwiseRegularizer=ms(this.depthwiseRegularizer),e.pointwiseRegularizer=ms(this.pointwiseRegularizer),e.depthwiseConstraint=Dr(this.depthwiseConstraint),e.pointwiseConstraint=Dr(this.pointwiseConstraint),e}}AO.className="SeparableConv";class IO extends AO{constructor(e){super(2,e)}}IO.className="SeparableConv2D";st(IO);class Zv extends ag{constructor(e){super(1,e),Zv.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!M3(e.kernelSize,"number",1,1))throw new ke(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}}Zv.className="Conv1D";st(Zv);class EO extends Sn{constructor(e){super(e),typeof e.cropping=="number"?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,t){return _e(()=>{if(e=Qt(e),this.dataFormat==="channelsLast"){const s=k2(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return k2(s,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const s=k2(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return k2(s,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}EO.className="Cropping2D";st(EO);class _O extends Sn{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,fr(this.dataFormat),this.interpolation=e.interpolation==null?"nearest":e.interpolation,JX(this.interpolation)}computeOutputShape(e){if(this.dataFormat==="channelsFirst"){const t=e[2]==null?null:this.size[0]*e[2],s=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],t,s]}else{const t=e[1]==null?null:this.size[0]*e[1],s=e[2]==null?null:this.size[1]*e[2];return[e[0],t,s,e[3]]}}call(e,t){return _e(()=>{let s=Qt(e);const r=s.shape;if(this.dataFormat==="channelsFirst"){s=An(s,[0,2,3,1]);const a=this.size[0]*r[2],i=this.size[1]*r[3],o=this.interpolation==="nearest"?Bo.resizeNearestNeighbor(s,[a,i]):Bo.resizeBilinear(s,[a,i]);return An(o,[0,3,1,2])}else{const a=this.size[0]*r[1],i=this.size[1]*r[2];return this.interpolation==="nearest"?Bo.resizeNearestNeighbor(s,[a,i]):Bo.resizeBilinear(s,[a,i])}})}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}}_O.className="UpSampling2D";st(_O);function NZ(n,e,t=[1,1],s="valid",r,a){return _e(()=>{r==null&&(r=Ll()),fr(r);let i=Z3(n,r);if(n.rank!==4)throw new ke(`Input for depthwiseConv2d is required to be 4-D, but is instead ${n.rank}-D`);if(e.rank!==4)throw new ke(`depthwiseKernel is required to be 4-D, but is instead ${e.rank}-D`);return i=Jm(i,e,t,s==="same"?"same":"valid","NHWC",a),r==="channelsFirst"&&(i=An(i,[0,3,1,2])),i})}class $O extends Yv{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=Rs(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=Or(e.depthwiseConstraint),this.depthwiseRegularizer=Ds(e.depthwiseRegularizer)}build(e){if(e=Vn(e),e.length<4)throw new ke(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);const t=this.dataFormat==="channelsFirst"?1:3;if(e[t]==null||e[t]<0)throw new ke(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[t]}).`);const s=e[t],r=[this.kernelSize[0],this.kernelSize[1],s,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[s*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return _e(()=>{e=Qt(e);let s=NZ(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(s=Ul(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),s})}computeOutputShape(e){e=Vn(e);const t=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],r=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,a=$l(t,this.kernelSize[0],this.padding,this.strides[0]),i=$l(s,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],r,a,i]:[e[0],a,i,r]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=Us(this.depthwiseInitializer),e.depthwiseRegularizer=ms(this.depthwiseRegularizer),e.depthwiseConstraint=Dr(this.depthwiseRegularizer),e}}$O.className="DepthwiseConv2D";st($O);function RO(n,e,t,s){if(Array.isArray(n)){if(e!=null||t!=null)throw new ke("When inputs is an array, neither initialState or constants should be provided");s!=null&&(t=n.slice(n.length-s,n.length),n=n.slice(0,n.length-s)),n.length>1&&(e=n.slice(1,n.length)),n=n[0]}function r(a){return a==null||Array.isArray(a)?a:[a]}return e=r(e),t=r(t),{inputs:n,initialState:e,constants:t}}function DO(n,e,t,s=!1,r,a,i=!1,o=!1){return _e(()=>{const l=e.shape.length;if(l<3)throw new ke(`Input should be at least 3D, but is ${l}D.`);const c=[1,0].concat(Ol(2,l));e=An(e,c),i&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),r!=null&&(r=lt(lt(r,"bool"),"float32"),r.rank===l-1&&(r=Ca(r,-1)),r=An(r,c)),s&&(e=po(e,0),r!=null&&(r=po(r,0)));const f=[];let d,m=t;const g=e.shape[0],b=mo(e);let x;r!=null&&(x=mo(r));for(let w=0;w<g;++w){const k=b[w],I=_e(()=>n(k,m));if(r==null)d=I[0],m=I[1];else{const A=_e(()=>{const R=x[w],U=mt(Fi(R),R),V=et(xe(I[0],R),xe(m[0],U)),P=m.map((D,B)=>et(xe(I[1][B],R),xe(D,U)));return{output:V,newStates:P}});d=A.output,m=A.newStates}o&&f.push(d)}let v;return o&&(v=ui(f,1)),[d,v,m]})}class qh extends Sn{constructor(e){super(e);let t;if(e.cell==null)throw new ke("cell property is missing for the constructor of RNN.");if(Array.isArray(e.cell)?t=new eC({cells:e.cell}):t=e.cell,t.stateSize==null)throw new ke("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=t,this.returnSequences=e.returnSequences==null?!1:e.returnSequences,this.returnState=e.returnState==null?!1:e.returnState,this.goBackwards=e.goBackwards==null?!1:e.goBackwards,this._stateful=e.stateful==null?!1:e.stateful,this.unroll=e.unroll==null?!1:e.unroll,this.supportsMasking=!0,this.inputSpec=[new Rr({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return Ol(0,e).map(t=>null)}else return this.states_}setStates(e){this.states_=e}computeOutputShape(e){sN(e)&&(e=e[0]),e=e;let t=this.cell.stateSize;Array.isArray(t)||(t=[t]);const s=t[0];let r;if(this.returnSequences?r=[e[0],e[1],s]:r=[e[0],s],this.returnState){const a=[];for(const i of t)a.push([e[0],i]);return[r].concat(a)}else return r}computeMask(e,t){return _e(()=>{Array.isArray(t)&&(t=t[0]);const s=this.returnSequences?t:null;if(this.returnState){const r=this.states.map(a=>null);return[s].concat(r)}else return s})}get states(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,t=[];for(let s=0;s<e;++s)t.push(null);return t}else return this.states_}set states(e){this.states_=e}build(e){if(this.numConstants!=null)throw new gn("Constants support is not implemented in RNN yet.");sN(e)&&(e=e[0]),e=e;const t=this.stateful?e[0]:null,s=e.slice(2);this.inputSpec[0]=new Rr({shape:[t,null,...s]});const r=[e[0]].concat(e.slice(2));this.cell.build(r);let a;if(Array.isArray(this.cell.stateSize)?a=this.cell.stateSize:a=[this.cell.stateSize],this.stateSpec!=null){if(!Nn(this.stateSpec.map(i=>i.shape[i.shape.length-1]),a))throw new ke(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=a.map(i=>new Rr({shape:[null,i]}));this.stateful&&this.resetStates()}resetStates(e,t=!1){_e(()=>{if(!this.stateful)throw new fu("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape[0];if(s==null)throw new ke("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>lr([s,r])):this.states_=[lr([s,this.cell.stateSize])];else if(e==null)xn(this.states_),this.keptStates!=null&&(xn(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>lr([s,r])):this.states_[0]=lr([s,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new ke(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);t===!0?this.keptStates.push(this.states_.slice()):xn(this.states_);for(let r=0;r<this.states_.length;++r){const a=e[r],i=Array.isArray(this.cell.stateSize)?this.cell.stateSize[r]:this.cell.stateSize,o=[s,i];if(!Nn(a.shape,o))throw new ke(`State ${r} is incompatible with layer ${this.name}: expected shape=${o}, received shape=${a.shape}`);this.states_[r]=a}}this.states_=this.states_.map(r=>_r(r.clone()))})}apply(e,t){let s=t==null?null:t.initialState,r=t==null?null:t.constants;t==null&&(t={});const a=RO(e,s,r,this.numConstants);e=a.inputs,s=a.initialState,r=a.constants;let i=[],o=[];if(s!=null){t.initialState=s,i=i.concat(s),this.stateSpec=[];for(const c of s)this.stateSpec.push(new Rr({shape:c.shape}));o=o.concat(this.stateSpec)}if(r!=null&&(t.constants=r,i=i.concat(r),this.numConstants=r.length),i[0]instanceof Au){const c=[e].concat(i),f=this.inputSpec.concat(o),d=this.inputSpec;this.inputSpec=f;const m=super.apply(c,t);return this.inputSpec=d,m}else return super.apply(e,t)}call(e,t){return _e(()=>{const s=t==null?null:t.mask,r=t==null?null:t.training;let a=t==null?null:t.initialState;e=Qt(e),a==null&&(this.stateful?a=this.states_:a=this.getInitialState(e));const i=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(a.length!==i)throw new ke(`RNN Layer has ${i} state(s) but was passed ${a.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const o={training:r},c=DO((b,x)=>{const v=this.cell.call([b].concat(x),o);return[v[0],v.slice(1)]},e,a,this.goBackwards,s,null,this.unroll,this.returnSequences),f=c[0],d=c[1],m=c[2];this.stateful&&this.resetStates(m,r);const g=this.returnSequences?d:f;return this.returnState?[g].concat(m):g})}getInitialState(e){return _e(()=>{let t=lr(e.shape);return t=St(t,[1,2]),t=fy(t),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(s=>s>1?tN(t,[1,s]):t):this.cell.stateSize>1?[tN(t,[1,this.cell.stateSize])]:[t]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),t={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(t.numConstants=this.numConstants);const s=this.cell.getConfig();return this.getClassName()===qh.className&&(t.cell={className:this.cell.getClassName(),config:s}),Object.assign(Object.assign(Object.assign({},s),e),t)}static fromConfig(e,t,s={}){const r=t.cell,a=gc(r,s);return new e(Object.assign(t,{cell:a}))}}qh.className="RNN";st(qh);class Jv extends Sn{}class J3 extends Jv{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,Hr(this.units,"units"),this.activation=Oh(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=Rs(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Rs(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Rs(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Ds(e.kernelRegularizer),this.recurrentRegularizer=Ds(e.recurrentRegularizer),this.biasRegularizer=Ds(e.biasRegularizer),this.kernelConstraint=Or(e.kernelConstraint),this.recurrentConstraint=Or(e.recurrentConstraint),this.biasConstraint=Or(e.biasConstraint),this.dropout=Kp([1,Rh([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Kp([1,Rh([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Vn(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return _e(()=>{if(e=e,e.length!==2)throw new ke(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let s=e[1];e=e[0];const r=t.training==null?!1:t.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Lh({ones:()=>Fi(e),rate:this.dropout,training:r,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Lh({ones:()=>Fi(s),rate:this.recurrentDropout,training:r,dropoutFunc:this.dropoutFunc}));let a;const i=this.dropoutMask,o=this.recurrentDropoutMask;i!=null?a=Su(xe(e,i),this.kernel.read()):a=Su(e,this.kernel.read()),this.bias!=null&&(a=Ul(a,this.bias.read())),o!=null&&(s=xe(s,o));let l=et(a,Su(s,this.recurrentKernel.read()));return this.activation!=null&&(l=this.activation.apply(l)),[l,l]})}getConfig(){const e=super.getConfig(),t={units:this.units,activation:Dh(this.activation),useBias:this.useBias,kernelInitializer:Us(this.kernelInitializer),recurrentInitializer:Us(this.recurrentInitializer),biasInitializer:Us(this.biasInitializer),kernelRegularizer:ms(this.kernelRegularizer),recurrentRegularizer:ms(this.recurrentRegularizer),biasRegularizer:ms(this.biasRegularizer),activityRegularizer:ms(this.activityRegularizer),kernelConstraint:Dr(this.kernelConstraint),recurrentConstraint:Dr(this.recurrentConstraint),biasConstraint:Dr(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),t)}}J3.className="SimpleRNNCell";st(J3);class OO extends qh{constructor(e){e.cell=new J3(e),super(e)}call(e,t){return _e(()=>{this.cell.dropoutMask!=null&&(xn(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(xn(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=t==null?null:t.mask,r=t==null?null:t.training,a=t==null?null:t.initialState;return super.call(e,{mask:s,training:r,initialState:a})})}static fromConfig(e,t){return new e(t)}}OO.className="SimpleRNN";st(OO);class Q3 extends Jv{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new ke("GRUCell does not support reset_after parameter set to true.");this.units=e.units,Hr(this.units,"units"),this.activation=Oh(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Oh(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=Rs(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Rs(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Rs(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Ds(e.kernelRegularizer),this.recurrentRegularizer=Ds(e.recurrentRegularizer),this.biasRegularizer=Ds(e.biasRegularizer),this.kernelConstraint=Or(e.kernelConstraint),this.recurrentConstraint=Or(e.recurrentConstraint),this.biasConstraint=Or(e.biasConstraint),this.dropout=Kp([1,Rh([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Kp([1,Rh([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Vn(e);const t=e[e.length-1];this.kernel=this.addWeight("kernel",[t,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return _e(()=>{if(e=e,e.length!==2)throw new ke(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);const s=t.training==null?!1:t.training;let r=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Lh({ones:()=>Fi(e),rate:this.dropout,training:s,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Lh({ones:()=>Fi(r),rate:this.recurrentDropout,training:s,count:3,dropoutFunc:this.dropoutFunc}));const a=this.dropoutMask,i=this.recurrentDropoutMask;let o,l,c;0<this.dropout&&this.dropout<1&&(e=xe(e,a[0]));let f=Su(e,this.kernel.read());this.useBias&&(f=Ul(f,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(r=xe(r,i[0]));const d=this.recurrentKernel.read(),[m,g]=ri(d,[2*this.units,this.units],d.rank-1),b=Su(r,m),[x,v,w]=ri(f,3,f.rank-1),[k,I]=ri(b,2,b.rank-1);o=this.recurrentActivation.apply(et(x,k)),l=this.recurrentActivation.apply(et(v,I));const A=Su(xe(l,r),g);c=this.activation.apply(et(w,A));const R=et(xe(o,r),xe(et(1,ws(o)),c));return[R,R]})}getConfig(){const e=super.getConfig(),t={units:this.units,activation:Dh(this.activation),recurrentActivation:Dh(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Us(this.kernelInitializer),recurrentInitializer:Us(this.recurrentInitializer),biasInitializer:Us(this.biasInitializer),kernelRegularizer:ms(this.kernelRegularizer),recurrentRegularizer:ms(this.recurrentRegularizer),biasRegularizer:ms(this.biasRegularizer),activityRegularizer:ms(this.activityRegularizer),kernelConstraint:Dr(this.kernelConstraint),recurrentConstraint:Dr(this.recurrentConstraint),biasConstraint:Dr(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),t)}}Q3.className="GRUCell";st(Q3);class LO extends qh{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new Q3(e),super(e)}call(e,t){return _e(()=>{this.cell.dropoutMask!=null&&(xn(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(xn(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=t==null?null:t.mask,r=t==null?null:t.training,a=t==null?null:t.initialState;return super.call(e,{mask:s,training:r,initialState:a})})}static fromConfig(e,t){return t.implmentation===0&&(t.implementation=1),new e(t)}}LO.className="GRU";st(LO);class Qv extends Jv{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,Hr(this.units,"units"),this.activation=Oh(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Oh(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=Rs(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Rs(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Rs(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=Ds(e.kernelRegularizer),this.recurrentRegularizer=Ds(e.recurrentRegularizer),this.biasRegularizer=Ds(e.biasRegularizer),this.kernelConstraint=Or(e.kernelConstraint),this.recurrentConstraint=Or(e.recurrentConstraint),this.biasConstraint=Or(e.biasConstraint),this.dropout=Kp([1,Rh([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Kp([1,Rh([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var t;e=Vn(e);const s=e[e.length-1];this.kernel=this.addWeight("kernel",[s,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let r;if(this.useBias){if(this.unitForgetBias){const a=this.biasInitializer,i=this.units;r=new(t=class extends Ho{apply(l,c){const f=a.apply([i]),d=new P3().apply([i]),m=a.apply([i*2]);return XI(XI(f,d),m)}},t.className="CustomInit",t)}else r=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,r,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,t){return _e(()=>{const s=t.training==null?!1:t.training;if(e=e,e.length!==3)throw new ke(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let r=e[1];const a=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Lh({ones:()=>Fi(e),rate:this.dropout,training:s,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Lh({ones:()=>Fi(r),rate:this.recurrentDropout,training:s,count:4,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,o=this.recurrentDropoutMask;let l,c,f,d;0<this.dropout&&this.dropout<1&&(e=xe(e,i[0]));let m=Su(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(r=xe(r,o[0])),m=et(m,Su(r,this.recurrentKernel.read())),this.useBias&&(m=Ul(m,this.bias.read()));const[g,b,x,v]=ri(m,4,m.rank-1);l=this.recurrentActivation.apply(g),c=this.recurrentActivation.apply(b),f=et(xe(c,a),xe(l,this.activation.apply(x))),d=this.recurrentActivation.apply(v);const w=xe(d,this.activation.apply(f));return[w,w,f]})}getConfig(){const e=super.getConfig(),t={units:this.units,activation:Dh(this.activation),recurrentActivation:Dh(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Us(this.kernelInitializer),recurrentInitializer:Us(this.recurrentInitializer),biasInitializer:Us(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:ms(this.kernelRegularizer),recurrentRegularizer:ms(this.recurrentRegularizer),biasRegularizer:ms(this.biasRegularizer),activityRegularizer:ms(this.activityRegularizer),kernelConstraint:Dr(this.kernelConstraint),recurrentConstraint:Dr(this.recurrentConstraint),biasConstraint:Dr(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),t)}}Qv.className="LSTMCell";st(Qv);class FO extends qh{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new Qv(e),super(e)}call(e,t){return _e(()=>{this.cell.dropoutMask!=null&&(xn(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(xn(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=t==null?null:t.mask,r=t==null?null:t.training,a=t==null?null:t.initialState;return super.call(e,{mask:s,training:r,initialState:a})})}static fromConfig(e,t){return t.implmentation===0&&(t.implementation=1),new e(t)}}FO.className="LSTM";st(FO);class eC extends Jv{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const t of this.cells.slice().reverse())Array.isArray(t.stateSize)?e.push(...t.stateSize):e.push(t.stateSize);return e}call(e,t){return _e(()=>{e=e;let s=e.slice(1);const r=[];for(const o of this.cells.slice().reverse())Array.isArray(o.stateSize)?r.push(s.splice(0,o.stateSize.length)):r.push(s.splice(0,1));r.reverse();const a=[];let i;for(let o=0;o<this.cells.length;++o){const l=this.cells[o];s=r[o],o===0?i=[e[0]].concat(s):i=[i[0]].concat(s),i=l.call(i,t),a.push(i.slice(1))}s=[];for(const o of a.slice().reverse())s.push(...o);return[i[0]].concat(s)})}build(e){sN(e)&&(e=e[0]),e=e;let t;this.cells.forEach((s,r)=>{qf(`RNNCell_${r}`,()=>{s.build(e),Array.isArray(s.stateSize)?t=s.stateSize[0]:t=s.stateSize,e=[e[0],t]})}),this.built=!0}getConfig(){const e=super.getConfig(),t=a=>({className:a.getClassName(),config:a.getConfig()}),r={cells:this.cells.map(t)};return Object.assign(Object.assign({},e),r)}static fromConfig(e,t,s={}){const r=[];for(const a of t.cells)r.push(gc(a,s));return new e({cells:r})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const t of this.cells)e.push(...t.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const t of this.cells)e.push(...t.nonTrainableWeights);if(!this.trainable){const t=[];for(const s of this.cells)t.push(...s.trainableWeights);return t.concat(e)}return e}getWeights(){const e=[];for(const t of this.cells)e.push(...t.weights);return rN(e)}setWeights(e){const t=[];for(const s of this.cells){const r=s.weights.length,a=e.splice(r);for(let i=0;i<s.weights.length;++i)t.push([s.weights[i],a[i]])}q3(t)}}eC.className="StackedRNNCells";st(eC);function Lh(n){const{ones:e,rate:t,training:s=!1,count:r=1,dropoutFunc:a}=n,i=()=>a!=null?a(e(),t):AD(e(),t),o=()=>py(i,e,s);return!r||r<=1?_r(o().clone()):Array(r).fill(void 0).map(o).map(c=>_r(c.clone()))}var kZ=function(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(n);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(n,s[r])&&(t[s[r]]=n[s[r]]);return t};class MO extends qh{constructor(e){if(e.unroll)throw new gn("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new gn("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new Rr({ndim:5})]}call(e,t){return _e(()=>{if(this.cell.dropoutMask!=null&&(xn(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(xn(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),t&&t.constants)throw new ke("ConvRNN2D cell does not support constants");const s=t==null?null:t.mask,r=t==null?null:t.training,a=t==null?null:t.initialState;return super.call(e,{mask:s,training:r,initialState:a})})}computeOutputShape(e){let t=this.computeSingleOutputShape(e);return this.returnSequences||(t=[t[0],...t.slice(2)]),this.returnState&&(t=[t,...Array(2).fill([e[0],...t.slice(-3)])]),t}getInitialState(e){return _e(()=>{const{stateSize:t}=this.cell,s=e.shape,r=this.computeSingleOutputShape(s),a=[r[0],...r.slice(2)],i=lr(a);return Array.isArray(t)?Array(t.length).fill(i):[i]})}resetStates(e,t=!1){_e(()=>{if(!this.stateful)throw new fu("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape,r=this.computeSingleOutputShape(s),a=[r[0],...r.slice(2)];if(s[0]==null)throw new ke("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>lr(a)):this.states_=[lr(a)];else if(e==null)xn(this.states_),this.keptStates!=null&&(xn(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>lr(a)):this.states_[0]=lr(a);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new ke(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);t?this.keptStates.push(this.states_.slice()):xn(this.states_);for(let o=0;o<this.states_.length;++o){const l=e[o],c=a;if(!Nn(l.shape,c))throw new ke(`State ${o} is incompatible with layer ${this.name}: expected shape=${c}, received shape=${l.shape}`);this.states_[o]=l}}this.states_=this.states_.map(o=>_r(o.clone()))})}computeSingleOutputShape(e){const{dataFormat:t,filters:s,kernelSize:r,padding:a,strides:i,dilationRate:o}=this.cell,l=t==="channelsFirst",c=e[l?3:2],f=e[l?4:3],d=$l(c,r[0],a,i[0],o[0]),m=$l(f,r[1],a,i[1],o[1]);return[...e.slice(0,2),...l?[s,d,m]:[d,m,s]]}}MO.className="ConvRNN2D";class tC extends Qv{constructor(e){const{filters:t,kernelSize:s,strides:r,padding:a,dataFormat:i,dilationRate:o}=e;super(Object.assign(Object.assign({},e),{units:t})),this.filters=t,Hr(this.filters,"filters"),this.kernelSize=Op(s,2,"kernelSize"),this.kernelSize.forEach(l=>Hr(l,"kernelSize")),this.strides=Op(r||1,2,"strides"),this.strides.forEach(l=>Hr(l,"strides")),this.padding=a||"valid",go(this.padding),this.dataFormat=i||"channelsLast",fr(this.dataFormat),this.dilationRate=Op(o||1,2,"dilationRate"),this.dilationRate.forEach(l=>Hr(l,"dilationRate"))}build(e){var t;e=Vn(e);const s=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[s]==null)throw new ke(`The channel dimension of the input should be defined. Found ${e[s]}`);const r=e[s],a=4,i=this.kernelSize.concat([r,this.filters*a]);this.kernel=this.addWeight("kernel",i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const o=this.kernelSize.concat([this.filters,this.filters*a]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",o,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let l;if(this.unitForgetBias){const c=this.biasInitializer,f=this.filters;l=new(t=class extends Ho{apply(m,g){const b=c.apply([f]),x=si([f]),v=c.apply([f*2]);return z3([b,x,v])}},t.className="CustomInit",t)}else l=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*a],null,l,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,t){return _e(()=>{if(e.length!==3)throw new ke(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);const s=t.training||!1,r=e[0],a=e[1],i=e[2],o=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Lh({ones:()=>Fi(r),rate:this.dropout,training:s,count:o,dropoutFunc:this.dropoutFunc}));const l=this.dropoutMask,c=(ye,G,O)=>!G||!G[O]?ye:xe(G[O],ye);let f=c(r,l,0),d=c(r,l,1),m=c(r,l,2),g=c(r,l,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Lh({ones:()=>Fi(a),rate:this.recurrentDropout,training:s,count:o,dropoutFunc:this.dropoutFunc}));const b=this.recurrentDropoutMask;let x=c(a,b,0),v=c(a,b,1),w=c(a,b,2),k=c(a,b,3);const I=3,[A,R,U,V]=ri(this.kernel.read(),o,I),[P,D,B,E]=this.useBias?ri(this.bias.read(),o):[null,null,null,null];f=this.inputConv(f,A,P,this.padding),d=this.inputConv(d,R,D,this.padding),m=this.inputConv(m,U,B,this.padding),g=this.inputConv(g,V,E,this.padding);const[M,K,X,ae]=ri(this.recurrentKernel.read(),o,I);x=this.recurrentConv(x,M),v=this.recurrentConv(v,K),w=this.recurrentConv(w,X),k=this.recurrentConv(k,ae);const W=this.recurrentActivation.apply(et(f,x)),se=this.recurrentActivation.apply(et(d,v)),ee=et(xe(se,i),xe(W,this.activation.apply(et(m,w)))),ce=xe(this.recurrentActivation.apply(et(g,k)),this.activation.apply(ee));return[ce,ce,ee]})}getConfig(){const e=super.getConfig(),{units:t}=e,s=kZ(e,["units"]),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},s),r)}inputConv(e,t,s,r){const a=vc(e,t,this.strides,r||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return s?Ul(a,s,this.dataFormat):a}recurrentConv(e,t){return vc(e,t,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}tC.className="ConvLSTM2DCell";st(tC);class zO extends MO{constructor(e){const t=new tC(e);super(Object.assign(Object.assign({},e),{cell:t}))}static fromConfig(e,t){return new e(t)}}zO.className="ConvLSTM2D";st(zO);class nC extends Sn{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;const t=e.shape,s=[];for(let r=0;r<this.noiseShape.length;++r)s.push(this.noiseShape[r]==null?t[r]:this.noiseShape[r]);return s}call(e,t){return _e(()=>{this.invokeCallHook(e,t);const s=Qt(e);if(0<this.rate&&this.rate<1){const r=t.training==null?!1:t.training,a=this.getNoiseShape(s);return py(()=>AD(s,this.rate,a,this.seed),()=>s,r)}return e})}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},t=super.getConfig();return Object.assign(e,t),e}dispose(){return super.dispose()}}nC.className="Dropout";st(nC);class PO extends nC{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const t=e.shape;return[t[0],1,t[2]]}}PO.className="SpatialDropout1D";st(PO);class BO extends Sn{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let t=null;e.batchSize!=null&&(t=e.batchSize),this.batchInputShape=[t,e.inputDim]}this.units=e.units,Hr(this.units,"units"),this.activation=Oh(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=Rs(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=Rs(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=Or(e.kernelConstraint),this.biasConstraint=Or(e.biasConstraint),this.kernelRegularizer=Ds(e.kernelRegularizer),this.biasRegularizer=Ds(e.biasRegularizer),this.activityRegularizer=Ds(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=Vn(e);const t=e[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[t,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:t}}],this.built=!0}computeOutputShape(e){e=Vn(e);const t=e.slice();return t[t.length-1]=this.units,t}call(e,t){return _e(()=>{this.invokeCallHook(e,t);const s=Qt(e),r=vD(this.activation.getClassName());let a;return r!=null?a=Su(s,this.kernel.read(),r,this.bias?this.bias.read():null):(a=Su(s,this.kernel.read()),this.bias!=null&&(a=Ul(a,this.bias.read())),this.activation!=null&&(a=this.activation.apply(a))),a})}getConfig(){const e={units:this.units,activation:Dh(this.activation),useBias:this.useBias,kernelInitializer:Us(this.kernelInitializer),biasInitializer:Us(this.biasInitializer),kernelRegularizer:ms(this.kernelRegularizer),biasRegularizer:ms(this.biasRegularizer),activityRegularizer:ms(this.activityRegularizer),kernelConstraint:Dr(this.kernelConstraint),biasConstraint:Dr(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}}BO.className="Dense";st(BO);class UO extends Sn{constructor(e){e=e||{},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=Vn(e);for(const t of e.slice(1))if(t==null)throw new ke(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],kh(e,1)]}call(e,t){return _e(()=>{this.invokeCallHook(e,t);let s=Qt(e);if(this.dataFormat==="channelsFirst"&&s.rank>1){const r=[0];for(let a=2;a<s.rank;++a)r.push(a);r.push(1),s=An(s,r)}return rY(s)})}getConfig(){const e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);const t=super.getConfig();return Object.assign(e,t),e}}UO.className="Flatten";st(UO);class VO extends Sn{constructor(e){super(e),this.supportsMasking=!0,this.activation=Oh(e.activation)}call(e,t){return _e(()=>{this.invokeCallHook(e,t);const s=Qt(e);return this.activation.apply(s)})}getConfig(){const e={activation:Dh(this.activation)},t=super.getConfig();return Object.assign(e,t),e}}VO.className="Activation";st(VO);class jO extends Sn{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,t){return _e(()=>(e=Qt(e),nY(e,this.n)))}getConfig(){const e={n:this.n},t=super.getConfig();return Object.assign(e,t),e}}jO.className="RepeatVector";st(jO);class WO extends Sn{constructor(e){super(e),this.targetShape=e.targetShape;for(let t=0;t<this.targetShape.length;++t)this.isUnknown(this.targetShape[t])&&(this.targetShape[t]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,t){const s="Total size of new array must be unchanged.",r=t.slice();let a=1,i=null;for(let l=0;l<r.length;++l){const c=r[l];if(this.isUnknown(c))if(i===null)i=l;else throw new ke("Can only specifiy one unknown dimension.");else a*=c}const o=kh(e);if(i!==null){if(a===0||o%a!==0)throw new ke(s);r[i]=o/a}else if(o!==a)throw new ke(s);return r}computeOutputShape(e){let t=!1;for(let s=0;s<e.length;++s)if(this.isUnknown(e[s])){t=!0;break}return t?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,t){return _e(()=>{this.invokeCallHook(e,t);const s=Qt(e),r=s.shape,a=r.slice(0,1).concat(this.fixUnknownDimension(r.slice(1),this.targetShape));return we(s,a)})}getConfig(){const e={targetShape:this.targetShape},t=super.getConfig();return Object.assign(e,t),e}}WO.className="Reshape";st(WO);class GO extends Sn{constructor(e){if(super(e),e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);const t=Ol(1,e.dims.length+1);if(!Nn(e.dims.slice().sort(),t))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new Rr({ndim:this.dims.length+1})]}computeOutputShape(e){e=Vn(e);const t=e.slice();return this.dims.forEach((s,r)=>{t[r+1]=e[s]}),t}call(e,t){return An(Qt(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},t=super.getConfig();return Object.assign(e,t),e}}GO.className="Permute";st(GO);class qO extends Sn{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null?this.maskValue=e.maskValue==null?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={maskValue:this.maskValue};return Object.assign(t,e),t}computeMask(e,t){const s=Qt(e);return N1(nd(s,this.maskValue),-1)}call(e,t){return _e(()=>{this.invokeCallHook(e,t);const s=Qt(e),i=N1(nd(s,this.maskValue),-1,!0);return xe(s,lt(i,s.dtype))})}}qO.className="Masking";st(qO);class HO extends Sn{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){let t=null;e.batchSize!=null&&(t=e.batchSize),e.inputLength==null?this.batchInputShape=[t,null]:this.batchInputShape=[t].concat(Jn(e.inputLength))}this.inputDim=e.inputDim,Hr(this.inputDim,"inputDim"),this.outputDim=e.outputDim,Hr(this.outputDim,"outputDim"),this.embeddingsInitializer=Rs(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=Ds(e.embeddingsRegularizer),this.activityRegularizer=Ds(e.activityRegularizer),this.embeddingsConstraint=Or(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,t){return _e(()=>this.maskZero?(e=Qt(e),nd(e,$n(e))):null)}computeOutputShape(e){if(e=Vn(e),this.inputLength==null)return[...e,this.outputDim];const t=Jn(this.inputLength);if(t.length!==e.length-1)throw new ke(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let s=0;for(let r=0;r<t.length;++r){const a=t[r],i=e[r+1];if(a!=null&&i!=null&&a!==i)throw new ke(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);a==null&&(t[s]=i),s++}}return[e[0],...t,this.outputDim]}call(e,t){return _e(()=>{this.invokeCallHook(e,t);let s=Qt(e);s.dtype!=="int32"&&(s=wu(s,"int32"));const r=TD(this.embeddings.read(),we(s,[s.size]));return we(r,Vn(this.computeOutputShape(s.shape)))})}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:Us(this.embeddingsInitializer),embeddingsRegularizer:ms(this.embeddingsRegularizer),activityRegularizer:ms(this.activityRegularizer),embeddingsConstraint:Dr(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},t=super.getConfig();return Object.assign(e,t),e}}HO.className="Embedding";st(HO);class Sd extends Sn{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new gn}computeElementwiseOpOutputShape(e,t){if(e==null||t==null)return null;if(e.length<t.length)return this.computeElementwiseOpOutputShape(t,e);if(t.length===0)return e;const s=e.slice(0,e.length-t.length);for(let r=0;r<t.length;++r){const a=e[e.length-t.length+r],i=t[r];if(a==null||i==null||a<0||i<0)s.push(null);else if(a===1)s.push(i);else if(i===1)s.push(a);else{if(a!==i)throw new ke("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(t));s.push(a)}}return s}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[Vn(e)]),e=e,e.length<2)throw new ke(`A merge layer should be called on an Array of at least 2 inputs. Got ${e.length} input(s).`);let t=[];for(const a of e)a!=null&&a[0]!==null&&t.push(a[0]);if(t=Nh(t),t.length>1)throw new ke(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(e)}.`);let s=e[0]==null?null:e[0].slice(1);for(let a=1;a<e.length;++a){const i=e[a]==null?null:e[a].slice(1);s=this.computeElementwiseOpOutputShape(s,i)}const r=e.map(a=>a.length);e.indexOf(null)===-1&&Nh(r).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,t){return _e(()=>{if(e=e,this.reshapeRequired){const s=[],r=e.map(a=>a.rank);if(r.indexOf(null)===-1){const a=Rh(r);for(let i of e){const o=i.rank;for(let l=0;l<a-o;++l)i=fy(i,1);s.push(i)}return this.mergeFunction(s)}else{let a=!1;for(const l of e){const c=l.rank;if(c==null){const f=l.shape,d=f[0],m=f.slice(1).concat([d]);let g=we(l,[d].concat(kh(f.slice(1))));g=An(g,[1,0]),g=we(g,m),s.push(g),a=!0}else if(c>1){const f=Ol(1,c).concat([0]);s.push(An(l,f)),a=!0}else s.push(l)}let i=this.mergeFunction(s);const o=i.rank;if(a){if(o==null){const l=i.shape,c=l.length,f=l[c-1],d=[f].concat(l.slice(0,l.length-1));i=we(An(we(i,[-1,f]),[1,0]),d)}else if(o>1){const l=[o-1].concat(Ol(0,o-1));i=An(i,l)}}return i}}else return this.mergeFunction(e)})}computeOutputShape(e){e=e;let t;e[0]==null?t=null:t=e[0].slice(1);for(let r=1;r<e.length;++r){const a=e[r]==null?null:e[r].slice(1);t=this.computeElementwiseOpOutputShape(t,a)}let s=[];for(const r of e)r!=null&&r[0]!==null&&s.push(r[0]);return s=Nh(s),s.length===1?t=s.concat(t):t=[null].concat(t),t}computeMask(e,t){return _e(()=>{if(t==null)return null;if(!Array.isArray(t))throw new ke("`mask` should be an Array");if(!Array.isArray(e))throw new ke("`inputs` should be an Array");if(t.length!==e.length)throw new ke(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${e.length} vs ${t.length})`);if(t.every(r=>r==null))return null;t=t.map(r=>r==null?r:Ca(r,0));let s=t[0];for(let r=1;r<t.length-1;++r)s=Dl(s,t[r]);return s})}}class KO extends Sd{constructor(e){super(e)}mergeFunction(e){return _e(()=>{let t=e[0].clone();for(let s=1;s<e.length;++s)t=et(t,e[s]);return t})}}KO.className="Add";st(KO);class XO extends Sd{constructor(e){super(e)}mergeFunction(e){return _e(()=>{let t=e[0].clone();for(let s=1;s<e.length;++s)t=xe(t,e[s]);return t})}}XO.className="Multiply";st(XO);class YO extends Sd{constructor(e){super(e)}mergeFunction(e){return _e(()=>{let t=e[0].clone();for(let s=1;s<e.length;++s)t=et(t,e[s]);return xe(1/e.length,t)})}}YO.className="Average";st(YO);class ZO extends Sd{constructor(e){super(e)}mergeFunction(e){return _e(()=>{let t=e[0];for(let s=1;s<e.length;++s)t=_u(t,e[s]);return t})}}ZO.className="Maximum";st(ZO);class JO extends Sd{constructor(e){super(e)}mergeFunction(e){return _e(()=>{let t=e[0];for(let s=1;s<e.length;++s)t=$h(t,e[s]);return t})}}JO.className="Minimum";st(JO);class QO extends Sd{constructor(e){super(e),this.DEFAULT_AXIS=-1,e==null&&(e={}),this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new ke("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let t=!0;for(const r of e)if(r!=null){t=!1;break}if(t)return;const s=[];for(let r=0;r<e.length;++r){const a=e[r].slice();a.splice(this.axis,1);let i=!1;for(const o of s)if(Nn(o,a)){i=!0;break}i||s.push(a)}if(s.length>1)throw new ke("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return _e(()=>z3(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new ke("A `Concatenate` layer should be called on a list of inputs.");const t=e,s=t[0].slice(),r=this.axis<0?s.length+this.axis:this.axis;for(const a of t.slice(1)){if(s[r]==null||a[r]==null){s[r]=null;break}s[r]+=a[r]}return s}computeMask(e,t){if(t==null)return null;if(!Array.isArray(t))throw new ke("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new ke("`inputs` should be an array for Concatenate");if(t.length!==e.length)throw new ke(`Mismatch in the length of mask (${t.length}) and the legnth of inputs (${e.length})`);return _e(()=>{let s=!0;if(t.forEach(i=>{if(i!=null){s=!1;return}}),s)return null;const r=[];for(let i=0;i<e.length;++i)t[i]==null?r.push(lt(Fi(e[i]),"bool")):t[i].rank<e[i].rank?r.push(Ca(t[i],-1)):r.push(t[i]);const a=ur(r,this.axis);return rv(a,-1,!1)})}getConfig(){const e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}}QO.className="Concatenate";st(QO);function n1(n,e){for(;n<0;)n+=e;return n}function CZ(n,e,t){if(n.shape.length>3||e.shape.length>3)throw new gn("batchDot is not implemented for tensors of 4D or higher rank yet");if(Z(n.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${n.shape.length}`),Z(n.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${e.shape.length}`),typeof t=="number"&&(t=[t,t]),n.dtype==="complex64"||e.dtype==="complex64")throw new gn("batchDot is not implemented for complex64-type Tensors yet.");const s=n.shape.length,r=e.shape.length;t==null&&(t=[s-1,r-2]);const a=t;return _e(()=>{let i;if(s>r){i=s-r;const l=[];for(let c=0;c<i;++c)l.push(1);e=we(e,e.shape.concat(l))}else if(r>s){i=r-s;const l=[];for(let c=0;c<i;++c)l.push(1);n=we(n,n.shape.concat(l))}else i=0;let o;if(n.shape.length===2&&e.shape.length===2)a[0]===a[1]?o=St(xe(n,e),a[0]):o=St(xe(An(n,[1,0]),e),a[1]);else{const l=a[0]!==n.shape.length-1,c=a[1]===e.shape.length-1;o=bn(n,e,l,c)}if(i>0){let l;s>r?l=s+r-3:l=s-1;const c=[];for(let f=l;f<l+i;++f)c.push(f);o=Ec(o,c)}return o.shape.length===1&&(o=Ca(o,1)),o})}class eL extends Sd{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){Z(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const t=e[0],s=e[1];if(t.length>3||s.length>3)throw new gn("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(t,s);if(t[r[0]]!==s[r[1]])throw new ke(`Dimension incompatibility: ${t[r[0]]} !== ${s[r[1]]}`)}mergeFunction(e){if(e.length!==2)throw new ke(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let t=e[0],s=e[1],r;return Array.isArray(this.axes)?r=this.axes.map((a,i)=>n1(a,e[i].shape.length)):r=[n1(this.axes,t.shape.length),n1(this.axes,s.shape.length)],this.normalize&&(t=Ab(t,r[0]),s=Ab(s,r[1])),CZ(t,s,r)}interpretAxes(e,t){let s;return Array.isArray(this.axes)?s=this.axes:s=[n1(this.axes,e.length),n1(this.axes,t.length)],s}computeOutputShape(e){Z(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const t=e[0].slice(),s=e[1].slice();if(t.length>3||s.length>3)throw new gn("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(t,s);t.splice(r[0],1),s.splice(r[1],1),s.splice(0,1);const a=t.concat(s);return a.length===1&&a.push(1),a}computeMask(e,t){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},t=super.getConfig();return Object.assign(e,t),e}}eL.className="Dot";st(eL);class tL extends Sn{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={stddev:this.stddev};return Object.assign(t,e),t}call(e,t){return _e(()=>{this.invokeCallHook(e,t);const s=Qt(e);return py(()=>et(qv(s.shape,0,this.stddev),s),()=>s,t.training||!1)})}}tL.className="GaussianNoise";st(tL);class nL extends Sn{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return _e(()=>{this.invokeCallHook(e,t);const s=Qt(e);return this.rate>0&&this.rate<1?py(()=>{const a=Math.sqrt(this.rate/(1-this.rate));return xe(s,qv(s.shape,1,a))},()=>s,t.training||!1):s})}}nL.className="GaussianDropout";st(nL);class sL extends Sn{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||Qt(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return _e(()=>{if(this.rate<1&&this.rate>0){const s=this._getNoiseShape(e);return py(()=>{const a=Qt(e),o=-1.6732632423543772*1.0507009873554805;let l=Ac(Wh(s),this.rate);l=wu(l,"float32");const c=((1-this.rate)*(1+this.rate*o**2))**-.5,f=-c*o*this.rate,d=et(xe(a,l),xe(et(l,-1),o));return et(xe(d,c),f)},()=>Qt(e),t.training||!1)}return e})}}sL.className="AlphaDropout";st(sL);function _1(n,e,t,s,r,a=.001){let i;if(n.rank===2)i=ik(n,e,t,s,r,a);else if(n.rank===3)i=ok(n,e,t,s,r,a);else if(n.rank===4)i=lk(n,e,t,s,r,a);else throw new gn(`batchNormalization is not implemented for array of rank ${n.rank} yet`);return i}function TZ(n,e,t,s,r=.001){return _e(()=>{const a=ty(n,s),i=a.mean,o=a.variance;return[_1(n,i,o,t,e,r),i,o]})}function AZ(n,e,t,s,r=.001){return _e(()=>{const a=ty(n,s),i=a.mean,o=a.variance,l=[];for(const b of Ol(0,n.rank))s.indexOf(b)!==-1?l.push(1):l.push(n.shape[b]);const c=we(i,l),f=we(o,l),d=e==null?null:we(e,l),m=t==null?null:we(t,l);return[_1(n,c,f,m,d,r),i,o]})}function IZ(n,e,t,s,r=.001){return Nn(s.slice().sort(),Ol(0,n.rank-1))?TZ(n,e,t,s,r):AZ(n,e,t,s,r)}class rL extends Sn{constructor(e){e==null&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=Rs(e.betaInitializer||"zeros"),this.gammaInitializer=Rs(e.gammaInitializer||"ones"),this.movingMeanInitializer=Rs(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=Rs(e.movingVarianceInitializer||"ones"),this.betaConstraint=Or(e.betaConstraint),this.gammaConstraint=Or(e.gammaConstraint),this.betaRegularizer=Ds(e.betaRegularizer),this.gammaRegularizer=Ds(e.gammaRegularizer)}build(e){e=Vn(e);const t=this.axis>=0?this.axis:this.axis+e.length,s=e[t];if(s==null)throw new ke(`Axis ${t} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new Rr({ndim:e.length,axes:{[t]:s}})];const r=[s];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,t){return _e(()=>{const s=t.training==null?!1:t.training,r=Qt(e),a=r.shape,i=a.length,o=Ol(0,i),l=this.axis>=0?this.axis:this.axis+i;o.splice(l,1);const c=id(1,i);c[l]=a[l];const f=o.slice();f.sort();const d=!Nn(f,Ol(0,i).slice(0,i-1)),m=()=>{if(d){const k=we(this.movingMean.read(),c),I=we(this.movingVariance.read(),c),A=this.center?we(this.beta.read(),c):null,R=this.scale?we(this.gamma.read(),c):null;return _1(r,k,I,A,R,this.epsilon)}else return _1(r,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!s)return m();const[g,b,x]=IZ(r,this.gamma.read(),this.beta.read(),o,this.epsilon),v=(k,I,A)=>{_e(()=>{const R=1-A,U=k.read(),V=xe(mt(U,I),R);k.write(mt(U,V))})};return(()=>{v(this.movingMean,b,this.momentum),v(this.movingVariance,x,this.momentum)})(),g})}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Us(this.betaInitializer),gammaInitializer:Us(this.gammaInitializer),movingMeanInitializer:Us(this.movingMeanInitializer),movingVarianceInitializer:Us(this.movingVarianceInitializer),betaRegularizer:ms(this.betaRegularizer),gammaRegularizer:ms(this.gammaRegularizer),betaConstraint:Dr(this.betaConstraint),gammaConstraint:Dr(this.gammaConstraint)},t=super.getConfig();return Object.assign(e,t),e}}rL.className="BatchNormalization";st(rL);class aL extends Sn{constructor(e){if(e==null&&(e={}),super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const t of this.axis)if(!Number.isInteger(t))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=Rs(e.betaInitializer||"zeros"),this.gammaInitializer=Rs(e.gammaInitializer||"ones"),this.betaRegularizer=Ds(e.betaRegularizer),this.gammaRegularizer=Ds(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=Vn(e);const t=e.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let a=0;a<this.axis.length;++a)this.axis[a]<0&&(this.axis[a]+=t);for(const a of this.axis)if(a<0||a>=t)throw new Error(`Invalid axis: ${a}`);if(this.axis.length!==Nh(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const s=this.axis.map(a=>e[a]),r=!0;this.scale?this.gamma=this.addWeight("gamma",s,"float32",this.gammaInitializer,this.gammaRegularizer,r):this.gamma=null,this.center?this.beta=this.addWeight("beta",s,"float32",this.betaInitializer,this.betaRegularizer,r):this.beta=null,this.built=!0}call(e,t){const s=Qt(e),r=s.shape,a=r.length;return _e(()=>{let{mean:o,variance:l}=ty(s,this.axis,!0);const c=id(1,a);for(const x of this.axis)c[x]=r[x];const f=x=>x!=null&&x.shape.length!==a?we(x,c):x;let d=this.scale?f(this.gamma.read()):null,m=this.center?f(this.beta.read()):null;const g=[],b=[];for(let x=0;x<a;++x)this.axis.indexOf(x)!==-1?(g.push(r[x]),b.push(1)):(g.push(1),b.push(r[x]));return o=lo(o,g),l=lo(l,g),d!=null&&(d=lo(d,b)),m!=null&&(m=lo(m,b)),_1(s,o,l,m,d,this.epsilon)})}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Us(this.betaInitializer),gammaInitializer:Us(this.gammaInitializer),betaRegularizer:ms(this.betaRegularizer),gammaRegularizer:ms(this.gammaRegularizer)},t=super.getConfig();return Object.assign(e,t),e}}aL.className="LayerNormalization";st(aL);function EZ(n,e,t){return _e(()=>{if(n.rank!==4)throw new ke(`temporalPadding expects input tensor to be 4-D, but received a ${n.rank}-D tensor.`);if(e==null&&(e=[[1,1],[1,1]]),e.length!==2||e[0].length!==2||e[1].length!==2)throw new ke("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(t==null&&(t=Ll()),t!=="channelsLast"&&t!=="channelsFirst")throw new ke(`Unknown data format: ${t}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let s;return t==="channelsFirst"?s=[[0,0],[0,0],e[0],e[1]]:s=[[0,0],e[0],e[1],[0,0]],Ic(n,s)})}class iL extends Sn{constructor(e){if(e==null&&(e={}),super(e),this.dataFormat=e.dataFormat==null?Ll():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new ke(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let t,s;if(typeof e.padding[0]=="number")t=[e.padding[0],e.padding[0]],s=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new ke(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(t=e.padding[0],e.padding[1].length!==2)throw new ke(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);s=e.padding[1]}this.padding=[t,s]}this.inputSpec=[new Rr({ndim:4})]}computeOutputShape(e){e=Vn(e);let t,s;return this.dataFormat==="channelsFirst"?(e[2]!=null&&e[2]>=0?t=e[2]+this.padding[0][0]+this.padding[0][1]:t=null,e[3]!=null&&e[3]>=0?s=e[3]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],e[1],t,s]):(e[1]!=null&&e[1]>=0?t=e[1]+this.padding[0][0]+this.padding[0][1]:t=null,e[2]!=null&&e[2]>=0?s=e[2]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],t,s,e[3]])}call(e,t){return _e(()=>EZ(Qt(e),this.padding,this.dataFormat))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}iL.className="ZeroPadding2D";st(iL);function ew(n,e,t,s,r,a){return _e(()=>{fr(r),SD(a),go(s),t==null&&(t=[1,1]),s==null&&(s="valid"),r==null&&(r=Ll()),a==null&&(a="max"),n=Z3(n,r);let i;const o=s==="same"?"same":"valid";return a==="max"?i=ey(n,e,t,o):i=q0(n,e,t,o),r==="channelsFirst"&&(i=An(i,[0,3,1,2])),i})}function oL(n,e,t,s,r,a){return _e(()=>{fr(r),SD(a),go(s),t==null&&(t=[1,1,1]),s==null&&(s="valid"),r==null&&(r=Ll()),a==null&&(a="max"),n=kO(n,r);let i;const o=s==="same"?"same":"valid";return a==="max"?i=$k(n,e,t,o):i=ak(n,e,t,o),r==="channelsFirst"&&(i=An(i,[0,4,1,2,3])),i})}class lL extends Sn{constructor(e){if(e.poolSize==null&&(e.poolSize=2),super(e),typeof e.poolSize=="number")this.poolSize=[e.poolSize];else if(Array.isArray(e.poolSize)&&e.poolSize.length===1&&typeof e.poolSize[0]=="number")this.poolSize=e.poolSize;else throw new ke(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.poolSize)}`);if(Hr(this.poolSize,"poolSize"),e.strides==null)this.strides=this.poolSize;else if(typeof e.strides=="number")this.strides=[e.strides];else if(Array.isArray(e.strides)&&e.strides.length===1&&typeof e.strides[0]=="number")this.strides=e.strides;else throw new ke(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.strides)}`);Hr(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,go(this.padding),this.inputSpec=[new Rr({ndim:3})]}computeOutputShape(e){e=Vn(e);const t=$l(e[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],t,e[2]]}call(e,t){return _e(()=>{this.invokeCallHook(e,t),e=fy(Qt(e),2);const s=this.poolingFunction(Qt(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return Ec(s,[2])})}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},t=super.getConfig();return Object.assign(e,t),e}}class uL extends lL{constructor(e){super(e)}poolingFunction(e,t,s,r,a){return fr(a),go(r),ew(e,t,s,r,a,"max")}}uL.className="MaxPooling1D";st(uL);class cL extends lL{constructor(e){super(e)}poolingFunction(e,t,s,r,a){return fr(a),go(r),ew(e,t,s,r,a,"avg")}}cL.className="AveragePooling1D";st(cL);class hL extends Sn{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==2)throw new ke(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides];Hr(this.poolSize,"poolSize"),Hr(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,fr(this.dataFormat),go(this.padding),this.inputSpec=[new Rr({ndim:4})]}computeOutputShape(e){e=Vn(e);let t=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2];return t=$l(t,this.poolSize[0],this.padding,this.strides[0]),s=$l(s,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[e[0],e[1],t,s]:[e[0],t,s,e[3]]}call(e,t){return _e(()=>(this.invokeCallHook(e,t),this.poolingFunction(Qt(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class fL extends hL{constructor(e){super(e)}poolingFunction(e,t,s,r,a){return fr(a),go(r),ew(e,t,s,r,a,"max")}}fL.className="MaxPooling2D";st(fL);class dL extends hL{constructor(e){super(e)}poolingFunction(e,t,s,r,a){return fr(a),go(r),ew(e,t,s,r,a,"avg")}}dL.className="AveragePooling2D";st(dL);class pL extends Sn{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==3)throw new ke(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];Hr(this.poolSize,"poolSize"),Hr(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,fr(this.dataFormat),go(this.padding),this.inputSpec=[new Rr({ndim:5})]}computeOutputShape(e){e=Vn(e);let t=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],r=this.dataFormat==="channelsFirst"?e[4]:e[3];return t=$l(t,this.poolSize[0],this.padding,this.strides[0]),s=$l(s,this.poolSize[1],this.padding,this.strides[1]),r=$l(r,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[e[0],e[1],t,s,r]:[e[0],t,s,r,e[4]]}call(e,t){return _e(()=>(this.invokeCallHook(e,t),this.poolingFunction(Qt(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class mL extends pL{constructor(e){super(e)}poolingFunction(e,t,s,r,a){return fr(a),go(r),oL(e,t,s,r,a,"max")}}mL.className="MaxPooling3D";st(mL);class gL extends pL{constructor(e){super(e)}poolingFunction(e,t,s,r,a){return fr(a),go(r),oL(e,t,s,r,a,"avg")}}gL.className="AveragePooling3D";st(gL);class yL extends Sn{constructor(e){super(e),this.inputSpec=[new Rr({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,t){throw new gn}}class bL extends yL{constructor(e){super(e||{})}call(e,t){return _e(()=>{const s=Qt(e);return Bs(s,1)})}}bL.className="GlobalAveragePooling1D";st(bL);class xL extends yL{constructor(e){super(e||{})}call(e,t){return _e(()=>{const s=Qt(e);return fo(s,1)})}}xL.className="GlobalMaxPooling1D";st(xL);class vL extends Sn{constructor(e){super(e),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,fr(this.dataFormat),this.inputSpec=[new Rr({ndim:4})]}computeOutputShape(e){return e=e,this.dataFormat==="channelsLast"?[e[0],e[3]]:[e[0],e[1]]}call(e,t){throw new gn}getConfig(){const e={dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class wL extends vL{call(e,t){return _e(()=>{const s=Qt(e);return this.dataFormat==="channelsLast"?Bs(s,[1,2]):Bs(s,[2,3])})}}wL.className="GlobalAveragePooling2D";st(wL);class SL extends vL{call(e,t){return _e(()=>{const s=Qt(e);return this.dataFormat==="channelsLast"?fo(s,[1,2]):fo(s,[2,3])})}}SL.className="GlobalMaxPooling2D";st(SL);class NL extends Sn{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(e){this.layer!=null&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){const e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},t=super.getConfig();return Object.assign(e,t),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,t,s={}){const r=t.layer,a=gc(r,s);delete t.layer;const i={layer:a};return Object.assign(i,t),new e(i)}}class kL extends NL{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=Vn(e),e.length<3)throw new ke(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];const t=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(t),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=Vn(e);const t=[e[0]].concat(e.slice(2)),s=this.layer.computeOutputShape(t),r=e[1];return[s[0],r].concat(s.slice(1))}call(e,t){return _e(()=>(e=Qt(e),DO((i,o)=>[Qt(this.layer.call(i,t)),[]],e,[],!1,null,null,!1,!0)[1]))}}kL.className="TimeDistributed";st(kL);function _Z(n){wd(ZX,"BidirectionalMergeMode",n)}const $Z="concat";class CL extends NL{constructor(e){super(e);const t=e.layer.getConfig(),s={};s.className=e.layer.getClassName(),s.config=t,this.forwardLayer=gc(s),t.goBackwards=t.goBackwards!==!0;const r={};if(r.className=e.layer.getClassName(),r.config=t,this.backwardLayer=gc(r),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?$Z:e.mergeMode,_Z(this.mergeMode),e.weights)throw new gn("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const t=e.length,s=Math.floor(t/2);this.forwardLayer.setWeights(e.slice(0,s)),this.backwardLayer.setWeights(e.slice(s))}computeOutputShape(e){let t=this.forwardLayer.computeOutputShape(e);Array.isArray(t)&&Array.isArray(t[0])||(t=[t]),t=t;let s,r,a;return this.returnState&&(a=t.slice(1)),s=t[0],s=s,this.mergeMode==="concat"?(s[s.length-1]*=2,r=[s]):this.mergeMode==null?r=[s,s.slice()]:r=[s],this.returnState?this.mergeMode==null?r.concat(a).concat(a.slice()):[s].concat(a).concat(a.slice()):ni(r)}apply(e,t){let s=t==null?null:t.initialState,r=t==null?null:t.constants;t==null&&(t={});const a=RO(e,s,r,this.numConstants);if(e=a.inputs,s=a.initialState,r=a.constants,Array.isArray(e)&&(s=e.slice(1),e=e[0]),(s==null||s.length===0)&&r==null)return super.apply(e,t);const i=[],o=[];if(s!=null){const c=s.length;if(c%2>0)throw new ke("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");t.initialState=s,i.push(...s);const f=s.map(d=>new Rr({shape:d.shape}));this.forwardLayer.stateSpec=f.slice(0,c/2),this.backwardLayer.stateSpec=f.slice(c/2),o.push(...f)}if(r!=null)throw new gn("Support for constants in Bidirectional layers is not implemented yet.");const l=i[0]instanceof Au;for(const c of i)if(c instanceof Au!==l)throw new ke("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(l){const c=[e].concat(i),f=this.inputSpec.concat(o),d=this.inputSpec;this.inputSpec=f;const m=super.apply(c,t);return this.inputSpec=d,m}else return super.apply(e,t)}call(e,t){return _e(()=>{const s=t.initialState;let r,a;if(s==null)r=this.forwardLayer.call(e,t),a=this.backwardLayer.call(e,t);else{const l=s.slice(0,s.length/2),c=s.slice(s.length/2);r=this.forwardLayer.call(e,Object.assign(t,{initialState:l})),a=this.backwardLayer.call(e,Object.assign(t,{initialState:c}))}let i;this.returnState&&(Array.isArray(r)&&(i=r.slice(1).concat(a.slice(1))),r=r[0],a=a[0]),this.returnSequences&&(a=po(a,1));let o;return this.mergeMode==="concat"?o=z3([r,a]):this.mergeMode==="sum"?o=et(r,a):this.mergeMode==="ave"?o=xe(.5,et(r,a)):this.mergeMode==="mul"?o=xe(r,a):this.mergeMode==null&&(o=[r,a]),this.returnState?this.mergeMode==null?o.concat(i):[o].concat(i):o})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){qf(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),qf(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,t){Array.isArray(t)&&(t=t[0]);let s;if(this.returnSequences?this.mergeMode==null?s=[t,t]:s=t:this.mergeMode==null?s=[null,null]:s=null,this.returnState){const a=this.forwardLayer.states.map(i=>null);return Array.isArray(s)?s.concat(a).concat(a):[s].concat(a).concat(a)}else return s}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},t=super.getConfig();return Object.assign(e,t),e}static fromConfig(e,t){const s=gc(t.layer);if(delete t.layer,t.numConstants!=null)throw new gn("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const r=t;return r.layer=s,new e(r)}}CL.className="Bidirectional";st(CL);class TL extends Sn{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){const e={scale:this.scale,offset:this.offset},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return _e(()=>(e=Qt(e),e.dtype!=="float32"&&(e=wu(e,"float32")),et(xe(e,this.scale),this.offset)))}}TL.className="Rescaling";st(TL);const{resizeBilinear:RZ,cropAndResize:DZ}=Bo;class AL extends Sn{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,t,s,r,a,i,o,l){return _e(()=>{let c,f=!1;const d=t/i,m=s/o,g=(r+t)/i,b=(a+s)/o,x=[d,m,g,b],v=[];e.rank===3?(f=!0,c=ui([e])):c=e;for(let R=0;R<c.shape[0];R++)v.push(x);const w=jo(v,[v.length,4]),k=sd(0,v.length,1,"int32"),A=DZ(c,w,k,[r,a],"nearest");return wu(f?Qt(mo(A)):A,l)})}upsize(e,t,s,r){return _e(()=>{const a=RZ(e,[t,s]);return wu(a,r)})}call(e,t){return _e(()=>{const s=Qt(e),r=s.dtype,a=s.shape,i=a[a.length-3],o=a[a.length-2];let l=0;i!==this.height&&(l=Math.floor((i-this.height)/2));let c=0;return o!==this.width&&(c=Math.floor((o-this.width)/2),c===0&&(c=1)),l>=0&&c>=0?this.centerCrop(s,l,c,this.height,this.width,i,o,r):this.upsize(e,this.height,this.width,r)})}getConfig(){const e={height:this.height,width:this.width},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){e=Vn(e);const t=e.length-3,s=e.length-2;return e[t]=this.height,e[s]=this.width,e}}AL.className="CenterCrop";st(AL);function OZ(n,e,t,s){let r=Qt(n);if(r.dtype!=="int32"&&(r=wu(r,"int32")),e==="int")return r;const a=r.shape;if(r.rank===0&&(r=Ca(r,-1)),e==="oneHot"&&r.shape[r.shape.length-1]!==1&&(r=Ca(r,-1)),r.rank>2)throw new ke(`When outputMode is not int, maximum output rank is 2 Received outputMode ${e} and input shape ${a} which would result in output rank ${r.rank}.`);const i=["multiHot","oneHot"].includes(e),o=r;let l;if(typeof s<"u"&&e==="count"?l=bb(o,s,t,i):l=bb(o,[],t,i),e!=="tfIdf")return l;if(s)return xe(l,s);throw new ke("When outputMode is 'tfIdf', weights must be provided.")}class IL extends Sn{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){const e={numTokens:this.numTokens,outputMode:this.outputMode},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){return e=Vn(e),e==null?[this.numTokens]:this.outputMode==="oneHot"&&e[e.length-1]!==1?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,t){return _e(()=>{e=Qt(e),e.dtype!=="int32"&&(e=wu(e,"int32"));let s;if(typeof t.countWeights<"u"){if(this.outputMode!=="count")throw new ke(`countWeights is not used when outputMode !== count.
              Received countWeights=${t.countWeights}`);s=Qt(t.countWeights)}const r=fo(e),a=Vp(e),i=hi(this.numTokens,r).bufferSync().get(0),o=Ac(a,0).bufferSync().get(0);if(!(i&&o))throw new ke(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return OZ(e,this.outputMode,this.numTokens,s)})}}IL.className="CategoryEncoding";st(IL);const LZ=["bilinear","nearest"],dE=new Set(LZ);class EL extends Sn{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation)if(dE.has(e.interpolation))this.interpolation=e.interpolation;else throw new ke(`Invalid interpolation parameter: ${e.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=!!e.cropToAspectRatio}computeOutputShape(e){e=Vn(e);const t=e[2];return[this.height,this.width,t]}getConfig(){const e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return _e(()=>{const s=[this.height,this.width];if(this.interpolation==="bilinear")return Bo.resizeBilinear(e,s,!this.cropToAspectRatio);if(this.interpolation==="nearest")return Bo.resizeNearestNeighbor(e,s,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...dE]} are supported`)})}}EL.className="Resizing";st(EL);class _L{constructor(e){this.seed=e}next(){if(this.seed!==void 0)return this.seed++}}_L.className="RandomSeed";class $L extends Sn{constructor(e){super(e),this.randomGenerator=new _L(e.seed)}getConfig(){const e={seed:this.randomGenerator.seed},t=super.getConfig();return Object.assign(e,t),e}}$L.className="BaseRandomLayer";const FZ=["bilinear","nearest"],pE=new Set(FZ);class RL extends $L{constructor(e){super(e);const{factor:t,interpolation:s="bilinear"}=e;if(this.factor=t,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new ke(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new ke(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new ke(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(s)if(pE.has(s))this.interpolation=s;else throw new ke(`Invalid interpolation parameter: ${s} is not implemented`)}getConfig(){const e={factor:this.factor,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){e=Vn(e);const t=e[2];return[this.imgHeight,-1,t]}call(e,t){return _e(()=>{const s=Qt(e);this.imgHeight=s.shape[s.shape.length-3];const r=s.shape[s.shape.length-2];this.widthFactor=Wh([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let a=this.widthFactor.dataSync()[0]*r;a=Math.round(a);const i=[this.imgHeight,a];switch(this.interpolation){case"bilinear":return Bo.resizeBilinear(e,i);case"nearest":return Bo.resizeNearestNeighbor(e,i);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...pE]} are supported`)}})}}RL.className="RandomWidth";st(RL);var mE;(function(n){n[n.FAIL=0]="FAIL",n[n.SHORTEST=1]="SHORTEST",n[n.LONGEST=2]="LONGEST"})(mE||(mE={}));function Ct(n,e){Array.isArray(n)||(n=[n]),n.forEach(t=>{t!=null&&Z(t.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the CPU backend.`)})}const MZ=_v;class tw extends Hb{nextDataId(){return tw.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new DN(this,Tl())}write(e,t,s){this.firstUse&&(this.firstUse=!1,De().get("IS_NODE")&&io(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const r={id:this.nextDataId()};return this.data.set(r,{values:e,dtype:s,refCount:1}),r}makeTensorInfo(e,t,s){let r;if(t==="string"&&s!=null&&s.length>0&&mu(s[0])){const a=s.map(i=>bu(i));r=this.write(a,e,t)}else r=this.write(s,e,t);return{dataId:r,shape:e,dtype:t}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){const t=this.data.get(e);t.refCount++}decRef(e){if(this.data.has(e)){const t=this.data.get(e);t.refCount--}}move(e,t,s,r,a){this.data.set(e,{values:t,dtype:r,refCount:a})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:t,complexTensorInfos:s}=this.data.get(e);if(t==="complex64"){const r=this.readSync(s.real.dataId),a=this.readSync(s.imag.dataId);return wc(r,a)}return P_(this.data.get(e).values,t)}bufferSync(e){const t=this.readSync(e.dataId);if(e.dtype==="string")try{const s=t.map(r=>bc(r));return mn(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return mn(e.shape,e.dtype,t)}makeOutput(e,t,s){return Tl().makeTensorFromTensorInfo(this.makeTensorInfo(t,s,e),this)}disposeData(e,t=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!t&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:s}=this.data.get(e);s!=null&&(this.disposeData(s.real.dataId,!0),this.disposeData(s.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const t=Ma();return e(),{kernelMs:Ma()-t}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){Ct([e],"where");const t=this.readSync(e.dataId);return MZ(e.shape,t)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}tw.nextDataId=0;function DL(n){const e=new Float32Array(n.length);for(let t=0;t<n.length;++t)e[t]=Math.abs(n[t]);return e}const zZ=n=>{const{x:e}=n.inputs,t=n.backend;Ct(e,"abs");let s=new Float32Array(Be(e.shape));const r=t.data.get(e.dataId).values;return s=DL(r),t.makeOutput(s,e.shape,e.dtype)},PZ={kernelName:B1,backendName:"cpu",kernelFunc:zZ};function dr(n){return(e,t,s,r,a)=>{const i=on(e,t),o=i.length,l=Ot(i),c=Be(i),f=Kr(a,c),d=e.length,m=t.length,g=Ot(e),b=Ot(t),x=td(e,i),v=td(t,i);if(x.length+v.length===0)for(let w=0;w<f.length;++w)f[w]=n(s[w%s.length],r[w%r.length]);else for(let w=0;w<f.length;++w){const k=md(w,o,l),I=k.slice(-d);x.forEach(V=>I[V]=0);const A=El(I,d,g),R=k.slice(-m);v.forEach(V=>R[V]=0);const U=El(R,m,b);f[w]=n(s[A],r[U])}return[f,i]}}function Oi(n){const{inputs:e,backend:t}=n,{real:s,imag:r}=e,a=t.data.get(s.dataId).values,i=t.data.get(r.dataId).values,o=t.makeTensorInfo(s.shape,"complex64"),l=t.data.get(o.dataId);return l.complexTensorInfos={real:t.makeTensorInfo(s.shape,"float32",a),imag:t.makeTensorInfo(r.shape,"float32",i)},o}const BZ={kernelName:nx,backendName:"cpu",kernelFunc:Oi};function Rb(n,e,t="float32"){if(t==="complex64"){const r=Rb(n,e,"float32"),a=Rb(n,e,"float32");return Oi({inputs:{real:r,imag:a},backend:n})}const s=ca(Be(e),t);return n.makeTensorInfo(e,t,s)}function Iu(n){const{inputs:e,backend:t}=n,{x:s}=e;return t.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const UZ={kernelName:Sm,backendName:"cpu",kernelFunc:Iu};function od(n){const{inputs:e,backend:t}=n,{input:s}=e,r=t.data.get(s.dataId).complexTensorInfos.real,a=t.data.get(r.dataId).values;return t.makeTensorInfo(r.shape,r.dtype,a)}const VZ={kernelName:Lx,backendName:"cpu",kernelFunc:od};function OL(n,e,t,s){if(s==="int32"){const r=Int32Array.from(n);return[e,"int32",r]}if(s==="bool"){const r=Ph([0],t),[a,i]=dr((o,l)=>o!==l?1:0)(e,[],n,r,"bool");return[i,"bool",a]}throw new Error(`Error in Cast: failed to cast ${t} to ${s}`)}function Fh(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{dtype:a}=s;if(a==="complex64"){if(r.dtype==="complex64")return Iu({inputs:{x:r},backend:t});const f=Rb(t,r.shape,r.dtype),d=Fh({inputs:{x:r},backend:t,attrs:{dtype:"float32"}}),m=Oi({inputs:{real:d,imag:f},backend:t});return t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(d),m}if(r.dtype==="complex64"){const f=od({inputs:{input:r},backend:t}),d=Fh({inputs:{x:f},backend:t,attrs:{dtype:a}});return t.disposeIntermediateTensorInfo(f),d}if(!FN(r.dtype,a)){const f=Iu({inputs:{x:r},backend:t});return{dataId:f.dataId,shape:f.shape,dtype:a}}const i=t.data.get(r.dataId).values,[o,l,c]=OL(i,r.shape,r.dtype,a);return t.makeTensorInfo(o,l,c)}const jZ={kernelName:um,backendName:"cpu",kernelFunc:Fh};function Lr(n,e,t,s){return t==null?({inputs:r,backend:a})=>{const{a:i,b:o}=r,l=a;Ct([i,o],n);const c=l.data.get(i.dataId).values,f=l.data.get(o.dataId).values,d=i.dtype==="string"?Sc(c):c,m=i.dtype==="string"?Sc(f):f,g=s||i.dtype,[b,x]=e(i.shape,o.shape,d,m,g);return l.makeTensorInfo(x,g,b)}:({inputs:r,backend:a})=>{const{a:i,b:o}=r,l=a;if(i.dtype==="complex64"||o.dtype==="complex64"){const c=Fh({inputs:{x:i},backend:l,attrs:{dtype:"complex64"}}),f=l.data.get(c.dataId),d=f.complexTensorInfos.real,m=f.complexTensorInfos.imag,g=l.data.get(d.dataId).values,b=l.data.get(m.dataId).values,x=Fh({inputs:{x:o},backend:l,attrs:{dtype:"complex64"}}),v=l.data.get(x.dataId),w=v.complexTensorInfos.real,k=v.complexTensorInfos.imag,I=l.data.get(w.dataId).values,A=l.data.get(k.dataId).values,[R,U,V]=t(i.shape,o.shape,g,b,I,A),P=l.makeTensorInfo(V,"float32",R),D=l.makeTensorInfo(V,"float32",U),B=Oi({inputs:{real:P,imag:D},backend:l});return l.disposeIntermediateTensorInfo(c),l.disposeIntermediateTensorInfo(x),l.disposeIntermediateTensorInfo(P),l.disposeIntermediateTensorInfo(D),B}else{const c=l.data.get(i.dataId).values,f=l.data.get(o.dataId).values,d=s||i.dtype,[m,g]=e(i.shape,o.shape,c,f,d);return l.makeTensorInfo(g,d,m)}}}function sC(n){return(e,t,s,r,a,i)=>{const o=on(e,t),l=Be(o),c=o.length,f=Ot(o),d=Kr("float32",l),m=Kr("float32",l),g=td(e,o),b=td(t,o),x=wc(s,r),v=wc(a,i),w=e.length,k=Ot(e),I=t.length,A=Ot(t);if(g.length+b.length===0)for(let R=0;R<d.length;R++){const U=R%x.length,V=R%v.length,P=n(x[U*2],x[U*2+1],v[V*2],v[V*2+1]);d[R]=P.real,m[R]=P.imag}else for(let R=0;R<d.length;R++){const U=md(R,c,f),V=U.slice(-w);g.forEach(M=>V[M]=0);const P=El(V,w,k),D=U.slice(-I);b.forEach(M=>D[M]=0);const B=El(D,I,A),E=n(x[P*2],x[P*2+1],v[B*2],v[B*2+1]);d[R]=E.real,m[R]=E.imag}return[d,m,o]}}const LL=dr(((n,e)=>n+e)),WZ=sC(((n,e,t,s)=>({real:n+t,imag:e+s}))),Xp=Lr(gd,LL,WZ),GZ={kernelName:gd,backendName:"cpu",kernelFunc:Xp};function rC(n,e,t,s,r){const a=Be(s),i=ca(r,t);for(let o=0;o<n.length;o++){const l=n[o];if(l<0)throw new Error("Input x must be non-negative!");l>=r||(a>0?i[l]+=e[o]:i[l]+=1)}return i}function FL(n,e,t,s=!1){const r=n.shape[0],a=n.shape[1],i=mn([r,t],e.dtype);for(let o=0;o<r;o++)for(let l=0;l<a;l++){const c=n.get(o,l);if(c<0)throw new Error("Input x must be non-negative!");c>=t||(s?i.set(1,o,c):e.size>0?i.set(i.get(o,c)+e.get(o,l),o,c):i.set(i.get(o,c)+1,o,c))}return i}const ML=dr(((n,e)=>n&e)),qZ=Lr(K1,ML),HZ={kernelName:K1,backendName:"cpu",kernelFunc:qZ};function $u(n){return(e,t,s)=>{const r=Ys(t,e.length);for(let a=0;a<e.length;++a)r[a]=n(e[a],s);return r}}function Qn(n,e,t){const s=$u(e);return Hh(n,s,t)}function Hh(n,e,t){return({inputs:s,attrs:r,backend:a})=>{const{x:i}=s;Ct(i,n);const o=a,l=o.data.get(i.dataId).values;let c;if(i.dtype==="string"){if(!Array.isArray(l))throw new Error("String tensor's value was not an instance of Array");c=Sc(l)}else c=l;const f=t||i.dtype,d=e(c,f,r);return o.makeTensorInfo(i.shape,f,d)}}const zL=$u(n=>Math.ceil(n)),KZ=Hh(cm,zL),XZ={kernelName:cm,backendName:"cpu",kernelFunc:KZ};function PL(n,e,t,s){const r=Ys(t,Be(e));if(s&&t!=="string"){let a=0;n.forEach(i=>{const o=Be(i.shape);r.set(i.vals,a),a+=o})}else{let a=0;n.forEach(i=>{const o=t==="string"?Sc(i.vals):i.vals;let l=0;for(let c=0;c<i.shape[0];++c){const f=c*e[1]+a;for(let d=0;d<i.shape[1];++d)r[f+d]=o[l++]}a+=i.shape[1]})}return r}const BL=dr((n,e)=>n===e?1:0),UL=Lr(s0,BL,null,"bool"),YZ={kernelName:s0,backendName:"cpu",kernelFunc:UL};const VL=$u(n=>Math.exp(n)),jL=Hh(ym,VL,"float32"),ZZ={kernelName:ym,backendName:"cpu",kernelFunc:jL};const WL=$u(n=>Math.expm1(n)),JZ=Hh(bm,WL),QZ={kernelName:bm,backendName:"cpu",kernelFunc:JZ};const GL=$u(n=>Math.floor(n)),eJ=Hh(xm,GL),tJ={kernelName:xm,backendName:"cpu",kernelFunc:eJ};const qL=dr((n,e)=>Math.floor(n/e)),nJ=Lr(vm,qL,null,"int32"),sJ={kernelName:vm,backendName:"cpu",kernelFunc:nJ};function HL(n,e,t,s,r,a,i,o,l){const c=mn([s,a],t);for(let f=0;f<s;f++){const d=[];let m=0;for(let g=0;g<r;g++){const b=n[f*r+g];m+=b*i[g],d.push(b)}if(m<0||m>=l/a)throw new Error(`Invalid indices: ${d} does not index into ${o}`);for(let g=0;g<a;g++)c.values[f*a+g]=e.get(...e.indexToLoc(m*a+g))}return c}function KL(n,e,t){const s=mn(t,n.dtype);for(let r=0;r<s.size;++r){const i=s.indexToLoc(r).slice(),o=i[0],l=i[2],c=e.locToIndex([o,l]);i[2]=e.values[c];const f=n.locToIndex(i);0<=f&&f<n.values.length&&(s.values[r]=n.values[f])}return s}const XL=dr((n,e)=>n>e?1:0),rJ=Lr(o0,XL,null,"bool"),aJ={kernelName:o0,backendName:"cpu",kernelFunc:rJ};const YL=dr((n,e)=>n>=e?1:0),iJ=Lr(wm,YL,null,"bool"),oJ={kernelName:wm,backendName:"cpu",kernelFunc:iJ};const ZL=dr((n,e)=>n<e?1:0),lJ=Lr(u0,ZL,null,"bool"),uJ={kernelName:u0,backendName:"cpu",kernelFunc:lJ};const JL=dr((n,e)=>n<=e?1:0),cJ=Lr(c0,JL,null,"bool"),hJ={kernelName:c0,backendName:"cpu",kernelFunc:cJ};function QL(n,e,t){const s=(e-n)/(t-1),r=ca(t,"float32");r[0]=n;for(let a=1;a<r.length;a++)r[a]=r[a-1]+s;return r}const e6=$u(n=>Math.log(n)),fJ=Hh(Tm,e6),dJ={kernelName:Tm,backendName:"cpu",kernelFunc:fJ};function t6(n,e,t,s){const r=Kr(s,Be(t));for(let a=0;a<r.length;++a){const i=a*e;let o=n[i];for(let l=0;l<e;++l){const c=n[i+l];(Number.isNaN(c)||c>o)&&(o=c)}r[a]=o}return r}const n6=dr(((n,e)=>Math.max(n,e))),pJ=Lr(Im,n6),mJ={kernelName:Im,backendName:"cpu",kernelFunc:pJ};const s6=dr(((n,e)=>Math.min(n,e))),gJ=Lr(Em,s6),yJ={kernelName:Em,backendName:"cpu",kernelFunc:gJ};const aC=dr(((n,e)=>n*e)),bJ=sC(((n,e,t,s)=>({real:n*t-e*s,imag:n*s+e*t}))),nw=Lr($m,aC,bJ),xJ={kernelName:$m,backendName:"cpu",kernelFunc:nw};function r6(n,e,t){const s=kc(-1,t);return aC([],e,s,n,t)}function vJ(n){const{inputs:e,backend:t}=n,{x:s}=e;Ct(s,"neg");const r=t.data.get(s.dataId).values,[a,i]=r6(r,s.shape,s.dtype);return t.makeTensorInfo(i,s.dtype,a)}const wJ={kernelName:w0,backendName:"cpu",kernelFunc:vJ};const a6=dr(((n,e)=>n!==e?1:0)),SJ=Lr(S0,a6,null,"bool"),NJ={kernelName:S0,backendName:"cpu",kernelFunc:SJ};function iC(n,e,t,s,r){const a=e.length,i=Be(e),o=Ot(e),l=Ot(r),c=Kr(t,Be(r));for(let f=0;f<i;++f){const d=md(f,a,o),m=new Array(d.length);for(let b=0;b<m.length;b++)m[b]=d[s[b]];const g=El(m,a,l);c[g]=n[f]}return c}function ci(n){const{inputs:e,attrs:t,backend:s}=n,{x:r}=e,{perm:a}=t;Ct(r,"transpose");const i=r.shape.length,o=new Array(i);for(let d=0;d<o.length;d++)o[d]=r.shape[a[d]];const l=s.data.get(r.dataId).values,c=iC(l,r.shape,r.dtype,a,o);return{dataId:s.write(c,o,r.dtype),shape:o,dtype:r.dtype}}const kJ={kernelName:Wf,backendName:"cpu",kernelFunc:ci};function i6(n,e,t,s){const[r,a]=Zr(n,s),i=ai(e,"int32"),o=ca(Be(r),i),l=Be(a);for(let c=0;c<o.length;++c){const f=c*l;let d=1;for(let m=0;m<l;++m)d*=t[f+m];o[c]=d}return{outVals:o,outShape:r,outDtype:i}}function CJ(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:a,keepDims:i}=s;Ct(r,"prod");const o=r.shape.length,l=vn(a,r.shape),c=js(l,o);let f=l,d=r;const m=[];c!=null&&(d=ci({inputs:{x:r},backend:t,attrs:{perm:c}}),m.push(d),f=hr(f.length,o));const g=t.data.get(d.dataId).values,{outVals:b,outShape:x,outDtype:v}=i6(d.shape,d.dtype,g,f);let w=x;return i&&(w=cr(x,l)),m.forEach(k=>t.disposeIntermediateTensorInfo(k)),t.makeTensorInfo(w,v,b)}const TJ={kernelName:I0,backendName:"cpu",kernelFunc:CJ};function AJ(n,e,t){n.forEach((s,r)=>{if(s<0||s>=t){const a=md(r,e.length,Ot(e)).join(",");throw new Error(`indices[${a}] = ${s} is not in [0, ${t})`)}})}function IJ(n,e){for(let t=0;t<n.length;++t){const s=n[t],r=t===n.length-1?e:n[t+1].length;if(s.length===0)throw new Error("Ragged splits may not be empty");if(s[0]<0)throw new Error("Ragged splits must be non-negative");if(s[s.length-1]>r)throw new Error("Ragged splits must not point past values");for(let a=1;a<s.length;++a)if(s[a-1]>s[a])throw new Error("Ragged splits must be sorted in ascending order")}}function EJ(n,e,t,s){const r=[];let a=0;const i=e.length-1+t.length,o=new Array(i).fill(null).map(()=>[0]);IJ(t,s);let l=1;for(let c=0;c<e.length-1;++c){l*=e[c];const f=e[c+1];for(let d=1;d<l+1;++d)o[c].push(d*f)}for(let c=0;c<n.length;++c){let f=n[c],d=n[c]+1;for(let m=0;m<t.length;++m){const g=t[m],b=m+e.length-1;if(b>=0){const x=o[b],v=x[x.length-1]-g[f];for(let w=f;w<d;++w)o[b].push(g[w+1]+v)}f=g[f],d=g[d]}d!==f&&(r.push([f,d]),a+=d-f)}return{outSplits:o,valueSlices:r,numValues:a}}function _J(n){const e=[];for(let t=0;t<n.length;++t){const s=n[t].length,r=Ys("int32",s);e.push(r),n[t].forEach((a,i)=>r[i]=a)}return e}function gE(n,e){const t=n.slice(0,e);for(;t.length<e;)t.push(1);for(let s=e;s<n.length;s++)t[e-1]*=n[s];return t}function $J(n,e,t,s,r,a){const i=gE(e,2)[1],o=gE(a,2)[1];let l=0;for(const c of t)for(let f=c[0];f<c[1];++f){for(let d=0;d<s;++d)r[l*o+d]=n[f*i+d];++l}}function RJ(n,e,t,s,r){const a=e.slice();a[0]=r;const i=Ys(t,Be(a)),o=n.length,l=o===0?0:o/e[0];return $J(n,e,s,l,i,a),[i,a]}function o6(n,e,t,s,r,a,i,o){if(n.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const l=e[0][0]-1;if(AJ(a,i,l),s.length===0)throw new Error("params.rank must be nonzero");const c=s[0],{outSplits:f,valueSlices:d,numValues:m}=EJ(a,i,n,c),g=_J(f),b=RJ(t,s,r,d,m);return[g,b[0],b[1]]}const yE=2147483647;function l6(n,e,t,s,r,a,i){if(e.length>1)throw new Error("starts must be a scalar or vector");if(r.length>1)throw new Error("limits must be a scalar or vector");if(i.length>1)throw new Error("deltas must be a scalar or vector");const o=e.length===0,l=r.length===0,c=i.length===0,f=[];o||f.push(e[0]),l||f.push(r[0]),c||f.push(i[0]);for(let v=1;v<f.length;++v)if(f[v]!==f[v-1])throw new Error("starts, limits, and deltas must have the same shape");const d=f.length===0?1:f[0],m=Ys("int32",d+1);m[0]=0;for(let v=0;v<d;++v){const w=o?n[0]:n[v],k=l?s[0]:s[v],I=c?a[0]:a[v];if(I===0)throw new Error("Requires delta != 0");let A;if(I>0&&k<w||I<0&&k>w)A=0;else if(A=Math.ceil(Math.abs((k-w)/I)),A>yE)throw new Error(`Requires ((limit - start) / delta) <= ${yE}`);m[v+1]=m[v]+A}const g=m[d],b=Ys(t,g);let x=0;for(let v=0;v<d;++v){const w=m[v+1]-m[v];let k=o?n[0]:n[v];const I=c?a[0]:a[v];for(let A=0;A<w;++A)b[x++]=k,k+=I}return[m,b]}var Mo=Il;class Db{constructor(e,t,s,r,a,i,o,l,c,f){this.shape=e,this.shapeShape=t,this.values=s,this.valuesShape=r,this.valuesDType=a,this.defaultValue=i,this.defaultValueShape=o,this.rowPartitionValues=l,this.rowPartitionValuesShapes=c,this.rowPartitionTypes=jR(f),this.raggedRank=WR(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===Mo.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===Mo.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const t=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case Mo.VALUE_ROWIDS:return Db.getMaxWidthValueRowID(t);case Mo.ROW_SPLITS:return Db.getMaxWidthRowSplit(t);default:throw new Error(`Cannot handle partition type ${Mo[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const t=e.length;if(t===0||t===1)return 0;let s=0;for(let r=0;r<t-1;++r){const a=e[r+1]-e[r];a>s&&(s=a)}return s}static getMaxWidthValueRowID(e){const t=e.length;if(t===0)return 0;let s=0,r=e[0],a=0;for(let i=1;i<t;++i){const o=e[i];o!==r&&(r=o,a=Math.max(i-s,a),s=i)}return Math.max(t-s,a)}tensorShapeFromTensor(e,t,s=!0){if(t.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return xE(e,s)}calculateOutputSize(e){const t=this.valuesShape,s=this.defaultValueShape;GR(s,t);const r=this.tensorShapeFromTensor(this.shape,this.shapeShape),i=VR(this.raggedRank,r,t);i[0]<0&&(i[0]=e);for(let o=1;o<=this.raggedRank;++o)i[o]<0&&(i[o]=this.getMaxWidth(o));return i}calculateFirstParentOutputIndex(e,t,s){const r=Math.min(e,s),a=[];let i=0;for(let o=0;o<r;++o,i+=t)a.push(i);for(let o=r;o<e;++o)a.push(-1);return Z(a.length===e,()=>"Final length of result must be equal to firstDimension."),a}calculateOutputIndexRowSplit(e,t,s,r){const a=e.length,i=[];for(let o=0;o<a-1;++o){const l=e[o+1]-e[o];let c=Math.min(r,l),f=t[o];f===-1&&(c=0);for(let d=0;d<c;++d)i.push(f),f+=s;for(let d=0;d<l-c;++d)i.push(-1)}if(a>0&&i.length!==e[a-1])throw new Error("Invalid row split size.");return i}calculateOutputIndexValueRowID(e,t,s,r){const a=e.length,i=[];if(a===0)return[];let o=0,l=e[0];if(l>=t.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${t.length}`);let c=t[l];i.push(c);for(let f=1;f<a;++f){const d=e[f];if(d===l)c>=0&&(++o,o<r?c+=s:c=-1);else{if(o=0,l=d,d>=t.length)throw new Error(`Got nextValueRowId=${d} which is not less than ${t.length}`);c=t[d]}i.push(c)}if(i.length!==e.length)throw new Error("Invalid row ids.");return i}calculateOutputIndex(e,t,s,r){const a=this.getRowPartitionTensor(e),i=this.getRowPartitionTypeByDimension(e);switch(i){case Mo.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(a,t,s,r);case Mo.ROW_SPLITS:if(a.length-1>t.length)throw new Error(`Row partition size is greater than output size: ${a.length-1} > ${t.length}`);return this.calculateOutputIndexRowSplit(a,t,s,r);default:throw new Error(`Unsupported partition type: ${Mo[i]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const t=this.rowPartitionTypes[0];switch(t){case Mo.FIRST_DIM_SIZE:return e[0];case Mo.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case Mo.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${Mo[t]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const t=this.getFirstDimensionSize(),s=this.calculateOutputSize(t),r=new Array(this.raggedRank+1);r[r.length-1]=1;for(let l=r.length-2;l>=0;--l)r[l]=r[l+1]*s[l+1];const a=xE(s,!1),i=Ys(this.valuesDType,Be(a));if(r[0]*s[0]>0){let l=this.calculateFirstParentOutputIndex(t,r[0],s[0]);for(let c=1;c<=this.raggedRank;++c)l=this.calculateOutputIndex(c-1,l,r[c],s[c]);this.setOutput(this.raggedRank,l,i,a)}return[a,i]}setOutput(e,t,s,r){if(s.length===0)return;const a=this.values,i=s;let o=r.slice();o=o.slice(e+1);const l=Be(o),c=t.length;let f=this.defaultValue;if(f.length!==l&&f.length!==1){const b=this.defaultValueShape;_e(()=>{const x=we(f,b);f=Gf(x,o).dataSync()})}let d=0,m=0,g=0;for(let b=0;b<=c;++b){let x=b<c?t[b]:-1;if(x===g){++g;continue}if(m<g){const v=a.subarray(d*l),w=i.subarray(m*l),k=(g-m)*l;bE(w,v,k)}if(b>=c){const v=s.length;x=Math.floor(v/l)}if(x>g)if(this.defaultValue.length===1)i.subarray(g*l,x*l).fill(this.defaultValue[0]),g=x;else for(;x>g;){const v=i.slice(g*l);bE(v,f,l),++g}x<0?(d=b+1,m=g):(d=b,m=g,g=m+1)}}}function bE(n,e,t){for(let s=0;s<t;s++)n[s]=e[s]}function xE(n,e){const t=[];for(let s of n){if(s<0){if(!e)throw new Error(`Dimension ${s} must be >= 0`);if(s<-1)throw new Error(`Dimension ${s} must be >= -1`);s=-1}t.push(s)}return t}function u6(n,e,t,s,r,a,i,o,l,c){return new Db(n,e,t,s,r,a,i,o,l,c).compute()}function c6(n,e,t,s){const r=n===e,a=n<e&&t<0,i=e<n&&t>1;if(r||a||i)return ca(0,s);const o=Math.abs(Math.ceil((e-n)/t)),l=ca(o,s);e<n&&t===1&&(t=-1),l[0]=n;for(let c=1;c<l.length;c++)l[c]=l[c-1]+t;return l}const h6=$u(n=>1/Math.sqrt(n)),DJ=Hh(Mm,h6),OJ={kernelName:Mm,backendName:"cpu",kernelFunc:DJ};function Uf(n,e,t,s,r,a,i,o,l,c){const f=[s/r,r],d=n.values,m=e.values;if(s===0)return mn(t,e.dtype);const g=l instanceof Sr?l:mn(f,e.dtype);typeof l=="string"||typeof l=="number"?g.values.fill(l):typeof l=="boolean"&&g.values.fill(+l);for(let b=0;b<a;b++){const x=[];let v=0;for(let w=0;w<i;w++){const k=d[b*i+w];x.push(k),v+=k*o[w]}if(v<0||v>=s/r)throw new Error(`Invalid indices: ${x} does not index into ${t}`);for(let w=0;w<r;w++)c?g.values[v*r+w]+=m[b*r+w]:g.values[v*r+w]=e.rank===0?m[0]:m[b*r+w]}return g}const LJ=$u(n=>1/(1+Math.exp(-n))),f6=Qn(Vm,n=>1/(1+Math.exp(-n))),FJ={kernelName:Vm,backendName:"cpu",kernelFunc:f6};function d6(n,e,t,s,r){const a=h3(s,e,t),i=Be(t),o=Ot(s);if(a){const d=f3(e,o);return r==="string"?n.slice(d,d+i):n.subarray(d,d+i)}const l=r==="string"?Sc(n):n,c=mn(s,r,l),f=mn(t,r);for(let d=0;d<f.size;++d){const m=f.indexToLoc(d),g=m.map((b,x)=>b+e[x]);f.set(c.get(...g),...m)}return r==="string"?hD(f.values):f.values}function ld(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{begin:a,size:i}=s;Ct(r,"slice");const[o,l]=Uv(r,a,i);u3(r,o,l);const c=t.data.get(r.dataId).values,f=d6(c,o,l,r.shape,r.dtype);return t.makeTensorInfo(l,r.dtype,f)}const MJ={kernelName:O0,backendName:"cpu",kernelFunc:ld};function p6(n,e,t,s,r,a,i){const o=e[0],l=a[0],c=new Array(l),f=new Array(o),d=e[1];if(l===0){if(o!==0)throw new Error(JR(o));const v=Ys(t,0),w=Ys(r,0);return[v,[0,d],w,c,f]}let m=!0,g=0;const b=new Array(l).fill(0);for(let v=0;v<o;++v){const w=n[v*d];if(w<0)throw new Error(QR(v,w));if(w>=l)throw new Error(eD(v,w,l));++b[w],m=m&&w>=g,g=w}let x=!0;for(let v=0;v<l;++v){const w=b[v]===0;c[v]=w,x=x&&!w,b[v]=Math.max(b[v],1),v>0&&(b[v]+=b[v-1])}if(x&&m){const v=n,w=s;for(let k=0;k<o;++k)f[k]=k;return[v,[o,d],w,c,f]}else{const v=b[l-1],w=Ys(t,v*d),k=Ys(r,v),I=new Array(l).fill(0);for(let A=0;A<o;++A){const R=n[A*d],U=I[R],V=(R===0?0:b[R-1])+U;I[R]++;for(let P=0;P<d;++P)w[V*d+P]=n[A*d+P];k[V]=s[A],f[A]=V}for(let A=0;A<l;++A)if(I[A]===0){const U=A===0?0:b[A-1];w[U*d+0]=A;for(let V=1;V<d;++V)w[U*d+V]=0;k[U]=i}return[w,[v,d],k,c,f]}}function m6(n,e,t,s,r){const a=Be(s),i=e[0],o=r.length,l=[];let c=1,f=-1;for(let v=0;v<o;++v){const w=r[v];if(w===-1){if(f!==-1)throw new Error(tD(f,v));f=v,l.push(1)}else{if(w<0)throw new Error(nD(v,w));c*=w,l.push(w)}}if(f!==-1){if(c<=0)throw new Error(sD());const v=Math.trunc(a/c);if(c*v!==a)throw new Error(rD(s,l));l[f]=v}if(Be(l)!==a)throw new Error(aD(s,l));const m=s.length,g=[];if(m>0){g[m-1]=1;for(let v=m-2;v>=0;--v)g[v]=g[v+1]*s[v+1]}const b=[];if(o>0){b[o-1]=1;for(let v=o-2;v>=0;--v)b[v]=b[v+1]*l[v+1]}const x=Ys(t,i*o);for(let v=0;v<i;++v){let w=0;for(let k=0;k<m;++k)w+=n[v*m+k]*g[k];for(let k=0;k<o;++k)x[v*o+k]=Math.trunc(w/b[k]),w%=b[k]}return[x,[i,o],l]}function oC(n,e,t,s,r,a=!1,i=0){const o=s.length,l=[e[0],n.length/e[0]],c=l[1],d=o>0?r[o-1]+1:0;if(d<0)throw new Error(VS());const m=e.slice();m[0]=d;const g=m.reduce((I,A)=>I*A,1),b=Ys(t,g);if(o===0)return d>0&&b.fill(i),[b,m];if(d<=0)throw new Error(VS());let x=0,v=1,w=0,k=r[x];for(;;){let I=0;if(v<o){if(I=r[v],k===I){++v;continue}if(k>=I)throw new Error(iD())}if(k<0||k>=d)throw new Error(oD(k,d));k>w&&b.fill(i,w*c,k*c);for(let A=x;A<v;++A){const R=s[A];if(R<0||R>=l[0])throw new Error(lD(A,s[A],l[0]));for(let U=0;U<c;U++)b[k*c+U]+=n[R*c+U]}if(a)for(let A=0;A<c;A++)b[k*c+A]/=v-x;if(x=v,++v,w=k+1,k=I,v>o)break}return w<d&&b.fill(i,w*c,d*c),[b,m]}const zJ=$u(n=>Math.sqrt(n)),PJ=Qn(Wm,n=>Math.sqrt(n)),BJ={kernelName:Wm,backendName:"cpu",kernelFunc:PJ};const g6=dr(((n,e)=>{const t=n-e;return t*t})),UJ=Lr(Gm,g6),VJ={kernelName:Gm,backendName:"cpu",kernelFunc:UJ};const y6=$u((n,e)=>{const{pattern:t,replaceGlobal:s,rewrite:r}=e;return n.replace(new RegExp(t,s?"g":""),r)}),jJ=Hh(P0,y6),WJ={kernelName:P0,backendName:"cpu",kernelFunc:jJ};function b6(n,e,t,s){const r=mn(n,e.dtype);for(let a=0;a<r.size;a++){const i=r.indexToLoc(a),o=new Array(i.length);for(let l=0;l<o.length;l++)o[l]=i[l]*t[l]+s[l];r.set(e.get(...o),...i)}return r}class GJ{constructor(e,t,s,r,a,i){this.separator=bu(e),this.nGramWidths=t,this.leftPad=bu(s),this.rightPad=bu(r),this.padWidth=a,this.preserveShort=i}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,t){const s=this.getPadWidth(t);return Math.max(0,e+2*s-t+1)}createNGrams(e,t,s,r,a,i){for(let o=0;o<a;++o){const l=this.getPadWidth(i),c=Math.max(0,l-o),f=Math.max(0,l-(a-(o+1))),d=i-(c+f),m=t+(c>0?0:o-l);let g=0;g+=c*this.leftPad.length;for(let k=0;k<d;++k)g+=e[m+k].length;g+=f*this.rightPad.length;const b=c+f+d-1;g+=b*this.separator.length,s[r+o]=new Uint8Array(g);const x=s[r+o];let v=0;const w=k=>k.forEach(I=>x[v++]=I);for(let k=0;k<c;++k)w(this.leftPad),w(this.separator);for(let k=0;k<d-1;++k)w(e[m+k]),w(this.separator);if(d>0){w(e[m+d-1]);for(let k=0;k<f;++k)w(this.separator),w(this.rightPad)}else{for(let k=0;k<f-1;++k)w(this.rightPad),w(this.separator);w(this.rightPad)}}}compute(e,t){const s=e.length,r=t.length;if(r>0){let l=t[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let c=1;c<r;++c){let f=t[c]>=l;if(f=f&&t[c]<=s,!f)throw new Error(`Invalid split value ${t[c]}, must be in [${l}, ${s}]`);l=t[c]}if(l!==s)throw new Error(`Last split value must be data size. Expected ${s}, got ${l}`)}const a=r-1,i=Ys("int32",r);if(s===0||r===0){const l=new Array(s);for(let c=0;c<=a;++c)i[c]=0;return[l,i]}i[0]=0;for(let l=1;l<=a;++l){const c=t[l]-t[l-1];let f=0;this.nGramWidths.forEach(d=>{f+=this.getNumNGrams(c,d)}),this.preserveShort&&c>0&&f===0&&(f=1),i[l]=i[l-1]+f}const o=new Array(i[a]);for(let l=0;l<a;++l){const c=t[l];let f=i[l];if(this.nGramWidths.forEach(d=>{const m=t[l+1]-t[l],g=this.getNumNGrams(m,d);this.createNGrams(e,c,o,f,g,d),f+=g}),this.preserveShort&&f===i[l]){const d=t[l+1]-t[l];if(d===0)continue;const m=d+2*this.padWidth;this.createNGrams(e,c,o,f,1,m)}}return[o,i]}}function x6(n,e,t,s,r,a,i,o){return new GJ(t,s,r,a,i,o).compute(n,e)}function qJ(n,e,t,s){if(!n.length)return;if(e.length===0){for(let a=0;a<n.length;++a)s.push(n.subarray(a,a+1));return}if(e.length===1){const a=e[0];let i=n.indexOf(a);for(;i!==-1;){const o=n.subarray(0,i);(!t||o.length!==0)&&s.push(o),n=n.subarray(i+1),i=n.indexOf(a)}(!t||n.length!==0)&&s.push(n);return}let r=0;for(let a=0;a<n.length+1;a++)if(a===n.length||e.indexOf(n[a])!==-1){const i=n.subarray(r,a);(!t||i.length!==0)&&s.push(i),r=a+1}}function v6(n,e,t){const s=n.length,r=[];let a=0,i=0;const o=new Array(s);for(let m=0;m<s;++m){const g=r.length;qJ(n[m],e,t,r);const b=r.length-g;o[m]=b,a+=b,i=Math.max(i,b)}const l=Ys("int32",a*2),c=new Array(a),f=[s,i];let d=0;for(let m=0;m<s;++m)for(let g=0;g<o[m];++g)l[d*2]=m,l[d*2+1]=g,c[d]=r[d],++d;return[l,c,f]}function w6(n,e){const t=Ys("int32",n.length);for(let s=0;s<n.length;++s)t[s]=Y_(n[s]).modulo(e).getLowBitsUnsigned();return t}const S6=dr(((n,e)=>n-e)),HJ=sC(((n,e,t,s)=>({real:n-t,imag:e-s}))),lC=Lr(qm,S6,HJ),KJ={kernelName:qm,backendName:"cpu",kernelFunc:lC};function N6(n,e){const t=new Array(n.rank);for(let r=0;r<t.length;r++)t[r]=n.shape[r]*e[r];const s=mn(t,n.dtype);for(let r=0;r<s.values.length;++r){const a=s.indexToLoc(r),i=new Array(n.rank);for(let l=0;l<i.length;l++)i[l]=a[l]%n.shape[l];const o=n.locToIndex(i);s.values[r]=n.values[o]}return s}const l1=(n,e)=>{const t=e.value-n.value;return t===0?n.index-e.index:t};function k6(n,e,t=0,s=n.length-1){for(;s>t;){if(s-t>600){const o=s-t+1,l=e-t+1,c=Math.log(o),f=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*f*(o-f)/o)*Math.sign(l-o/2),m=Math.max(t,Math.floor(e-l*f/o+d)),g=Math.min(s,Math.floor(e+(o-l)*f/o+d));k6(n,e,m,g)}const r=n[e];let a=t,i=s;for(dc(n,t,e),l1(n[s],r)>0&&dc(n,t,s);a<i;){for(dc(n,a,i),a++,i--;l1(n[a],r)<0;)a=a+1;for(;l1(n[i],r)>0;)i=i-1}l1(n[t],r)===0?dc(n,t,i):(i=i+1,dc(n,i,s)),i<=e&&(t=i+1),e<=i&&(s=i-1)}}function C6(n,e,t,s,r){const a=e[e.length-1],[i,o]=[n.length/a,a],l=Kr(t,i*s),c=Kr("int32",i*s);for(let d=0;d<i;d++){const m=d*o,g=n.subarray(m,m+o);let b=new Array(g.length);g.forEach((k,I)=>b[I]={value:k,index:I}),s<b.length&&(k6(b,s),b=b.slice(0,s)),r&&b.sort(l1);const x=d*s,v=l.subarray(x,x+s),w=c.subarray(x,x+s);for(let k=0;k<s;k++)v[k]=b[k].value,w[k]=b[k].index}const f=e.slice();return f[f.length-1]=s,[mn(f,t,l),mn(f,"int32",c)]}function T6(n,e,t,s){const r=vn(e,t)[0],a=[1,t[0],1];for(let b=0;b<r;b++)a[0]*=t[b];a[1]=t[r];for(let b=r+1;b<t.length;b++)a[2]*=t[b];const i=new Map,o=new Int32Array(t[r]),l=new Sr(a,s,n),c=[],f=a[0]===1&&a[2]===1;for(let b=0;b<t[r];b++){let x;if(f)x=n[b].toString();else{const w=[];for(let k=0;k<a[0];k++)for(let I=0;I<a[2];I++)w.push(l.get(k,b,I));x=w.join(",")}const v=i.get(x);if(v!=null)o[b]=v;else{const w=i.size;i.set(x,w),o[b]=w,c.push(b)}}const d=a.slice();d[1]=i.size;const m=new Sr(d,s);c.forEach((b,x)=>{for(let v=0;v<a[0];v++)for(let w=0;w<a[2];w++)m.set(l.get(v,b,w),v,x,w)});const g=t.slice();return g[r]=d[1],{outputValues:m.values,outputShape:g,indices:o}}const XJ=Object.freeze(Object.defineProperty({__proto__:null,addImpl:LL,bincountImpl:rC,bincountReduceImpl:FL,bitwiseAndImpl:ML,castImpl:OL,ceilImpl:zL,concatImpl:PL,equalImpl:BL,expImpl:VL,expm1Impl:WL,floorDivImpl:qL,floorImpl:GL,gatherNdImpl:HL,gatherV2Impl:KL,greaterEqualImpl:YL,greaterImpl:XL,lessEqualImpl:JL,lessImpl:ZL,linSpaceImpl:QL,logImpl:e6,maxImpl:t6,maximumImpl:n6,minimumImpl:s6,multiplyImpl:aC,negImpl:r6,notEqualImpl:a6,prodImpl:i6,raggedGatherImpl:o6,raggedRangeImpl:l6,raggedTensorToTensorImpl:u6,rangeImpl:c6,rsqrtImpl:h6,scatterImpl:Uf,sigmoidImpl:LJ,simpleAbsImpl:DL,sliceImpl:d6,sparseFillEmptyRowsImpl:p6,sparseReshapeImpl:m6,sparseSegmentReductionImpl:oC,sqrtImpl:zJ,squaredDifferenceImpl:g6,staticRegexReplaceImpl:y6,stridedSliceImpl:b6,stringNGramsImpl:x6,stringSplitImpl:v6,stringToHashBucketFastImpl:w6,subImpl:S6,tileImpl:N6,topKImpl:C6,transposeImpl:iC,uniqueImpl:T6},Symbol.toStringTag,{value:"Module"}));GN("cpu",()=>new tw,1);const A6=Qn(mm,n=>n>=0?n:Math.exp(n)-1),YJ={kernelName:mm,backendName:"cpu",kernelFunc:A6};function I6(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{alpha:a}=s;Ct([r],"leakyRelu");const i=Be(r.shape),o=t.data.get(r.dataId).values,l=Kr("float32",i);for(let c=0;c<o.length;c++)l[c]=o[c]<0?a*o[c]:o[c];return t.makeTensorInfo(r.shape,"float32",l)}const ZJ={kernelName:l0,backendName:"cpu",kernelFunc:I6};const JJ=dr((n,e)=>n<0?e*n:n);function E6(n){const{inputs:e,backend:t}=n,{x:s,alpha:r}=e;Ct([s,r],"prelu");const a=t.data.get(s.dataId).values,i=t.data.get(r.dataId).values,[o,l]=JJ(s.shape,r.shape,a,i,"float32");return t.makeTensorInfo(l,"float32",o)}const QJ={kernelName:A0,backendName:"cpu",kernelFunc:E6};const _6=Qn(Om,n=>Math.max(0,n)),eQ={kernelName:Om,backendName:"cpu",kernelFunc:_6};const $6=Qn(Lm,n=>Math.min(Math.max(0,n),6)),tQ={kernelName:Lm,backendName:"cpu",kernelFunc:$6};function Ob(n,e,t,s,r){if(t==="linear")return Iu({inputs:{x:e},backend:n});if(t==="relu")return _6({inputs:{x:e},backend:n});if(t==="elu")return A6({inputs:{x:e},backend:n});if(t==="relu6")return $6({inputs:{x:e},backend:n});if(t==="prelu")return E6({inputs:{x:e,alpha:s},backend:n});if(t==="leakyrelu")return I6({inputs:{x:e},backend:n,attrs:{alpha:r}});if(t==="sigmoid")return f6({inputs:{x:e},backend:n});throw new Error(`Activation ${t} has not been implemented for the CPU backend.`)}function Ss(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{shape:a}=s,i=Be(r.shape),o=LN(a,i),l=Be(o);Z(i===l,()=>`The new shape (${o}) has ${l} elements and the old shape (${r.shape}) has ${i} elements. The new shape and old shape must have the same number of elements.`),t.incRef(r.dataId);const c=t.data.get(r.dataId);if(c.complexTensorInfos!=null){const f=c.complexTensorInfos.real,d=c.complexTensorInfos.imag;f.shape=o,d.shape=o}return{dataId:r.dataId,shape:o,dtype:r.dtype}}const nQ={kernelName:E0,backendName:"cpu",kernelFunc:Ss};function R6(n){const{inputs:e,backend:t,attrs:s}=n,{a:r,b:a}=e,{transposeA:i,transposeB:o}=s;Ct([r,a],"matMul");const l=r.shape.length,c=a.shape.length,f=i?r.shape[l-2]:r.shape[l-1],d=o?a.shape[c-1]:a.shape[c-2],m=i?r.shape[l-1]:r.shape[l-2],g=o?a.shape[c-2]:a.shape[c-1],b=r.shape.slice(0,-2),x=a.shape.slice(0,-2),v=Be(b),w=Be(x),I=on(r.shape.slice(0,-2),a.shape.slice(0,-2)).concat([m,g]);Z(f===d,()=>`Error in matMul: inner shapes (${f}) and (${d}) of Tensors with shapes ${r.shape} and ${a.shape} and transposeA=${i} and transposeB=${o} must match.`);const A=i?[v,f,m]:[v,m,f],R=o?[w,g,d]:[w,d,g],U=Ss({inputs:{x:r},backend:t,attrs:{shape:A}}),V=Ss({inputs:{x:a},backend:t,attrs:{shape:R}}),P=i?U.shape[1]:U.shape[2],D=i?U.shape[2]:U.shape[1],B=o?V.shape[1]:V.shape[2],E=Math.max(v,w),M=t.data.get(U.dataId).values,K=t.data.get(V.dataId).values,X=Ot(U.shape),ae=Ot(V.shape),[W,se,ee]=i?[X[0],1,X[1]]:[X[0],X[1],1],[ce,ye,G]=o?[1,ae[1],ae[0]]:[ae[1],1,ae[0]],O=D*B,j=mn([E,D,B],U.dtype),Y=j.values,ie=t.blockSize;for(let ue=0;ue<E;ue++){const pe=ue%v,Ce=ue%w;for(let Ne=0;Ne<D;Ne+=ie){const Le=Math.min(Ne+ie,D);for(let Ve=0;Ve<B;Ve+=ie){const rt=Math.min(Ve+ie,B);for(let at=0;at<P;at+=ie){const ot=Math.min(at+ie,P);for(let oe=Ne;oe<Le;oe++)for(let tt=Ve;tt<rt;tt++){let xt=0;for(let ht=at;ht<ot;ht++){const Je=M[pe*W+oe*se+ht*ee],dt=K[ht*ce+tt*ye+Ce*G];xt+=Je*dt}Y[ue*O+(oe*B+tt)]+=xt}}}}}return t.disposeIntermediateTensorInfo(U),t.disposeIntermediateTensorInfo(V),t.makeTensorInfo(I,j.dtype,j.values)}const sQ={kernelName:q1,backendName:"cpu",kernelFunc:R6};function rQ(n){const{inputs:e,backend:t,attrs:s}=n,{a:r,b:a,bias:i,preluActivationWeights:o}=e,{transposeA:l,transposeB:c,activation:f,leakyreluAlpha:d}=s;let m,g,b;const x=[];m=R6({inputs:{a:r,b:a},attrs:{transposeA:l,transposeB:c},backend:t}),i&&(g=Xp({inputs:{a:m,b:i},backend:t}),x.push(m),m=g),f&&(b=Ob(t,m,f,o,d),x.push(m),m=b);for(const w of x)t.disposeIntermediateTensorInfo(w);return m}const aQ={kernelName:g1,backendName:"cpu",kernelFunc:rQ};const iQ=Qn(nm,n=>Math.acos(n)),oQ={kernelName:nm,backendName:"cpu",kernelFunc:iQ};const lQ=Qn(sm,n=>Math.acosh(n)),uQ={kernelName:sm,backendName:"cpu",kernelFunc:lQ};function cQ(n){const{inputs:e,backend:t}=n,s=e;Ct(e,"addN");const r=s.map(o=>t.data.get(o.dataId).values),a=mn(s[0].shape,s[0].dtype),i=a.values;for(let o=0;o<s.length;o++){const l=r[o];for(let c=0;c<i.length;c++)i[c]+=l[c]}return t.makeTensorInfo(a.shape,a.dtype,a.values)}const hQ={kernelName:U1,backendName:"cpu",kernelFunc:cQ};function fQ(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:a,keepDims:i}=s;Ct(r,"all");const o=vn(a,r.shape);let l=o;const c=js(l,r.shape.length);let f=r;c!=null&&(f=ci({inputs:{x:r},backend:t,attrs:{perm:c}}),l=hr(l.length,r.shape.length)),da("all",l,f.shape.length);const[d,m]=Zr(f.shape,l),g=Be(m),b=ca(Be(d),f.dtype),x=t.data.get(f.dataId).values;for(let w=0;w<b.length;++w){const k=w*g;let I=x[k];for(let A=0;A<g;++A){const R=x[k+A];I=I&&R}b[w]=I}c!=null&&t.disposeIntermediateTensorInfo(f);const v=t.makeTensorInfo(d,f.dtype,b);if(i){const w=cr(d,o),k=Ss({inputs:{x:v},backend:t,attrs:{shape:w}});return t.disposeIntermediateTensorInfo(v),k}return v}const dQ={kernelName:Yb,backendName:"cpu",kernelFunc:fQ};function pQ(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:a,keepDims:i}=s;Ct(r,"any");const o=vn(a,r.shape);let l=o;const c=js(l,r.shape.length);let f=r;c!=null&&(f=ci({inputs:{x:r},backend:t,attrs:{perm:c}}),l=hr(l.length,r.shape.length)),da("any",l,f.shape.length);const[d,m]=Zr(f.shape,l),g=Be(m),b=ca(Be(d),f.dtype),x=t.data.get(f.dataId).values;for(let w=0;w<b.length;++w){const k=w*g;let I=x[k];for(let A=0;A<g;++A){const R=x[k+A];I=I||R}b[w]=I}c!=null&&t.disposeIntermediateTensorInfo(f);const v=t.makeTensorInfo(d,f.dtype,b);if(i){const w=cr(d,o),k=Ss({inputs:{x:v},backend:t,attrs:{shape:w}});return t.disposeIntermediateTensorInfo(v),k}return v}const mQ={kernelName:Zb,backendName:"cpu",kernelFunc:pQ};function gQ(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:a}=s;Ct(r,"argMax");let i=vn(a,r.shape);const o=js(i,r.shape.length);let l=r;const c=[];o!=null&&(l=ci({inputs:{x:r},backend:t,attrs:{perm:o}}),c.push(l),i=hr(i.length,l.shape.length)),i=[i[0]],da("argMax",i,l.shape.length);const[f,d]=Zr(l.shape,i),m=Be(f),g=ca(m,"int32"),b=Be(d),x=t.data.get(l.dataId).values;for(let v=0;v<g.length;++v){const w=v*b;let k=x[w],I=0;for(let A=0;A<b;++A){const R=x[w+A];R>k&&(k=R,I=A)}g[v]=I}return c.forEach(v=>t.disposeIntermediateTensorInfo(v)),t.makeTensorInfo(f,"int32",g)}const yQ={kernelName:V1,backendName:"cpu",kernelFunc:gQ};function bQ(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:a}=s;Ct(r,"argMin");let i=vn(a,r.shape);const o=js(i,r.shape.length);let l=r;const c=[];o!=null&&(l=ci({inputs:{x:r},backend:t,attrs:{perm:o}}),c.push(l),i=hr(i.length,l.shape.length)),i=[i[0]],da("argMin",i,l.shape.length);const[f,d]=Zr(l.shape,i),m=Be(f),g=ca(m,"int32"),b=Be(d),x=t.data.get(l.dataId).values;for(let v=0;v<g.length;++v){const w=v*b;let k=x[w],I=0;for(let A=0;A<b;++A){const R=x[w+A];R<k&&(k=R,I=A)}g[v]=I}return c.forEach(v=>t.disposeIntermediateTensorInfo(v)),t.makeTensorInfo(f,"int32",g)}const xQ={kernelName:j1,backendName:"cpu",kernelFunc:bQ};const vQ=Qn(rm,n=>Math.asin(n)),wQ={kernelName:rm,backendName:"cpu",kernelFunc:vQ};const SQ=Qn(am,n=>Math.asinh(n)),NQ={kernelName:am,backendName:"cpu",kernelFunc:SQ};const kQ=Qn(im,n=>Math.atan(n)),CQ={kernelName:im,backendName:"cpu",kernelFunc:kQ};const TQ=dr((n,e)=>Math.atan2(n,e)),AQ=Lr(lm,TQ),IQ={kernelName:lm,backendName:"cpu",kernelFunc:AQ};const EQ=Qn(om,n=>Math.atanh(n)),_Q={kernelName:om,backendName:"cpu",kernelFunc:EQ};function uC(n,e,t,s,r,a){const i=r.strideHeight,o=r.strideWidth,l=r.dilationHeight,c=r.dilationWidth,f=r.effectiveFilterHeight,d=r.effectiveFilterWidth,m=r.padInfo.top,g=r.padInfo.left,b=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,x=mn(r.outShape,t),v=x.values,w=r.outShape[1]*r.outShape[2]*r.outShape[3],k=r.outShape[2]*r.outShape[3],I=r.outShape[3];for(let A=0;A<r.batchSize;++A){const R=A*w,U=A*s[0];for(let V=0;V<r.inChannels;++V)for(let P=0;P<r.outHeight;++P){const D=P*i-m,B=Math.max(0,D),E=Math.min(r.inHeight,f+D),M=R+P*k;for(let K=0;K<r.outWidth;++K){const X=K*o-g,ae=Math.max(0,X),W=Math.min(r.inWidth,d+X);let se=b,ee=0,ce=0;for(let G=B;G<E;G+=l){const O=U+G*s[1];for(let j=ae;j<W;j+=c){const Y=O+j*s[2],ie=n[Y+V];a==="max"&&ie>se?se=ie:a==="avg"&&(ee+=ie,ce++)}if(isNaN(se))break}const ye=M+K*I+V;v[ye]=a==="avg"?ee/ce:se}}}return x}function D6(n,e,t,s,r=!1,a=!1){const i=mn(s.outShape,"int32"),o=s.strideHeight,l=s.strideWidth,c=s.dilationHeight,f=s.dilationWidth,d=s.effectiveFilterHeight,m=s.effectiveFilterWidth,g=s.padInfo.top,b=s.padInfo.left,x=mn(e,t,n);for(let v=0;v<s.batchSize;++v)for(let w=0;w<s.inChannels;++w)for(let k=0;k<s.outHeight;++k){const I=k*o-g;let A=I;for(;A<0;)A+=c;const R=Math.min(s.inHeight,d+I);for(let U=0;U<s.outWidth;++U){const V=U*l-b;let P=V;for(;P<0;)P+=f;const D=Math.min(s.inWidth,m+V);let B=Number.NEGATIVE_INFINITY,E=-1;for(let M=A;M<R;M+=c){const K=M-I;for(let X=P;X<D;X+=f){const ae=X-V,W=x.get(v,M,X,w);W>B&&(B=W,r?E=a?((v*s.inHeight+M)*s.inWidth+X)*s.inChannels+w:(M*s.inWidth+X)*s.inChannels+w:E=K*m+ae)}}i.set(E,v,k,U,w)}}return i}function O6(n,e,t,s,r,a){const i=r.strideDepth,o=r.strideHeight,l=r.strideWidth,c=r.dilationDepth,f=r.dilationHeight,d=r.dilationWidth,m=r.effectiveFilterDepth,g=r.effectiveFilterHeight,b=r.effectiveFilterWidth,x=r.padInfo.front,v=r.padInfo.top,w=r.padInfo.left,k=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,I=mn(r.outShape,t),A=I.values,R=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],U=r.outShape[2]*r.outShape[3]*r.outShape[4],V=r.outShape[3]*r.outShape[4],P=r.outShape[4];for(let D=0;D<r.batchSize;++D){const B=D*R,E=D*s[0];for(let M=0;M<r.inChannels;++M)for(let K=0;K<r.outDepth;++K){const X=K*i-x;let ae=X;for(;ae<0;)ae+=c;const W=Math.min(r.inDepth,m+X),se=B+K*U;for(let ee=0;ee<r.outHeight;++ee){const ce=ee*o-v;let ye=ce;for(;ye<0;)ye+=f;const G=Math.min(r.inHeight,g+ce),O=se+ee*V;for(let j=0;j<r.outWidth;++j){const Y=j*l-w;let ie=Y;for(;ie<0;)ie+=d;const ue=Math.min(r.inWidth,b+Y),pe=O+j*P;let Ce=k,Ne=0,Le=0;for(let rt=ae;rt<W;rt+=c){const at=E+rt*s[1];for(let ot=ye;ot<G;ot+=f){const oe=at+ot*s[2];for(let tt=ie;tt<ue;tt+=d){const xt=oe+tt*s[3],ht=n[xt+M];if(a==="max"&&ht>Ce?Ce=ht:a==="avg"&&(Ne+=ht,Le++),isNaN(Ce))break}if(isNaN(Ce))break}if(isNaN(Ce))break}const Ve=pe+M;A[Ve]=a==="avg"?Ne/Math.max(Le,1):Ce}}}}return I}function $Q(n,e){const t=mn(e.outShape,"int32"),s=e.strideDepth,r=e.strideHeight,a=e.strideWidth,i=e.dilationDepth,o=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterDepth,f=e.effectiveFilterHeight,d=e.effectiveFilterWidth,m=e.padInfo.front,g=e.padInfo.top,b=e.padInfo.left;for(let x=0;x<e.batchSize;++x)for(let v=0;v<e.inChannels;++v)for(let w=0;w<e.outDepth;++w){const k=w*s-m;let I=k;for(;I<0;)I+=i;const A=Math.min(e.inDepth,c+k);for(let R=0;R<e.outHeight;++R){const U=R*r-g;let V=U;for(;V<0;)V+=o;const P=Math.min(e.inHeight,f+U);for(let D=0;D<e.outWidth;++D){const B=D*a-b;let E=B;for(;E<0;)E+=l;const M=Math.min(e.inWidth,d+B);let K=Number.NEGATIVE_INFINITY,X=-1;for(let ae=I;ae<A;ae+=i){const W=ae-k;for(let se=V;se<P;se+=o){const ee=se-U;for(let ce=E;ce<M;ce+=l){const ye=ce-B,G=n.get(x,ae,se,ce,v);G>=K&&(K=G,X=W*f*d+ee*f+ye)}}}t.set(X,x,w,R,D,v)}}}return t}function RQ(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e;Ct(r,"avgPool");const{filterSize:a,strides:i,pad:o,dimRoundingMode:l}=s,c=1;Z(fa(i,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const f=qo(r.shape,a,i,c,o,l);let d;if(f.filterWidth===1&&f.filterHeight===1&&Nn(f.inShape,f.outShape))d=Iu({inputs:{x:r},backend:t});else{const m=t.data.get(r.dataId).values,g=Ot(r.shape),b=uC(m,r.shape,r.dtype,g,f,"avg");d=t.makeTensorInfo(f.outShape,r.dtype,b.values)}return d}const DQ={kernelName:W1,backendName:"cpu",kernelFunc:RQ};function OQ(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{filterSize:a,strides:i,pad:o,dimRoundingMode:l,dataFormat:c}=s;Ct(r,"avgPool3d");const f=Cc(r.shape,a,i,1,o,l,c),d=t.data.get(r.dataId).values,m=O6(d,r.shape,r.dtype,Ot(r.shape),f,"avg");return t.makeTensorInfo(m.shape,"float32",m.values)}const LQ={kernelName:G1,backendName:"cpu",kernelFunc:OQ};function FQ(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,input:a}=e,{filterSize:i,strides:o,pad:l,dimRoundingMode:c}=s;Ct([r,a],"avgPool3DGrad");const f=Cc(a.shape,i,o,1,l,c),d=f.strideDepth,m=f.strideHeight,g=f.strideWidth,b=f.filterDepth,x=f.filterHeight,v=f.filterWidth,w=f.dilationDepth,k=f.dilationHeight,I=f.dilationWidth,A=f.effectiveFilterDepth,R=f.effectiveFilterHeight,U=f.effectiveFilterWidth,V=A-1-f.padInfo.front,P=U-1-f.padInfo.left,D=R-1-f.padInfo.top,B=mn(a.shape,"float32"),E=1/(b*x*v),M=t.bufferSync(r);for(let K=0;K<f.batchSize;++K)for(let X=0;X<f.inChannels;++X)for(let ae=0;ae<f.inDepth;++ae)for(let W=0;W<f.inHeight;++W)for(let se=0;se<f.inWidth;++se){const ee=ae-V,ce=W-D,ye=se-P;let G=0;for(let O=0;O<A;O+=w){const j=(ee+O)/d;if(!(j<0||j>=f.outDepth||Math.floor(j)!==j))for(let Y=0;Y<R;Y+=k){const ie=(ce+Y)/m;if(!(ie<0||ie>=f.outHeight||Math.floor(ie)!==ie))for(let ue=0;ue<U;ue+=I){const pe=(ye+ue)/g;if(pe<0||pe>=f.outWidth||Math.floor(pe)!==pe)continue;const Ce=M.get(K,j,ie,pe,X);G+=Ce}}}B.set(G*E,K,ae,W,se,X)}return t.makeTensorInfo(B.shape,B.dtype,B.values)}const MQ={kernelName:Qb,backendName:"cpu",kernelFunc:FQ};function zQ(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,input:a}=e,i=a;Ct([r,a],"avgPoolGrad");const{filterSize:o,strides:l,pad:c}=s,f=qo(i.shape,o,l,1,c),d=f.strideHeight,m=f.strideWidth,g=f.filterHeight,b=f.filterWidth,x=f.dilationHeight,v=f.dilationWidth,w=f.effectiveFilterHeight,k=f.effectiveFilterWidth,I=k-1-f.padInfo.left,A=w-1-f.padInfo.top,R=mn(i.shape,"float32"),U=1/(g*b),V=t.data.get(r.dataId).values,P=mn(r.shape,"float32",V);for(let D=0;D<f.batchSize;++D)for(let B=0;B<f.inChannels;++B)for(let E=0;E<f.inHeight;++E)for(let M=0;M<f.inWidth;++M){const K=E-A,X=M-I;let ae=0;for(let W=0;W<w;W+=x){const se=(K+W)/d;if(!(se<0||se>=f.outHeight||Math.floor(se)!==se))for(let ee=0;ee<k;ee+=v){const ce=(X+ee)/m;if(ce<0||ce>=f.outWidth||Math.floor(ce)!==ce)continue;const ye=P.get(D,se,ce,B);ae+=ye}}R.set(ae*U,D,E,M,B)}return t.makeTensorInfo(R.shape,R.dtype,R.values)}const PQ={kernelName:Jb,backendName:"cpu",kernelFunc:zQ};function BQ(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,scale:a,offset:i,mean:o,variance:l}=e;Z(o.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),Z(i==null||o.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),Z(a==null||o.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),Ct([r,o,l,a,i],"batchNorm");let{varianceEpsilon:c}=s;c==null&&(c=.001);const f=t.data.get(r.dataId).values,d=t.data.get(o.dataId).values,m=t.data.get(l.dataId).values,g=a?t.data.get(a.dataId).values:new Float32Array([1]),b=i?t.data.get(i.dataId).values:new Float32Array([0]),x=new Float32Array(f.length),v=b.length,w=g.length,k=m.length,I=d.length;let A=0,R=0,U=0,V=0;for(let P=0;P<f.length;++P)x[P]=b[A++]+(f[P]-d[R++])*g[U++]/Math.sqrt(m[V++]+c),A>=v&&(A=0),R>=I&&(R=0),U>=w&&(U=0),V>=k&&(V=0);return t.makeTensorInfo(r.shape,r.dtype,x)}const UQ={kernelName:a0,backendName:"cpu",kernelFunc:BQ};function VQ(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{blockShape:a,crops:i}=s;Ct([r],"batchToSpaceND");const o=a.reduce((w,k)=>w*k),l=ly(r.shape,a,o),c=uy(l.length,a.length),f=cy(r.shape,a,o),d=b3(i,a.length),m=x3(f,i,a.length),g=Ss({inputs:{x:r},backend:t,attrs:{shape:l}}),b=ci({inputs:{x:g},backend:t,attrs:{perm:c}}),x=Ss({inputs:{x:b},backend:t,attrs:{shape:f}}),v=ld({inputs:{x},backend:t,attrs:{begin:d,size:m}});return t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(b),t.disposeIntermediateTensorInfo(x),v}const jQ={kernelName:H1,backendName:"cpu",kernelFunc:VQ};function WQ(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,weights:a}=e,{size:i}=s,o=t.data.get(r.dataId).values,l=t.data.get(a.dataId).values,c=rC(o,l,a.dtype,a.shape,i);return t.makeTensorInfo([i],a.dtype,c)}const GQ={kernelName:ex,backendName:"cpu",kernelFunc:WQ};function qQ(n){const{inputs:e,backend:t}=n,{s0:s,s1:r}=e,a=t.data.get(s.dataId).values,i=t.data.get(r.dataId).values,o=on(Array.from(a),Array.from(i));return t.makeTensorInfo([o.length],"int32",Int32Array.from(o))}const HQ={kernelName:tx,backendName:"cpu",kernelFunc:qQ};const KQ=Qn(hm,(n,e)=>{const t=e;return n>t.clipValueMax?t.clipValueMax:n<t.clipValueMin?t.clipValueMin:n}),XQ={kernelName:hm,backendName:"cpu",kernelFunc:KQ};const YQ=n=>{const{x:e}=n.inputs,t=n.backend,s=new Float32Array(Be(e.shape)),r=t.data.get(e.dataId),a=r.complexTensorInfos.real,i=r.complexTensorInfos.imag,o=t.data.get(a.dataId).values,l=t.data.get(i.dataId).values;for(let c=0;c<o.length;c++){const f=o[c],d=l[c];s[c]=Math.hypot(f,d)}return t.makeOutput(s,e.shape,"float32")},ZQ={kernelName:X1,backendName:"cpu",kernelFunc:YQ};function Yp(n){const{inputs:e,backend:t}=n,{input:s}=e,r=t.data.get(s.dataId).complexTensorInfos.imag,a=t.data.get(r.dataId).values;return t.makeTensorInfo(r.shape,r.dtype,a)}const JQ={kernelName:wx,backendName:"cpu",kernelFunc:Yp};function Zp(n){const{inputs:e,backend:t,attrs:s}=n,{axis:r}=s,a=vn(r,e[0].shape)[0],i=e.map(x=>x.shape);m3(i,a);let o=vu(e.map(x=>x.shape),a);if(Be(o)===0)return t.makeTensorInfo(o,e[0].dtype,[]);const l=e.filter(x=>Be(x.shape)>0);if(l.length===1)return Iu({inputs:{x:l[0]},backend:t});if(l[0].dtype==="complex64"){const x=l.map(A=>od({inputs:{input:A},backend:t})),v=l.map(A=>Yp({inputs:{input:A},backend:t})),w=Zp({inputs:x,backend:t,attrs:{axis:a}}),k=Zp({inputs:v,backend:t,attrs:{axis:a}}),I=Oi({inputs:{real:w,imag:k},backend:t});return x.forEach(A=>t.disposeIntermediateTensorInfo(A)),v.forEach(A=>t.disposeIntermediateTensorInfo(A)),t.disposeIntermediateTensorInfo(w),t.disposeIntermediateTensorInfo(k),I}const c=l.map(x=>{const w=[-1,Be(x.shape.slice(a))];return Ss({inputs:{x},backend:t,attrs:{shape:w}})}),f=c.map(x=>({vals:t.data.get(x.dataId).values,shape:x.shape}));o=vu(c.map(x=>x.shape),1);const d=c[0].shape[0]===1,m=PL(f,o,e[0].dtype,d),g=vu(l.map(x=>x.shape),a),b=t.makeTensorInfo(g,e[0].dtype,m);return c.forEach(x=>t.disposeIntermediateTensorInfo(x)),b}const QQ={kernelName:Y1,backendName:"cpu",kernelFunc:Zp};function L6(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:a}=e,{strides:i,pad:o,dataFormat:l,dilations:c,dimRoundingMode:f}=s;Ct([r,a],"conv2d");const d=Tc(l),m=Yr(r.shape,a.shape,i,c,o,f,!1,d),g=m.filterHeight,b=m.filterWidth,x=m.dilationHeight,v=m.dilationWidth,w=m.padInfo.left,k=m.padInfo.top,I=m.dataFormat==="channelsLast",A=new Sr(m.outShape,r.dtype),R=Ot(r.shape),U=Ot(a.shape),V=R[0],P=I?R[1]:R[2],D=I?R[2]:1,B=I?1:R[1],E=A.strides[0],M=I?A.strides[1]:A.strides[2],K=I?A.strides[2]:1,X=I?1:A.strides[1],ae=t.data.get(r.dataId).values,W=t.data.get(a.dataId).values,se=A.values;for(let ee=0;ee<m.batchSize;++ee){const ce=ee*V,ye=ee*E;for(let G=0;G<m.outHeight;++G){const O=ye+G*M,j=G*m.strideHeight-k;for(let Y=0;Y<g;++Y){const ie=j+Y*x;if(ie<0||ie>=m.inHeight)continue;const ue=Y*U[0],pe=ce+ie*P;for(let Ce=0;Ce<m.outWidth;++Ce){const Ne=O+Ce*K,Le=Ce*m.strideWidth-w;for(let Ve=0;Ve<b;++Ve){const rt=Le+Ve*v;if(rt<0||rt>=m.inWidth)continue;const at=ue+Ve*U[1],ot=pe+rt*D;let oe=at;for(let tt=0;tt<m.inChannels;++tt){const xt=ae[ot+tt*B];for(let ht=0;ht<m.outChannels;++ht)se[Ne+ht*X]+=xt*W[oe+ht];oe+=m.outChannels}}}}}}return t.makeTensorInfo(A.shape,A.dtype,se)}const eee={kernelName:Z1,backendName:"cpu",kernelFunc:L6};function tee(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,dy:a}=e,{strides:i,pad:o,dataFormat:l,dimRoundingMode:c,filterShape:f}=s;Ct([r,a],"conv2dBackpropFilter");const d=Tc(l),m=Yr(r.shape,f,i,1,o,c,!1,d),{strideHeight:g,strideWidth:b,filterHeight:x,filterWidth:v}=m,w=m.dataFormat==="channelsLast",k=new Sr(m.filterShape,"float32"),I=m.padInfo.left,A=m.padInfo.top,R=t.data.get(r.dataId).values,U=t.data.get(a.dataId).values,V=new Sr(r.shape,r.dtype,R),P=new Sr(a.shape,a.dtype,U);for(let D=0;D<x;++D){const B=Math.max(0,Math.ceil((A-D)/g)),E=Math.min(m.outHeight,(m.inHeight+A-D)/g);for(let M=0;M<v;++M){const K=Math.max(0,Math.ceil((I-M)/b)),X=Math.min(m.outWidth,(m.inWidth+I-M)/b);for(let ae=0;ae<m.inChannels;++ae)for(let W=0;W<m.outChannels;++W){let se=0;for(let ee=0;ee<m.batchSize;++ee)for(let ce=B;ce<E;++ce){const ye=D+ce*g-A;for(let G=K;G<X;++G){const O=M+G*b-I;w?se+=V.get(ee,ye,O,ae)*P.get(ee,ce,G,W):se+=V.get(ee,ae,ye,O)*P.get(ee,W,ce,G)}}k.set(se,D,M,ae,W)}}}return t.makeTensorInfo(k.shape,k.dtype,k.values)}const nee={kernelName:sx,backendName:"cpu",kernelFunc:tee};function see(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,filter:a}=e,{inputShape:i,strides:o,pad:l,dataFormat:c,dimRoundingMode:f}=s;Ct([r,a],"conv2dBackpropInput");const d=Ot(a.shape),m=Ot(r.shape);let g=Tc(c);const b=Yr(i,a.shape,o,1,l,f,!1,g),x=new Sr(b.inShape,"float32"),v=x.values,w=t.data.get(r.dataId).values,k=t.data.get(a.dataId).values,[I,A,R]=d,{batchSize:U,filterHeight:V,filterWidth:P,inChannels:D,inHeight:B,inWidth:E,outChannels:M,outHeight:K,outWidth:X,strideHeight:ae,strideWidth:W}=b;g=b.dataFormat;const se=V-1-b.padInfo.top,ee=P-1-b.padInfo.left,ce=g==="channelsLast",ye=x.strides[0],G=ce?x.strides[1]:x.strides[2],O=ce?x.strides[2]:1,j=ce?1:x.strides[1],Y=m[0],ie=ce?m[1]:m[2],ue=ce?m[2]:1,pe=ce?1:m[1];for(let Ce=0;Ce<U;++Ce)for(let Ne=0;Ne<D;++Ne)for(let Le=0;Le<B;++Le){const Ve=Le-se,rt=Math.max(0,Math.ceil(Ve/ae)),at=Math.min(K,(V+Ve)/ae);for(let ot=0;ot<E;++ot){const oe=ot-ee,tt=Math.max(0,Math.ceil(oe/W)),xt=Math.min(X,(P+oe)/W);let ht=0;for(let dt=rt;dt<at;++dt){const ft=dt*ae-Ve;for(let bt=tt;bt<xt;++bt){const Tt=bt*W-oe,zt=Y*Ce+ie*dt+ue*bt,tn=I*(V-1-ft)+A*(P-1-Tt)+R*Ne;for(let Ut=0;Ut<M;++Ut){const sn=w[zt+pe*Ut],Yt=k[tn+Ut];ht+=sn*Yt}}}const Je=ye*Ce+G*Le+O*ot+j*Ne;v[Je]=ht}}return t.makeTensorInfo(x.shape,x.dtype,x.values)}const ree={kernelName:J1,backendName:"cpu",kernelFunc:see};function aee(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:a}=e,{strides:i,pad:o,dilations:l}=s;Ct([r,a],"conv3d");const c=Uh(r.shape,a.shape,i,l,o),{filterDepth:f,filterHeight:d,filterWidth:m,dilationDepth:g,dilationHeight:b,dilationWidth:x,padInfo:v}=c,w=v.front,k=v.left,I=v.top,A=new Sr(c.outShape,r.dtype),R=t.data.get(r.dataId).values,U=t.data.get(a.dataId).values,V=A.values,P=Ot(r.shape),D=Ot(a.shape);for(let B=0;B<c.batchSize;++B){const E=B*P[0],M=B*A.strides[0];for(let K=0;K<c.outDepth;++K){const X=M+K*A.strides[1],ae=K*c.strideDepth-w;for(let W=0;W<f;++W){const se=ae+W*g;if(se<0||se>=c.inDepth)continue;const ee=W*D[0],ce=E+se*P[1];for(let ye=0;ye<c.outHeight;++ye){const G=X+ye*A.strides[2],O=ye*c.strideHeight-I;for(let j=0;j<d;++j){const Y=O+j*b;if(Y<0||Y>=c.inHeight)continue;const ie=ee+j*D[1],ue=ce+Y*P[2];for(let pe=0;pe<c.outWidth;++pe){const Ce=G+pe*c.outChannels,Ne=pe*c.strideWidth-k;for(let Le=0;Le<m;++Le){const Ve=Ne+Le*x;if(Ve<0||Ve>=c.inWidth)continue;const rt=ie+Le*D[2],at=ue+Ve*c.inChannels;let ot=rt;for(let oe=0;oe<c.inChannels;++oe){const tt=R[at+oe];for(let xt=0;xt<c.outChannels;++xt)V[Ce+xt]+=tt*U[ot+xt];ot+=c.outChannels}}}}}}}}return t.makeTensorInfo(A.shape,A.dtype,A.values)}const iee={kernelName:Q1,backendName:"cpu",kernelFunc:aee};function oee(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,dy:a}=e,{strides:i,pad:o,filterShape:l}=s;Ct([r,a],"conv3dBackpropFilterV2");const c=Ot(r.shape),f=Ot(a.shape),d=Uh(r.shape,l,i,1,o),m=d.strideDepth,g=d.strideHeight,b=d.strideWidth,x=d.filterDepth,v=d.filterHeight,w=d.filterWidth,k=new Sr(d.filterShape,"float32"),I=k.values,[A,R,U,V]=k.strides,P=t.data.get(a.dataId).values,[D,B,E,M]=f,K=t.data.get(r.dataId).values,[X,ae,W,se]=c,ee=d.padInfo.front,ce=d.padInfo.left,ye=d.padInfo.top;for(let G=0;G<x;++G){const O=Math.max(0,Math.ceil((ee-G)/m)),j=Math.min(d.outDepth,(d.inDepth+ee-G)/m),Y=G*A;for(let ie=0;ie<v;++ie){const ue=Math.max(0,Math.ceil((ye-ie)/g)),pe=Math.min(d.outHeight,(d.inHeight+ye-ie)/g),Ce=ie*R+Y;for(let Ne=0;Ne<w;++Ne){const Le=Math.max(0,Math.ceil((ce-Ne)/b)),Ve=Math.min(d.outWidth,(d.inWidth+ce-Ne)/b),rt=Ne*U+Ce;for(let at=0;at<d.inChannels;++at){const ot=at*V+rt;for(let oe=0;oe<d.outChannels;++oe){let tt=0;for(let xt=0;xt<d.batchSize;++xt){const ht=xt*X,Je=xt*D;for(let dt=O;dt<j;++dt){const bt=(G+dt*m-ee)*ae+ht,Tt=dt*B+Je;for(let zt=ue;zt<pe;++zt){const Ut=(ie+zt*g-ye)*W+bt,sn=zt*E+Tt;for(let Yt=Le;Yt<Ve;++Yt){const en=(Ne+Yt*b-ce)*se+Ut,_t=Yt*M+sn;tt+=K[en+at]*P[_t+oe]}}}}I[ot+oe]=tt}}}}}return t.makeTensorInfo(k.shape,k.dtype,k.values)}const lee={kernelName:rx,backendName:"cpu",kernelFunc:oee};function uee(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,filter:a}=e,{pad:i,strides:o,inputShape:l}=s;Ct([r],"conv3dBackpropInputV2");const c=Ot(r.shape),f=Ot(a.shape),d=Uh(l,a.shape,o,1,i),m=new Sr(d.inShape,"float32"),g=m.values,[b,x,v,w]=m.strides,k=t.data.get(r.dataId).values,[I,A,R,U]=c,V=t.data.get(a.dataId).values,[P,D,B,E]=f,{batchSize:M,filterDepth:K,filterHeight:X,filterWidth:ae,inChannels:W,inDepth:se,inHeight:ee,inWidth:ce,outChannels:ye,outDepth:G,outHeight:O,outWidth:j,strideDepth:Y,strideHeight:ie,strideWidth:ue}=d,pe=K-1-d.padInfo.front,Ce=X-1-d.padInfo.top,Ne=ae-1-d.padInfo.left;for(let Le=0;Le<M;++Le)for(let Ve=0;Ve<W;++Ve)for(let rt=0;rt<se;++rt){const at=rt-pe,ot=Math.max(0,Math.ceil(at/Y)),oe=Math.min(G,(K+at)/Y);for(let tt=0;tt<ee;++tt){const xt=tt-Ce,ht=Math.max(0,Math.ceil(xt/ie)),Je=Math.min(O,(X+xt)/ie);for(let dt=0;dt<ce;++dt){const ft=dt-Ne,bt=Math.max(0,Math.ceil(ft/ue)),Tt=Math.min(j,(ae+ft)/ue);let zt=0;for(let tn=ot;tn<oe;++tn){const Ut=tn*Y-at;for(let sn=ht;sn<Je;++sn){const Yt=sn*ie-xt;for(let vt=bt;vt<Tt;++vt){const en=vt*ue-ft,_t=I*Le+A*tn+R*sn+U*vt,ks=P*(K-1-Ut)+D*(X-1-Yt)+B*(ae-1-en)+E*Ve;for(let ln=0;ln<ye;++ln){const Vt=k[_t+ln],Zt=V[ks+ln];zt+=Vt*Zt}}}}g[b*Le+x*rt+v*tt+w*dt+Ve]=zt}}}return t.makeTensorInfo(m.shape,m.dtype,m.values)}const cee={kernelName:ax,backendName:"cpu",kernelFunc:uee};const hee=Qn(fm,n=>Math.cos(n)),fee={kernelName:fm,backendName:"cpu",kernelFunc:hee};const dee=Qn(dm,n=>Math.cosh(n)),pee={kernelName:dm,backendName:"cpu",kernelFunc:dee};function mee(n){const{inputs:e,backend:t,attrs:s}=n,{image:r,boxes:a,boxInd:i}=e,{cropSize:o,method:l,extrapolationValue:c}=s,[f,d,m,g]=r.shape,b=a.shape[0],[x,v]=o,w=mn([b,x,v,g],"float32"),k=t.data.get(a.dataId).values,I=t.data.get(i.dataId).values,A=t.data.get(r.dataId).values,R=Ot(r.shape),U=Ot(w.shape);for(let V=0;V<b;V++){const P=V*4,D=k[P],B=k[P+1],E=k[P+2],M=k[P+3],K=I[V];if(K>=f)continue;const X=x>1?(E-D)*(d-1)/(x-1):0,ae=v>1?(M-B)*(m-1)/(v-1):0;for(let W=0;W<x;W++){const se=x>1?D*(d-1)+W*X:.5*(D+E)*(d-1);if(se<0||se>d-1){for(let ee=0;ee<v;ee++)for(let ce=0;ce<g;ce++){const ye=ce+ee*U[2]+W*U[1]+V*U[0];w.values[ye]=c}continue}if(l==="bilinear"){const ee=Math.floor(se),ce=Math.ceil(se),ye=se-ee;for(let G=0;G<v;G++){const O=v>1?B*(m-1)+G*ae:.5*(B+M)*(m-1);if(O<0||O>m-1){for(let ue=0;ue<g;ue++){const pe=ue+G*U[2]+W*U[1]+V*U[0];w.values[pe]=c}continue}const j=Math.floor(O),Y=Math.ceil(O),ie=O-j;for(let ue=0;ue<g;ue++){let pe=ue+j*R[2]+ee*R[1]+K*R[0];const Ce=A[pe];pe=ue+Y*R[2]+ee*R[1]+K*R[0];const Ne=A[pe];pe=ue+j*R[2]+ce*R[1]+K*R[0];const Le=A[pe];pe=ue+Y*R[2]+ce*R[1]+K*R[0];const Ve=A[pe],rt=Ce+(Ne-Ce)*ie,at=Le+(Ve-Le)*ie;pe=ue+G*U[2]+W*U[1]+V*U[0],w.values[pe]=rt+(at-rt)*ye}}}else for(let ee=0;ee<v;++ee){const ce=v>1?B*(m-1)+ee*ae:.5*(B+M)*(m-1);if(ce<0||ce>m-1){for(let O=0;O<g;O++){const j=O+ee*U[2]+W*U[1]+V*U[0];w.values[j]=c}continue}const ye=Math.round(ce),G=Math.round(se);for(let O=0;O<g;O++){const j=O+ye*R[2]+G*R[1]+K*R[0],Y=O+ee*U[2]+W*U[1]+V*U[0];w.values[Y]=A[j]}}}}return t.makeTensorInfo(w.shape,w.dtype,w.values)}const gee={kernelName:ox,backendName:"cpu",kernelFunc:mee};function yee(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:a,exclusive:i,reverse:o}=s;Ct(r,"cumprod");const l=js([a],r.shape.length);let c=r;l!=null&&(c=ci({inputs:{x:r},backend:t,attrs:{perm:l}}));const f=hr(1,r.shape.length)[0];if(f!==c.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${f}`);const d=ai(c.dtype,"int32"),m=Xb(Be(c.shape),d),g=t.data.get(c.dataId).values,b=c.shape[c.shape.length-1],x=o?(w,k)=>w+b-k-1:(w,k)=>w+k;for(let w=0;w<g.length;w+=b)for(let k=0;k<b;k++){const I=x(w,k);if(k===0)m[I]=i?1:g[I];else{const A=x(w,k-1);m[I]=i?g[A]*m[A]:g[I]*m[A]}}const v=t.makeTensorInfo(c.shape,d,m);if(l!=null){const w=Vh(l),k=ci({inputs:{x:v},backend:t,attrs:{perm:w}});return t.disposeIntermediateTensorInfo(v),t.disposeIntermediateTensorInfo(c),k}return v}const bee={kernelName:ix,backendName:"cpu",kernelFunc:yee};function xee(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:a,exclusive:i,reverse:o}=s;Ct(r,"cumsum");const l=js([a],r.shape.length);let c=r;l!=null&&(c=ci({inputs:{x:r},backend:t,attrs:{perm:l}}));const f=hr(1,r.shape.length)[0];if(f!==c.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${f}`);const d=ai(c.dtype,"int32"),m=ca(Be(c.shape),d),g=t.data.get(c.dataId).values,b=c.shape[c.shape.length-1],x=o?(w,k)=>w+b-k-1:(w,k)=>w+k;for(let w=0;w<g.length;w+=b)for(let k=0;k<b;k++){const I=x(w,k);if(k===0)m[I]=i?0:g[I];else{const A=x(w,k-1);m[I]=i?g[A]+m[A]:g[I]+m[A]}}const v=t.makeTensorInfo(c.shape,d,m);if(l!=null){const w=Vh(l),k=ci({inputs:{x:v},backend:t,attrs:{perm:w}});return t.disposeIntermediateTensorInfo(v),t.disposeIntermediateTensorInfo(c),k}return v}const vee={kernelName:e0,backendName:"cpu",kernelFunc:xee};function wee(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,weights:a}=e,{size:i,binaryOutput:o}=s;if(r.shape.length===1){const l=t.data.get(r.dataId).values,c=t.data.get(a.dataId).values,f=rC(l,c,a.dtype,a.shape,i);return t.makeTensorInfo([i],a.dtype,f)}else if(r.shape.length===2){const l=t.bufferSync(r),c=t.bufferSync(a),f=FL(l,c,i,o);return t.makeTensorInfo(f.shape,a.dtype,f.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const See={kernelName:lx,backendName:"cpu",kernelFunc:wee};function Nee(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{blockSize:a,dataFormat:i}=s;Z(i==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${i}`);const o=r.shape[0],l=r.shape[1],c=r.shape[2],f=r.shape[3],d=l*a,m=c*a,g=f/(a*a),b=t.data.get(r.dataId).values,x=new Float32Array(o*d*m*g);let v=0;for(let w=0;w<o;++w)for(let k=0;k<d;++k){const I=Math.floor(k/a),A=k%a;for(let R=0;R<m;++R){const U=Math.floor(R/a),V=R%a,P=(A*a+V)*g;for(let D=0;D<g;++D){const E=D+P+f*(U+c*(I+l*w));x[v++]=b[E]}}}return t.makeTensorInfo([o,d,m,g],r.dtype,x)}const kee={kernelName:ux,backendName:"cpu",kernelFunc:Nee};function F6(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:a}=e,{strides:i,pad:o,dilations:l,dimRoundingMode:c}=s;Ct([r,a],"depthwiseConv2DNative");const f=Ot(r.shape),d=Ot(a.shape);let m=l;m==null&&(m=[1,1]),Z(fa(i,m),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${m}'`);const g=Yr(r.shape,a.shape,i,m,o,c,!0),{filterHeight:b,filterWidth:x,dilationHeight:v,dilationWidth:w,padInfo:k}=g,I=k.left,A=k.top,R=g.outChannels/g.inChannels,U=new Sr(g.outShape,r.dtype),V=t.data.get(r.dataId).values,P=t.data.get(a.dataId).values,D=U.values;for(let B=0;B<g.batchSize;++B){const E=B*f[0],M=B*U.strides[0];for(let K=0;K<g.outHeight;++K){const X=M+K*U.strides[1],ae=K*g.strideHeight-A;for(let W=0;W<b;++W){const se=ae+W*v;if(se<0||se>=g.inHeight)continue;const ee=W*d[0],ce=E+se*f[1];for(let ye=0;ye<g.outWidth;++ye){const G=X+ye*U.strides[2],O=ye*g.strideWidth-I;for(let j=0;j<x;++j){const Y=O+j*w;if(Y<0||Y>=g.inWidth)continue;const ie=ee+j*d[1],ue=ce+Y*g.inChannels;let pe=G,Ce=ie;for(let Ne=0;Ne<g.inChannels;++Ne){const Le=V[ue+Ne];for(let Ve=0;Ve<R;++Ve)D[pe+Ve]+=Le*P[Ce+Ve];pe+=R,Ce+=R}}}}}}return t.makeTensorInfo(U.shape,U.dtype,U.values)}const Cee={kernelName:t0,backendName:"cpu",kernelFunc:F6};function Tee(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,dy:a}=e,{strides:i,dilations:o,pad:l,dimRoundingMode:c,filterShape:f}=s;Ct([r,a],"depthwiseConv2dNativeBackpropFilter");const d=Yr(r.shape,f,i,o,l,c,!0),{strideHeight:m,strideWidth:g,filterHeight:b,filterWidth:x}=d,v=new Sr(d.filterShape,"float32"),w=d.padInfo.left,k=d.padInfo.top,I=d.outChannels/d.inChannels,A=t.data.get(r.dataId).values,R=new Sr(r.shape,r.dtype,A),U=t.data.get(a.dataId).values,V=new Sr(a.shape,a.dtype,U);for(let P=0;P<b;++P){const D=Math.max(0,Math.ceil((k-P)/m)),B=Math.min(d.outHeight,(d.inHeight+k-P)/m);for(let E=0;E<x;++E){const M=Math.max(0,Math.ceil((w-E)/g)),K=Math.min(d.outWidth,(d.inWidth+w-E)/g);for(let X=0;X<d.outChannels;++X){const ae=Math.trunc(X/I),W=X%I;let se=0;for(let ee=0;ee<d.batchSize;++ee)for(let ce=D;ce<B;++ce){const ye=P+ce*m-k;for(let G=M;G<K;++G){const O=E+G*g-w;se+=R.get(ee,ye,O,ae)*V.get(ee,ce,G,X)}}v.set(se,P,E,ae,W)}}}return t.makeTensorInfo(v.shape,v.dtype,v.values)}const Aee={kernelName:cx,backendName:"cpu",kernelFunc:Tee};function Iee(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,filter:a}=e,{strides:i,dilations:o,pad:l,dimRoundingMode:c,inputShape:f}=s;Ct([r,a],"depthwiseConv2DNativeBackpropInput");const d=Ot(r.shape),m=Ot(a.shape),g=Yr(f,a.shape,i,o,l,c,!0),b=new Sr(g.inShape,"float32"),x=b.values,[v,w,k]=b.strides,I=t.data.get(r.dataId).values,[A,R,U]=d,V=t.data.get(a.dataId).values,[P,D,B]=m,{batchSize:E,filterHeight:M,filterWidth:K,inChannels:X,inHeight:ae,inWidth:W,outChannels:se,outHeight:ee,outWidth:ce,strideHeight:ye,strideWidth:G}=g,O=M-1-g.padInfo.top,j=K-1-g.padInfo.left,Y=se/X;for(let ie=0;ie<E;++ie)for(let ue=0;ue<X;++ue)for(let pe=0;pe<ae;++pe){const Ce=pe-O,Ne=Math.max(0,Math.ceil(Ce/ye)),Le=Math.min(ee,(M+Ce)/ye);for(let Ve=0;Ve<W;++Ve){const rt=Ve-j,at=Math.max(0,Math.ceil(rt/G)),ot=Math.min(ce,(K+rt)/G);let oe=0;for(let tt=Ne;tt<Le;++tt){const xt=tt*ye-Ce;for(let ht=at;ht<ot;++ht){const Je=ht*G-rt,dt=A*ie+R*tt+U*ht,ft=P*(M-1-xt)+D*(K-1-Je)+B*ue;for(let bt=0;bt<Y;++bt){const Tt=ue*Y+bt,zt=I[dt+Tt],tn=V[ft+bt];oe+=zt*tn}}}x[v*ie+w*pe+k*Ve+ue]=oe}}return t.makeTensorInfo(b.shape,b.dtype,b.values)}const Eee={kernelName:hx,backendName:"cpu",kernelFunc:Iee};function _ee(n){const{inputs:e,backend:t}=n,{x:s}=e,r=Be(s.shape),a=t.data.get(s.dataId).values,i=mn([r,r],s.dtype),o=i.values;for(let c=0;c<a.length;c++)o[c*r+c]=a[c];const l=[...s.shape,...s.shape];return t.makeTensorInfo(l,i.dtype,i.values)}const $ee={kernelName:fx,backendName:"cpu",kernelFunc:_ee};const Ree={kernelName:n0,backendName:"cpu",kernelFunc:({inputs:n,backend:e,attrs:t})=>{const{x:s,filter:r}=n,{strides:a,pad:i,dilations:o}=t,l=e,c=l.data.get(s.dataId).values,f=s.shape.length,d=l.data.get(r.dataId).values,m=r.shape.length,{batchSize:g,inHeight:b,inWidth:x,inChannels:v,outHeight:w,outWidth:k,padInfo:I,strideHeight:A,strideWidth:R,filterHeight:U,filterWidth:V,dilationHeight:P,dilationWidth:D,outShape:B}=G0(s.shape,r.shape,a,i,"NHWC",o),E=Be(B),M=B.length,K=Ys(s.dtype,E);for(let ae=0;ae<g;++ae)for(let W=0;W<w;++W){const se=W*A-I.top;for(let ee=0;ee<k;++ee){const ce=ee*R-I.left;for(let ye=0;ye<v;++ye){let G=Number.MIN_SAFE_INTEGER;for(let j=0;j<U;++j){const Y=se+j*P;if(Y>=0&&Y<b)for(let ie=0;ie<V;++ie){const ue=ce+ie*D;if(ue>=0&&ue<x){const pe=El([ae,Y,ue,ye],f,Ot(s.shape)),Ce=El([j,ie,ye],m,Ot(r.shape)),Ne=c[pe]+d[Ce];Ne>G&&(G=Ne)}}}const O=El([ae,W,ee,ye],M,Ot(B));K[O]=G}}}return{dataId:l.write(Ph(K,s.dtype),B,s.dtype),shape:B,dtype:s.dtype}}};const Dee={kernelName:mb,backendName:"cpu",kernelFunc:({inputs:n,backend:e,attrs:t})=>{const{x:s,filter:r,dy:a}=n,{strides:i,pad:o,dilations:l}=t,c=e,f=ho(s.shape,c.data.get(s.dataId).values),d=ho(r.shape,c.data.get(r.dataId).values),{batchSize:m,inHeight:g,inWidth:b,inChannels:x,outHeight:v,outWidth:w,padInfo:k,strideHeight:I,strideWidth:A,filterHeight:R,filterWidth:U,dilationHeight:V,dilationWidth:P,outShape:D}=G0(s.shape,r.shape,i,o,"NHWC",l);Z(a.rank===D.length,()=>`Error in ${mb}, dy must have the same rank as output ${D.length}, but got ${a.rank}`);const B=ho(D,c.data.get(a.dataId).values),E=MN(r.shape,r.dtype);for(let K=0;K<m;++K)for(let X=0;X<v;++X){const ae=X*I-k.top;for(let W=0;W<w;++W){const se=W*A-k.left;for(let ee=0;ee<x;++ee){let ce=Number.MIN_SAFE_INTEGER,ye=0,G=0;for(let O=0;O<R;++O){const j=ae+O*V;if(j>=0&&j<g)for(let Y=0;Y<U;++Y){const ie=se+Y*P;if(ie>=0&&ie<b){const ue=f[K][j][ie][ee]+d[O][Y][ee];ue>ce&&(ce=ue,ye=O,G=Y)}}}E[ye][G][ee]+=B[K][X][W][ee]}}}return{dataId:c.write(Ph(E,s.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};const Oee={kernelName:pb,backendName:"cpu",kernelFunc:({inputs:n,backend:e,attrs:t})=>{const{x:s,filter:r,dy:a}=n,{strides:i,pad:o,dilations:l}=t,c=e,f=ho(s.shape,c.data.get(s.dataId).values),d=ho(r.shape,c.data.get(r.dataId).values),{batchSize:m,inHeight:g,inWidth:b,inChannels:x,outHeight:v,outWidth:w,padInfo:k,strideHeight:I,strideWidth:A,filterHeight:R,filterWidth:U,dilationHeight:V,dilationWidth:P,outShape:D}=G0(s.shape,r.shape,i,o,"NHWC",l);Z(a.rank===D.length,()=>`Error in ${pb}, dy must have the same rank as output ${D.length}, but got ${a.rank}`);const B=ho(D,c.data.get(a.dataId).values),E=MN(s.shape,s.dtype);for(let K=0;K<m;++K)for(let X=0;X<v;++X){const ae=X*I-k.top;for(let W=0;W<w;++W){const se=W*A-k.left;for(let ee=0;ee<x;++ee){let ce=Number.MIN_SAFE_INTEGER,ye=ae<0?0:ae,G=se<0?0:se;for(let O=0;O<R;++O){const j=ae+O*V;if(j>=0&&j<g)for(let Y=0;Y<U;++Y){const ie=se+Y*P;if(ie>=0&&ie<b){const ue=f[K][j][ie][ee]+d[O][Y][ee];ue>ce&&(ce=ue,ye=j,G=ie)}}}E[K][ye][G][ee]+=B[K][X][W][ee]}}}return{dataId:c.write(Ph(E,s.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};function Lee(n){const{inputs:e,backend:t,attrs:s}=n,{image:r}=e,{canvas:a,options:i}=s,{contextOptions:o,imageOptions:l}=i||{},c=l?.alpha||1,f=o?.contextType||"2d";if(f!=="2d")throw new Error(`Context type ${o.contextType} is not supported by the CPU backend.`);const d=a.getContext(f,o?.contextAttributes||{});if(d==null)throw new Error(`Could not get the context with ${f} type.`);const[m,g]=r.shape.slice(0,2),b=r.shape.length===2?1:r.shape[2],x=t.data.get(r.dataId).values,v=r.dtype==="float32"?255:1,w=new Uint8ClampedArray(g*m*4);for(let I=0;I<m*g;++I){const A=[0,0,0,255*c];for(let U=0;U<b;U++){const V=x[I*b+U];if(r.dtype==="float32"){if(V<0||V>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${V}.`)}else if(r.dtype==="int32"&&(V<0||V>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${V}.`);b===1?(A[0]=V*v,A[1]=V*v,A[2]=V*v):A[U]=V*v}const R=I*4;w[R+0]=Math.round(A[0]),w[R+1]=Math.round(A[1]),w[R+2]=Math.round(A[2]),w[R+3]=Math.round(A[3])}a.width=g,a.height=m;const k=new ImageData(w,g,m);return d.putImageData(k,0,0),r}const Fee={kernelName:dx,backendName:"cpu",kernelFunc:Lee};function xy(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:a,keepDims:i}=s;Ct(r,"sum");let o;r.dtype==="bool"?o=Fh({inputs:{x:r},backend:t,attrs:{dtype:"int32"}}):o=Iu({inputs:{x:r},backend:t});const l=o.shape.length,c=vn(a,o.shape),f=js(c,l);let d=c,m=o;f!=null&&(m=ci({inputs:{x:o},backend:t,attrs:{perm:f}}),d=hr(d.length,l)),da("sum",d,m.shape.length);const[g,b]=Zr(m.shape,d),x=ai(m.dtype,"int32");let v=Rb(t,g,x);const w=Be(b),k=t.data.get(v.dataId).values,I=t.data.get(m.dataId).values;for(let A=0;A<k.length;++A){const R=A*w;let U=0;for(let V=0;V<w;++V)U+=I[R+V];k[A]=U}if(i){const A=cr(v.shape,c),R=v;v=Ss({inputs:{x:v},backend:t,attrs:{shape:A}}),t.disposeIntermediateTensorInfo(R)}return t.disposeIntermediateTensorInfo(o),f!=null&&t.disposeIntermediateTensorInfo(m),v}const Mee={kernelName:L0,backendName:"cpu",kernelFunc:xy};function zee(n){const{inputs:e,backend:t,attrs:s}=n,{equation:r}=s,a=e,{allDims:i,summedDims:o,idDims:l}=A3(r,a.length);E3(i.length,l,a);const{path:c,steps:f}=_3(o,l),d=f.length;let m=null,g=i.length;const b=[];for(let x=0;x<d;++x){for(const v of f[x]){const{permutationIndices:w,expandDims:k}=I3(g,l[v]);let I;$3(w)?I=a[v]:(I=ci({inputs:{x:a[v]},backend:t,attrs:{perm:w}}),b.push(I));const A=I.shape.slice();for(let R=0;R<k.length;++R)A.splice(k[R],0,1);Nn(I.shape,A)||(I=Ss({inputs:{x:I},backend:t,attrs:{shape:A}}),b.push(I)),m===null?m=I:(m=nw({inputs:{a:I,b:m},backend:t}),b.push(m))}x<d-1&&(c[x]>=0&&(m=xy({inputs:{x:m},backend:t,attrs:{axis:c[x]-(i.length-g),keepDims:!1}}),b.push(m)),g--)}for(const x of b)x!==m&&t.disposeIntermediateTensorInfo(x);return m}const Pee={kernelName:px,backendName:"cpu",kernelFunc:zee};function Bee(n){const{inputs:e,backend:t}=n,{dy:s,y:r}=e;Ct([s,r],"eluGrad");const a=new Float32Array(Be(r.shape)),i=t.data.get(r.dataId).values,o=t.data.get(s.dataId).values;for(let l=0;l<i.length;++l){const c=i[l];c>=0?a[l]=o[l]:a[l]=o[l]*(c+1)}return t.makeTensorInfo(r.shape,"float32",a)}const Uee={kernelName:mx,backendName:"cpu",kernelFunc:Bee};const Vee=v3,jee=w3,Wee=S3,Gee=N3,qee=k3,Hee=C3,Kee=Qn(gm,n=>{const e=Math.sign(n),t=Math.abs(n),s=1/(1+Vee*t);return e*(1-((((Hee*s+qee)*s+Gee)*s+Wee)*s+jee)*s*Math.exp(-t*t))}),Xee={kernelName:gm,backendName:"cpu",kernelFunc:Kee};function Lb(n){const{inputs:e,backend:t,attrs:s}=n,{input:r}=e,{dim:a}=s,i=r.shape.length,o=r.shape.slice();let l=a;return a<0&&(Z(-(i+1)<=a,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),l=i+a+1),o.splice(l,0,1),Ss({inputs:{x:r},backend:t,attrs:{shape:o}})}const Yee={kernelName:r0,backendName:"cpu",kernelFunc:Lb};const Zee=dr((n,e)=>n/e),cC=Lr(pm,Zee),cN={kernelName:pm,backendName:"cpu",kernelFunc:cC};function M6(n,e,t){const s=n.shape,r=s[0],a=s[1],i=t.data.get(n.dataId),o=i.complexTensorInfos.real,l=i.complexTensorInfos.imag,c=[r,a],f=Be(c),d=Kr("float32",f),m=Kr("float32",f);for(let v=0;v<r;v++){const w=ld({inputs:{x:o},backend:t,attrs:{begin:[v,0],size:[1,a]}}),k=ld({inputs:{x:l},backend:t,attrs:{begin:[v,0],size:[1,a]}}),I=Oi({inputs:{real:w,imag:k},backend:t}),{real:A,imag:R}=Jee(I,e,t),U=wc(A,R);for(let V=0;V<a;V++){const P=T3(U,V);d[v*a+V]=P.real,m[v*a+V]=P.imag}t.disposeIntermediateTensorInfo(w),t.disposeIntermediateTensorInfo(k),t.disposeIntermediateTensorInfo(I)}const g=t.makeTensorInfo(c,"float32",d),b=t.makeTensorInfo(c,"float32",m),x=Oi({inputs:{real:g,imag:b},backend:t});return t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(b),x}function Jee(n,e,t){const s=Be(n.shape),r=t.data.get(n.dataId),a=t.data.get(r.complexTensorInfos.real.dataId).values,i=t.data.get(r.complexTensorInfos.imag.dataId).values;if(Qee(s)){const o=hN(a,i,s,e,t),l=[n.shape[0],n.shape[1]];if(e){const c=t.makeTensorInfo(l,"float32",o.real),f=t.makeTensorInfo(l,"float32",o.imag),d=t.makeTensorInfo([],"float32",kc(s,"float32")),m=Iu({inputs:{x:d},backend:t}),g=cN.kernelFunc({inputs:{a:c,b:d},backend:t}),b=cN.kernelFunc({inputs:{a:f,b:m},backend:t}),x=t.data.get(g.dataId).values,v=t.data.get(b.dataId).values;return t.disposeIntermediateTensorInfo(c),t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(b),{real:x,imag:v}}return o}else{const o=wc(a,i),l=ete(o,s,e);return qR(l)}}function Qee(n){return(n&n-1)===0}function hN(n,e,t,s,r){if(t===1)return{real:n,imag:e};const a=wc(n,e),i=t/2,o=HR(a),l=o.real,c=o.imag,f=[l.length],d=r.makeTensorInfo(f,"float32",l),m=r.makeTensorInfo(f,"float32",c),g=Oi({inputs:{real:d,imag:m},backend:r}),b=KR(a),x=b.real,v=b.imag,w=[x.length],k=r.makeTensorInfo(w,"float32",x),I=r.makeTensorInfo(w,"float32",v),A=Oi({inputs:{real:k,imag:I},backend:r}),R=hN(l,c,i,s,r),U=R.real,V=R.imag,P=[U.length],D=r.makeTensorInfo(P,"float32",U),B=r.makeTensorInfo(P,"float32",V),E=Oi({inputs:{real:D,imag:B},backend:r}),M=hN(x,v,i,s,r),K=M.real,X=M.imag,ae=[K.length],W=r.makeTensorInfo(ae,"float32",K),se=r.makeTensorInfo(ae,"float32",X),ee=Oi({inputs:{real:W,imag:se},backend:r}),ce=YR(t,s),ye=[ce.real.length],G=r.makeTensorInfo(ye,"float32",ce.real),O=r.makeTensorInfo(ye,"float32",ce.imag),j=Oi({inputs:{real:G,imag:O},backend:r}),Y=nw({inputs:{a:j,b:ee},backend:r}),ie=Xp({inputs:{a:E,b:Y},backend:r}),ue=lC({inputs:{a:E,b:Y},backend:r}),pe=od({inputs:{input:ie},backend:r}),Ce=od({inputs:{input:ue},backend:r}),Ne=Yp({inputs:{input:ie},backend:r}),Le=Yp({inputs:{input:ue},backend:r}),Ve=Zp({inputs:[pe,Ce],backend:r,attrs:{axis:0}}),rt=Zp({inputs:[Ne,Le],backend:r,attrs:{axis:0}}),at=r.data.get(Ve.dataId).values,ot=r.data.get(rt.dataId).values;return r.disposeIntermediateTensorInfo(d),r.disposeIntermediateTensorInfo(m),r.disposeIntermediateTensorInfo(g),r.disposeIntermediateTensorInfo(k),r.disposeIntermediateTensorInfo(I),r.disposeIntermediateTensorInfo(A),r.disposeIntermediateTensorInfo(D),r.disposeIntermediateTensorInfo(B),r.disposeIntermediateTensorInfo(E),r.disposeIntermediateTensorInfo(W),r.disposeIntermediateTensorInfo(se),r.disposeIntermediateTensorInfo(ee),r.disposeIntermediateTensorInfo(G),r.disposeIntermediateTensorInfo(O),r.disposeIntermediateTensorInfo(j),r.disposeIntermediateTensorInfo(Y),r.disposeIntermediateTensorInfo(ie),r.disposeIntermediateTensorInfo(ue),r.disposeIntermediateTensorInfo(pe),r.disposeIntermediateTensorInfo(Ne),r.disposeIntermediateTensorInfo(Ce),r.disposeIntermediateTensorInfo(Le),r.disposeIntermediateTensorInfo(Ve),r.disposeIntermediateTensorInfo(rt),{real:at,imag:ot}}function ete(n,e,t){const s=new Float32Array(e*2);for(let r=0;r<e;r++){let a=0,i=0;for(let o=0;o<e;o++){const l=ZR(r*o,e,t),c=T3(n,o);a+=c.real*l.real-c.imag*l.imag,i+=c.real*l.imag+c.imag*l.real}t&&(a/=e,i/=e),XR(s,a,i,r)}return s}function tte(n){const{inputs:e,backend:t}=n,{input:s}=e,r=Be(s.shape),a=s.shape[s.shape.length-1],i=r/a,o=Ss({inputs:{x:s},backend:t,attrs:{shape:[i,a]}}),l=M6(o,!1,t),c=Ss({inputs:{x:l},backend:t,attrs:{shape:s.shape}});return t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(l),c}const nte={kernelName:gx,backendName:"cpu",kernelFunc:tte};function hC(n){const{backend:e,attrs:t}=n,{shape:s,value:r,dtype:a}=t,i=a||pd(r),o=Ys(i,Be(s));return rte(o,r,i),e.makeTensorInfo(s,i,o)}const ste={kernelName:yx,backendName:"cpu",kernelFunc:hC};function rte(n,e,t){n.fill(e)}const ate={kernelName:bx,backendName:"cpu",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{image:s}=n,r=t,a=Kr(s.dtype,Be(s.shape)),[i,o,l,c]=s.shape,f=r.data.get(s.dataId).values;for(let m=0;m<i;m++){const g=m*l*o*c;for(let b=0;b<o;b++){const x=b*(l*c);for(let v=0;v<l;v++){const w=v*c;for(let k=0;k<c;k++){const I=Math.round(l-v-1),A=g+x+w+k;let R=f[A];if(I>=0&&I<l){const U=I*c,V=g+x+U+k;R=f[V]}a[A]=R}}}}return{dataId:r.write(a,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};function ite(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:a,bias:i,preluActivationWeights:o}=e,{strides:l,pad:c,dataFormat:f,dilations:d,dimRoundingMode:m,activation:g,leakyreluAlpha:b}=s;let x=L6({inputs:{x:r,filter:a},backend:t,attrs:{strides:l,pad:c,dataFormat:f,dilations:d,dimRoundingMode:m}});if(i){const v=x;if(f==="NCHW"&&i.shape.length===1&&i.shape[0]!==1){const w=Ss({inputs:{x:i},backend:t,attrs:{shape:[i.shape[0],1,1]}});x=Xp({inputs:{a:x,b:w},backend:t}),t.disposeIntermediateTensorInfo(w)}else x=Xp({inputs:{a:x,b:i},backend:t});t.disposeIntermediateTensorInfo(v)}if(g){const v=x;if(f==="NCHW"&&g==="prelu"&&o.shape.length===1&&o.shape[0]!==1){const w=Ss({inputs:{x:o},backend:t,attrs:{shape:[o.shape[0],1,1]}});x=Ob(t,x,g,w,b),t.disposeIntermediateTensorInfo(w)}else x=Ob(t,x,g,o,b);t.disposeIntermediateTensorInfo(v)}return x}const ote={kernelName:y1,backendName:"cpu",kernelFunc:ite};function lte(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:a,bias:i,preluActivationWeights:o}=e,{strides:l,pad:c,dataFormat:f,dilations:d,dimRoundingMode:m,activation:g,leakyreluAlpha:b}=s;let x=F6({inputs:{x:r,filter:a},backend:t,attrs:{strides:l,pad:c,dataFormat:f,dilations:d,dimRoundingMode:m}});if(i){const v=x;x=Xp({inputs:{a:x,b:i},backend:t}),t.disposeIntermediateTensorInfo(v)}if(g){const v=x;x=Ob(t,x,g,o,b),t.disposeIntermediateTensorInfo(v)}return x}const ute={kernelName:b1,backendName:"cpu",kernelFunc:lte};function cte(n){const{inputs:e,backend:t}=n,{params:s,indices:r}=e,a=Be(s.shape),i=r.shape,o=i[i.length-1],[l,c,f,d]=Bv(s,r);if(c===0)return t.makeTensorInfo(l,s.dtype,[]);const m=t.data.get(r.dataId).values,g=t.bufferSync(s),b=HL(m,g,s.dtype,c,o,f,d,s.shape,a);return t.makeTensorInfo(l,s.dtype,b.values)}const hte={kernelName:xx,backendName:"cpu",kernelFunc:cte};function fte(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,indices:a}=e,{axis:i,batchDims:o}=s;Ct([r,a],"gatherV2");const l=vn(i,r.shape)[0],c=t.data.get(a.dataId).values,f=r.shape[l];for(let A=0;A<c.length;++A){const R=c[A];Z(R<=f-1&&R>=0,()=>`GatherV2: the index value ${R} is not in [0, ${f-1}]`)}let d=o;o==null&&(d=0);const m=Be(a.shape),g=D3(r,a,l,d),b=Ss({inputs:{x:r},backend:t,attrs:{shape:[g.batchSize,g.outerSize,g.dimSize,g.sliceSize]}}),x=Ss({inputs:{x:a},backend:t,attrs:{shape:[g.batchSize,m/g.batchSize]}}),v=[g.batchSize,g.outerSize,m/g.batchSize,g.sliceSize],w=t.bufferSync(x),k=t.bufferSync(b),I=KL(k,w,v);return t.disposeIntermediateTensorInfo(b),t.disposeIntermediateTensorInfo(x),t.makeTensorInfo(g.outputShape,I.dtype,I.values)}const dte={kernelName:i0,backendName:"cpu",kernelFunc:fte};function pte(n){const{inputs:e,backend:t}=n,{input:s}=e,r=Be(s.shape),a=s.shape[s.shape.length-1],i=r/a,o=Ss({inputs:{x:s},backend:t,attrs:{shape:[i,a]}}),l=M6(o,!0,t),c=Ss({inputs:{x:l},backend:t,attrs:{shape:s.shape}});return t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(l),c}const mte={kernelName:vx,backendName:"cpu",kernelFunc:pte};const gte=Qn(Nm,n=>Number.isFinite(n)?1:0,"bool"),yte={kernelName:Nm,backendName:"cpu",kernelFunc:gte};const bte=Qn(km,n=>Math.abs(n)===1/0?1:0,"bool"),xte={kernelName:km,backendName:"cpu",kernelFunc:bte};const vte=Qn(Cm,n=>Number.isNaN(n)?1:0,"bool"),wte={kernelName:Cm,backendName:"cpu",kernelFunc:vte};function Ste(n){const{backend:e,attrs:t}=n,{start:s,stop:r,num:a}=t,i=QL(s,r,a);return e.makeTensorInfo([i.length],"float32",i)}const Nte={kernelName:Sx,backendName:"cpu",kernelFunc:Ste};const kte=Qn(Am,n=>Math.log1p(n)),Cte={kernelName:Am,backendName:"cpu",kernelFunc:kte};const Tte=dr((n,e)=>n&&e),Ate=Lr(h0,Tte,null,"bool"),Ite={kernelName:h0,backendName:"cpu",kernelFunc:Ate};const Ete=Qn(f0,n=>n?0:1,"bool"),_te={kernelName:f0,backendName:"cpu",kernelFunc:Ete};const $te=dr((n,e)=>n||e),Rte=Lr(d0,$te,null,"bool"),Dte={kernelName:d0,backendName:"cpu",kernelFunc:Rte};function Ote(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{depthRadius:a,bias:i,alpha:o,beta:l}=s;Ct(r,"LRN");const c=r.shape[3],f=c-1,d=t.data.get(r.dataId).values,m=Be(r.shape),g=new Float32Array(m);function b(x){const v=x%c;let w=x-v+Math.max(0,v-a);const k=x-v+Math.min(v+a,f);let I=0;for(;w<=k;w++){const A=d[w];I+=A*A}return I}for(let x=0;x<m;x++){const v=b(x),w=d[x]*Math.pow(i+o*v,-l);g[x]=w}return t.makeTensorInfo(r.shape,r.dtype,g)}const Lte={kernelName:p0,backendName:"cpu",kernelFunc:Ote};function Fte(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,y:a,dy:i}=e,{depthRadius:o,bias:l,alpha:c,beta:f}=s;Ct(i,"LRNGrad");const d=Be(i.shape),m=i.shape[3],g=t.data.get(i.dataId).values,b=t.data.get(r.dataId).values,x=t.data.get(a.dataId).values,v=new Float32Array(d),w=d;for(let k=0;k<w;k++){const I=k%m,A=k-I+Math.max(0,I-o),R=k-I+Math.min(m,I+o+1);let U=0;for(let V=A;V<R;V++)U+=Math.pow(b[V],2);U=c*U+l;for(let V=A;V<R;V++){let P=-2*c*f*b[V]*x[k]/U;k===V&&(P+=Math.pow(U,-f)),P*=g[k],v[V]+=P}}return t.makeTensorInfo(i.shape,r.dtype,v)}const Mte={kernelName:Nx,backendName:"cpu",kernelFunc:Fte};function z6(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{reductionIndices:a,keepDims:i}=s,o=t;let l=r.shape;const c=l.length,f=vn(a,l);let d=f;const m=js(d,c);let g=o.data.get(r.dataId).values;if(m!=null){const A=new Array(c);for(let R=0;R<A.length;R++)A[R]=l[m[R]];g=iC(g,l,r.dtype,m,A),d=hr(d.length,c),l=A}Ct(r,"max"),da("max",d,c);const[b,x]=Zr(l,d),v=Be(x),w=t6(g,v,b,r.dtype),k=o.write(w,b,r.dtype);let I=b;return i&&(I=cr(b,f)),{dataId:k,shape:I,dtype:r.dtype}}const zte={kernelName:m0,backendName:"cpu",kernelFunc:z6};function Pte(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e;Ct(r,"maxPool");const{filterSize:a,strides:i,pad:o,dimRoundingMode:l}=s,c=1;Z(fa(i,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const f=qo(r.shape,a,i,c,o,l);let d;if(f.filterWidth===1&&f.filterHeight===1&&Nn(f.inShape,f.outShape))d=Iu({inputs:{x:r},backend:t});else{const m=t.data.get(r.dataId).values,g=Ot(r.shape),b=uC(m,r.shape,r.dtype,g,f,"max");d=t.makeTensorInfo(f.outShape,r.dtype,b.values)}return d}const Bte={kernelName:g0,backendName:"cpu",kernelFunc:Pte};function Ute(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{filterSize:a,strides:i,pad:o,dimRoundingMode:l,dataFormat:c}=s;Ct(r,"maxPool3d");const f=Cc(r.shape,a,i,1,o,l,c),d=t.data.get(r.dataId).values,m=O6(d,r.shape,r.dtype,Ot(r.shape),f,"max");return t.makeTensorInfo(m.shape,"float32",m.values)}const Vte={kernelName:y0,backendName:"cpu",kernelFunc:Ute};function jte(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,input:a}=e,{filterSize:i,strides:o,pad:l,dimRoundingMode:c}=s;Ct([r,a],"maxPool3DGrad");const f=Cc(a.shape,i,o,1,l,c),d=t.bufferSync(a),m=$Q(d,f),g=f.strideDepth,b=f.strideHeight,x=f.strideWidth,v=f.dilationDepth,w=f.dilationHeight,k=f.dilationWidth,I=f.effectiveFilterDepth,A=f.effectiveFilterHeight,R=f.effectiveFilterWidth,U=I-1-f.padInfo.front,V=R-1-f.padInfo.left,P=A-1-f.padInfo.top,D=mn(a.shape,"float32"),B=t.bufferSync(r);for(let E=0;E<f.batchSize;++E)for(let M=0;M<f.inChannels;++M)for(let K=0;K<f.inDepth;++K)for(let X=0;X<f.inHeight;++X)for(let ae=0;ae<f.inWidth;++ae){const W=K-U,se=X-P,ee=ae-V;let ce=0;for(let ye=0;ye<I;ye+=v){const G=(W+ye)/g;if(!(G<0||G>=f.outDepth||Math.floor(G)!==G))for(let O=0;O<A;O+=w){const j=(se+O)/b;if(!(j<0||j>=f.outHeight||Math.floor(j)!==j))for(let Y=0;Y<R;Y+=k){const ie=(ee+Y)/x;if(ie<0||ie>=f.outWidth||Math.floor(ie)!==ie)continue;const ue=I*A*R-1-m.get(E,G,j,ie,M),pe=ye*A*R+O*R+Y,Ce=ue===pe?1:0;if(Ce===0)continue;const Ne=B.get(E,G,j,ie,M);ce+=Ne*Ce}}}D.set(ce,E,K,X,ae,M)}return t.makeTensorInfo(D.shape,D.dtype,D.values)}const Wte={kernelName:Cx,backendName:"cpu",kernelFunc:jte};function Gte(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,input:a,output:i}=e,o=a;Ct([a,i],"maxPoolGrad");const{filterSize:l,strides:c,pad:f,dimRoundingMode:d}=s,m=qo(o.shape,l,c,1,f,d),g=t.data.get(o.dataId).values,b=mn(m.outShape,o.dtype,D6(g,o.shape,o.dtype,m).values),x=m.strideHeight,v=m.strideWidth,w=m.dilationHeight,k=m.dilationWidth,I=m.effectiveFilterHeight,A=m.effectiveFilterWidth,R=A-1-m.padInfo.left,U=I-1-m.padInfo.top,V=mn(o.shape,"float32"),P=t.data.get(r.dataId).values,D=mn(r.shape,"float32",P);for(let B=0;B<m.batchSize;++B)for(let E=0;E<m.inChannels;++E)for(let M=0;M<m.inHeight;++M)for(let K=0;K<m.inWidth;++K){const X=M-U,ae=K-R;let W=0;for(let se=0;se<I;se+=w){const ee=(X+se)/x;if(!(ee<0||ee>=m.outHeight||Math.floor(ee)!==ee))for(let ce=0;ce<A;ce+=k){const ye=(ae+ce)/v;if(ye<0||ye>=m.outWidth||Math.floor(ye)!==ye)continue;const G=I*A-1-b.get(B,ee,ye,E),O=se*A+ce,j=G===O?1:0;if(j===0)continue;const Y=D.get(B,ee,ye,E);W+=Y*j}}V.set(W,B,M,K,E)}return t.makeTensorInfo(V.shape,V.dtype,V.values)}const qte={kernelName:kx,backendName:"cpu",kernelFunc:Gte};function Hte(n,e,t,s,r){const a=Ot(e),i=uC(n,e,t,a,r,"max"),o=D6(n,e,t,r,!0,s);return[i.values,o.values]}const Kte={kernelName:Tx,backendName:"cpu",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{x:s}=n,{filterSize:r,strides:a,pad:i,includeBatchInIndex:o}=e,l=t;Ct(s,"MaxPoolWithArgmax");const c=l.data.get(s.dataId).values,f=qo(s.shape,r,a,[1,1],i),[d,m]=Hte(c,s.shape,s.dtype,o,f),g=l.write(d,f.outShape,s.dtype),b=l.write(m,f.outShape,s.dtype);return[{dataId:g,shape:f.outShape,dtype:s.dtype},{dataId:b,shape:f.outShape,dtype:"int32"}]}};function Xte(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:a,keepDims:i}=s,o=vn(a,r.shape),c=Zr(r.shape,o)[1],f=Be(c),d=[],m=t.makeTensorInfo([],"float32",new Float32Array([f]));d.push(m);const g=Fh({inputs:{x:r},backend:t,attrs:{dtype:"float32"}});d.push(g);const b=cC({inputs:{a:g,b:m},backend:t});d.push(b);const x=xy({inputs:{x:b},backend:t,attrs:{axis:a,keepDims:i}});return d.forEach(v=>t.disposeIntermediateTensorInfo(v)),x}const Yte={kernelName:b0,backendName:"cpu",kernelFunc:Xte};function Zte(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:a,keepDims:i}=s;Ct(r,"min");const o=vn(a,r.shape);let l=o;const c=js(l,r.shape.length);let f=r;c!=null&&(f=ci({inputs:{x:r},backend:t,attrs:{perm:c}}),l=hr(l.length,r.shape.length)),da("min",l,f.shape.length);const[d,m]=Zr(f.shape,l),g=Be(m),b=ca(Be(d),f.dtype),x=t.data.get(f.dataId).values;for(let w=0;w<b.length;++w){const k=w*g;let I=x[k];for(let A=0;A<g;++A){const R=x[k+A];(Number.isNaN(R)||R<I)&&(I=R)}b[w]=I}c!=null&&t.disposeIntermediateTensorInfo(f);const v=t.makeTensorInfo(d,f.dtype,b);if(i){const w=cr(d,o),k=Ss({inputs:{x:v},backend:t,attrs:{shape:w}});return t.disposeIntermediateTensorInfo(v),k}return v}const Jte={kernelName:x0,backendName:"cpu",kernelFunc:Zte};function Qte(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{paddings:a,mode:i}=s;Ct(r,"mirrorPad");const o=a.map((I,A)=>I[0]+r.shape[A]+I[1]),l=a.map(I=>I[0]),c=a.map((I,A)=>I[0]+r.shape[A]),f=i==="reflect"?0:1,d=t.data.get(r.dataId).values,m=r.shape.length,g=Ot(r.shape),b=Be(o),x=o.length,v=Ot(o),w=Kr(r.dtype,b);for(let I=0;I<b;I++){let A=md(I,x,v);for(let U=0;U<x;U++)A[U]<l[U]?A[U]=l[U]*2-A[U]-f:A[U]>=c[U]&&(A[U]=(c[U]-1)*2-A[U]+f);A=A.map((U,V)=>U-l[V]);const R=El(A,m,g);w[I]=d[R]}return{dataId:t.write(w,o,r.dtype),shape:o,dtype:r.dtype}}const ene={kernelName:v0,backendName:"cpu",kernelFunc:Qte};const tne=dr(((n,e)=>{const t=n%e;return n<0&&e<0||n>=0&&e>=0?t:(t+e)%e})),nne=Lr(_m,tne),sne={kernelName:_m,backendName:"cpu",kernelFunc:nne};function P6(n){const{inputs:e,backend:t,attrs:s}=n,{logits:r}=e,{dim:a}=s,i=r.shape.length;let o=a;if(o===-1&&(o=i-1),o!==i-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${i} and dim was ${o}`);const l=vn([o],r.shape),c=z6({inputs:{x:r},backend:t,attrs:{reductionIndices:l,keepDims:!1}}),f=cr(c.shape,l),d=Ss({inputs:{x:c},backend:t,attrs:{shape:f}}),m=lC({inputs:{a:r,b:d},backend:t}),g=jL({inputs:{x:m},backend:t}),b=xy({inputs:{x:g},backend:t,attrs:{axis:l,keepDims:!1}}),x=Ss({inputs:{x:b},backend:t,attrs:{shape:f}}),v=cC({inputs:{a:g,b:x},backend:t});return t.disposeIntermediateTensorInfo(c),t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(b),t.disposeIntermediateTensorInfo(x),v}const rne={kernelName:z0,backendName:"cpu",kernelFunc:P6};function ane(n){const{inputs:e,backend:t,attrs:s}=n,{logits:r}=e,{numSamples:a,seed:i,normalized:o}=s;Ct(r,"multinomial");const l=o?r:P6({inputs:{logits:r},backend:t,attrs:{dim:-1}}),c=l.shape[0],f=l.shape[1],d=t.data.get(l.dataId).values,m=[c,a],g=ca(Be(m),"int32");for(let b=0;b<c;++b){const x=b*f,v=new Float32Array(f-1);v[0]=d[x];for(let I=1;I<v.length;++I)v[I]=v[I-1]+d[x+I];const w=mv.alea(i.toString()),k=b*a;for(let I=0;I<a;++I){const A=w();g[k+I]=v.length;for(let R=0;R<v.length;R++)if(A<v[R]){g[k+I]=R;break}}}return o||t.disposeIntermediateTensorInfo(l),t.makeTensorInfo(m,"int32",g)}const ine={kernelName:Ax,backendName:"cpu",kernelFunc:ane};const one=Fv;function lne(n){const{inputs:e,backend:t,attrs:s}=n,{boxes:r,scores:a}=e,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l}=s;Ct(r,"NonMaxSuppression");const c=t.data.get(r.dataId).values,f=t.data.get(a.dataId).values,{selectedIndices:d}=one(c,f,i,o,l);return t.makeTensorInfo([d.length],"int32",new Int32Array(d))}const une={kernelName:Ix,backendName:"cpu",kernelFunc:lne};const cne=Mv;function hne(n){const{inputs:e,backend:t,attrs:s}=n,{boxes:r,scores:a}=e,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l,padToMaxOutputSize:c}=s;Ct(r,"NonMaxSuppressionPadded");const f=t.data.get(r.dataId).values,d=t.data.get(a.dataId).values,{selectedIndices:m,validOutputs:g}=cne(f,d,i,o,l,c);return[t.makeTensorInfo([m.length],"int32",new Int32Array(m)),t.makeTensorInfo([],"int32",new Int32Array([g]))]}const fne={kernelName:Ex,backendName:"cpu",kernelFunc:hne};const dne=zv;function pne(n){const{inputs:e,backend:t,attrs:s}=n,{boxes:r,scores:a}=e,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l,softNmsSigma:c}=s;Ct(r,"NonMaxSuppressionWithScore");const f=t.data.get(r.dataId).values,d=t.data.get(a.dataId).values,m=i,g=o,b=l,x=c,{selectedIndices:v,selectedScores:w}=dne(f,d,m,g,b,x);return[t.makeTensorInfo([v.length],"int32",new Int32Array(v)),t.makeTensorInfo([w.length],"float32",new Float32Array(w))]}const mne={kernelName:_x,backendName:"cpu",kernelFunc:pne};function gne(n){const{inputs:e,backend:t,attrs:s}=n,{indices:r}=e,{dtype:a,depth:i,onValue:o,offValue:l}=s;Ct(r,"oneHot");const c=Be(r.shape),f=new Float32Array(c*i);f.fill(l);const d=t.data.get(r.dataId).values;for(let m=0;m<c;++m)d[m]>=0&&d[m]<i&&(f[m*i+d[m]]=o);return t.makeTensorInfo([...r.shape,i],a,f)}const yne={kernelName:k0,backendName:"cpu",kernelFunc:gne};function Fb(n){const{inputs:e,backend:t}=n,{x:s}=e;if(s.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(s.dtype==="complex64"){const r=od({inputs:{input:s},backend:t}),a=Fb({inputs:{x:r},backend:t}),i=Yp({inputs:{input:s},backend:t}),o=Fb({inputs:{x:i},backend:t}),l=Oi({inputs:{real:a,imag:o},backend:t});return t.disposeIntermediateTensorInfo(r),t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(o),l}else return hC({backend:t,attrs:{shape:s.shape,value:0,dtype:s.dtype}})}const bne={kernelName:V0,backendName:"cpu",kernelFunc:Fb};function B6(n){const{inputs:e,backend:t}=n,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(s.dtype==="complex64"){const r=od({inputs:{input:s},backend:t}),a=B6({inputs:{x:r},backend:t}),i=Yp({inputs:{input:s},backend:t}),o=Fb({inputs:{x:i},backend:t}),l=Oi({inputs:{real:a,imag:o},backend:t});return t.disposeIntermediateTensorInfo(r),t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(o),l}else return hC({backend:t,attrs:{shape:s.shape,value:1,dtype:s.dtype}})}const xne={kernelName:N0,backendName:"cpu",kernelFunc:B6};function U6(n){const{inputs:e,backend:t,attrs:s}=n,{axis:r}=s;if(e.length===1)return Lb({inputs:{input:e[0]},backend:t,attrs:{dim:r}});const a=e[0].shape,i=e[0].dtype;e.forEach(f=>{ha(a,f.shape,"All tensors passed to stack must have matching shapes"),Z(i===f.dtype,()=>"All tensors passed to stack must have matching dtypes")});const o=[],l=e.map(f=>{const d=Lb({inputs:{input:f},backend:t,attrs:{dim:r}});return o.push(d),d}),c=Zp({inputs:l,backend:t,attrs:{axis:r}});return o.forEach(f=>t.disposeIntermediateTensorInfo(f)),c}const vne={kernelName:C0,backendName:"cpu",kernelFunc:U6};function wne(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{paddings:a,constantValue:i}=s;Ct(r,"pad");const o=a.map((k,I)=>k[0]+r.shape[I]+k[1]),l=a.map(k=>k[0]),c=t.data.get(r.dataId).values,f=Be(r.shape),d=r.shape.length,m=Ot(r.shape),g=Be(o),b=o.length,x=Ot(o),v=Kr(r.dtype,g);i!==0&&v.fill(i);for(let k=0;k<f;k++){const A=md(k,d,m).map((U,V)=>U+l[V]),R=El(A,b,x);v[R]=c[k]}return{dataId:t.write(v,o,r.dtype),shape:o,dtype:r.dtype}}const V6={kernelName:T0,backendName:"cpu",kernelFunc:wne};const Sne=dr((n,e)=>Math.pow(n,e)),Nne=Lr(Rm,Sne),kne={kernelName:Rm,backendName:"cpu",kernelFunc:Nne};function Cne(n){const{inputs:e,backend:t,attrs:s}=n,{paramsNestedSplits:r,paramsDenseValues:a,indices:i}=e,{outputRaggedRank:o}=s,l=r.map(w=>t.data.get(w.dataId).values),c=r.map(w=>w.shape),f=t.data.get(a.dataId).values,d=t.data.get(i.dataId).values,[m,g,b]=o6(l,c,f,a.shape,a.dtype,d,i.shape),x=m.map(w=>t.makeTensorInfo([w.length],"int32",w)),v=t.makeTensorInfo(b,a.dtype,g);return x.concat([v])}const Tne={kernelName:$x,backendName:"cpu",kernelFunc:Cne};function Ane(n){const{inputs:e,backend:t}=n,{starts:s,limits:r,deltas:a}=e,i=t.data.get(s.dataId).values,o=t.data.get(r.dataId).values,l=t.data.get(a.dataId).values,[c,f]=l6(i,s.shape,s.dtype,o,r.shape,l,a.shape),d=t.makeTensorInfo([c.length],"int32",c),m=t.makeTensorInfo([f.length],s.dtype,f);return[d,m]}const Ine={kernelName:Rx,backendName:"cpu",kernelFunc:Ane};function Ene(n){const{inputs:e,backend:t,attrs:s}=n,{shape:r,values:a,defaultValue:i,rowPartitionTensors:o}=e,{rowPartitionTypes:l}=s,c=t.data.get(r.dataId).values,f=t.data.get(a.dataId).values,d=t.data.get(i.dataId).values,m=o.map(v=>t.data.get(v.dataId).values),g=o.map(v=>v.shape),[b,x]=u6(c,r.shape,f,a.shape,a.dtype,d,i.shape,m,g,l);return t.makeTensorInfo(b,a.dtype,x)}const _ne={kernelName:Dx,backendName:"cpu",kernelFunc:Ene};function $ne(n){const{backend:e,attrs:t}=n,{start:s,stop:r,dtype:a,step:i}=t,o=c6(s,r,i,a);return e.makeTensorInfo([o.length],a,o)}const Rne={kernelName:Ox,backendName:"cpu",kernelFunc:$ne};const Dne=Qn(Dm,n=>1/n),One={kernelName:Dm,backendName:"cpu",kernelFunc:Dne};function Lne(n){const{inputs:e,backend:t,attrs:s}=n,{images:r}=e,{alignCorners:a,halfPixelCenters:i,size:o}=s;Ct(r,"resizeBilinear");const l=Ot(r.shape),[c,f]=o,[d,m,g,b]=r.shape,x=t.data.get(r.dataId).values,v=new Float32Array(Be([d,c,f,b])),w=[a&&c>1?m-1:m,a&&f>1?g-1:g],k=[a&&c>1?c-1:c,a&&f>1?f-1:f];let I=0;const A=w[0]/k[0],R=w[1]/k[1];for(let U=0;U<d;U++)for(let V=0;V<c;V++){let P;i?P=A*(V+.5)-.5:P=A*V;const D=Math.max(0,Math.floor(P)),B=P-D,E=Math.min(m-1,Math.ceil(P)),M=U*l[0]+D*l[1],K=U*l[0]+E*l[1];for(let X=0;X<f;X++){let ae;i?ae=R*(X+.5)-.5:ae=R*X;const W=Math.max(0,Math.floor(ae)),se=ae-W,ee=Math.min(g-1,Math.ceil(ae)),ce=M+W*l[2],ye=K+W*l[2],G=M+ee*l[2],O=K+ee*l[2];for(let j=0;j<b;j++){const Y=x[ce+j],ie=x[ye+j],ue=x[G+j],pe=x[O+j],Ce=Y+(ue-Y)*se,Ne=ie+(pe-ie)*se,Le=Ce+(Ne-Ce)*B;v[I++]=Le}}}return t.makeTensorInfo([d,c,f,b],"float32",v)}const Fne={kernelName:$0,backendName:"cpu",kernelFunc:Lne};function Mne(n){const{inputs:e,backend:t,attrs:s}=n,{images:r,dy:a}=e,{alignCorners:i}=s;Ct([a,r],"resizeBilinearGrad");const o=Ot(r.shape),[l,c,f,d]=r.shape,[,m,g]=a.shape,b=new Float32Array(l*c*f*d),x=[i&&m>1?c-1:c,i&&g>1?f-1:f],v=[i&&m>1?m-1:m,i&&g>1?g-1:g],w=x[0]/v[0],k=x[1]/v[1],I=t.data.get(a.dataId).values;let A=0;for(let R=0;R<l;R++){const U=R*o[0];for(let V=0;V<m;V++){const P=V*w,D=Math.floor(P),B=Math.min(Math.ceil(P),c-1),E=U+D*o[1],M=U+B*o[1],K=P-D,X=1-K;for(let ae=0;ae<g;ae++){const W=ae*k,se=Math.floor(W),ee=Math.min(Math.ceil(W),f-1),ce=W-se,ye=1-ce,G=E+se*o[2],O=E+ee*o[2],j=M+se*o[2],Y=M+ee*o[2],ie=X*ye,ue=X*ce,pe=K*ye,Ce=K*ce;for(let Ne=0;Ne<d;Ne++){const Le=I[A++];b[G+Ne]+=Le*ie,b[O+Ne]+=Le*ue,b[j+Ne]+=Le*pe,b[Y+Ne]+=Le*Ce}}}}return t.makeTensorInfo([l,f,c,d],"float32",b)}const zne={kernelName:Mx,backendName:"cpu",kernelFunc:Mne};function Pne(n){const{inputs:e,backend:t,attrs:s}=n,{images:r}=e,{alignCorners:a,halfPixelCenters:i,size:o}=s;Ct(r,"resizeNearestNeighbor");const l=Ot(r.shape),[c,f]=o,[d,m,g,b]=r.shape,x=t.data.get(r.dataId).values,v=new Float32Array(d*c*f*b),w=[a&&c>1?m-1:m,a&&f>1?g-1:g],k=[a&&c>1?c-1:c,a&&f>1?f-1:f],I=w[0]/k[0],A=w[1]/k[1];let R=0;for(let U=0;U<d;U++){const V=U*l[0];for(let P=0;P<c;P++){const D=i?I*(P+.5):I*P;let B=Math.min(m-1,a?Math.round(D):Math.floor(D));i&&(B=Math.max(0,B));const E=V+B*l[1];for(let M=0;M<f;M++){const K=i?A*(M+.5):A*M;let X=Math.min(g-1,a?Math.round(K):Math.floor(K));i&&(X=Math.max(0,X));const ae=E+X*l[2];for(let W=0;W<b;W++){const se=x[ae+W];v[R++]=se}}}}return t.makeTensorInfo([d,c,f,b],r.dtype,v)}const Bne={kernelName:_0,backendName:"cpu",kernelFunc:Pne};function Une(n){const{inputs:e,backend:t,attrs:s}=n,{images:r,dy:a}=e,{alignCorners:i}=s;Ct([a,r],"resizeNearestNeighborGrad");const o=Ot(r.shape),l=Ot(a.shape),[c,f,d,m]=r.shape,[,g,b]=a.shape,x=new Float32Array(c*f*d*m),v=t.data.get(a.dataId).values,w=[i&&g>1?f-1:f,i&&b>1?d-1:d],k=[i&&g>1?g-1:g,i&&b>1?b-1:b],I=w[0]/k[0],A=w[1]/k[1],R=1/I,U=1/A,V=Math.ceil(R)*2+2,P=Math.ceil(U)*2+2;for(let D=0;D<c;D++){const B=D*o[0];for(let E=0;E<f;E++){const M=B+E*o[1],K=Math.floor(E*R),X=Math.floor(K-V/2);for(let ae=0;ae<d;ae++){const W=M+ae*o[2],se=Math.floor(ae*U),ee=Math.floor(se-P/2);for(let ce=0;ce<m;ce++){let ye=0;for(let G=0;G<V;G++){const O=G+X;if(O<0||O>=g)continue;const j=B+O*l[1],Y=O*I,ie=Math.min(f-1,i?Math.round(Y):Math.floor(Y));if(E===ie)for(let ue=0;ue<P;ue++){const pe=ue+ee;if(pe<0||pe>=b)continue;const Ce=j+pe*l[2],Ne=pe*A,Le=Math.min(d-1,i?Math.round(Ne):Math.floor(Ne));ae===Le&&(ye+=v[Ce+ce])}}x[W+ce]=ye}}}}return t.makeTensorInfo(r.shape,r.dtype,x)}const Vne={kernelName:Fx,backendName:"cpu",kernelFunc:Une};function jne(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{dims:a}=s;Ct(r,"reverse");const i=r.shape.length,o=vn(a,r.shape);if(i===0)return Iu({inputs:{x:r},backend:t});const l=new Sr(r.shape,r.dtype),c=t.bufferSync(r);for(let f=0;f<l.size;f++){const d=l.indexToLoc(f),m=d.slice();o.forEach(g=>m[g]=r.shape[g]-1-m[g]),l.set(c.get(...m),...d)}return t.makeTensorInfo(l.shape,l.dtype,l.values)}const Wne={kernelName:R0,backendName:"cpu",kernelFunc:jne};const Gne={kernelName:ev,backendName:"cpu",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{image:s}=n,{radians:r,fillValue:a,center:i}=e,o=t,l=Kr(s.dtype,Be(s.shape)),[c,f,d,m]=s.shape,[g,b]=y3(i,f,d),x=255,v=Math.sin(r),w=Math.cos(r),k=o.data.get(s.dataId).values;for(let A=0;A<c;A++){const R=A*d*f*m;for(let U=0;U<f;U++){const V=U*(d*m);for(let P=0;P<d;P++){const D=P*m;for(let B=0;B<m;B++){const E=[c,U,P,B],M=E[2],K=E[1];let X=(M-g)*w-(K-b)*v,ae=(M-g)*v+(K-b)*w;X=Math.round(X+g),ae=Math.round(ae+b);let W=a;if(typeof a!="number"&&(B===3?W=x:W=a[B]),X>=0&&X<d&&ae>=0&&ae<f){const ee=ae*(d*m),ce=X*m,ye=R+ee+ce+B;W=k[ye]}const se=R+V+D+B;l[se]=W}}}}return{dataId:o.write(l,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};const qne=Qn(Fm,n=>{const e=Math.floor(n);return n-e<.5?Math.floor(n):n-e>.5?Math.ceil(n):e%2===0?e:e+1}),Hne={kernelName:Fm,backendName:"cpu",kernelFunc:qne};function Kne(n){const{inputs:e,backend:t,attrs:s}=n,{indices:r,updates:a}=e,{shape:i}=s,{sliceRank:o,numUpdates:l,sliceSize:c,strides:f,outputSize:d}=Gh(a,r,i),m=!0,g=t.bufferSync(r),b=t.bufferSync(a),x=Uf(g,b,i,d,c,l,o,f,0,m);return t.makeTensorInfo(i,x.dtype,x.values)}const Xne={kernelName:zx,backendName:"cpu",kernelFunc:Kne};function Yne(n,e){let t=0,s=n.length,r=0;for(;t<s;)r=Math.floor((t+s)/2),n[r]<e?t=r+1:s=r;return s}function Zne(n,e){let t=0,s=n.length,r=0;for(;t<s;)r=Math.floor((t+s)/2),n[r]<=e?t=r+1:s=r;return s}function Jne(n,e,t,s,r,a){const i=Ys("int32",t*r);for(let o=0;o<t;++o){const l=n.slice(o*s,(o+1)*s),c=o*r;for(let f=0;f<r;++f)i[c+f]=a==="left"?Yne(l,e[f+c]):Zne(l,e[f+c])}return i}function Qne(n){const{inputs:e,backend:t,attrs:s}=n,{sortedSequence:r,values:a}=e,{side:i}=s,o=t.data.get(r.dataId).values,l=t.data.get(a.dataId).values,c=Jne(o,l,r.shape[0],r.shape[1],a.shape[1],i);return t.makeTensorInfo(a.shape,"int32",c)}const ese={kernelName:Bx,backendName:"cpu",kernelFunc:Qne};function tse(n){const{inputs:e,backend:t}=n,{condition:s,t:r,e:a}=e;Ct([s,r,a],"select");const i=s.shape.length,o=t.data.get(s.dataId).values,l=t.data.get(r.dataId).values,c=t.data.get(a.dataId).values,f=ai(r.dtype,a.dtype),d=ca(Be(r.shape),f);let m=0;const g=i===0||i>1||r.shape.length===1?1:Be(r.shape.slice(1));for(let b=0;b<o.length;b++)for(let x=0;x<g;x++)o[b]===1?d[m++]=l[b]:d[m++]=c[b];return t.makeTensorInfo(r.shape,f,d)}const nse={kernelName:D0,backendName:"cpu",kernelFunc:tse};const sse=jv,rse=Wv,ase=Qn(zm,n=>n>=0?rse*n:sse*(Math.exp(n)-1)),ise={kernelName:zm,backendName:"cpu",kernelFunc:ase};const ose=Qn(Um,n=>n<0?-1:n>0?1:0),lse={kernelName:Um,backendName:"cpu",kernelFunc:ose};const use=Qn(Pm,n=>Math.sin(n)),cse={kernelName:Pm,backendName:"cpu",kernelFunc:use};const hse=Qn(Bm,n=>Math.sinh(n)),fse={kernelName:Bm,backendName:"cpu",kernelFunc:hse};const dse=11920928955078125e-23,vE=Math.log(dse)+2,pse=Qn(jm,n=>{const e=n>-vE,t=n<vE,s=Math.exp(n);let r;return t?r=s:e?r=n:r=Math.log(1+s),r}),mse={kernelName:jm,backendName:"cpu",kernelFunc:pse};function gse(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{blockShape:a,paddings:i}=s;Ct([r],"spaceToBatchND");const o=Be(a),l=[[0,0]];l.push(...i);for(let U=1+a.length;U<r.shape.length;++U)l.push([0,0]);const c=V6.kernelFunc({inputs:{x:r},backend:t,attrs:{paddings:l,constantValue:0}}),f=ly(c.shape,a,o,!1),d=uy(f.length,a.length,!1),m=cy(c.shape,a,o,!1),x=Ss({inputs:{x:c},backend:t,attrs:{shape:f}}),k=ci({inputs:{x},backend:t,attrs:{perm:d}}),R=Ss({inputs:{x:k},backend:t,attrs:{shape:m}});return t.disposeIntermediateTensorInfo(c),t.disposeIntermediateTensorInfo(x),t.disposeIntermediateTensorInfo(k),R}const yse={kernelName:F0,backendName:"cpu",kernelFunc:gse};function bse(n){const{inputs:e,backend:t}=n,{indices:s,values:r,denseShape:a,defaultValue:i}=e;if(a.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${a.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${r.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);const o=t.data.get(s.dataId).values,l=t.data.get(r.dataId).values,c=t.data.get(a.dataId).values,f=t.data.get(i.dataId).values[0],[d,m,g,b,x]=p6(o,s.shape,s.dtype,l,r.dtype,c,f);return[t.makeTensorInfo(m,s.dtype,d),t.makeTensorInfo([m[0]],r.dtype,g),t.makeTensorInfo([b.length],"bool",new Uint8Array(b.map(v=>Number(v)))),t.makeTensorInfo([x.length],s.dtype,new Int32Array(x))]}const xse={kernelName:Ux,backendName:"cpu",kernelFunc:bse};function vse(n){const{inputs:e,backend:t}=n,{inputIndices:s,inputShape:r,newShape:a}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${r.shape}`);if(a.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${a.shape}`);const i=Array.from(t.data.get(r.dataId).values),o=t.data.get(s.dataId).values,l=Array.from(t.data.get(a.dataId).values),[c,f,d]=m6(o,s.shape,s.dtype,i,l);return[t.makeTensorInfo(f,s.dtype,c),t.makeTensorInfo([d.length],a.dtype,new Int32Array(d))]}const wse={kernelName:Vx,backendName:"cpu",kernelFunc:vse};function Sse(n){const{inputs:e,backend:t}=n,{data:s,indices:r,segmentIds:a}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${r.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${a.shape}`);if(r.shape[0]!==a.shape[0])throw new Error("segmentIds and indices should have same size.");const i=t.data.get(s.dataId).values,o=t.data.get(r.dataId).values,l=t.data.get(a.dataId).values,[c,f]=oC(i,s.shape,s.dtype,o,l,!0);return t.makeTensorInfo(f,s.dtype,c)}const Nse={kernelName:jx,backendName:"cpu",kernelFunc:Sse};function kse(n){const{inputs:e,backend:t}=n,{data:s,indices:r,segmentIds:a}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${r.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${a.shape}`);if(r.shape[0]!==a.shape[0])throw new Error("segmentIds and indices should have same size.");const i=t.data.get(s.dataId).values,o=t.data.get(r.dataId).values,l=t.data.get(a.dataId).values,[c,f]=oC(i,s.shape,s.dtype,o,l);return t.makeTensorInfo(f,s.dtype,c)}const Cse={kernelName:Wx,backendName:"cpu",kernelFunc:kse};function Tse(n){const{inputs:e,backend:t,attrs:s}=n,{sparseIndices:r,sparseValues:a,defaultValue:i}=e,{outputShape:o}=s,{sliceRank:l,numUpdates:c,sliceSize:f,strides:d,outputSize:m}=Gh(a,r,o),g=!1,b=t.bufferSync(r);let x;switch(a.dtype){case"bool":{const v=t.bufferSync(a),w=!!t.data.get(i.dataId).values[0];x=Uf(b,v,o,m,f,c,l,d,w,g);break}case"float32":{const v=t.bufferSync(a),w=t.data.get(i.dataId).values[0];x=Uf(b,v,o,m,f,c,l,d,w,g);break}case"int32":{const v=t.bufferSync(a),w=t.data.get(i.dataId).values[0];x=Uf(b,v,o,m,f,c,l,d,w,g);break}case"string":{const v=t.bufferSync(a),w=bc(t.data.get(i.dataId).values[0]);x=Uf(b,v,o,m,f,c,l,d,w,g);break}default:throw new Error(`Unsupported type ${a.dtype}`)}return t.makeTensorInfo(o,x.dtype,x.values)}const Ase={kernelName:Gx,backendName:"cpu",kernelFunc:Tse};function Ise(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{numOrSizeSplits:a,axis:i}=s,o=vn(i,r.shape)[0],l=R3(r,a,o),c=new Array(r.shape.length).fill(0),f=r.shape.slice();return l.map(d=>{const m=[...f];m[o]=d;const g=ld({inputs:{x:r},backend:t,attrs:{begin:c,size:m}});return c[o]+=d,g})}const Ese={kernelName:M0,backendName:"cpu",kernelFunc:Ise};const _se={kernelName:qx,backendName:"cpu",kernelFunc:({inputs:n,backend:e})=>{const{x:t}=n,s=e;Ct(t,"square");const r=s.data.get(t.dataId).values,a=new Float32Array(r.length);for(let o=0;o<r.length;++o){const l=r[o];a[o]=l*l}return{dataId:s.write(a,t.shape,t.dtype),shape:t.shape,dtype:t.dtype}}};const $se=Qn(Ym,(n,e)=>{const t=e;return isNaN(n)?NaN:n>0?1:t.alpha}),Rse={kernelName:Ym,backendName:"cpu",kernelFunc:$se};function Dse(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{begin:a,end:i,strides:o,beginMask:l,endMask:c,ellipsisMask:f,newAxisMask:d,shrinkAxisMask:m}=s;Ct(r,"stridedSlice");const{finalShapeSparse:g,finalShape:b,isIdentity:x,sliceDim0:v,isSimpleSlice:w,begin:k,end:I,strides:A}=d3(r.shape,a,i,o,l,c,f,d,m);let R;if(x)R=Ss({inputs:{x:r},backend:t,attrs:{shape:b}});else if(v||w){Z(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const U=c3(k,I,A),V=ld({inputs:{x:r},backend:t,attrs:{begin:k,size:U}});R=Ss({inputs:{x:V},backend:t,attrs:{shape:b}}),t.disposeIntermediateTensorInfo(V)}else{const U=t.bufferSync(r),V=b6(g,U,A,k);R=t.makeTensorInfo(b,V.dtype,V.values)}return R}const Ose={kernelName:Hx,backendName:"cpu",kernelFunc:Dse};function Lse(n){const{inputs:e,backend:t,attrs:s}=n,{separator:r,nGramWidths:a,leftPad:i,rightPad:o,padWidth:l,preserveShortSequences:c}=s,{data:f,dataSplits:d}=e,m=t.data.get(f.dataId).values,g=t.data.get(d.dataId).values,[b,x]=x6(m,g,r,a,i,o,l,c);return[t.makeTensorInfo([b.length],"string",b),t.makeTensorInfo(d.shape,"int32",x)]}const Fse={kernelName:Kx,backendName:"cpu",kernelFunc:Lse};function Mse(n){const{inputs:e,backend:t,attrs:s}=n,{skipEmpty:r}=s,{input:a,delimiter:i}=e;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(a.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${a.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);const o=t.data.get(a.dataId).values,l=t.data.get(i.dataId).values[0],[c,f,d]=v6(o,l,r),m=f.length;return[t.makeTensorInfo([m,2],"int32",c),t.makeTensorInfo([m],"string",f),t.makeTensorInfo([2],"int32",new Int32Array(d))]}const zse={kernelName:Xx,backendName:"cpu",kernelFunc:Mse};function Pse(n){const{inputs:e,backend:t,attrs:s}=n,{numBuckets:r}=s,{input:a}=e;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const i=t.data.get(a.dataId).values,o=w6(i,r);return t.makeTensorInfo(a.shape,"int32",o)}const Bse={kernelName:Yx,backendName:"cpu",kernelFunc:Pse};const Use=Qn(Hm,n=>Math.tan(n)),Vse={kernelName:Hm,backendName:"cpu",kernelFunc:Use};const jse=Qn(Km,n=>Math.tanh(n)),Wse={kernelName:Km,backendName:"cpu",kernelFunc:jse};function Gse(n){const{inputs:e,backend:t}=n,{tensor:s,indices:r,updates:a}=e,{sliceRank:i,numUpdates:o,sliceSize:l,strides:c,outputSize:f}=Gh(a,r,s.shape),d=!1,m=t.bufferSync(r),g=t.bufferSync(a),b=t.bufferSync(s),x=Uf(m,g,s.shape,f,l,o,i,c,b,d);return t.makeTensorInfo(s.shape,x.dtype,x.values)}const qse={kernelName:Px,backendName:"cpu",kernelFunc:Gse};function Hse(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{reps:a}=s;Ct(r,"tile");const i=N6(t.bufferSync(r),a);return t.makeTensorInfo(i.shape,i.dtype,i.values)}const Kse={kernelName:Xm,backendName:"cpu",kernelFunc:Hse};function Xse(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{k:a,sorted:i}=s;Ct(r,"topk");const o=t.data.get(r.dataId).values,[l,c]=C6(o,r.shape,r.dtype,a,i);return[t.makeTensorInfo(l.shape,l.dtype,l.values),t.makeTensorInfo(c.shape,c.dtype,c.values)]}const Yse={kernelName:Zx,backendName:"cpu",kernelFunc:Xse};function Zse(n){const{inputs:e,attrs:t,backend:s}=n,{image:r,transforms:a}=e,{interpolation:i,fillMode:o,fillValue:l,outputShape:c}=t,[f,d,m,g]=r.shape,[b,x]=c??[d,m],v=[f,b,x,g],w=Ot(r.shape),k=w[0],I=w[1],A=w[2],R=Ot(v),U=R[0],V=R[1],P=R[2],D=Kr(r.dtype,Be(v));D.fill(l);const B=s.data.get(r.dataId).values,E=s.data.get(a.dataId).values;for(let K=0;K<f;++K){const X=a.shape[0]===1?E:E.subarray(K*8,K*8+8);for(let ae=0;ae<b;++ae)for(let W=0;W<x;++W)for(let se=0;se<g;++se){let ee;const ce=X[6]*W+X[7]*ae+1;if(ce===0)continue;const ye=(X[0]*W+X[1]*ae+X[2])/ce,G=(X[3]*W+X[4]*ae+X[5])/ce,O=wE(ye,m,o),j=wE(G,d,o);switch(i){case"nearest":ee=sre(B,d,m,k,I,A,K,j,O,se,l);break;case"bilinear":ee=rre(B,d,m,k,I,A,K,j,O,se,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${i}`)}const Y=K*U+ae*V+W*P+se;D[Y]=ee}return s.makeTensorInfo(v,r.dtype,D)}return{dataId:s.write(D,v,r.dtype),shape:r.shape,dtype:r.dtype}}const Jse={kernelName:Jx,backendName:"cpu",kernelFunc:Zse};function wE(n,e,t){switch(t){case"reflect":return Qse(n,e);case"wrap":return ere(n,e);case"nearest":return nre(n,e);case"constant":default:return tre(n)}}function Qse(n,e){let t=n;if(t<0)if(e<=1)t=0;else{const s=2*e;t<s&&(t=s*Math.trunc(-t/s)+t),t=t<-e?t+s:-t-1}else if(t>e-1)if(e<=1)t=0;else{const s=2*e;t-=s*Math.trunc(t/s),t>=e&&(t=s-t-1)}return Ch(0,t,e-1)}function ere(n,e){let t=n;if(t<0)if(e<=1)t=0;else{const s=e-1;t+=e*(Math.trunc(-t/s)+1)}else if(t>e-1)if(e<=1)t=0;else{const s=e-1;t-=e*Math.trunc(t/s)}return Ch(0,t,e-1)}function tre(n,e){return n}function nre(n,e){return Ch(0,n,e-1)}function u1(n,e,t,s,r,a,i,o,l,c,f){const d=i*s+o*r+l*a+c;return 0<=o&&o<e&&0<=l&&l<t?n[d]:f}function sre(n,e,t,s,r,a,i,o,l,c,f){const d=Math.round(o),m=Math.round(l);return u1(n,e,t,s,r,a,i,d,m,c,f)}function rre(n,e,t,s,r,a,i,o,l,c,f){const d=Math.floor(o),m=Math.floor(l),g=d+1,b=m+1,x=(b-l)*u1(n,e,t,s,r,a,i,d,m,c,f)+(l-m)*u1(n,e,t,s,r,a,i,d,b,c,f),v=(b-l)*u1(n,e,t,s,r,a,i,g,m,c,f)+(l-m)*u1(n,e,t,s,r,a,i,g,b,c,f);return(g-o)*x+(o-d)*v}function are(n){const{inputs:e,attrs:t,backend:s}=n,{axis:r}=t,{x:a}=e;Ct(a,"unique");const i=s.data.get(a.dataId).values,{outputValues:o,outputShape:l,indices:c}=T6(i,r,a.shape,a.dtype);return[s.makeTensorInfo(l,a.dtype,o),s.makeTensorInfo([c.length],"int32",c)]}const ire={kernelName:Qx,backendName:"cpu",kernelFunc:are};function ore(n){const{inputs:e,backend:t,attrs:s}=n,{value:r}=e;let{axis:a}=s;a<0&&(a+=r.shape.length);const i=r.shape.length,o=r.shape[a],l=new Array(i-1);let c=0;for(let g=0;g<i;g++)g!==a&&(l[c++]=r.shape[g]);const f=new Array(i).fill(0),d=r.shape.slice();d[a]=1;const m=new Array(o);for(let g=0;g<m.length;g++){f[a]=g;const b=ld({inputs:{x:r},backend:t,attrs:{begin:f,size:d}});m[g]=Ss({inputs:{x:b},backend:t,attrs:{shape:l}}),t.disposeIntermediateTensorInfo(b)}return m}const lre={kernelName:B0,backendName:"cpu",kernelFunc:ore};function ure(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,segmentIds:a}=e,{numSegments:i}=s;Ct(r,"unsortedSegmentSum");const o=r.shape.length,l=a.shape.length,c=[],f=[],d=o-l;let m=a;for(let b=0;b<d;++b){const x=Lb({inputs:{input:m},backend:t,attrs:{dim:b+1}});m=x,f.push(x)}for(let b=0;b<i;++b){const x=kc(b,"int32"),v=t.makeTensorInfo([],"int32",x),w=UL({inputs:{a:v,b:m},backend:t}),k=Fh({inputs:{x:w},backend:t,attrs:{dtype:"float32"}}),I=nw({inputs:{a:k,b:r},backend:t}),A=xy({inputs:{x:I},backend:t,attrs:{axis:0,keepDims:!1}});c.push(A),f.push(v),f.push(w),f.push(k),f.push(I),f.push(A)}const g=U6({inputs:c,backend:t,attrs:{axis:0}});return f.forEach(b=>t.disposeIntermediateTensorInfo(b)),g}const cre={kernelName:U0,backendName:"cpu",kernelFunc:ure};const hre=[aQ,PZ,oQ,uQ,GZ,hQ,dQ,mQ,yQ,xQ,wQ,NQ,CQ,IQ,_Q,DQ,LQ,MQ,PQ,sQ,UQ,jQ,GQ,HZ,HQ,jZ,XZ,XQ,BZ,ZQ,QQ,eee,nee,ree,iee,lee,cee,fee,pee,gee,bee,vee,See,kee,Cee,Aee,Eee,$ee,Ree,Dee,Oee,Fee,Pee,YJ,Uee,YZ,Xee,ZZ,Yee,QZ,nte,ste,ate,tJ,sJ,ote,ute,hte,dte,aJ,oJ,UZ,mte,JQ,yte,xte,wte,ZJ,uJ,hJ,Nte,dJ,Cte,Ite,_te,Dte,Lte,Mte,zte,mJ,Bte,Vte,Wte,qte,Kte,Yte,Jte,yJ,ene,sne,ine,xJ,wJ,une,fne,mne,NJ,yne,xne,vne,V6,kne,QJ,TJ,Tne,Ine,_ne,Rne,VZ,cN,One,eQ,tQ,nQ,Fne,zne,Bne,Vne,Wne,Gne,Hne,OJ,Xne,ese,nse,ise,FJ,lse,cse,fse,MJ,rne,mse,yse,xse,wse,Nse,Cse,Ase,Ese,BJ,_se,VJ,WJ,Rse,Ose,Fse,zse,Bse,KJ,Mee,Vse,Wse,qse,Kse,Yse,Jse,kJ,ire,lre,cre,bne];for(const n of hre)tv(n);const zf={},T2={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function fre(n,e){zf[n]=e}function Fl(n,e){if(!(n in zf)||e!=null){const s=pre(n,e);if(s!==null)zf[n]=s;else return console.log("Could not get context for WebGL version",n),null}const t=zf[n];return t==null||t.isContextLost()?(delete zf[n],Fl(n)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),zf[n])}function dre(n){if(!De().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&n===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function pre(n,e){if(n!==1&&n!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const t=e??dre(n);return t.addEventListener("webglcontextlost",s=>{s.preventDefault(),delete zf[n]},!1),De().getBool("SOFTWARE_WEBGL_ENABLED")&&(T2.failIfMajorPerformanceCaveat=!1),n===1?t.getContext("webgl",T2)||t.getContext("experimental-webgl",T2):t.getContext("webgl2",T2)}var $1;(function(n){n[n.DENSE=0]="DENSE",n[n.SHARED_BATCH=1]="SHARED_BATCH"})($1||($1={}));var uo;(function(n){n[n.RENDER=0]="RENDER",n[n.UPLOAD=1]="UPLOAD",n[n.PIXELS=2]="PIXELS",n[n.DOWNLOAD=3]="DOWNLOAD"})(uo||(uo={}));var la;(function(n){n[n.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",n[n.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",n[n.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",n[n.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",n[n.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(la||(la={}));function vy(n,e){return[e,n]}function mre(n,e){return n*e}function A2(n){const e=Be(n),t=Math.ceil(e/4);return hb(t)}function ig(n,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(n/2))]}function gre(n,e){const[t,s]=ig(n,e);return t*s*4}function fC(n,e){const t=n;let s,r,a,i,o,l,c,f,d,m;return De().getNumber("WEBGL_VERSION")===2?(s=t.R32F,r=t.R16F,a=t.RGBA16F,i=t.RGBA32F,o=t.RED,c=4,f=1,d=t.HALF_FLOAT,m=t.FLOAT,l=t.RGBA8):(s=n.RGBA,r=n.RGBA,a=n.RGBA,i=t.RGBA,o=n.RGBA,c=4,f=4,d=e!=null?e.HALF_FLOAT_OES:null,m=n.FLOAT,l=n.RGBA),{internalFormatFloat:s,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:i,textureFormatFloat:o,downloadTextureFormat:l,downloadUnpackNumChannels:c,defaultNumChannels:f,textureTypeHalfFloat:d,textureTypeFloat:m}}function pt(n,e){const t=e();return De().getBool("DEBUG")&&yre(n),t}function yre(n){const e=n.getError();if(e!==n.NO_ERROR)throw new Error("WebGL Error: "+wre(n,e))}const bre=596e-10,xre=65504;function vre(n){return!!(De().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||n===0||bre<Math.abs(n)&&Math.abs(n)<xre)}function wre(n,e){switch(e){case n.NO_ERROR:return"NO_ERROR";case n.INVALID_ENUM:return"INVALID_ENUM";case n.INVALID_VALUE:return"INVALID_VALUE";case n.INVALID_OPERATION:return"INVALID_OPERATION";case n.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case n.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case n.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function I2(n,e){return Rc(n,()=>n.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function Sre(n,e){const t=Rc(n,()=>n.createShader(n.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(pt(n,()=>n.shaderSource(t,e)),pt(n,()=>n.compileShader(t)),n.getShaderParameter(t,n.COMPILE_STATUS)===!1)throw console.log(n.getShaderInfoLog(t)),new Error("Failed to compile vertex shader.");return t}function Nre(n,e){const t=Rc(n,()=>n.createShader(n.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(pt(n,()=>n.shaderSource(t,e)),pt(n,()=>n.compileShader(t)),De().get("ENGINE_COMPILE_ONLY"))return t;if(n.getShaderParameter(t,n.COMPILE_STATUS)===!1)throw j6(e,n.getShaderInfoLog(t)),new Error("Failed to compile fragment shader.");return t}const kre=/ERROR: [0-9]+:([0-9]+):/g;function j6(n,e){const t=kre.exec(e);if(t==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(n);return}const s=+t[1],r=n.split(`
`),a=r.length.toString().length+2,i=r.map((d,m)=>jf((m+1).toString(),a)+d);let o=0;for(let d=0;d<i.length;d++)o=Math.max(i[d].length,o);const l=i.slice(0,s-1),c=i.slice(s-1,s),f=i.slice(s);console.log(l.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${jf(c[0],o)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(f.join(`
`))}function Cre(n){return Rc(n,()=>n.createProgram(),"Unable to create WebGLProgram.")}function Tre(n,e){if(pt(n,()=>n.linkProgram(e)),!De().get("ENGINE_COMPILE_ONLY")&&n.getProgramParameter(e,n.LINK_STATUS)===!1)throw console.log(n.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function W5(n,e){if(pt(n,()=>n.validateProgram(e)),n.getProgramParameter(e,n.VALIDATE_STATUS)===!1)throw console.log(n.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function Are(n,e){const t=Rc(n,()=>n.createBuffer(),"Unable to create WebGLBuffer");return pt(n,()=>n.bindBuffer(n.ARRAY_BUFFER,t)),pt(n,()=>n.bufferData(n.ARRAY_BUFFER,e,n.STATIC_DRAW)),t}function Ire(n,e){const t=Rc(n,()=>n.createBuffer(),"Unable to create WebGLBuffer");return pt(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t)),pt(n,()=>n.bufferData(n.ELEMENT_ARRAY_BUFFER,e,n.STATIC_DRAW)),t}function Ere(n){return Rc(n,()=>n.createTexture(),"Unable to create WebGLTexture.")}function _re(n,e){const t=De().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(n<=0||e<=0){const s=`[${n}x${e}]`;throw new Error("Requested texture size "+s+" is invalid.")}if(n>t||e>t){const s=`[${n}x${e}]`,r=`[${t}x${t}]`;throw new Error("Requested texture size "+s+" greater than WebGL maximum on this browser / GPU "+r+".")}}function $re(n){return Rc(n,()=>n.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function SE(n,e,t,s,r,a,i){const o=n.getAttribLocation(e,t);return o===-1?!1:(pt(n,()=>n.bindBuffer(n.ARRAY_BUFFER,s)),pt(n,()=>n.vertexAttribPointer(o,r,n.FLOAT,!1,a,i)),pt(n,()=>n.enableVertexAttribArray(o)),!0)}function Rre(n,e,t){Mre(n,t),pt(n,()=>n.activeTexture(n.TEXTURE0+t)),pt(n,()=>n.bindTexture(n.TEXTURE_2D,e))}function Dre(n,e,t){return Rc(n,()=>n.getUniformLocation(e,t),'uniform "'+t+'" not present in program.')}function Ore(n,e,t){return n.getUniformLocation(e,t)}function Lre(n,e,t,s){pt(n,()=>Rre(n,e,s)),pt(n,()=>n.uniform1i(t,s))}function G5(n,e,t){pt(n,()=>n.bindFramebuffer(n.FRAMEBUFFER,t)),pt(n,()=>n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e,0))}function NE(n,e){pt(n,()=>n.bindFramebuffer(n.FRAMEBUFFER,e)),pt(n,()=>n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,null,0))}function E2(n){const e=n.checkFramebufferStatus(n.FRAMEBUFFER);if(e!==n.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+Fre(n,e))}function Fre(n,e){switch(e){case n.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case n.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function Rc(n,e,t){const s=pt(n,()=>e());if(s==null)throw new Error(t);return s}function Mre(n,e){const t=n.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,s=e+n.TEXTURE0;if(s<n.TEXTURE0||s>t){const r=`[gl.TEXTURE0, gl.TEXTURE${t}]`;throw new Error(`textureUnit must be in ${r}.`)}}function Jp(n,e=2){return Be(n.slice(0,n.length-e))}function Qp(n){if(n.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[n.length>1?n[n.length-2]:1,n[n.length-1]]}function _2(n){let e=[1,1,1];return n.length===0||n.length===1&&n[0]===1||(e=[Jp(n),...Qp(n)]),e}function zre(n,e=!1){let t=De().getNumber("WEBGL_MAX_TEXTURE_SIZE"),s=De().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");s===1/0&&De().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(s=t/2),e&&(t=t*2,s=s*2,n=n.map((o,l)=>l>=n.length-2?Kb(n[l]):n[l]),n.length===1&&(n=[2,n[0]])),n.length!==2&&(n=Nc(n).newShape);let r=Be(n),a=null;n.length<=1&&r<=t?a=[1,r]:n.length===2&&n[0]<=t&&n[1]<=t?a=n:n.length===3&&n[0]*n[1]<=t&&n[2]<=t?a=[n[0]*n[1],n[2]]:n.length===3&&n[0]<=t&&n[1]*n[2]<=t?a=[n[0],n[1]*n[2]]:n.length===4&&n[0]*n[1]*n[2]<=t&&n[3]<=t?a=[n[0]*n[1]*n[2],n[3]]:n.length===4&&n[0]<=t&&n[1]*n[2]*n[3]<=t&&(a=[n[0],n[1]*n[2]*n[3]]);const i=a!=null&&Math.max(...a)>s&&Math.min(...a)<=(e?2:1)&&Math.min(...a)>0;if(a==null||i)if(e){const o=Jp(n);let l=2,c=2;n.length&&([l,c]=Qp(n)),r=o*(l/2)*(c/2),a=hb(r).map(f=>f*2)}else a=hb(r);return a}function $2(n){return n%2===0}function Mb(n,e){if(n=n.slice(-2),e=e.slice(-2),Nn(n,e)||!n.length||!e.length||n[0]===0||n[1]===0||e[0]===0||e[1]===0)return!0;if(n.length!==e.length){const t=n[n.length-1],s=e[e.length-1];if(t===s||$2(t)&&$2(s)&&(n[0]===1||e[0]===1))return!0}return n[1]===e[1]&&$2(n[0])&&$2(e[0])}let q5,H5;function Pre(n){if(q5==null){const e=Fl(n);q5=e.getParameter(e.MAX_TEXTURE_SIZE)}return q5}function Bre(n){if(H5==null){const e=Fl(n);H5=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,H5)}function Ure(n){if(n===0)return 0;let e;const t=Fl(n);return Vo(t,"EXT_disjoint_timer_query_webgl2")&&n===2?e=2:Vo(t,"EXT_disjoint_timer_query")?e=1:e=0,e}function Vo(n,e){return n.getExtension(e)!=null}function kE(n){try{if(Fl(n)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function Vre(n){if(n===0)return!1;const e=Fl(n);if(n===1){if(!Vo(e,"OES_texture_float"))return!1}else if(!Vo(e,"EXT_color_buffer_float"))return!1;return fN(e)}function jre(n){if(n===0)return!1;const e=Fl(n);if(n===1){if(!Vo(e,"OES_texture_float")||!Vo(e,"WEBGL_color_buffer_float"))return!1}else{if(Vo(e,"EXT_color_buffer_float"))return fN(e);const s="EXT_color_buffer_half_float";if(Vo(e,s)){const r=e.getExtension(s);return Wre(e,r)}return!1}return fN(e)}function fN(n){const e=fC(n),t=n.createTexture();n.bindTexture(n.TEXTURE_2D,t),n.texImage2D(n.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const a=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,a),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,t,0);const i=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(t),n.deleteFramebuffer(a),i}function Wre(n,e){const t=fC(n,e),s=n.createTexture();n.bindTexture(n.TEXTURE_2D,s),n.texImage2D(n.TEXTURE_2D,0,t.internalFormatHalfFloat,1,1,0,t.textureFormatFloat,t.textureTypeHalfFloat,null);const i=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,i),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,s,0);const o=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(s),n.deleteFramebuffer(i),o}function Gre(n){return n!==2?!1:Fl(n).fenceSync!=null}function wy(n,e){Array.isArray(n)||(n=[n]),n.forEach(t=>{t!=null&&Z(t.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}const Et=De();Et.registerFlag("HAS_WEBGL",()=>Et.getNumber("WEBGL_VERSION")>0);Et.registerFlag("WEBGL_VERSION",()=>kE(2)?2:kE(1)?1:0);Et.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);Et.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>Et.get("WEBGL_VERSION")===2);Et.registerFlag("WEBGL_CPU_FORWARD",()=>!0);Et.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);Et.registerFlag("WEBGL_PACK",()=>Et.getBool("HAS_WEBGL"));Et.registerFlag("WEBGL_PACK_NORMALIZATION",()=>Et.getBool("WEBGL_PACK"));Et.registerFlag("WEBGL_PACK_CLIP",()=>Et.getBool("WEBGL_PACK"));Et.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>Et.getBool("WEBGL_PACK"));Et.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>Et.getBool("WEBGL_PACK"));Et.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>Et.getBool("WEBGL_PACK"));Et.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>Et.getBool("WEBGL_PACK"));Et.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>Et.getBool("WEBGL_PACK"));Et.registerFlag("WEBGL_PACK_REDUCE",()=>Et.getBool("WEBGL_PACK"));Et.registerFlag("WEBGL_LAZILY_UNPACK",()=>Et.getBool("WEBGL_PACK"));Et.registerFlag("WEBGL_CONV_IM2COL",()=>Et.getBool("WEBGL_PACK"));Et.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>Et.getBool("WEBGL_PACK"));Et.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>Pre(Et.getNumber("WEBGL_VERSION")));Et.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>Bre(Et.getNumber("WEBGL_VERSION")));Et.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const n=Et.getNumber("WEBGL_VERSION");return n===0?0:Ure(n)});Et.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>Et.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!VN());Et.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>Vre(Et.getNumber("WEBGL_VERSION")));Et.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>Et.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:Et.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));Et.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>jre(Et.getNumber("WEBGL_VERSION")));Et.registerFlag("WEBGL_FENCE_API_ENABLED",()=>Gre(Et.getNumber("WEBGL_VERSION")));Et.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>Et.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);Et.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,n=>{if(typeof n!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${n}.`);if(n<0&&n!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${n}.`)});Et.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>VN()?1:-1,n=>{if(typeof n!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${n}.`);if(n<0&&n!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${n}.`)});Et.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);Et.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);Et.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);Et.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);Et.registerFlag("WEBGL_EXP_CONV",()=>!1);Et.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>Et.getBool("IS_TEST"));Et.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);Et.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);Et.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);Et.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);function Wa(){let n,e,t,s,r,a,i,o,l,c;return De().getNumber("WEBGL_VERSION")===2?(n="#version 300 es",e="in",t="out",s="in",r="texture",a="outputColor",i="out vec4 outputColor;",o=De().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",c=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(n="",e="attribute",t="varying",s="varying",r="texture2D",a="gl_FragColor",i="",o=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,c=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:n,attribute:e,varyingVs:t,varyingFs:s,texture2D:r,output:a,defineOutput:i,defineSpecialNaN:o,defineSpecialInf:l,defineRound:c}}function Nd(n,e,t="index"){const s=Ot(e);return s.map((r,a)=>{const i=`int ${n[a]} = ${t} / ${r}`,o=a===s.length-1?`int ${n[a+1]} = ${t} - ${n[a]} * ${r}`:`index -= ${n[a]} * ${r}`;return`${i}; ${o};`}).join("")}function sw(n,e,t="index"){const s=Ot(e);return s.map((r,a)=>{const i=`int ${n[a]} = ${t} / outShapeStrides[${a}]`,o=a===s.length-1?`int ${n[a+1]} = ${t} - ${n[a]} * outShapeStrides[${a}]`:`index -= ${n[a]} * outShapeStrides[${a}]`;return`${i}; ${o};`}).join("")}function qre(n,e){const t=n.length,s=n.map(a=>`${e}[${a}]`),r=new Array(t-1);r[t-2]=s[t-1];for(let a=t-3;a>=0;--a)r[a]=`(${r[a+1]} * ${s[a+1]})`;return r}function Hre(n,e,t="index"){const s=n.map((a,i)=>i),r=qre(s,e);return r.map((a,i)=>{const o=`int ${n[i]} = ${t} / ${r[i]}`,l=i===r.length-1?`int ${n[i+1]} = ${t} - ${n[i]} * ${r[i]}`:`index -= ${n[i]} * ${r[i]}`;return`${o}; ${l};`}).join("")}function dC(n){const e=Ot(n).map(t=>t.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function pC(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const W6=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;const{getBroadcastDims:G6}=fD;function Kre(n,e,t){const s=[];if(n.forEach(g=>{const b=Be(g.shapeInfo.logicalShape);if(g.shapeInfo.isUniform?s.push(`uniform float ${g.name}${b>1?`[${b}]`:""};`):(s.push(`uniform sampler2D ${g.name};`),s.push(`uniform int offset${g.name};`)),t.enableShapeUniforms){const{uniformShape:x}=mC(t.packedInputs,g.shapeInfo.logicalShape,g.shapeInfo.texShape);switch(x.length){case 1:s.push(`uniform int ${g.name}Shape;`);break;case 2:s.push(`uniform ivec2 ${g.name}Shape;`);break;case 3:s.push(`uniform ivec3 ${g.name}Shape;`);break;case 4:s.push(`uniform ivec4 ${g.name}Shape;`);break}s.push(`uniform ivec2 ${g.name}TexShape;`)}}),t.enableShapeUniforms){switch(e.logicalShape.length){case 1:s.push("uniform int outShape;");break;case 2:s.push("uniform ivec2 outShape;"),s.push("uniform int outShapeStrides;");break;case 3:s.push("uniform ivec3 outShape;"),s.push("uniform ivec2 outShapeStrides;");break;case 4:s.push("uniform ivec4 outShape;"),s.push("uniform ivec3 outShapeStrides;");break}s.push("uniform ivec2 outTexShape;")}t.customUniforms&&t.customUniforms.forEach(g=>{s.push(`uniform ${g.type} ${g.name}${g.arrayIndex?`[${g.arrayIndex}]`:""};`)});const r=s.join(`
`),a=n.map(g=>Xre(g,e,t.packedInputs,t.enableShapeUniforms)).join(`
`),i=e.texShape,o=Wa(),l=Jre(o);let c,f,d=tae(o);return e.isPacked?(c=Yre(e.logicalShape,i,t.enableShapeUniforms),f=eae(o)):(c=Zre(e.logicalShape,i,t.enableShapeUniforms),f=Qre(o)),t.packedInputs&&(d+=aae),[d,l,f,r,c,a,t.userCode].join(`
`)}function og(n,e=!1){const t=n.shapeInfo.logicalShape;switch(t.length){case 0:return yae(n,e);case 1:return xae(n,e);case 2:return wae(n,e);case 3:return Nae(n,e);case 4:return Cae(n,e);case 5:return Tae(n);case 6:return Aae(n);default:throw new Error(`${t.length}-D input sampling is not yet supported`)}}function q6(n,e){switch(n.shapeInfo.logicalShape.length){case 0:return gae(n);case 1:return bae(n,e);case 2:return vae(n,e);case 3:return Sae(n,e);default:return kae(n,e)}}function Xre(n,e,t=!1,s){let r="";t?r+=q6(n,s):r+=og(n,s);const a=n.shapeInfo.logicalShape,i=e.logicalShape;return a.length<=i.length&&(t?r+=Iae(n,e):r+=Eae(n,e)),r}function Yre(n,e,t){switch(n.length){case 0:return H6();case 1:return iae(n,e,t);case 2:return pae(n,e,t);case 3:return lae(n,e,t);default:return cae(n,e,t)}}function Zre(n,e,t){switch(n.length){case 0:return H6();case 1:return oae(n,e,t);case 2:return mae(n,e,t);case 3:return uae(n,e,t);case 4:return hae(n,e,t);case 5:return fae(n,e);case 6:return dae(n,e);default:throw new Error(`${n.length}-D output sampling is not yet supported`)}}function Jre(n){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${n.texture2D}(textureSampler, uv).r;
    }
  `}function Qre(n){return`
    void setOutput(float val) {
      ${n.output} = vec4(val, 0, 0, 0);
    }
  `}function eae(n){return`
    void setOutput(vec4 val) {
      ${n.output} = val;
    }
  `}function tae(n){return`${n.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${n.varyingFs} vec2 resultUV;
    ${n.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${n.defineSpecialNaN}
    ${n.defineSpecialInf}
    ${n.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${nae}
    ${sae}
    ${rae}
  `}const nae=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,sae=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,rae=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,aae=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function H6(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function iae(n,e,t){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return s[0]===1?t?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${s[1]}.0);
      }
    `:s[1]===1?t?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${s[0]}.0);
      }
    `:t?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      return 2 * (resTexRC.x * ${s[1]} + resTexRC.y);
    }
  `}function oae(n,e,t){return e[0]===1?t?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?t?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:t?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function lae(n,e,t){if(t)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(n[2]/2),a=r*Math.ceil(n[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      int b = index / ${a};
      index -= b * ${a};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec3(b, r, c);
    }
  `}function uae(n,e,t){if(t)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${sw(["r","c","d"],n)}
    return ivec3(r, c, d);
  }
`;const s=Nd(["r","c","d"],n);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec3(r, c, d);
    }
  `}function cae(n,e,t){if(t)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(n[n.length-1]/2),a=r*Math.ceil(n[n.length-2]/2);let i=a,o="",l="b, r, c";for(let c=2;c<n.length-1;c++)i*=n[n.length-c-1],o=`
      int b${c} = index / ${i};
      index -= b${c} * ${i};
    `+o,l=`b${c}, `+l;return`
    ivec${n.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      ${o}

      int b = index / ${a};
      index -= b * ${a};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec${n.length}(${l});
    }
  `}function hae(n,e,t){if(t)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${sw(["r","c","d","d2"],n)}
      return ivec4(r, c, d, d2);
    }
  `;const s=Nd(["r","c","d","d2"],n);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec4(r, c, d, d2);
    }
  `}function fae(n,e){const t=Nd(["r","c","d","d2","d3"],n);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${t}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function dae(n,e){const t=Nd(["r","c","d","d2","d3","d4"],n);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${t}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function pae(n,e,t){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(Nn(n,e))return t?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${s[0]}, ${s[1]}));
      }
    `;const r=Math.ceil(n[1]/2);return t?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));

      int index = resTexRC.x * ${s[1]} + resTexRC.y;
      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec2(r, c);
    }
  `}function mae(n,e,t){return Nn(n,e)?t?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:n[1]===1?t?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:n[0]===1?t?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:t?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${n[1]};
      int c = index - r * ${n[1]};
      return ivec2(r, c);
    }
  `}function kd(n){return`offset${n}`}function gae(n){const e=n.name,t="get"+e.charAt(0).toUpperCase()+e.slice(1),s=Wa();return`
    vec4 ${t}() {
      return ${s.texture2D}(${e}, halfCR);
    }
  `}function yae(n,e){const t=n.name,s="get"+t.charAt(0).toUpperCase()+t.slice(1);if(n.shapeInfo.isUniform)return`float ${s}() {return ${t};}`;const[r,a]=n.shapeInfo.texShape;if(r===1&&a===1)return`
      float ${s}() {
        return sampleTexture(${t}, halfCR);
      }
    `;const i=kd(t);if(e)return`
    float ${s}() {
      vec2 uv = uvFromFlat(${t}TexShape[0], ${t}TexShape[1], ${i});
      return sampleTexture(${t}, uv);
    }
  `;const[o,l]=n.shapeInfo.texShape;return`
    float ${s}() {
      vec2 uv = uvFromFlat(${o}, ${l}, ${i});
      return sampleTexture(${t}, uv);
    }
  `}function bae(n,e){const t=n.name,s="get"+t.charAt(0).toUpperCase()+t.slice(1),r=n.shapeInfo.texShape,a=Wa();if(e)return`
    vec4 ${s}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${t}TexShape[0]) / 2.0), ceil(float(${t}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${a.texture2D}(${t}, uv);
    }
  `;const i=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)];return`
    vec4 ${s}(int index) {
      vec2 uv = packedUVfrom1D(
        ${i[0]}, ${i[1]}, index);
      return ${a.texture2D}(${t}, uv);
    }
  `}function xae(n,e){const t=n.name,s="get"+t.charAt(0).toUpperCase()+t.slice(1);if(n.shapeInfo.isUniform)return`
      float ${s}(int index) {
        ${lg(n)}
      }
    `;const r=n.shapeInfo.texShape,a=r[0],i=r[1];if(i===1&&a===1)return`
      float ${s}(int index) {
        return sampleTexture(${t}, halfCR);
      }
    `;const o=kd(t);return i===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${o}) + 0.5) / float(${t}TexShape[0]));
        return sampleTexture(${t}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${o}) + 0.5) / ${a}.0);
        return sampleTexture(${t}, uv);
      }
    `:a===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${o}) + 0.5) / float(${t}TexShape[1]), 0.5);
        return sampleTexture(${t}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${o}) + 0.5) / ${i}.0, 0.5);
        return sampleTexture(${t}, uv);
      }
    `:e?`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${t}TexShape[0], ${t}TexShape[1], index + ${o});
      return sampleTexture(${t}, uv);
    }
  `:`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${a}, ${i}, index + ${o});
      return sampleTexture(${t}, uv);
    }
  `}function vae(n,e){const t=n.shapeInfo.logicalShape,s=n.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),a=n.shapeInfo.texShape,i=a[0],o=a[1],l=Wa();if(a!=null&&Nn(t,a))return e?`
      vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);

        return ${l.texture2D}(${s}, uv);
      }
    `:`
      vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${o}.0, ${i}.0);

        return ${l.texture2D}(${s}, uv);
      }
    `;if(e)return`
    vec4 ${r}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `;const c=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],f=Math.ceil(t[1]/2);return`
    vec4 ${r}(int row, int col) {
      vec2 uv = packedUVfrom2D(${f}, ${c[0]}, ${c[1]}, row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `}function wae(n,e){const t=n.shapeInfo.logicalShape,s=n.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),a=n.shapeInfo.texShape;if(a!=null&&Nn(t,a)){if(e)return`
      float ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `;const m=a[0],g=a[1];return`
    float ${r}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${g}.0, ${m}.0);
      return sampleTexture(${s}, uv);
    }
  `}const{newShape:i,keptDims:o}=Nc(t),l=i;if(l.length<t.length){const m=ug(n,l),g=["row","col"];return`
      ${og(m,e)}
      float ${r}(int row, int col) {
        return ${r}(${cg(g,o)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${r}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${t[1]}, 1)));
        ${lg(n)}
      }
    `;const c=a[0],f=a[1],d=kd(s);return f===1?e?`
      float ${r}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${s}TexShape[0]));
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${t[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${c}.0);
      return sampleTexture(${s}, uv);
    }
  `:c===1?e?`
      float ${r}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${s}TexShape[1]), 0.5);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${t[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${f}.0, 0.5);
      return sampleTexture(${s}, uv);
    }
  `:e?`
      float ${r}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${s}Shape[1] + col + ${d};
        vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
        return sampleTexture(${s}, uv);
      }
    `:`
  float ${r}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${t[1]} + col + ${d};
    vec2 uv = uvFromFlat(${c}, ${f}, index);
    return sampleTexture(${s}, uv);
  }
`}function Sae(n,e){const t=n.shapeInfo.logicalShape,s=n.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),a=n.shapeInfo.texShape,i=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];if(t[0]===1){const m=t.slice(1),g=[1,2],b=ug(n,m),x=["b","row","col"];return`
        ${q6(b,e)}
        vec4 ${r}(int b, int row, int col) {
          return ${r}(${cg(x,g)});
        }
      `}const o=Wa();if(e)return`
    vec4 ${r}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${o.texture2D}(${s}, uv);
    }
  `;const l=i[0],c=i[1],f=Math.ceil(t[2]/2),d=f*Math.ceil(t[1]/2);return`
    vec4 ${r}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${c}, ${d}, ${f}, b, row, col);
      return ${o.texture2D}(${s}, uv);
    }
  `}function Nae(n,e){const t=n.shapeInfo.logicalShape,s=n.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),a=t[1]*t[2],i=t[2],{newShape:o,keptDims:l}=Nc(t),c=o;if(c.length<t.length){const x=ug(n,c),v=["row","col","depth"];return`
        ${og(x,e)}
        float ${r}(int row, int col, int depth) {
          return ${r}(${cg(v,l)});
        }
      `}if(n.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${a}, ${i}, 1)));
        ${lg(n)}
      }
    `;const f=n.shapeInfo.texShape,d=f[0],m=f[1],g=n.shapeInfo.flatOffset;if(m===a&&g==null)return e?`
      float ${r}(int row, int col, int depth) {
        int stride1 = ${s}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
        float ${r}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${i}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${m}.0, ${d}.0);
          return sampleTexture(${s}, uv);
        }
      `;if(m===i&&g==null)return e?`
      float ${r}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${s}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${t[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${m}.0, ${d}.0);
      return sampleTexture(${s}, uv);
    }
  `;const b=kd(s);return e?`
    float ${r}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${s}Shape[1] * ${s}Shape[2];
      int stride1 = ${s}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${b};
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
      return sampleTexture(${s}, uv);
    }
    `:`
      float ${r}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${a} + col * ${i} + depth + ${b};
        vec2 uv = uvFromFlat(${d}, ${m}, index);
        return sampleTexture(${s}, uv);
      }
  `}function kae(n,e){const t=n.name,s="get"+t.charAt(0).toUpperCase()+t.slice(1),r=Wa();if(e)return`
    vec4 ${s}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${t}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${t}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${t}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${t}TexShape[0]) / 2.0), ceil(float(${t}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${r.texture2D}(${t}, uv);
    }
  `;const a=n.shapeInfo.logicalShape,i=a.length,o=n.shapeInfo.texShape,l=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],c=l[0],f=l[1],d=Math.ceil(a[i-1]/2);let m=d*Math.ceil(a[i-2]/2),g="int b, int row, int col",b=`b * ${m} + (row / 2) * ${d} + (col / 2)`;for(let x=2;x<i-1;x++)g=`int b${x}, `+g,m*=a[i-x-1],b=`b${x} * ${m} + `+b;return`
    vec4 ${s}(${g}) {
      int index = ${b};
      int texR = index / ${f};
      int texC = index - texR * ${f};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${f}, ${c});
      return ${r.texture2D}(${t}, uv);
    }
  `}function Cae(n,e){const t=n.shapeInfo.logicalShape,s=n.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),a=t[3],i=t[2]*a,o=t[1]*i,{newShape:l,keptDims:c}=Nc(t);if(l.length<t.length){const k=ug(n,l),I=["row","col","depth","depth2"];return`
      ${og(k,e)}
      float ${r}(int row, int col, int depth, int depth2) {
        return ${r}(${cg(I,c)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${o}, ${i}, ${a}, 1)));
        ${lg(n)}
      }
    `;const f=n.shapeInfo.flatOffset,d=n.shapeInfo.texShape,m=d[0],g=d[1],b=`int stride2 = ${s}Shape[3];`,x=`int stride1 = ${s}Shape[2] * stride2;`,v=`int stride0 = ${s}Shape[1] * stride1;`;if(g===o&&f==null)return e?`
      float ${r}(int row, int col, int depth, int depth2) {
        ${b}
        ${x}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${i}, ${a}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${g}.0, ${m}.0);
        return sampleTexture(${s}, uv);
      }
    `;if(g===a&&f==null)return e?`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${s}Shape[1] * ${s}Shape[2], ${s}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${t[1]*t[2]}, ${t[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${g}.0, ${m}.0);
        return sampleTexture(${s}, uv);
      }
    `;const w=kd(s);return e?`
    float ${r}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${b}
      ${x}
      ${v}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index + ${w});
      return sampleTexture(${s}, uv);
    }
  `:`
    float ${r}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${o} + col * ${i} +
          depth * ${a} + depth2;
      vec2 uv = uvFromFlat(${m}, ${g}, index + ${w});
      return sampleTexture(${s}, uv);
    }
  `}function Tae(n){const e=n.shapeInfo.logicalShape,t=n.name,s="get"+t.charAt(0).toUpperCase()+t.slice(1),r=e[4],a=e[3]*r,i=e[2]*a,o=e[1]*i,{newShape:l,keptDims:c}=Nc(e);if(l.length<e.length){const x=ug(n,l),v=["row","col","depth","depth2","depth3"];return`
      ${og(x)}
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        return ${s}(${cg(v,c)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${o}, ${i}, ${a}, ${r})) +
          depth3;
        ${lg(n)}
      }
    `;const f=n.shapeInfo.flatOffset,d=n.shapeInfo.texShape,m=d[0],g=d[1];if(g===o&&f==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${i}, ${a}, ${r}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${g}.0, ${m}.0);
        return sampleTexture(${t}, uv);
      }
    `;if(g===r&&f==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${g}.0, ${m}.0);
        return sampleTexture(${t}, uv);
      }
    `;const b=kd(t);return`
    float ${s}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${o} + col * ${i} + depth * ${a} +
          depth2 * ${r} + depth3 + ${b};
      vec2 uv = uvFromFlat(${m}, ${g}, index);
      return sampleTexture(${t}, uv);
    }
  `}function Aae(n){const e=n.shapeInfo.logicalShape,t=n.name,s="get"+t.charAt(0).toUpperCase()+t.slice(1),{newShape:r,keptDims:a}=Nc(e);if(r.length<e.length){const v=ug(n,r),w=["row","col","depth","depth2","depth3","depth4"];return`
      ${og(v)}
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${s}(${cg(w,a)});
      }
    `}const i=e[5],o=e[4]*i,l=e[3]*o,c=e[2]*l,f=e[1]*c;if(n.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${f}, ${c}, ${l}, ${o})) +
          dot(
            vec2(depth3, depth4),
            vec2(${i}, 1)));
        ${lg(n)}
      }
    `;const d=n.shapeInfo.flatOffset,m=n.shapeInfo.texShape,g=m[0],b=m[1];if(b===f&&d==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${c}, ${l}, ${o}, ${i})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${b}.0, ${g}.0);
        return sampleTexture(${t}, uv);
      }
    `;if(b===i&&d==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${b}.0, ${g}.0);
        return sampleTexture(${t}, uv);
      }
    `;const x=kd(t);return`
    float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${f} + col * ${c} + depth * ${l} +
          depth2 * ${o} + depth3 * ${i} + depth4 + ${x};
      vec2 uv = uvFromFlat(${g}, ${b}, index);
      return sampleTexture(${t}, uv);
    }
  `}function lg(n){const e=n.name,t=Be(n.shapeInfo.logicalShape);return t<2?`return ${e};`:`
    for (int i = 0; i < ${t}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function Iae(n,e){const t=n.name,s=t.charAt(0).toUpperCase()+t.slice(1),r="get"+s+"AtOutCoords",a=n.shapeInfo.logicalShape.length,i=e.logicalShape.length,o=G6(n.shapeInfo.logicalShape,e.logicalShape),l=os(i),c=i-a;let f;const d=["x","y","z","w","u","v"];a===0?f="":i<2&&o.length>=1?f="coords = 0;":f=o.map(k=>`coords.${d[k+c]} = 0;`).join(`
`);let m="";i<2&&a>0?m="coords":m=n.shapeInfo.logicalShape.map((k,I)=>`coords.${d[I+c]}`).join(", ");let g="return outputValue;";const x=Be(n.shapeInfo.logicalShape)===1,w=Be(e.logicalShape)===1;if(a===1&&!x&&!w)g=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(x&&!w)i===1?g=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:g=`
        return vec4(outputValue.x);
      `;else if(o.length){const k=a-2,I=a-1;o.indexOf(k)>-1&&o.indexOf(I)>-1?g="return vec4(outputValue.x);":o.indexOf(k)>-1?g="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":o.indexOf(I)>-1&&(g="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${r}() {
      ${l} coords = getOutputCoords();
      ${f}
      vec4 outputValue = get${s}(${m});
      ${g}
    }
  `}function Eae(n,e){const t=n.name,s=t.charAt(0).toUpperCase()+t.slice(1),r="get"+s+"AtOutCoords",a=e.texShape,i=n.shapeInfo.texShape,o=n.shapeInfo.logicalShape.length,l=e.logicalShape.length;if(!n.shapeInfo.isUniform&&o===l&&n.shapeInfo.flatOffset==null&&Nn(i,a))return`
      float ${r}() {
        return sampleTexture(${t}, resultUV);
      }
    `;const c=os(l),f=G6(n.shapeInfo.logicalShape,e.logicalShape),d=l-o;let m;const g=["x","y","z","w","u","v"];o===0?m="":l<2&&f.length>=1?m="coords = 0;":m=f.map(x=>`coords.${g[x+d]} = 0;`).join(`
`);let b="";return l<2&&o>0?b="coords":b=n.shapeInfo.logicalShape.map((x,v)=>`coords.${g[v+d]}`).join(", "),`
    float ${r}() {
      ${c} coords = getOutputCoords();
      ${m}
      return get${s}(${b});
    }
  `}function os(n){if(n<=1)return"int";if(n===2)return"ivec2";if(n===3)return"ivec3";if(n===4)return"ivec4";if(n===5)return"ivec5";if(n===6)return"ivec6";throw Error(`GPU for rank ${n} is not yet supported`)}function mC(n,e,t){const{newShape:s,keptDims:r}=Nc(e),a=e.length,i=n&&a===3&&e[0]===1,o=i?e.slice(1):s,l=!n&&a>1&&!Nn(e,t)&&s.length<a||i;return{useSqueezeShape:l,uniformShape:l?o:e,keptDims:r}}function ug(n,e){const t=JSON.parse(JSON.stringify(n));return t.shapeInfo.logicalShape=e,t}function cg(n,e){return e.map(t=>n[t]).join(", ")}function _ae(n,e,t,s){const r=t.map((f,d)=>{const m={logicalShape:f.shape,texShape:f.isUniform?null:f.texData.texShape,isUniform:f.isUniform,isPacked:f.isUniform?!1:f.texData.isPacked,flatOffset:null};return f.texData!=null&&f.texData.slice!=null&&f.texData.slice.flatOffset>0&&(m.flatOffset=f.texData.slice.flatOffset),{name:e.variableNames[d],shapeInfo:m}}),a=r.map(f=>f.shapeInfo),i={logicalShape:s.shape,texShape:s.texData.texShape,isUniform:!1,isPacked:s.texData.isPacked,flatOffset:null},o=Kre(r,i,e),l=Nre(n.gl,o),c=n.createProgram(l);return De().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:l,source:o,webGLProgram:c,inShapeInfos:a,outShapeInfo:i,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(n.buildVao(c),Object.assign({program:e,fragmentShader:l,source:o,webGLProgram:c,inShapeInfos:a,outShapeInfo:i},K6(n,e,c)))}function K6(n,e,t){const s=[],r=[];let a,i,o,l=null,c=null;c=n.getUniformLocation(t,"NAN",!1),De().getNumber("WEBGL_VERSION")===1&&(l=n.getUniformLocation(t,"INFINITY",!1));const f=!1;for(const d of e.variableNames){const m={name:d,uniform:n.getUniformLocation(t,d,f),offset:n.getUniformLocation(t,`offset${d}`,f)};e.enableShapeUniforms&&(m.shape=n.getUniformLocation(t,`${d}Shape`,f),m.texShape=n.getUniformLocation(t,`${d}TexShape`,f)),s.push(m)}if(e.enableShapeUniforms&&(a=n.getUniformLocation(t,"outShape",f),o=n.getUniformLocation(t,"outShapeStrides",f),i=n.getUniformLocation(t,"outTexShape",f)),e.customUniforms)for(const d of e.customUniforms)r.push(n.getUniformLocation(t,d.name,f));return{variablesLocations:s,customUniformLocations:r,infLoc:l,nanLoc:c,outShapeLocation:a,outShapeStridesLocation:o,outTexShapeLocation:i}}function CE(n,e){if(n.length!==e.length)throw Error(`Binary was compiled with ${n.length} inputs, but was executed with ${e.length} inputs`);n.forEach((t,s)=>{const r=t.logicalShape,a=e[s],i=a.shape;if(!Nn(r,i))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${r} and ${i} must match`);if(t.isUniform&&a.isUniform)return;const o=t.texShape,l=a.isUniform?null:a.texData.texShape;if(!Nn(o,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${o} and ${l} must match`)})}function $ae(n,e,t,s,r){e.program.enableShapeUniforms||(CE(e.inShapeInfos,t),CE([e.outShapeInfo],[s]));const a=s.texData.texture,i=s.texData.texShape;s.texData.isPacked?n.setOutputPackedMatrixTexture(a.texture,i[0],i[1]):n.setOutputMatrixTexture(a.texture,i[0],i[1]),n.setProgram(e.webGLProgram),n.bindVertexArray(e.webGLProgram.vao),De().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&n.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&n.gl.uniform1f(e.nanLoc,NaN);for(let l=0;l<t.length;++l){const c=t[l],{uniform:f,offset:d,shape:m,texShape:g}=e.variablesLocations[l];if(m){const{uniformShape:b}=mC(e.program.packedInputs,c.shape,c.texData.texShape);switch(b.length){case 1:n.gl.uniform1iv(m,new Int32Array(b));break;case 2:n.gl.uniform2iv(m,new Int32Array(b));break;case 3:n.gl.uniform3iv(m,new Int32Array(b));break;case 4:n.gl.uniform4iv(m,new Int32Array(b));break}}if(g&&n.gl.uniform2i(g,c.texData.texShape[0],c.texData.texShape[1]),f!=null){if(c.isUniform){if(Be(c.shape)<2)n.gl.uniform1f(f,c.uniformValues[0]);else{let b=c.uniformValues;b instanceof Float32Array||(b=new Float32Array(b)),n.gl.uniform1fv(f,b)}continue}c.texData.slice!=null&&d!=null&&n.gl.uniform1i(d,c.texData.slice.flatOffset),n.setInputMatrixTexture(c.texData.texture.texture,f,l)}}const o=e.outShapeLocation;if(o)switch(s.shape.length){case 1:n.gl.uniform1iv(o,new Int32Array(s.shape));break;case 2:n.gl.uniform2iv(o,new Int32Array(s.shape));break;case 3:n.gl.uniform3iv(o,new Int32Array(s.shape));break;case 4:n.gl.uniform4iv(o,new Int32Array(s.shape));break}if(e.outShapeStridesLocation){const l=Ot(s.shape);switch(s.shape.length){case 2:n.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(l));break;case 3:n.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(l));break;case 4:n.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(l));break}}if(e.outTexShapeLocation&&n.gl.uniform2i(e.outTexShapeLocation,s.texData.texShape[0],s.texData.texShape[1]),e.program.customUniforms&&r)for(let l=0;l<e.program.customUniforms.length;++l){const c=e.program.customUniforms[l],f=e.customUniformLocations[l],d=r[l];if(c.type==="float")n.gl.uniform1fv(f,d);else if(c.type==="vec2")n.gl.uniform2fv(f,d);else if(c.type==="vec3")n.gl.uniform3fv(f,d);else if(c.type==="vec4")n.gl.uniform4fv(f,d);else if(c.type==="int")n.gl.uniform1iv(f,d);else if(c.type==="ivec2")n.gl.uniform2iv(f,d);else if(c.type==="ivec3")n.gl.uniform3iv(f,d);else if(c.type==="ivec4")n.gl.uniform4iv(f,d);else throw Error(`uniform type ${c.type} is not supported yet.`)}n.executeProgram()}function Rae(n,e,t){let s="";e.concat(t).forEach(i=>{const o=i.texData!=null&&i.texData.slice!=null&&i.texData.slice.flatOffset>0;if(n.enableShapeUniforms&&!i.isUniform){const l=i.texData.texShape,{useSqueezeShape:c,uniformShape:f,keptDims:d}=mC(n.packedInputs,i.shape,l);let m="",g="",b="";if(f.length===1&&n.packedInputs){const R=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];m=`${R[0]>1}_${R[1]>1}`}else if(f.length===2&&!n.packedInputs)g=`${f[0]>1}_${f[1]>1}`;else if(f.length>2&&!n.packedInputs){const R=Ot(f);b=`${R[0]===l[1]}_${R[R.length-1]===l[1]}`}const x=i.shape.length,v=f.length===2&&Nn(i.shape,l),w=Be(i.shape)===1,k=td(i.shape,t.shape),I=!n.packedInputs&&x===t.shape.length&&Nn(l,t.texData.texShape),A=n.packedInputs||f.length>2?"":`${l[0]>1}_${l[1]>1}`;s+=`${x}_${I}_${c?d:""}_${f.length}_${w}_${k}_${v}_${m}_${g}_${b}_${A}_${o}`}else{const l=i.isUniform?"uniform":i.texData.texShape;s+=`${i.shape}_${l}_${o}`}});const r=n.userCode;let a=n.constructor.name;return a+="_"+s+"_"+r+`${De().getNumber("WEBGL_VERSION")}`,a}function Ia(n){return De().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&n<=4}class Dae{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=$1.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=Wa();this.outputShape=e,this.enableShapeUniforms=Ia(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?sw(["r","c","d"],e):Nd(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${t.output} = result;
      }
    `}}class Oae{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=$1.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=Wa();this.outputShape=e,this.enableShapeUniforms=Ia(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?sw(["r","c","d"],e):Nd(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${t.output} = result;
      }
    `}}class Lae{constructor(e){this.variableNames=["A"],this.outTexUsage=uo.DOWNLOAD;const t=Wa();this.outputShape=e,this.userCode=`
      ${W6}

      void main() {
        float x = getAAtOutCoords();
        ${t.output} = encode_float(x);
      }
    `}}class Fae{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=uo.DOWNLOAD;const t=Wa();this.outputShape=e,this.userCode=`
      ${W6}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${t.output} = encode_float(x);
      }
    `}}const Mae={R:0,G:1,B:2,A:3};class TE{constructor(e,t=!1,s="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=Wa();this.outputShape=e,this.enableShapeUniforms=Ia(this.outputShape.length);let a="result";t&&(a="floor(result * 255. + 0.5)");let i="";for(let o=0;o<s.length;o++){const l=s[o];i+=`
          if(offset == ${o}) {
            result = values[${Mae[l]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?pC():dC(e)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${s.length});

        flatIndex = idiv(flatIndex, ${s.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${r.texture2D}(A, uv);
          ${i}
        }
        ${r.output} = vec4(${a}, 0., 0., 0.);
      }
    `}}class zae{constructor(e,t=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=Wa();this.outputShape=e,this.enableShapeUniforms=Ia(this.outputShape.length);let r="",a="result";t&&(a="floor(result * 255. + 0.5)");for(let i=0;i<=1;i++)for(let o=0;o<=1;o++){const l=i*2+o;r+=`
          localCoords = coords;
          if(localCoords[2] + ${o} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${o};
          if (localCoords[1] + ${i} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${i};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${s.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?pC():dC(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${r}

          ${s.output} = ${a};
        }
    `}}function Pae(n){const e=Wa(),t=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return Sre(n,t)}function Bae(n){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return Are(n,e)}function Uae(n){const e=new Uint16Array([0,1,2,2,1,3]);return Ire(n,e)}function Sy(n,e,t,s,r,a){_re(e,t);const i=Ere(n),o=n.TEXTURE_2D;return pt(n,()=>n.bindTexture(o,i)),pt(n,()=>n.texParameteri(o,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE)),pt(n,()=>n.texParameteri(o,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE)),pt(n,()=>n.texParameteri(o,n.TEXTURE_MIN_FILTER,n.NEAREST)),pt(n,()=>n.texParameteri(o,n.TEXTURE_MAG_FILTER,n.NEAREST)),De().getNumber("WEBGL_VERSION")===1?pt(n,()=>n.texImage2D(o,0,s,e,t,0,r,a,null)):pt(n,()=>n.texStorage2D(o,1,s,e,t)),pt(n,()=>n.bindTexture(n.TEXTURE_2D,null)),{texture:i,texShape:[t,e]}}function X6(n){return n.internalFormatFloat}function Vae(n,e,t,s){const[r,a]=vy(e,t);return Sy(n,r,a,X6(s),s.textureFormatFloat,n.FLOAT)}function Y6(n){return n.internalFormatHalfFloat}function jae(n,e,t,s){const[r,a]=vy(e,t);return Sy(n,r,a,Y6(s),s.textureFormatFloat,s.textureTypeHalfFloat)}function Z6(n){return n.downloadTextureFormat}function Wae(n,e,t,s){const[r,a]=vy(e,t);return Sy(n,r,a,Z6(s),n.RGBA,n.UNSIGNED_BYTE)}function J6(n){return n.internalFormatPackedFloat}function Gae(n,e,t,s){const[r,a]=ig(e,t);return Sy(n,r,a,J6(s),n.RGBA,n.FLOAT)}function Q6(n){return n.internalFormatPackedHalfFloat}function qae(n,e,t,s){const[r,a]=ig(e,t);return Sy(n,r,a,Q6(s),n.RGBA,s.textureTypeHalfFloat)}function Hae(n,e,t){return pt(n,()=>n.bindBuffer(n.ARRAY_BUFFER,t)),SE(n,e,"clipSpacePos",t,3,20,0)&&SE(n,e,"uv",t,2,20,12)}function Kae(n,e,t,s,r,a){pt(n,()=>n.bindTexture(n.TEXTURE_2D,e));let i,o,l;r instanceof Uint8Array?(i=new Uint8Array(t*s*4),o=n.UNSIGNED_BYTE,l=n.RGBA):(i=new Float32Array(t*s*4),o=n.FLOAT,l=a.internalFormatPackedFloat),i.set(r),De().getNumber("WEBGL_VERSION")===2?pt(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,t,s,n.RGBA,o,i)):pt(n,()=>n.texImage2D(n.TEXTURE_2D,0,l,t,s,0,n.RGBA,o,i)),pt(n,()=>n.bindTexture(n.TEXTURE_2D,null))}function Xae(n,e,t){pt(n,()=>n.bindTexture(n.TEXTURE_2D,e)),t.data instanceof Uint8Array?De().getNumber("WEBGL_VERSION")===2?pt(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,t.width,t.height,n.RGBA,n.UNSIGNED_BYTE,t.data)):pt(n,()=>n.texImage2D(n.TEXTURE_2D,0,n.RGBA,t.width,t.height,0,n.RGBA,n.UNSIGNED_BYTE,t.data)):De().getNumber("WEBGL_VERSION")===2?pt(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,t)):pt(n,()=>n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t)),pt(n,()=>n.bindTexture(n.TEXTURE_2D,null))}function Yae(n,e,t,s){const r=n.createBuffer();pt(n,()=>n.bindBuffer(n.PIXEL_PACK_BUFFER,r));const o=4*4*e*t;return pt(n,()=>n.bufferData(n.PIXEL_PACK_BUFFER,o,n.STREAM_READ)),pt(n,()=>n.readPixels(0,0,t,e,n.RGBA,n.FLOAT,0)),pt(n,()=>n.bindBuffer(n.PIXEL_PACK_BUFFER,null)),r}function Zae(n,e,t){const s=n,r=new Float32Array(t);return s.bindBuffer(s.PIXEL_PACK_BUFFER,e),s.getBufferSubData(s.PIXEL_PACK_BUFFER,0,r),s.bindBuffer(s.PIXEL_PACK_BUFFER,null),r}function Jae(n,e,t,s){const[r,a]=vy(e,t),i=4,o=new Uint8Array(mre(e*t,i));return pt(n,()=>n.readPixels(0,0,r,a,s.downloadTextureFormat,n.UNSIGNED_BYTE,o)),new Float32Array(o.buffer)}function Qae(n,e,t,s,r,a,i,o){const l=n,c=new Float32Array(gre(a,i));return l.bindBuffer(l.PIXEL_PACK_BUFFER,e),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,c),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),c}function eie(n,e,t){const s=new Float32Array(e*t*4);return pt(n,()=>n.readPixels(0,0,t,e,n.RGBA,n.FLOAT,s)),s}class K5{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const t=De().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,fre(t,e)):this.gl=Fl(t),e=this.gl,De().getNumber("WEBGL_VERSION")===2){const a=e;this.createVertexArray=()=>pt(a,()=>a.createVertexArray()),this.bindVertexArray=i=>pt(a,()=>a.bindVertexArray(i)),this.deleteVertexArray=i=>pt(a,()=>a.deleteVertexArray(i)),this.getVertexArray=()=>pt(a,()=>a.getParameter(a.VERTEX_ARRAY_BINDING))}else if(e!=null){const a=e.getExtension("OES_vertex_array_object");if(a==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>pt(e,()=>a.createVertexArrayOES()),this.bindVertexArray=i=>pt(e,()=>a.bindVertexArrayOES(i)),this.deleteVertexArray=i=>pt(e,()=>a.deleteVertexArrayOES(i)),this.getVertexArray=()=>pt(e,()=>e.getParameter(a.VERTEX_ARRAY_BINDING_OES))}let s="WEBGL_color_buffer_float";const r="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),De().getNumber("WEBGL_VERSION")===1){const a="OES_texture_float",i="OES_texture_half_float";if(this.textureFloatExtension=I2(this.gl,a),Vo(this.gl,i))this.textureHalfFloatExtension=I2(this.gl,i);else if(De().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(s),Vo(this.gl,r))this.colorBufferHalfFloatExtension=I2(this.gl,r);else if(De().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(s="EXT_color_buffer_float",Vo(this.gl,s))this.colorBufferFloatExtension=this.gl.getExtension(s);else if(Vo(this.gl,r))this.colorBufferHalfFloatExtension=this.gl.getExtension(r);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=Bae(this.gl),this.indexBuffer=Uae(this.gl),this.framebuffer=$re(this.gl),this.textureConfig=fC(this.gl,this.textureHalfFloatExtension)}get debug(){return De().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;pt(e,()=>e.finish()),pt(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),pt(e,()=>e.deleteFramebuffer(this.framebuffer)),pt(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),pt(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),pt(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,t){return this.throwIfDisposed(),Vae(this.gl,e,t,this.textureConfig)}createFloat16MatrixTexture(e,t){return this.throwIfDisposed(),jae(this.gl,e,t,this.textureConfig)}createUnsignedBytesMatrixTexture(e,t){return this.throwIfDisposed(),Wae(this.gl,e,t,this.textureConfig)}uploadPixelDataToTexture(e,t){this.throwIfDisposed(),Xae(this.gl,e,t)}uploadDenseMatrixToTexture(e,t,s,r){this.throwIfDisposed(),Kae(this.gl,e,t,s,r,this.textureConfig)}createFloat16PackedMatrixTexture(e,t){return this.throwIfDisposed(),qae(this.gl,e,t,this.textureConfig)}createPackedMatrixTexture(e,t){return this.throwIfDisposed(),Gae(this.gl,e,t,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(NE(this.gl,this.framebuffer),this.outputTexture=null),pt(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,t,s){return this.downloadMatrixDriver(e,()=>Jae(this.gl,t,s,this.textureConfig))}downloadPackedMatrixFromBuffer(e,t,s,r,a,i){return Qae(this.gl,e,t,s,r,a,i,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,t){return Zae(this.gl,e,t)}createBufferFromTexture(e,t,s){this.bindTextureToFrameBuffer(e);const r=Yae(this.gl,t,s,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let t,s;if(De().getBool("WEBGL_FENCE_API_ENABLED")){const r=e,a=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),s=()=>{const i=r.clientWaitSync(a,0,0);return i===r.ALREADY_SIGNALED||i===r.CONDITION_SATISFIED},t=a}else De().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),s=()=>this.isQueryAvailable(t,De().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):s=()=>!0;return{query:t,isFencePassed:s}}downloadMatrixFromPackedTexture(e,t,s){return this.downloadMatrixDriver(e,()=>eie(this.gl,t,s))}createProgram(e){this.throwIfDisposed();const t=this.gl;this.vertexShader==null&&(this.vertexShader=Pae(t));const s=Cre(t);pt(t,()=>t.attachShader(s,this.vertexShader)),pt(t,()=>t.attachShader(s,e)),Tre(t,s);const r=Object.assign(s,{vao:this.createVertexArray()});return this.debug&&W5(t,r),r}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const t=this.gl;pt(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),Hae(t,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&(pt(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&W5(this.gl,this.program),pt(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,t,s=!0){return this.throwIfDisposed(),s?Dre(this.gl,e,t):Ore(this.gl,e,t)}getAttributeLocation(e,t){return this.throwIfDisposed(),pt(this.gl,()=>this.gl.getAttribLocation(e,t))}getUniformLocationNoThrow(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}setInputMatrixTexture(e,t,s){this.throwIfDisposed(),this.throwIfNoProgram(),Lre(this.gl,e,t,s)}setOutputMatrixTexture(e,t,s){this.setOutputMatrixTextureDriver(e,s,t)}setOutputPackedMatrixTexture(e,t,s){this.throwIfDisposed();const[r,a]=ig(t,s);this.setOutputMatrixTextureDriver(e,r,a)}setOutputMatrixWriteRegion(e,t,s,r){this.setOutputMatrixWriteRegionDriver(s,e,r,t)}setOutputPackedMatrixWriteRegion(e,t,s,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&W5(this.gl,this.program),E2(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const t=this.getVertexArray();console.assert(t===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}pt(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),pt(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=I2(this.gl,De().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(De().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const s=this.gl,r=this.getQueryTimerExtensionWebGL2(),a=s.createQuery();return s.beginQuery(r.TIME_ELAPSED_EXT,a),a}const e=this.getQueryTimerExtensionWebGL1(),t=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,t),t}endQuery(){if(De().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const t=this.gl,s=this.getQueryTimerExtensionWebGL2();t.endQuery(s.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await wS(()=>this.disposed||this.isQueryAvailable(e,De().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,De().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,t){if(t===0)return null;if(t===2){const s=this.gl;return s.getQueryParameter(e,s.QUERY_RESULT)/1e6}else{const s=this.getQueryTimerExtensionWebGL1();return s.getQueryObjectEXT(e,s.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,t){if(t===0)return!0;if(t===2){const s=this.gl,r=this.getQueryTimerExtensionWebGL2(),a=s.getQueryParameter(e,s.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),a&&!this.disjoint}else{const s=this.getQueryTimerExtensionWebGL1(),r=s.getQueryObjectEXT(e,s.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),r&&!this.disjoint}}pollFence(e){return new Promise(t=>{this.addItemToPoll(()=>e.isFencePassed(),()=>t())})}pollItems(){const e=tie(this.itemsToPoll.map(t=>t.isDoneFn));for(let t=0;t<=e;++t){const{resolveFn:s}=this.itemsToPoll[t];s()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,t){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1)return;let s;"setTimeoutCustom"in De().platform&&(s=De().platform.setTimeoutCustom.bind(De().platform)),wS(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,s)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),G5(this.gl,e,this.framebuffer),this.debug&&E2(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(G5(this.gl,this.outputTexture,this.framebuffer),this.debug&&E2(this.gl)):NE(this.gl,this.framebuffer)}downloadMatrixDriver(e,t){this.bindTextureToFrameBuffer(e);const s=t();return this.unbindTextureToFrameBuffer(),s}setOutputMatrixTextureDriver(e,t,s){this.throwIfDisposed();const r=this.gl;G5(r,e,this.framebuffer),this.debug&&E2(r),this.outputTexture=e,pt(r,()=>r.viewport(0,0,t,s)),pt(r,()=>r.scissor(0,0,t,s))}setOutputMatrixWriteRegionDriver(e,t,s,r){this.throwIfDisposed(),pt(this.gl,()=>this.gl.scissor(e,t,s,r))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function tie(n){let e=0;for(;e<n.length&&n[e]();++e);return e-1}const{addImpl:nie,bincountImpl:eF,bincountReduceImpl:sie,bitwiseAndImpl:rie,castImpl:aie,ceilImpl:iie,concatImpl:oie,equalImpl:lie,expImpl:uie,expm1Impl:cie,floorImpl:hie,gatherNdImpl:fie,gatherV2Impl:die,greaterImpl:pie,greaterEqualImpl:mie,lessImpl:gie,lessEqualImpl:yie,linSpaceImpl:bie,logImpl:xie,maxImpl:vie,maximumImpl:wie,minimumImpl:Sie,multiplyImpl:Nie,negImpl:kie,notEqualImpl:Cie,prodImpl:Tie,raggedGatherImpl:Aie,raggedRangeImpl:Iie,raggedTensorToTensorImpl:Eie,rangeImpl:_ie,rsqrtImpl:$ie,scatterImpl:Rie,sigmoidImpl:Die,simpleAbsImpl:tF,sliceImpl:Oie,sparseFillEmptyRowsImpl:Lie,sparseReshapeImpl:Fie,sparseSegmentReductionImpl:nF,sqrtImpl:Mie,staticRegexReplaceImpl:zie,stridedSliceImpl:Pie,stringNGramsImpl:Bie,stringSplitImpl:Uie,stringToHashBucketFastImpl:Vie,subImpl:jie,tileImpl:Wie,topKImpl:Gie,transposeImpl:gC,uniqueImpl:qie}=XJ;function sF(n,e){return["x","y","z","w","u","v"].slice(0,e).map(t=>`${n}.${t}`)}function Ua(n,e){return e===1?[n]:sF(n,e)}function Hie(n,e){if(n===1)return"rc";let t="";for(let s=0;s<n;s++)t+=e[s],s<n-1&&(t+=",");return t}class Kie{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=Ia(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const t=Ua("rc",this.rank),s=os(this.rank),r=this.getOutOfBoundsCondition(t),a=this.getSetup(t),i=this.getOutput(t);this.userCode=`
        void main() {
          ${s} rc = getOutputCoords();

          if(${r}) {
            setOutput(vec4(0));
          } else {
            ${a}

            setOutput(vec4(${i}));
          }
        }
      `}}getSourceCoordsArr(e){const t=[];for(let s=0;s<=1;s++)for(let r=0;r<=1;r++){let a=`${s===0?"r":"rp1"}, ${r===0?"c":"cp1"}`;for(let i=2;i<this.rank;i++)a=`${e[e.length-1-i]},`+a;t.push(a)}return t}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let t="";for(let s=this.rank-2;s<this.rank;s++)t+=`${e[s]} >= ${this.enableShapeUniforms?`outShape[${s}]`:this.outputShape[s]}`,s<this.rank-1&&(t+="||");return t}getSetup(e){if(this.rank===1)return"";const t=e.slice(-2),s=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],r=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${t[0]};
      int c = ${t[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${s};
      bool rEdge = rp1 >= ${r};
    `}getOutput(e){const t=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${t[0]}),
            cEdge ? 0. : getA(${t[1]}),
            rEdge ? 0. : getA(${t[2]}),
            rEdge || cEdge ? 0. : getA(${t[3]})`}}class rF{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=Ia(this.outputShape.length);let s="";for(let r=0;r<4;r++){let a="thisRC = rc;";r%2===1&&(a+="thisRC.z += 1;"),r>1&&(a+="thisRC.y += 1;"),s+=`
        ${a}
        ${r>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${r}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${r>0?"}":""}
      `}this.userCode=`
      ${Xie(t,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?pC():dC(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${s}

        setOutput(result);
      }
    `}}function Xie(n,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?Hre(["r","c","d"],"inputShape"):Nd(["r","c","d"],n)}
      return ivec3(r, c, d);
    }
  `}class Yie{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,t,s){const r=IE(t,s),a=EE(e,r,s);a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]);const i=AE(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,s);if(this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=i,this.log();const l=this.freeTextures[a].pop();return this.usedTextures[a].push(l),l}let o;return r===la.PACKED_2X2_FLOAT32?o=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):r===la.PACKED_2X2_FLOAT16?o=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):r===la.UNPACKED_FLOAT32?o=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):r===la.UNPACKED_FLOAT16?o=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):r===la.PACKED_4X1_UNSIGNED_BYTE&&(o=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[a].push(o),this.numUsedTextures++,this._numBytesAllocated+=i,this.log(),o}releaseTexture(e,t,s,r){if(this.freeTextures==null)return;const a=IE(s,r),i=EE(t,a,r);i in this.freeTextures||(this.freeTextures[i]=[]);const o=AE(t,a,this.gpgpu.gl,this.gpgpu.textureConfig,r),l=De().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=o):(this.freeTextures[i].push(e),this.numFreeTextures++,this._numBytesFree+=o),this.numUsedTextures--;const c=this.usedTextures[i],f=c&&c.indexOf(e);if(f==null||f<0)throw new Error("Cannot release a texture that was never provided by this texture manager");c[f]=c[c.length-1],c.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const t=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*t)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(t=>{this.gpgpu.deleteMatrixTexture(t.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(t=>{this.gpgpu.deleteMatrixTexture(t.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function Zie(n,e){const t=n;if(e===t.R32F)return 4;if(e===t.R16F)return 2;if(e===t.RGBA32F)return 16;if(e===n.RGBA)return 16;if(e===t.RGBA16F)return 8;if(e===t.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function AE(n,e,t,s,r){const a=Jie(e,s);let i;if(r){const[l,c]=ig(n[0],n[1]);i=l*c}else{const[l,c]=vy(n[0],n[1]);i=l*c}const o=Zie(t,a);return i*o}function Jie(n,e){switch(n){case la.PACKED_2X2_FLOAT32:return J6(e);case la.PACKED_2X2_FLOAT16:return Q6(e);case la.UNPACKED_FLOAT32:return X6(e);case la.UNPACKED_FLOAT16:return Y6(e);case la.PACKED_4X1_UNSIGNED_BYTE:return Z6(e);default:throw new Error(`Unknown physical texture type ${n}`)}}function Qie(n){return De().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?n?la.PACKED_2X2_FLOAT32:la.UNPACKED_FLOAT32:n?la.PACKED_2X2_FLOAT16:la.UNPACKED_FLOAT16}function IE(n,e){if(n===uo.UPLOAD)return la.PACKED_2X2_FLOAT32;if(n===uo.RENDER||n==null)return Qie(e);if(n===uo.DOWNLOAD||n===uo.PIXELS)return la.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${n}`)}function EE(n,e,t){return`${n[0]}_${n[1]}_${e}_${t}`}class gu{constructor(e,t){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=Ia(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${t}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const Ko="if (isnan(x)) return x;",eoe="return x;",_E="return abs(x);",toe="return (x >= 0.0) ? x : (exp(x) - 1.0);",noe=Ko+`
  return (x < 0.0) ? 0.0 : x;
`,soe=Ko+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,yh="return x;",roe="return 1.0 / (1.0 + exp(-1.0 * x));";const aoe="return x;",ioe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,ooe=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,loe=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,uoe="return 1.0 / (1.0 + exp(-1.0 * x));";class vh{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=Ia(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${t}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}class coe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=Ia(this.outputShape.length);const t=e.length,s=Ua("rc",t),r=os(t),a=Hie(t,s),i=s.slice(-2),o=t<=1?"rc":`vec2(${i.join(",")})`;this.userCode=`
      void main() {
        ${r} rc = getOutputCoords();
        vec4 packedInput = getA(${a});

        setOutput(getChannel(packedInput, ${o}));
      }
    `}}const hoe=_v,foe=1e-7,doe=1e-4,R2={};function poe(n){return n in R2||(R2[n]={}),R2[n]}const moe=De().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),goe=600;function yoe(){return De().global.screen==null?1024:De().global.screen.height*De().global.screen.width*window.devicePixelRatio*goe/1024/1024}class rw extends Hb{nextDataId(){return rw.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!De().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let t;if(e!=null){if(e instanceof K5)t=e;else{const s=Fl(De().getNumber("WEBGL_VERSION"),e);t=new K5(s)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const s=Fl(De().getNumber("WEBGL_VERSION"));t=new K5(s),this.binaryCache=poe(De().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=t,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new Yie(this.gpgpu),this.numMBBeforeWarning=yoe(),this.texData=new DN(this,Tl())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,t,s,r,a,i){const o=this.makeTensorInfo(t,s),l=this.texData.get(o.dataId);l.isPacked=!1,l.texture={texture:e,texShape:[r,a]},l.texShape=[r,a];const c=_2(t),f=new TE(c,!1,i),d=this.runWebGLProgram(f,[o],s,[[r,a]]);return d.shape=t,l.texture=null,this.disposeIntermediateTensorInfo(o),d.dataId}write(e,t,s){if((De().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||De().getBool("DEBUG"))&&this.checkNumericalProblems(e),s==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const r={id:this.nextDataId()};return this.texData.set(r,{shape:t,dtype:s,values:e,usage:uo.UPLOAD,refCount:1}),r}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const t=this.texData.get(e);t.refCount++}decRef(e){if(this.texData.has(e)){const t=this.texData.get(e);t.refCount--}}move(e,t,s,r,a){if(De().getBool("DEBUG")&&this.checkNumericalProblems(t),r==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:s,dtype:r,values:t,usage:uo.UPLOAD,refCount:a})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const t=this.texData.get(e),{values:s,dtype:r,complexTensorInfos:a,slice:i,shape:o,isPacked:l}=t;if(i!=null){let m;l?m=new vh(o,yh):m=new gu(o,yh);const g=this.runWebGLProgram(m,[{dataId:e,shape:o,dtype:r}],r),b=this.readSync(g.dataId);return this.disposeIntermediateTensorInfo(g),b}if(s!=null)return this.convertAndCacheOnCPU(e);if(r==="string")return s;const c=this.activeTimers!=null;let f;c&&(f=Ma());let d;if(r==="complex64"){const m=this.readSync(a.real.dataId),g=this.readSync(a.imag.dataId);d=wc(m,g)}else d=this.getValuesFromTexture(e);return c&&(this.downloadWaitMs+=Ma()-f),this.convertAndCacheOnCPU(e,d)}async read(e){if(this.pendingRead.has(e)){const b=this.pendingRead.get(e);return new Promise(x=>b.push(x))}const t=this.texData.get(e),{values:s,shape:r,slice:a,dtype:i,complexTensorInfos:o,isPacked:l}=t;if(a!=null){let b;l?b=new vh(r,yh):b=new gu(r,yh);const x=this.runWebGLProgram(b,[{dataId:e,shape:r,dtype:i}],i),v=this.read(x.dataId);return this.disposeIntermediateTensorInfo(x),v}if(s!=null)return this.convertAndCacheOnCPU(e);if(De().getBool("DEBUG")&&!De().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&De().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let c=null,f;if(i!=="complex64"&&De().get("WEBGL_BUFFER_SUPPORTED")){f=this.decode(e);const b=this.texData.get(f.dataId);c=this.gpgpu.createBufferFromTexture(b.texture.texture,...A2(r))}this.pendingRead.set(e,[]),i!=="complex64"&&await this.gpgpu.createAndWaitForFence();let d;if(i==="complex64"){const b=await Promise.all([this.read(o.real.dataId),this.read(o.imag.dataId)]),x=b[0],v=b[1];d=wc(x,v)}else if(c==null)d=this.getValuesFromTexture(e);else{const b=Be(r);d=this.gpgpu.downloadFloat32MatrixFromBuffer(c,b)}if(f!=null&&this.disposeIntermediateTensorInfo(f),c!=null){const b=this.gpgpu.gl;pt(b,()=>b.deleteBuffer(c))}const m=this.convertAndCacheOnCPU(e,d),g=this.pendingRead.get(e);return this.pendingRead.delete(e),g.forEach(b=>b(m)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&Tl().removeDataId(e,this),this.pendingDeletes--),m}readToGPU(e,t={}){const s=this.texData.get(e),{values:r,shape:a,slice:i,dtype:o,isPacked:l,texture:c}=s;if(o==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(i!=null){let g;l?g=new vh(a,yh):g=new gu(a,yh);const b=this.runWebGLProgram(g,[{dataId:e,shape:a,dtype:o}],o),x=this.readToGPU(b,t);return this.disposeIntermediateTensorInfo(b),x}if(c==null)throw r!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const f=this.decode(e,t.customTexShape),d=Tl().makeTensorFromTensorInfo(f),m=this.texData.get(f.dataId);return Object.assign({tensorRef:d},m.texture)}bufferSync(e){const t=this.readSync(e.dataId);if(e.dtype==="string")try{const s=t.map(r=>bc(r));return mn(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return mn(e.shape,e.dtype,t)}checkNumericalProblems(e){if(e!=null)for(let t=0;t<e.length;t++){const s=e[t];if(!vre(s))throw De().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${s} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${s} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:t,dtype:s,isPacked:r}=this.texData.get(e),a=Be(t);if(De().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const m=this.decode(e),g=this.texData.get(m.dataId),b=this.gpgpu.downloadMatrixFromPackedTexture(g.texture.texture,...A2(t)).subarray(0,a);return this.disposeIntermediateTensorInfo(m),b}const i=De().getBool("WEBGL_PACK")&&r===!0,o=i?_2(t):t,l=i?new Fae(o):new Lae(o),c=this.runWebGLProgram(l,[{shape:o,dtype:s,dataId:e}],"float32"),f=this.texData.get(c.dataId),d=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(f.texture.texture,f.texShape[0],f.texShape[1]).subarray(0,a);return this.disposeIntermediateTensorInfo(c),d}timerAvailable(){return De().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const t=this.activeTimers,s=[];let r=!1;this.programTimersStack==null?(this.programTimersStack=s,r=!0):this.activeTimers.push(s),this.activeTimers=s,e();const a=Nu(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),i=Nu(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=t,r&&(this.programTimersStack=null);const o={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(De().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const l=await Promise.all(a);o.kernelMs=R_(l),o.getExtraProfileInfo=()=>l.map((c,f)=>({name:i[f],ms:c})).map(c=>`${c.name}: ${c.ms}`).join(", ")}else o.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,o})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return De().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Ma(),endMs:null}}endTimer(e){return De().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=Ma(),e)}async getQueryTime(e){if(De().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const t=e;return t.endMs-t.startMs}disposeData(e,t=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(t?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!t&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:s}=this.texData.get(e);return s!=null&&(this.disposeData(s.real.dataId,t),this.disposeData(s.imag.dataId,t)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:t,dtype:s,texShape:r,usage:a,isPacked:i,slice:o}=this.texData.get(e),l=o&&o.origDataId||e,c=this.dataRefCount.get(l);c>1?this.dataRefCount.set(l,c-1):(this.dataRefCount.delete(l),t!=null&&(this.numBytesInGPU-=this.computeBytes(r,s),this.textureManager.releaseTexture(t,r,a,i)));const f=this.texData.get(e);f.texture=null,f.texShape=null,f.isPacked=!1,f.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,t=moe){return De().getBool("WEBGL_CPU_FORWARD")&&e.every(s=>this.texData.get(s.dataId).texture==null&&Be(s.shape)<t)}getGPGPUContext(){return this.gpgpu}where(e){io("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const t=e.dataSync();return hoe(e.shape,t)}packedUnaryOp(e,t,s){const r=new vh(e.shape,t),a=this.compileAndRun(r,[e],s);return Tl().makeTensorFromTensorInfo(a)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const r=tF(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,r)}if(De().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,_E,e.dtype);const t=new gu(e.shape,_E),s=this.compileAndRun(t,[e]);return Tl().makeTensorFromTensorInfo(s)}makeTensorInfo(e,t,s){let r;if(t==="string"&&s!=null&&s.length>0&&mu(s[0])){const a=s.map(i=>bu(i));r=this.write(a,e,t)}else r=this.write(s,e,t);return this.texData.get(r).usage=null,{dataId:r,shape:e,dtype:t}}makeOutput(e,t,s){return Tl().makeTensorFromTensorInfo(this.makeTensorInfo(e,t,s),this)}unpackTensor(e){const t=new coe(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}packTensor(e){const t=new Kie(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)}packedReshape(e,t){const s=[Jp(e.shape),...Qp(e.shape)],r={dtype:e.dtype,shape:s,dataId:e.dataId},a=[Jp(t),...Qp(t)],i=new rF(a,s),o=!0,l=[s],c=this.runWebGLProgram(i,[r],e.dtype,l,o);return{dataId:c.dataId,shape:t,dtype:c.dtype}}decode(e,t){const s=this.texData.get(e),{isPacked:r,shape:a,dtype:i}=s;if(t!=null){const m=Be(a),g=t[0]*t[1]*4;Z(m<=g,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const o=_2(a);let l;r?l=new Oae(o):l=new Dae(o);const c=!0,f=[t??A2(o)],d=this.runWebGLProgram(l,[{shape:o,dtype:i,dataId:e}],i,f,c,t);return{dtype:i,shape:a,dataId:d.dataId}}runWebGLProgram(e,t,s,r,a=!1,i){const o=this.makeTensorInfo(e.outputShape,s),l=this.texData.get(o.dataId);if(e.packedOutput&&(l.isPacked=!0),e.outPackingScheme===$1.DENSE){const w=i??A2(e.outputShape);l.texShape=w.map(k=>k*2)}if(e.outTexUsage!=null&&(l.usage=e.outTexUsage),Be(o.shape)===0)return l.values=Kr(o.dtype,0),o;const c=[],f=t.map(w=>{if(w.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let k=this.texData.get(w.dataId);if(k.texture==null){if(!e.packedInputs&&Be(w.shape)<=De().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:w.shape,texData:null,isUniform:!0,uniformValues:k.values};e.packedInputs&&(k.isPacked=!0,k.shape=w.shape)}if(this.uploadToGPU(w.dataId),!!k.isPacked!=!!e.packedInputs)w=k.isPacked?this.unpackTensor(w):this.packTensor(w),c.push(w),k=this.texData.get(w.dataId);else if(k.isPacked&&!Mb(k.shape,w.shape)){const I=w,A=w.shape;w.shape=k.shape,w=this.packedReshape(w,A),c.push(w),k=this.texData.get(w.dataId),I.shape=A}return{shape:w.shape,texData:k,isUniform:!1}});this.uploadToGPU(o.dataId);const d={shape:o.shape,texData:l,isUniform:!1},m=Rae(e,f,d),g=this.getAndSaveBinary(m,()=>_ae(this.gpgpu,e,f,d)),b=this.activeTimers!=null;let x;b&&(x=this.startTimer()),De().get("ENGINE_COMPILE_ONLY")||$ae(this.gpgpu,g,f,d,r),c.forEach(w=>this.disposeIntermediateTensorInfo(w)),b&&(x=this.endTimer(x),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(x)}));const v=De().getNumber("WEBGL_FLUSH_THRESHOLD");if(v>0){const w=Ma();w-this.lastGlFlushTime>v&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=w)}if(!De().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&a===!1){const w=this.unpackTensor(o);return this.disposeIntermediateTensorInfo(o),w}return o}compileAndRun(e,t,s,r,a=!1){return s=s||t[0].dtype,this.runWebGLProgram(e,t,s,r,a)}getAndSaveBinary(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(De().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(t=>{this.gpgpu.deleteProgram(this.binaryCache[t].webGLProgram),delete this.binaryCache[t]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=_e(()=>{if(!De().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=De().getBool("DEBUG");De().set("DEBUG",!1);const t=this.abs(Mt(1e-8)).dataSync()[0];if(De().set("DEBUG",e),t>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?foe:doe}uploadToGPU(e){const t=this.texData.get(e),{shape:s,dtype:r,values:a,texture:i,usage:o,isPacked:l}=t;if(i!=null)return;const c=this.activeTimers!=null;let f;c&&(f=Ma());let d=t.texShape;if(d==null&&(d=zre(s,l),t.texShape=d),a!=null){const m=_2(s);let g,b=d[1],x=d[0];const v=a instanceof Uint8Array||a instanceof Uint8ClampedArray;(l||!v)&&([b,x]=ig(d[0],d[1])),l?g=new zae(m,v):g=new TE(m,v);const w=v?[x,b]:d,k=this.makeTensorInfo(w,r),I=this.texData.get(k.dataId);v?I.usage=uo.PIXELS:I.usage=uo.UPLOAD,I.texShape=w,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(k.dataId),b,x,a);const A=[[x,b]],U=this.runWebGLProgram(g,[k],r,A,!0),V=this.texData.get(U.dataId);t.texShape=V.texShape,t.isPacked=V.isPacked,t.usage=V.usage,De().get("ENGINE_COMPILE_ONLY")?this.disposeData(U.dataId):(t.texture=V.texture,t.values=null,this.texData.delete(U.dataId)),this.disposeIntermediateTensorInfo(k),c&&(this.uploadWaitMs+=Ma()-f)}else{const m=this.acquireTexture(d,o,r,l);t.texture=m}}convertAndCacheOnCPU(e,t){const s=this.texData.get(e),{dtype:r}=s;return t!=null&&(s.values=boe(t,r)),s.values}acquireTexture(e,t,s,r){if(this.numBytesInGPU+=this.computeBytes(e,s),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${a} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,t,r)}computeBytes(e,t){return e[0]*e[1]*m1(t)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,t]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(t));return Promise.all(e)}else{for(const[,t]of Object.entries(this.binaryCache)){const s=new Promise(r=>{try{this.checkCompletion_(t),r(!0)}catch(a){throw a}});e.push(s)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await p3(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(j6(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:t,customUniformLocations:s,infLoc:r,nanLoc:a,outShapeLocation:i,outShapeStridesLocation:o,outTexShapeLocation:l}=K6(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=t,e.customUniformLocations=s,e.infLoc=r,e.nanLoc=a,e.outShapeLocation=i,e.outShapeStridesLocation=o,e.outTexShapeLocation=l}}createTensorFromGPUData(e,t,s){e.channels=e.channels||"RGBA";const{texture:r,height:a,width:i,channels:o}=e,l=Tl().backend;if(!l.gpgpu.gl.isTexture(r))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const c=l.writeTexture(r,t,s,a,i,o);return Tl().makeTensorFromDataId(c,t,s,l)}}rw.nextDataId=0;function boe(n,e){if(e==="float32"||e==="complex64")return n;if(e==="int32"||e==="bool"){const t=e==="int32"?new Int32Array(n.length):new Uint8Array(n.length);for(let s=0;s<t.length;++s)t[s]=Math.round(n[s]);return t}else throw new Error(`Unknown dtype ${e}`)}jN()&&GN("webgl",()=>new rw,2);const yC=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class ud{constructor(e,t,s){this.variableNames=["A","B"],this.outputShape=on(t,s),this.enableShapeUniforms=Ia(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}const Cd=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class hg{constructor(e,t,s,r=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=on(t,s);const a=this.outputShape.length;this.enableShapeUniforms=Ia(a);let i="";if(r)if(a===0||Be(this.outputShape)===1)i=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(i=`
          ${os(a)} coords = getOutputCoords();
        `,a===1)this.enableShapeUniforms?i+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:i+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const l=Ua("coords",a);this.enableShapeUniforms?i+=`
            bool nextRowOutOfBounds =
              (${l[a-2]} + 1) >= outShape[${a} - 2];
            bool nextColOutOfBounds =
              (${l[a-1]} + 1) >= outShape[${a} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:i+=`
            bool nextRowOutOfBounds =
              (${l[a-2]} + 1) >= ${this.outputShape[a-2]};
            bool nextColOutOfBounds =
              (${l[a-1]} + 1) >= ${this.outputShape[a-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${i}

        setOutput(result);
      }
    `}}function zi(n){const{inputs:e,backend:t}=n,{x:s}=e;return t.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const xoe={kernelName:Sm,backendName:"webgl",kernelFunc:zi};function Kh(n){const{inputs:e,backend:t}=n,{real:s,imag:r}=e,a=t.makeTensorInfo(s.shape,"complex64"),i=t.texData.get(a.dataId),o=zi({inputs:{x:s},backend:t}),l=zi({inputs:{x:r},backend:t});return i.complexTensorInfos={real:o,imag:l},a}const voe={kernelName:nx,backendName:"webgl",kernelFunc:Kh};const aF="return (a < 0.) ? b * a : a;",iF=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function woe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{alpha:a}=s,i=t.makeTensorInfo([],"float32",kc(a,"float32")),o=De().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new hg(iF,r.shape,i.shape):new ud(aF,r.shape,i.shape),l=t.runWebGLProgram(o,[r,i],"float32");return t.disposeIntermediateTensorInfo(i),l}const Soe={kernelName:l0,backendName:"webgl",kernelFunc:woe};const oF="return (a < 0.) ? b * a : a;",lF=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function Noe(n){const{inputs:e,backend:t}=n,{x:s,alpha:r}=e,a=De().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new hg(lF,s.shape,r.shape):new ud(oF,s.shape,r.shape);return t.runWebGLProgram(a,[s,r],"float32")}const koe={kernelName:A0,backendName:"webgl",kernelFunc:Noe};const fg="if (isnan(x)) return x;";function zn({opSnippet:n,packedOpSnippet:e,cpuKernelImpl:t,dtype:s}){return({inputs:r,backend:a})=>{const{x:i}=r,o=a,l=s||i.dtype;if(o.shouldExecuteOnCPU([i])&&t!=null){const d=o.texData.get(i.dataId),m=t(d.values,l);return o.makeTensorInfo(i.shape,l,m)}const c=De().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let f;return c?f=new vh(i.shape,e):f=new gu(i.shape,n),o.runWebGLProgram(f,[i],l)}}function ma({opSnippet:n,packedOpSnippet:e,checkOutOfBounds:t=!1,supportsComplex:s=!1,cpuKernelImpl:r,dtype:a}){return({inputs:i,backend:o})=>{const{a:l,b:c}=i,f=o;if(s&&l.dtype==="complex64"){const b=f.texData.get(l.dataId),x=f.texData.get(c.dataId),[v,w]=[[b.complexTensorInfos.real,x.complexTensorInfos.real],[b.complexTensorInfos.imag,x.complexTensorInfos.imag]].map(I=>{const[A,R]=I,U={dataId:A.dataId,dtype:A.dtype,shape:l.shape},V={dataId:R.dataId,dtype:R.dtype,shape:c.shape},P=new ud(n,l.shape,c.shape);return f.runWebGLProgram(P,[U,V],ai(A.dtype,R.dtype))}),k=Kh({inputs:{real:v,imag:w},backend:f});return f.disposeIntermediateTensorInfo(v),f.disposeIntermediateTensorInfo(w),k}const d=a||ai(l.dtype,c.dtype);if((l.dtype==="string"||c.dtype==="string"||f.shouldExecuteOnCPU([l,c]))&&r!=null){const b=f.texData.get(l.dataId).values,x=f.texData.get(c.dataId).values,v=l.dtype==="string"?Sc(b):b,w=l.dtype==="string"?Sc(x):x,[k,I]=r(l.shape,c.shape,v,w,d),A=f.makeTensorInfo(I,d),R=f.texData.get(A.dataId);return R.values=k,A}const m=De().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let g;return m?g=new hg(e,l.shape,c.shape,t):g=new ud(n,l.shape,c.shape),f.runWebGLProgram(g,[l,c],d)}}function R1(n,e=!1){if(n==="linear")return e?aoe:eoe;if(n==="relu")return e?ooe:noe;if(n==="elu")return e?ioe:toe;if(n==="relu6")return e?loe:soe;if(n==="prelu")return e?lF:oF;if(n==="leakyrelu")return e?iF:aF;if(n==="sigmoid")return e?uoe:roe;throw new Error(`Activation ${n} has not been implemented for the WebGL backend.`)}class uF{constructor(e,t,s,r=!1,a=!1,i=!1,o=null,l=!1,c=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=s,this.enableShapeUniforms=Ia(this.outputShape.length);const f=r?e[1]:e[2],d=Math.ceil(f/2),m=r?"i * 2, rc.y":"rc.y, i * 2",g=a?"rc.z, i * 2":"i * 2, rc.z",b=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],x=a?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let v="",w="";o&&(l?v=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${o}
        }`:c?v=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${o}
        }`:v=`vec4 activation(vec4 x) {
          ${o}
        }`,w="result = activation(result);");const k=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),c&&this.variableNames.push("leakyreluAlpha");let I="rc.x",A="rc.x";e[0]<t[0]?I=`imod(rc.x, ${e[0]})`:t[0]<e[0]&&(A=`imod(rc.x, ${t[0]})`),this.userCode=`
      ${v}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${d}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${I};
        int batchB = ${A};
        for (int i = 0; i < ${d}; i++) {
          vec4 a = getMatrixA(batchA, ${m});
          vec4 b = getMatrixB(batchB, ${g});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${b[0]} * ${x[0]});
          result += (${b[1]} * ${x[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${k}

        ${w}

        setOutput(result);
      }
    `}}const $E={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class RE{constructor(e,t,s){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=on(t,s),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}const DE="return a * b;";function bC(n){const{inputs:e,backend:t}=n,{a:s,b:r}=e,a=ai(s.dtype,r.dtype);if(s.dtype==="complex64"){const o=t.texData.get(s.dataId),l=t.texData.get(r.dataId),c=new RE($E.REAL,s.shape,r.shape),f=new RE($E.IMAG,s.shape,r.shape),d=[{dataId:o.complexTensorInfos.real.dataId,dtype:o.complexTensorInfos.real.dtype,shape:s.shape},{dataId:o.complexTensorInfos.imag.dataId,dtype:o.complexTensorInfos.imag.dtype,shape:s.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:r.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:r.shape}],m=t.runWebGLProgram(c,d,"float32"),g=t.runWebGLProgram(f,d,"float32"),b=Kh({inputs:{real:m,imag:g},backend:t});return t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(g),b}if(t.shouldExecuteOnCPU([s,r])){const o=t.texData.get(s.dataId),l=t.texData.get(r.dataId),[c,f]=Nie(s.shape,r.shape,o.values,l.values,a),d=t.makeTensorInfo(f,a),m=t.texData.get(d.dataId);return m.values=c,d}let i;return De().getBool("WEBGL_PACK_BINARY_OPERATIONS")?i=new hg(DE,s.shape,r.shape):i=new ud(DE,s.shape,r.shape),t.runWebGLProgram(i,[s,r],a)}const Coe={kernelName:$m,backendName:"webgl",kernelFunc:bC};function Toe(n,e,t){const s=[Jp(n.shape),...Qp(n.shape)],r={dtype:n.dtype,shape:s,dataId:n.dataId},a=[Jp(e),...Qp(e)],i=new rF(a,s),o=!0,l=[s],c=t.runWebGLProgram(i,[r],n.dtype,l,o);return{dataId:c.dataId,shape:e,dtype:c.dtype}}function ct(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{shape:a}=s,i=t,o=Be(r.shape),l=LN(a,o),c=Be(l);Z(o===c,()=>`The new shape (${l}) has ${c} elements and the old shape (${r.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`);const f=i.texData.get(r.dataId);return f.isPacked&&!Mb(r.shape,l)&&!(f.texture!==null&&Mb(f.shape,l))?Toe(r,l,i):(i.incRef(r.dataId),{dataId:r.dataId,shape:l,dtype:r.dtype})}const Aoe={kernelName:E0,backendName:"webgl",kernelFunc:ct};class OE{constructor(e,t){this.variableNames=["x"];const{windowSize:s,batchSize:r,inSize:a,outSize:i}=e;this.outputShape=[r,i];const o=Math.floor(s/4)*4,l=s%4;let c="sumValue += dot(values, ones);";if(t!=null){const d=1/t;c=`sumValue += dot(values * ${Xf(d)?d.toPrecision(2):d}, ones);`}let f="";a%s>0&&(f=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${f}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        float sumValue = 0.0;

        for (int i = 0; i < ${o}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${c}
        }

        int inIdx = inOffset + ${o};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${c}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${c}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${c}
        }
        setOutput(sumValue);
      }
    `}}class Ioe{constructor(e,t){this.variableNames=["x"];const{windowSize:s,batchSize:r,inSize:a,outSize:i}=e;this.outputShape=[r,i];let o="0.0",l="";t==="prod"?o="1.0":t==="min"?(o="1.0 / 1e-20",l="min"):t==="max"&&(o="-1.0 / 1e-20",l="max");let c=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="sum"?c="sumValue":t==="prod"?c="prodValue":t==="all"?c="allValue":t==="any"&&(c="anyValue");const f=Math.floor(s/4)*4,d=s%4;let m=`
      if (${t==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${t==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${t==="min"} || ${t==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,g="vec4";t==="all"?(o="1.0",m=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,g="bvec4"):t==="any"&&(o="0.0",m=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,g="bvec4");let b="";a%s>0&&(b=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${o};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${b}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        vec4 minMaxValue = vec4(${o});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${f}; i += 4) {
          int inIdx = inOffset + i;
          ${g} values = ${g}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${m}
        }

        int inIdx = inOffset + ${f};
        if (${d===1}) {
          ${g} values = ${g}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${m}
        } else if (${d===2}) {
          ${g} values = ${g}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${m}
        } else if (${d===3}) {
          ${g} values = ${g}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${m}
        }
        setOutput(${c});
      }
    `}}function Eoe(n){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const t=e.length?e[e.length-1].outSize:n[1],s=Vv(t);e.push({inSize:t,windowSize:s,outSize:Math.ceil(t/s)})}return e}function Td(n,e,t,s){const r=Eoe(n.shape);let a=n;for(let i=0;i<r.length;i++){const{inSize:o,windowSize:l,outSize:c}=r[i];let f,d;t==="mean"?f=i===0?new OE({windowSize:l,inSize:o,batchSize:n.shape[0],outSize:c},o):new OE({windowSize:l,inSize:o,batchSize:n.shape[0],outSize:c}):f=new Ioe({windowSize:l,inSize:o,batchSize:n.shape[0],outSize:c},t),d=a,a=s.runWebGLProgram(f,[a],e),d.dataId!==n.dataId&&s.disposeIntermediateTensorInfo(d)}return a}class _oe{constructor(e,t){this.variableNames=["A"];const s=new Array(e.length);for(let i=0;i<s.length;i++)s[i]=e[t[i]];this.outputShape=s,this.rank=s.length;const r=os(this.rank),a=$oe(t);this.userCode=`
    void main() {
      ${r} resRC = getOutputCoords();
      setOutput(getA(${a}));
    }
    `}}function $oe(n){const e=n.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const t=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],s=new Array(e);for(let r=0;r<n.length;r++)s[n[r]]=t[r];return s.join()}class Roe{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const s=new Array(e.length);for(let f=0;f<s.length;f++)s[f]=e[t[f]];if(this.outputShape=s,this.rank=s.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const r=os(this.rank),a=sF("rc",this.rank),i=new Array(this.rank);for(let f=0;f<t.length;f++)i[t[f]]=a[f];const o=`vec2(${i.slice(-2).join()})`,l=`++${a[this.rank-1]} < ${s[this.rank-1]}`,c=`getChannel(getA(${i.join()}), ${o})`;this.userCode=`
    void main() {
      ${r} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${c};
      if(${l}) {
        result[1] = ${c};
      }
      --${a[this.rank-1]};
      if(++${a[this.rank-2]} < ${s[this.rank-2]}) {
        result[2] = ${c};
        if(${l}) {
          result[3] = ${c};
        }
      }
      setOutput(result);
    }
    `}}function aw(n,e,t){const s=De().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Roe(n.shape,e):new _oe(n.shape,e);return t.runWebGLProgram(s,[n],n.dtype)}function Doe(n,e,t,s){const r=e,a=n.shape.length,i=vn(r,n.shape);let o=i;const l=js(o,a),c=l!=null;let f=n;c&&(f=aw(n,l,s),o=hr(o.length,a)),da("sum",o,a);const[d,m]=Zr(f.shape,o);let g=d;t&&(g=cr(d,i));const b=Be(m),v=Be(n.shape)/b,w=ct({inputs:{x:f},attrs:{shape:[v,b]},backend:s}),k=nv(n.dtype),I=Td(w,k,"sum",s),A=ct({inputs:{x:I},attrs:{shape:g},backend:s});return s.disposeIntermediateTensorInfo(w),s.disposeIntermediateTensorInfo(I),c&&s.disposeIntermediateTensorInfo(f),A}function iw(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:a,keepDims:i}=s;return Doe(r,a,i,t)}const Ooe={kernelName:L0,backendName:"webgl",kernelFunc:iw};function Va(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{perm:a}=s,i=t,o=r.shape.length,l=new Array(o);for(let f=0;f<l.length;f++)l[f]=r.shape[a[f]];let c;if(i.shouldExecuteOnCPU([r])){const d=i.texData.get(r.dataId).values,m=gC(d,r.shape,r.dtype,a,l);c=i.makeTensorInfo(l,r.dtype);const g=i.texData.get(c.dataId);g.values=m}else c=aw(r,a,i);return c}const Loe={kernelName:Wf,backendName:"webgl",kernelFunc:Va};const cF=1e3;function zb({a:n,b:e,transposeA:t,transposeB:s,backend:r,bias:a=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:l=null}){const c=n.shape.length,f=e.shape.length,d=t?n.shape[c-2]:n.shape[c-1],m=s?e.shape[f-1]:e.shape[f-2],g=t?n.shape[c-1]:n.shape[c-2],b=s?e.shape[f-2]:e.shape[f-1],x=n.shape.slice(0,-2),v=e.shape.slice(0,-2),w=Be(x),k=Be(v),A=on(n.shape.slice(0,-2),e.shape.slice(0,-2)).concat([g,b]);Z(d===m,()=>`Error in matMul: inner shapes (${d}) and (${m}) of Tensors with shapes ${n.shape} and ${e.shape} and transposeA=${t} and transposeB=${s} must match.`);const R=t?[w,d,g]:[w,g,d],U=s?[k,b,m]:[k,m,b],V=ct({inputs:{x:n},backend:r,attrs:{shape:R}}),P=ct({inputs:{x:e},backend:r,attrs:{shape:U}}),D=[V,P],B=Math.max(w,k),E=t?V.shape[1]:V.shape[2],M=a!=null,K=i!=null,X=l==="leakyrelu",ae=l!=null?R1(l,!0):null,W=M||K||X||ae!=null;let se;if((g===1||b===1)&&E>cF&&W===!1){let ce=V,ye=P;t&&(ce=Va({inputs:{x:V},backend:r,attrs:{perm:[0,2,1]}}),D.push(ce)),s&&(ye=Va({inputs:{x:P},backend:r,attrs:{perm:[0,2,1]}}),D.push(ye));const G=b!==1,O=b===1;let j=ce;G&&(j=ct({inputs:{x:ce},backend:r,attrs:{shape:[B,E,1]}}),D.push(j));const Y=b===1?2:1;let ie=ye;O&&(ie=ct({inputs:{x:ye},backend:r,attrs:{shape:[B,1,E]}}),D.push(ie));const ue=bC({inputs:{a:j,b:ie},backend:r});se=iw({inputs:{x:ue},backend:r,attrs:{axis:Y,keepDims:!0}}),D.push(ue)}else{const ce=ai(n.dtype,e.dtype),ye=new uF(R,U,[B,g,b],t,s,M,ae,K,X),G=[V,P];if(a!=null&&G.push(a),K&&G.push(i),X){const O=r.makeTensorInfo([],"float32",kc(o,"float32"));G.push(O),D.push(O)}se=r.runWebGLProgram(ye,G,ce)}const ee=ct({inputs:{x:se},backend:r,attrs:{shape:A}});D.push(se);for(const ce of D)r.disposeIntermediateTensorInfo(ce);return ee}function Foe(n){const{inputs:e,backend:t,attrs:s}=n,{a:r,b:a,bias:i,preluActivationWeights:o}=e,{transposeA:l,transposeB:c,activation:f,leakyreluAlpha:d}=s;return zb({a:r,b:a,transposeA:l,transposeB:c,backend:t,bias:i,preluActivationWeights:o,leakyreluAlpha:d,activation:f})}const Moe={kernelName:g1,backendName:"webgl",kernelFunc:Foe};const LE="return abs(x);";function zoe(n){const{inputs:e,backend:t}=n,{x:s}=e;if(t.shouldExecuteOnCPU([s])&&s.dtype!=="complex64"){const a=t.texData.get(s.dataId),i=tF(a.values);return t.makeTensorInfo(s.shape,s.dtype,i)}let r;return De().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new vh(s.shape,LE):r=new gu(s.shape,LE),t.runWebGLProgram(r,[s],s.dtype)}const Poe={kernelName:B1,backendName:"webgl",kernelFunc:zoe};const Boe=Ko+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,Uoe=zn({opSnippet:Boe}),Voe={kernelName:nm,backendName:"webgl",kernelFunc:Uoe};const joe=Ko+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,Woe=zn({opSnippet:joe}),Goe={kernelName:sm,backendName:"webgl",kernelFunc:Woe};const FE="return a + b;",qoe=ma({opSnippet:FE,packedOpSnippet:FE,supportsComplex:!0,cpuKernelImpl:nie}),Hoe={kernelName:gd,backendName:"webgl",kernelFunc:qoe};class Koe{constructor(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map((a,i)=>`T${i}`);const s=[];this.variableNames.forEach(a=>{s.push(`float v${a} = get${a}AtOutCoords();`)});const r=this.variableNames.map(a=>`v${a}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        float result = ${r};
        setOutput(result);
      }
    `}}class Xoe{constructor(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map((a,i)=>`T${i}`);const s=[];this.variableNames.forEach(a=>{s.push(`vec4 v${a} = get${a}AtOutCoords();`)});const r=this.variableNames.map(a=>`v${a}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        vec4 result = ${r};
        setOutput(result);
      }
    `}}function tb(n){const{inputs:e,backend:t}=n,s=e;if(s.length===1)return zi({inputs:{x:s[0]},backend:t});if(s.length>De().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const l=Math.floor(s.length/2),c=tb({inputs:s.slice(0,l),backend:t}),f=tb({inputs:s.slice(l),backend:t});return tb({inputs:[c,f],backend:t})}const r=s.map(l=>l.dtype).reduce((l,c)=>ai(l,c)),a=s.map(l=>l.shape),o=De().getBool("WEBGL_PACK")?new Xoe(s[0].shape,a):new Koe(s[0].shape,a);return t.runWebGLProgram(o,s,r)}const Yoe={kernelName:U1,backendName:"webgl",kernelFunc:tb};function Zoe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:a,keepDims:i}=s,o=r.shape.length,l=vn(a,r.shape);let c=l;const f=js(c,o);let d=r;f!=null&&(d=Va({inputs:{x:r},backend:t,attrs:{perm:f}}),c=hr(c.length,o)),da("all",c,o);const[m,g]=Zr(d.shape,c),b=Be(g),x=ct({inputs:{x:d},backend:t,attrs:{shape:[-1,b]}}),v=Td(x,x.dtype,"all",t);let w;if(i){const k=cr(m,l);w=ct({inputs:{x:v},backend:t,attrs:{shape:k}})}else w=ct({inputs:{x:v},backend:t,attrs:{shape:m}});return t.disposeIntermediateTensorInfo(x),t.disposeIntermediateTensorInfo(v),f!=null&&t.disposeIntermediateTensorInfo(d),w}const Joe={kernelName:Yb,backendName:"webgl",kernelFunc:Zoe};function Qoe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:a,keepDims:i}=s,o=r.shape.length,l=vn(a,r.shape);let c=l;const f=js(c,o);let d=r;f!=null&&(d=Va({inputs:{x:r},backend:t,attrs:{perm:f}}),c=hr(c.length,o)),da("any",c,o);const[m,g]=Zr(d.shape,c),b=Be(g),x=ct({inputs:{x:d},backend:t,attrs:{shape:[-1,b]}}),v=Td(x,x.dtype,"any",t);let w;if(i){const k=cr(m,l);w=ct({inputs:{x:v},backend:t,attrs:{shape:k}})}else w=ct({inputs:{x:v},backend:t,attrs:{shape:m}});return t.disposeIntermediateTensorInfo(x),t.disposeIntermediateTensorInfo(v),f!=null&&t.disposeIntermediateTensorInfo(d),w}const ele={kernelName:Zb,backendName:"webgl",kernelFunc:Qoe};class tle{constructor(e,t,s){this.variableNames=["A"];const{windowSize:r,batchSize:a,outSize:i}=e;s||this.variableNames.push("bestIndicesA"),this.outputShape=[a,i];const o=t==="max"?">":"<",l=s?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${r}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${o} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}class nle{constructor(e,t,s,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,Z(e.length>2,()=>`Packed arg${s.charAt(0).toUpperCase()+s.slice(1)} supports only inputs with rank above 2.`);const a=e[e.length-1],i=Math.ceil(a/t);this.outputShape=e.slice(0,-1),i>1&&this.outputShape.push(i),r||this.variableNames.push("bestIndicesA");const o=this.outputShape,l=o.length,c=os(l),f=Ua("coords",l);let d,m;if(i===1){m=l+1;const P=os(m);d=`
        ${P} sourceLocR = ${P}(${f.join()}, 0);
        ++${f[l-1]};
        ${P} sourceLocG = ${P}(${f.join()}, 0);
        ++${f[l-2]};
        ${P} sourceLocA = ${P}(${f.join()}, 0);
        --${f[l-1]};
        ${P} sourceLocB = ${P}(${f.join()}, 0);
        --${f[l-2]};`}else m=l,d=`
        ${c} sourceLocR = coords;
        ++${f[l-1]};
        ${c} sourceLocG = coords;
        ++${f[l-2]};
        ${c} sourceLocA = coords;
        --${f[l-1]};
        ${c} sourceLocB = coords;
        --${f[l-2]};`;const g=["x","y","z","w","u","v"].slice(0,m),b="."+g[m-1],x=g.map(P=>"int "+P),v=Ua("sourceLocR",m-1).concat("inIdx.r"),w=Ua("sourceLocG",m-1).concat("inIdx.g"),k=Ua("sourceLocB",m-1).concat("inIdx.b"),I=Ua("sourceLocA",m-1).concat("inIdx.a"),A=s==="max"?"greaterThan":"lessThan",R=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${v.join()}),
                             getBestIndicesAChannel(${w.join()}),
                             getBestIndicesAChannel(${k.join()}),
                             getBestIndicesAChannel(${I.join()})));`,U=`vec4(
            getAChannel(${v.join()}),
            hasNextCol ? getAChannel(${w.join()}) : 0.,
            hasNextRow ? getAChannel(${k.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${I.join()}) : 0.)`,V=r?"":`
      float getBestIndicesAChannel(${x.join()}) {
        return getChannel(getBestIndicesA(${g.join()}),
                                          vec2(${g.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${x.join()}) {
        return getChannel(getA(${g.join()}),
                               vec2(${g.slice(-2).join()}));
      }
      ${V}
      void main() {
        ${c} coords = getOutputCoords();
        bool hasNextCol = ${f[l-1]} < ${o[l-1]-1};
        bool hasNextRow = ${f[l-2]} < ${o[l-2]-1};
        ${d}
        ivec4 srcIdx = ivec4(sourceLocR${b}, sourceLocG${b},
          sourceLocB${b}, sourceLocA${b}) * ${t};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${U};

        for (int i = 0; i < ${t}; i++) {
          inIdx = srcIdx;
          ${R}
          vec4 candidate = ${U};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${A}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}function hF(n,e,t,s=null){let r=e.shape[0],a=e.shape[1];s!=null&&(r=s.shape[0],a=s.shape[1]);const i=Vv(a),o={windowSize:i,inSize:a,batchSize:r,outSize:Math.ceil(a/i)},l=new tle(o,t,s==null),c=[e];s!=null&&c.push(s);const f=n.runWebGLProgram(l,c,"int32");if(f.shape[1]===1)return f;const d=hF(n,e,t,f);return n.disposeIntermediateTensorInfo(f),d}function fF(n,e,t,s=null){const r=s!=null?s.shape:e.shape,a=r[r.length-1],i=Vv(a),o=new nle(r,i,t,s==null),l=s==null?[e]:[e,s],c=n.runWebGLProgram(o,l,"int32");if(c.shape.length===e.shape.length){const f=fF(n,e,t,c);return n.disposeIntermediateTensorInfo(c),f}return c}function dF(n,e,t,s){const r=[t];if(da("arg"+s.charAt(0).toUpperCase()+s.slice(1),r,e.shape.length),!De().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const a=[],i=n.texData.get(e.dataId),o=i!==null&&i.isPacked;let l=e;o&&(l=n.unpackTensor(e),a.push(l));const[c,f]=Zr(l.shape,r),d=Be(f),m=ct({inputs:{x:l},backend:n,attrs:{shape:[-1,d]}});a.push(m);const g=hF(n,m,s);a.push(g);const b=ct({inputs:{x:g},backend:n,attrs:{shape:c}});return a.forEach(x=>n.disposeIntermediateTensorInfo(x)),b}return fF(n,e,s)}function sle(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:a}=s;let i=vn(a,r.shape);const o=js(i,r.shape.length);let l=r;const c=[];o!=null&&(l=Va({inputs:{x:r},backend:t,attrs:{perm:o}}),c.push(l),i=hr(i.length,l.shape.length)),da("argMax",[i[0]],l.shape.length);const f=dF(t,l,i[0],"max");return c.forEach(d=>t.disposeIntermediateTensorInfo(d)),f}const rle={kernelName:V1,backendName:"webgl",kernelFunc:sle};function ale(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:a}=s;let i=vn(a,r.shape);const o=js(i,r.shape.length);let l=r;const c=[];o!=null&&(l=Va({inputs:{x:r},backend:t,attrs:{perm:o}}),c.push(l),i=hr(i.length,l.shape.length)),da("argMin",[i[0]],l.shape.length);const f=dF(t,l,i[0],"min");return c.forEach(d=>t.disposeIntermediateTensorInfo(d)),f}const ile={kernelName:j1,backendName:"webgl",kernelFunc:ale};const ole=Ko+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,lle=zn({opSnippet:ole}),ule={kernelName:rm,backendName:"webgl",kernelFunc:lle};const cle=Ko+"return log(x + sqrt(x * x + 1.0));",hle=zn({opSnippet:cle}),fle={kernelName:am,backendName:"webgl",kernelFunc:hle};const dle=Ko+`
  return atan(x);
`,ple=zn({opSnippet:dle}),mle={kernelName:im,backendName:"webgl",kernelFunc:ple};const gle=yC+`
  return atan(a, b);
`,yle=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Cd+`
  return result;
`,ble=ma({opSnippet:gle,packedOpSnippet:yle}),xle={kernelName:lm,backendName:"webgl",kernelFunc:ble};const vle=Ko+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,wle=zn({opSnippet:vle}),Sle={kernelName:om,backendName:"webgl",kernelFunc:wle};class D1{constructor(e,t,s,r=!1,a=!1){if(this.variableNames=["x"],t==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const i=e.filterWidth,o=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,f=e.dilationWidth,d=e.effectiveFilterHeight,m=e.effectiveFilterWidth,g=e.padInfo.top,b=e.padInfo.left;this.outputShape=e.outShape;const x=t==="avg",v=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,w=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let k="0.0";if(x||(k="-1.0 / 1e-20"),s){this.userCode=`
        const ivec2 strides = ivec2(${o}, ${l});
        const ivec2 pads = ivec2(${g}, ${b});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${d};
              wR += ${c}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${m};
                wC += ${f}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value >= currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${r?a?v:w:`wR * ${m} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const I="max";let A=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="avg"&&(A="avgValue / max(count, 1.0)");const R=Math.floor(i/4)*4,U=i%4,V=`
      if (${x}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${I}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${o}, ${l});
      const ivec2 pads = ivec2(${g}, ${b});
      const float initializationValue = ${k};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${k});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${d};
            wR += ${c}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${R}; wC += 4) {
            int xC = xCCorner + wC * ${f};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${f}, d),
              getValue(batch, xR, xC + 2 * ${f}, d),
              getValue(batch, xR, xC + 3 * ${f}, d)
            );

            ${V}
          }

          int xC = xCCorner + ${R};
          if (${U===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${V}
          } else if (${U===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${f}, d),
              initializationValue,
              initializationValue
            );

            ${V}
          } else if (${U===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${f}, d),
              getValue(batch, xR, xC + 2 * ${f}, d),
              initializationValue
            );

            ${V}
          }
        }
        setOutput(${A});
      }
    `}}class xC{constructor(e,t,s,r=!1,a=!1){if(this.variableNames=["x"],t==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const i=e.filterWidth,o=e.strideDepth,l=e.strideHeight,c=e.strideWidth,f=e.dilationDepth,d=e.dilationHeight,m=e.dilationWidth,g=e.effectiveFilterDepth,b=e.effectiveFilterHeight,x=e.effectiveFilterWidth,v=e.padInfo.front,w=e.padInfo.top,k=e.padInfo.left;this.outputShape=e.outShape;const I=t==="avg";let A="0.0";if(I||(A="-1.0 / 1e-20"),s){this.userCode=`
        const ivec3 strides =
            ivec3(${o}, ${l}, ${c});
        const ivec3 pads = ivec3(${v}, ${w}, ${k});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${g};
              wD += ${f}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${b};
                wR += ${d}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${x};
                  wC += ${m}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value >= currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${r?a?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${b} * ${x} +
                      wR * ${x} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const R="max";let U=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="avg"&&(U="avgValue / max(count, 1.0)");const V=Math.floor(i/4)*4,P=i%4,D=`
      if (${I}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${R}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${o}, ${l}, ${c});
      const ivec3 pads = ivec3(${v}, ${w}, ${k});
      const float initializationValue = ${A};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${A});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${g};
            wD += ${f}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${b};
            wR += ${d}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${V}; wC += 4) {
              int xC = xCCorner + wC * ${m};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${m}, ch),
                getValue(batch, xD, xR, xC + 2 * ${m}, ch),
                getValue(batch, xD, xR, xC + 3 * ${m}, ch)
              );

              ${D}
            }

            int xC = xCCorner + ${V};
            if (${P===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${D}
            } else if (${P===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${m}, ch),
                initializationValue,
                initializationValue
              );

              ${D}
            } else if (${P===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${m}, ch),
                getValue(batch, xD, xR, xC + 2 * ${m}, ch),
                initializationValue
              );

              ${D}
            }
          }
        }
        setOutput(${U});
      }
    `}}function Nle(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e;wy(r,"avgPool");const{filterSize:a,strides:i,pad:o,dimRoundingMode:l}=s,c=1;Z(fa(i,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const f=qo(r.shape,a,i,c,o,l);if(f.filterWidth===1&&f.filterHeight===1&&Nn(f.inShape,f.outShape))return zi({inputs:{x:r},backend:t});const d=new D1(f,"avg",!1);return t.runWebGLProgram(d,[r],"float32")}const kle={kernelName:W1,backendName:"webgl",kernelFunc:Nle};function Cle(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{filterSize:a,strides:i,pad:o,dimRoundingMode:l,dataFormat:c}=s,f=[1,1,1],d=Cc(r.shape,a,i,f,o,l,c),m=new xC(d,"avg",!1);return t.runWebGLProgram(m,[r],"float32")}const Tle={kernelName:G1,backendName:"webgl",kernelFunc:Cle};class Ale{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterHeight,s=e.filterWidth,r=e.strideHeight,a=e.strideWidth,i=e.dilationHeight,o=e.dilationWidth,l=e.effectiveFilterHeight,c=e.effectiveFilterWidth,f=l-1-e.padInfo.top,d=c-1-e.padInfo.left,m=1/(t*s);this.userCode=`
      const ivec2 pads = ivec2(${f}, ${d});
      const float avgMultiplier = float(${m});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${i}) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${c};
            wC+= ${o}) {
            float dyC = float(dyCCorner + wC) / ${a}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class Ile{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterDepth,s=e.filterHeight,r=e.filterWidth,a=e.strideDepth,i=e.strideHeight,o=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,f=e.dilationWidth,d=e.effectiveFilterDepth,m=e.effectiveFilterHeight,g=e.effectiveFilterWidth,b=d-1-e.padInfo.front,x=m-1-e.padInfo.top,v=g-1-e.padInfo.left,w=1/(t*s*r);this.userCode=`
      const ivec3 pads = ivec3(${b}, ${x}, ${v});
      const float avgMultiplier = float(${w});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${d};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${a}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${m};
              wR += ${c}) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${g};
                wC += ${f}) {
              float dyC = float(dyCCorner + wC) / ${o}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}function Ele(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,input:a}=e,i=a,{filterSize:o,strides:l,pad:c,dimRoundingMode:f}=s,d=[1,1,1],m=Cc(i.shape,o,l,d,c,f),g=new Ile(m);return t.runWebGLProgram(g,[r],i.dtype)}const _le={kernelName:Qb,backendName:"webgl",kernelFunc:Ele};function $le(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,input:a}=e,i=a;wy([r,a],"avgPoolGrad");const{filterSize:o,strides:l,pad:c}=s,f=qo(i.shape,o,l,1,c),d=new Ale(f);return t.runWebGLProgram(d,[r],i.dtype)}const Rle={kernelName:Jb,backendName:"webgl",kernelFunc:$le};function Dle(n){const{inputs:e,backend:t,attrs:s}=n,{a:r,b:a}=e,{transposeA:i,transposeB:o}=s;return zb({a:r,b:a,transposeA:i,transposeB:o,backend:t})}const Ole={kernelName:q1,backendName:"webgl",kernelFunc:Dle};class Lle{constructor(e,t,s,r,a,i){this.outputShape=[],this.variableNames=["x","mean","variance"],on(e,t),on(e,s);let o="0.0";r!=null&&(on(e,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");let l="1.0";a!=null&&(on(e,a),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${o};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${i}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}class Fle{constructor(e,t,s,r,a,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],on(e,t),on(e,s);let o="vec4(0.0)";r!=null&&(on(e,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");let l="vec4(1.0)";a!=null&&(on(e,a),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${o};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${i}));

        setOutput((x - mean) * inv + offset);
      }
    `}}const Mle=({inputs:n,backend:e,attrs:t})=>{const{x:s,mean:r,variance:a,offset:i,scale:o}=n;Z(r.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),Z(i==null||r.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),Z(o==null||r.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=t;l==null&&(l=.001);const c=[s,r,a];let f=null;i!=null&&(f=i.shape,c.push(i));let d=null;o!=null&&(d=o.shape,c.push(o));const m=De().getBool("WEBGL_PACK_NORMALIZATION")?new Fle(s.shape,r.shape,a.shape,f,d,l):new Lle(s.shape,r.shape,a.shape,f,d,l);return e.runWebGLProgram(m,c,c[0].dtype)},zle={kernelName:a0,backendName:"webgl",kernelFunc:Mle};class Ple{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const t=os(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const s=Ble(this.rank);let r;const a=e.map((i,o)=>`sourceLoc.${dN[o]} = start[${o}] + coords.${dN[o]};`);r=`
        ${t} sourceLoc;
        ${t} coords = getOutputCoords();
        ${a.join(`
`)}
      `,this.userCode=`
      void main() {
        ${r}
        setOutput(getSource(${s}));
      }
    `}}const dN=["x","y","z","w","u","v"];function Ble(n){if(n===1)return"sourceLoc";if(n<=6)return dN.slice(0,n).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${n} is not yet supported`)}class Ule{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const t=os(this.rank),s=Ua("coords",this.rank),r=Ua("sourceLoc",this.rank),a=this.rank===1?"sourceLoc":`vec2(${r.slice(-2).join()})`,i=`getChannel(getSource(${r.join()}), ${a})`,o=`
      result.x = ${i};
      if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
        ++${r[this.rank-1]};
        result.y = ${i};
        --${r[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${s[this.rank-1]};
      if (++${s[this.rank-2]} < ${e[this.rank-2]}) {
        ++${r[this.rank-2]};
        result.z = ${i};
        if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
          ++${r[this.rank-1]};
          result.w = ${i};
        }
      }
    `,c=this.rank<=4?`sourceLoc = coords +
            ${t}(${e.map((f,d)=>`start[${d}]`).join()});`:e.map((f,d)=>`${r[d]} = ${s[d]} + start[${d}];`).join(`
`);this.userCode=`
      void main() {
        ${t} coords = getOutputCoords();
        ${t} sourceLoc;
        ${c}
        vec4 result = vec4(0.);
        ${o}
        ${l}
        setOutput(result);
      }
    `}}function Vle(n,e,t,s){const r=s.texData.get(n.dataId),a=s.makeTensorInfo(t,n.dtype),i=s.texData.get(a.dataId);Object.assign(i,r),i.refCount=1,i.shape=t,i.dtype=n.dtype;let o=f3(e,Ot(n.shape));r.slice&&(o+=r.slice.flatOffset),i.slice={flatOffset:o,origDataId:r.slice&&r.slice.origDataId||n.dataId};const l=s.dataRefCount.get(i.slice.origDataId)||1;return s.dataRefCount.set(i.slice.origDataId,l+1),a}function dg(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{begin:a,size:i}=s,[o,l]=Uv(r,a,i);if(u3(r,o,l),Be(l)===0)return t.makeTensorInfo(l,r.dtype,[]);if(t.shouldExecuteOnCPU([r])||r.dtype==="string"){const d=t.texData.get(r.dataId),m=Oie(d.values,o,l,r.shape,r.dtype);return t.makeTensorInfo(l,r.dtype,m)}const{isPacked:c}=t.texData.get(r.dataId),f=h3(r.shape,o,l);if(c||!f){const d=De().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Ule(l):new Ple(l),m=[o];return t.runWebGLProgram(d,[r],r.dtype,m)}return t.uploadToGPU(r.dataId),Vle(r,o,l,t)}const jle={kernelName:O0,backendName:"webgl",kernelFunc:dg};const Wle=n=>{const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{blockShape:a,crops:i}=s;Z(r.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const o=a.reduce((k,I)=>k*I),l=ly(r.shape,a,o),c=uy(l.length,a.length),f=cy(r.shape,a,o),d=b3(i,a.length),m=x3(f,i,a.length),g=[],b=ct({inputs:{x:r},backend:t,attrs:{shape:l}}),x=Va({inputs:{x:b},backend:t,attrs:{perm:c}}),v=ct({inputs:{x},backend:t,attrs:{shape:f}}),w=dg({inputs:{x:v},backend:t,attrs:{begin:d,size:m}});return g.push(b),g.push(x),g.push(v),g.forEach(k=>t.disposeIntermediateTensorInfo(k)),w},Gle={kernelName:H1,backendName:"webgl",kernelFunc:Wle};function qle(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,weights:a}=e,{size:i}=s,o=t.readSync(r.dataId),l=t.readSync(a.dataId),c=eF(o,l,a.dtype,a.shape,i);return t.makeTensorInfo([i],a.dtype,c)}const Hle={kernelName:ex,backendName:"webgl",kernelFunc:qle};const Kle=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,Xle=`
  return float(int(a.r) & int(b.r));
`;function Yle(n){const{inputs:e,backend:t}=n,{a:s,b:r}=e,a=De().getBool("WEBGL_PACK_BINARY_OPERATIONS"),i=De().getNumber("WEBGL_VERSION");if(t.shouldExecuteOnCPU([s,r])||i===1){const l=t.texData.get(s.dataId).values,c=t.texData.get(r.dataId).values,[f,d]=rie(s.shape,r.shape,l,c,s.dtype),m=t.makeTensorInfo(d,s.dtype),g=t.texData.get(m.dataId);return g.values=f,m}let o;return a?o=new hg(Kle,s.shape,r.shape,!1):o=new ud(Xle,s.shape,r.shape),t.runWebGLProgram(o,[s,r],s.dtype)}const Zle={kernelName:K1,backendName:"webgl",kernelFunc:Yle};function Jle(n){const{inputs:e,backend:t}=n,{s0:s,s1:r}=e,a=t.readSync(s.dataId),i=t.readSync(r.dataId),o=on(Array.from(a),Array.from(i));return t.makeTensorInfo([o.length],"int32",Int32Array.from(o))}const Qle={kernelName:tx,backendName:"webgl",kernelFunc:Jle};const eue="return float(a != b);",pF=ma({opSnippet:eue,cpuKernelImpl:Cie,dtype:"bool"}),tue={kernelName:S0,backendName:"webgl",kernelFunc:pF};function Ny(n){const{inputs:e,backend:t}=n,{input:s}=e,r=t.texData.get(s.dataId);return zi({inputs:{x:r.complexTensorInfos.real},backend:t})}const nue={kernelName:Lx,backendName:"webgl",kernelFunc:Ny};const sue="return float(int(x));";function rue(n,e){const t=new gu(n.shape,sue),s=e.runWebGLProgram(t,[n],"int32");return{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}function pN(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{dtype:a}=s;if(a==="complex64"){if(r.dtype==="complex64")return zi({inputs:{x:r},backend:t});const i=lr(r.shape),o=pN({inputs:{x:r},backend:t,attrs:{dtype:"float32"}}),l=Kh({inputs:{real:o,imag:i},backend:t});return i.dispose(),t.disposeIntermediateTensorInfo(o),l}if(r.dtype==="complex64"){const i=Ny({inputs:{input:r},backend:t}),o=pN({inputs:{x:i},backend:t,attrs:{dtype:a}});return t.disposeIntermediateTensorInfo(i),o}if(!FN(r.dtype,a)){const i=zi({inputs:{x:r},backend:t});return{dataId:i.dataId,shape:i.shape,dtype:a}}if(t.shouldExecuteOnCPU([r])){const i=t.texData.get(r.dataId).values,[o,l,c]=aie(i,r.shape,r.dtype,a);return t.makeTensorInfo(o,l,c)}if(a==="int32")return rue(r,t);if(a==="bool"){const i=t.makeTensorInfo([],"bool",Kr("bool",1)),l=pF({inputs:{a:r,b:i},backend:t});return t.disposeIntermediateTensorInfo(i),l}throw new Error(`Error in Cast: failed to cast ${r.dtype} to ${a}`)}const aue={kernelName:um,backendName:"webgl",kernelFunc:pN};const ME="return ceil(x);",iue=zn({opSnippet:ME,packedOpSnippet:ME,cpuKernelImpl:iie}),oue={kernelName:cm,backendName:"webgl",kernelFunc:iue};class lue{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}class uue{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}function cue(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{clipValueMin:a,clipValueMax:i}=s;let o;De().getBool("WEBGL_PACK_CLIP")?o=new uue(r.shape):o=new lue(r.shape);const l=[[a],[i]];return t.runWebGLProgram(o,[r],r.dtype,l)}const hue={kernelName:hm,backendName:"webgl",kernelFunc:cue};class fue{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}function zE(n,e){return{dataId:e.dataId,dtype:e.dtype,shape:n.shape}}function due(n){const{inputs:e,backend:t}=n,{x:s}=e,r=t.texData.get(s.dataId),a=new fue(s.shape),i=[zE(s,r.complexTensorInfos.real),zE(s,r.complexTensorInfos.imag)];return t.runWebGLProgram(a,i,i[0].dtype)}const pue={kernelName:X1,backendName:"webgl",kernelFunc:due};class mue{constructor(e){this.outputShape=[],this.outputShape=vu(e,1),this.variableNames=e.map((i,o)=>`T${o}`);const t=new Array(e.length-1);t[0]=e[0][1];for(let i=1;i<t.length;i++)t[i]=t[i-1]+e[i][1];const s=[`if (yC < ${t[0]}) setOutput(getT0(yR, yC));`];for(let i=1;i<t.length;i++){const o=t[i-1];s.push(`else if (yC < ${t[i]}) setOutput(getT${i}(yR, yC-${o}));`)}const r=t.length,a=t[t.length-1];s.push(`else setOutput(getT${r}(yR, yC-${a}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${s.join(`
        `)}
      }
    `}}class gue{constructor(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=vu(e,t);const s=this.outputShape,r=s.length,a=os(r),i=Ua("coords",r),o=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map((x,v)=>`T${v}`);const l=new Array(e.length-1);l[0]=e[0][t];for(let x=1;x<l.length;x++)l[x]=l[x-1]+e[x][t];const c=o[t],f=o.slice(-2),d=o.join();let m=`if (${c} < ${l[0]}) {
        return getChannel(
            getT0(${d}), vec2(${f.join()}));
        }`;for(let x=1;x<l.length;x++){const v=l[x-1];m+=`
        if (${c} < ${l[x]}  && ${c} >= ${l[x-1]}) {
          return getChannel(
            getT${x}(${D2(o,c,v)}),
            vec2(${D2(f,c,v)}));
        }`}const g=l.length,b=l[l.length-1];m+=`
        return getChannel(
          getT${g}(${D2(o,c,b)}),
          vec2(${D2(f,c,b)}));`,this.userCode=`
      float getValue(${o.map(x=>"int "+x)}) {
        ${m}
      }

      void main() {
        ${a} coords = getOutputCoords();
        vec4 result = vec4(getValue(${i}), 0., 0., 0.);

        ${i[r-1]} = ${i[r-1]} + 1;
        if (${i[r-1]} < ${s[r-1]}) {
          result.g = getValue(${i});
        }

        ${i[r-2]} = ${i[r-2]} + 1;
        if (${i[r-2]} < ${s[r-2]}) {
          result.a = getValue(${i});
        }

        ${i[r-1]} = ${i[r-1]} - 1;
        if (${i[r-2]} < ${s[r-2]} &&
            ${i[r-1]} < ${s[r-1]}) {
          result.b = getValue(${i});
        }
        setOutput(result);
      }
    `}}function D2(n,e,t){const s=n.indexOf(e);return n.map((a,i)=>i===s?`${a} - ${t}`:a).join()}function ow(n){const{inputs:e,backend:t}=n,{input:s}=e,r=t.texData.get(s.dataId);return zi({inputs:{x:r.complexTensorInfos.imag},backend:t})}const yue={kernelName:wx,backendName:"webgl",kernelFunc:ow};function c1(n,e,t){const s=n[0].dtype;if(s==="complex64"){const g=n.map(k=>Ny({inputs:{input:k},backend:t})),b=n.map(k=>ow({inputs:{input:k},backend:t})),x=c1(g,e,t),v=c1(b,e,t),w=Kh({inputs:{real:x,imag:v},backend:t});return g.forEach(k=>t.disposeIntermediateTensorInfo(k)),b.forEach(k=>t.disposeIntermediateTensorInfo(k)),t.disposeIntermediateTensorInfo(x),t.disposeIntermediateTensorInfo(v),w}let r=t.shouldExecuteOnCPU(n);if(s==="string"&&(r=!0),r){const g=n.map(A=>{const U=[-1,Be(A.shape.slice(e))];return ct({inputs:{x:A},backend:t,attrs:{shape:U}})}),b=g.map(A=>({vals:t.readSync(A.dataId),shape:A.shape})),x=vu(g.map(A=>A.shape),1),v=g[0].shape[0]===1,w=oie(b,x,s,v),k=vu(n.map(A=>A.shape),e),I=t.makeTensorInfo(k,s,w);return g.forEach(A=>t.disposeIntermediateTensorInfo(A)),I}const a=n.filter(g=>Be(g.shape)>0),i=De().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&a[0].shape.length>1;if(a.length===1){const g=i?new gu(n[0].shape,yh):new vh(n[0].shape,yh);return t.runWebGLProgram(g,n,s)}const o=De().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(a.length>o){const g=[];for(let x=0;x<a.length;x+=o){const v=a.slice(x,x+o);g.push(c1(v,e,t))}const b=c1(g,e,t);for(const x of g)t.disposeIntermediateTensorInfo(x);return b}if(i){const g=new gue(a.map(b=>b.shape),e);return t.runWebGLProgram(g,a,s)}const{tensors2D:l,outShape:c}=bue(a,e,t),f=new mue(l.map(g=>g.shape)),d=t.runWebGLProgram(f,l,s);l.forEach(g=>t.disposeIntermediateTensorInfo(g));const m=ct({inputs:{x:d},attrs:{shape:c},backend:t});return t.disposeIntermediateTensorInfo(d),m}function bue(n,e,t){const s=vu(n.map(a=>a.shape),e);return{tensors2D:n.map(a=>ct({inputs:{x:a},attrs:{shape:[-1,Be(a.shape.slice(e))]},backend:t})),outShape:s}}function mF(n){const{inputs:e,backend:t,attrs:s}=n,{axis:r}=s,a=vn(r,e[0].shape)[0],i=e.map(c=>c.shape);m3(i,a);const o=vu(e.map(c=>c.shape),a);if(Be(o)===0)return t.makeTensorInfo(o,e[0].dtype,[]);const l=e.filter(c=>Be(c.shape)>0);return l.length===1?zi({inputs:{x:l[0]},backend:t}):c1(l,a,t)}const xue={kernelName:Y1,backendName:"webgl",kernelFunc:mF};class gF{constructor(e,t=!1,s=null,r=!1,a=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const i=e.padInfo.top,o=e.padInfo.left,l=e.strideHeight,c=e.strideWidth,f=e.dilationHeight,d=e.dilationWidth,m=e.filterHeight,g=e.filterWidth,b=Math.floor(e.inChannels/4)*4,x=e.inChannels%4,v=e.dataFormat==="channelsLast",w=v?1:2,k=v?2:3,I=v?3:1;let A="",R="";s&&(r?A=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:a?A=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:A=`
          float activation(float x) {
            ${s}
          }
        `,R="result = activation(result);");const U=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${A}

      const ivec2 strides = ivec2(${l}, ${c});
      const ivec2 pads = ivec2(${i}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${I}];

        ivec2 xRCCorner =
            ivec2(coords[${w}], coords[${k}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${m}; wR++) {
          int xR = xRCorner + wR * ${f};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${g}; wC++) {
            int xC = xCCorner + wC * ${d};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${b}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${v}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${x===1}) {

              if (${v}) {
                dotProd +=
                    getX(batch, xR, xC, ${b}) *
                    getW(wR, wC, ${b}, d2);
              } else {
                dotProd +=
                    getX(batch, ${b}, xR, xC) *
                    getW(wR, wC, ${b}, d2);
              }

            } else if (${x===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${b}, d2),
                getW(wR, wC, ${b} + 1, d2)
              );

              if (${v}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${b}),
                  getX(batch, xR, xC, ${b} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${b}, xR, xC),
                  getX(batch, ${b} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${x===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${b}, d2),
                getW(wR, wC, ${b} + 1, d2),
                getW(wR, wC, ${b} + 2, d2)
              );

              if (${v}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${b}),
                  getX(batch, xR, xC, ${b} + 1),
                  getX(batch, xR, xC, ${b} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${b}, xR, xC),
                  getX(batch, ${b} + 1, xR, xC),
                  getX(batch, ${b} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${U}
        ${R}
        setOutput(result);
      }
    `}}class vue{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const t=e.padInfo.front,s=e.padInfo.top,r=e.padInfo.left,a=e.strideDepth,i=e.strideHeight,o=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,f=e.dilationWidth,d=e.filterDepth,m=e.filterHeight,g=e.filterWidth,b=Math.floor(e.inChannels/4)*4,x=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${a}, ${i}, ${o});
      const ivec3 pads = ivec3(${t}, ${s}, ${r});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${d}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${m}; wR++) {
            int xR = xRCorner + wR * ${c};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${g}; wC++) {
              int xC = xCCorner + wC * ${f};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${b}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${x===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${b}) *
                  getW(wF, wR, wC, ${b}, d2);
              } else if (${x===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${b}),
                  getX(batch, xF, xR, xC, ${b} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${b}, d2),
                  getW(wF, wR, wC, ${b} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${x===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${b}),
                  getX(batch, xF, xR, xC, ${b} + 1),
                  getX(batch, xF, xR, xC, ${b} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${b}, d2),
                  getW(wF, wR, wC, ${b} + 1, d2),
                  getW(wF, wR, wC, ${b} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class yF{constructor(e,t=!1,s=null,r=!1,a=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Ia(this.outputShape.length);const i=e.padInfo.left,o=e.strideWidth,l=e.dilationWidth,c=e.filterHeight,f=e.filterWidth,d=f;let m=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let v=0;v<f;v++)m+=`
           vec4 xTexelC${v*2};
           int xTexelC${v*2}Ready;
           vec4 xTexelC${v*2+1};
           int xTexelC${v*2+1}Ready;
           vec4 xC${v};`;m+=`
     for (int r = 0; r < ${c}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let v=0;v<f;v++)m+=`
           xTexelC${v*2} = vec4(0.0);
           xTexelC${v*2}Ready = 0;
           xTexelC${v*2+1} = vec4(0.0);
           xTexelC${v*2+1}Ready = 0;
           xC${v} = vec4(0.0);`;m+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let v=0;v<(d+1)/2;v++){const w=v*2;if(m+=`
           xC = xCCorner + ${w*l};
           `,o===1){if(w<f&&(i%2===1?(m+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w}Ready == 0) {
                   xTexelC${w} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${w}.zw = vec2(0.0);
                   }
                   xTexelC${w}Ready = 1;
                 }
               `,l===1&&w>0?m+=`
                 xC${w} = vec4(xTexelC${w-2}.zw, xTexelC${w}.xy);
                 `:m+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${w} = vec4(previous.zw, xTexelC${w}.xy);
                   } else {
                     xC${w} = vec4(0.0, 0.0, xTexelC${w}.xy);
                   }
                   `):m+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${w}Ready == 0) {
                   xTexelC${w} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${w}.zw = vec2(0.0);
                   }
                   xTexelC${w}Ready = 1;
                 }

                 xC${w} = xTexelC${w};
                 `,w+1<f)){const k=i%2===0?Kb(l):l;l%2===0&&i%2===1||l%2!==0&&i%2!==1?(m+=`
                   xCOffset = xC + imod(pads[1], 2) + ${k};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w+1}Ready == 0) {
                     xTexelC${w+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${w+1}.zw = vec2(0.0);
                     }
                     xTexelC${w+1}Ready = 1;
                   }
                   `,l>1?m+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${w+1} = vec4(previous.zw, xTexelC${w+1}.xy);
                     } else {
                      xC${w+1} = vec4(0.0, 0.0, xTexelC${w+1}.xy);
                     }
                     `:m+=`
                     xC${w+1} = vec4(xTexelC${w}.zw, xTexelC${w+1}.xy);
                     `):k===1?m+=`
                     xC${w+1} = xTexelC${w};
                     `:m+=`
                     xCOffset = xC + ${k};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w+1}Ready == 0) {
                       xTexelC${w+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${w+1}.zw = vec2(0.0);
                       }
                       xTexelC${w+1}Ready = 1;
                     }

                     xC${w+1} = xTexelC${w+1};
                     `}}else w<f&&(i%2===1?(m+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w}Ready == 0) {
                   xTexelC${w} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${w}.zw = vec2(0.0);
                   }
                   xTexelC${w}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${w+1}Ready == 0) {
                   xTexelC${w+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${w+1}.zw = vec2(0.0);
                   }
                   xTexelC${w+1}Ready = 1;
                 }

                 xC${w} = vec4(xTexelC${w}.zw, xTexelC${w+1}.zw);
               `,w+1<f&&(m+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${w+1} = vec4(xTexelC${w+1}.xy, final.xy);
                 `)):(m+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${w}Ready == 0) {
                   xTexelC${w} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${w}.zw = vec2(0.0);
                   }
                   xTexelC${w}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w+1}Ready == 0) {
                   xTexelC${w+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${w+1}.zw = vec2(0.);
                   }
                   xTexelC${w+1}Ready = 1;
                 }

                 xC${w} = vec4(
                   xTexelC${w}.xy, xTexelC${w+1}.xy);
               `,w+1<f&&(m+=`
                   xC${w+1} = vec4(xTexelC${w}.zw, xTexelC${w+1}.zw);
                 `)));w<f&&(m+=`
             wTexel = getW(r, ${w}, d1, d2);
             dotProd += xC${w}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${w}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,w+1<f&&(m+=`
               wTexel = getW(r, ${w+1}, d1, d2);
               dotProd += xC${w+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${w+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}m+=`
     }
   `,m+=`
     }
   `,m+=`
     }
   `;let g="",b="";s&&(r?g=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${s}
         }`:a?g=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${s}
         }`:g=`vec4 activation(vec4 x) {
           ${s}
         }`,b="result = activation(result);");const x=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${g}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${m}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${x}
         ${b}
         setOutput(result);
       }
     `}}class wue{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=Ia(this.outputShape.length);const{dataFormat:s}=t,r=Wa(),a=s==="channelsLast",i=a?1:2,o=a?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let c="";for(let f=0;f<=1;f++)for(let d=0;d<=1;d++)c+=`
          blockIndex = rc.z + ${d};
          pos = rc.y + ${f};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${i}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${o}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${a}) {
                  innerDims = vec2(d1, ch);
                  result[${f*2+d}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${f*2+d}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${c}

        ${r.output} = result;
      }
    `}}function Pb(n,e){const t=n.length;return t>=3?e?[...n.slice(0,-3),n[t-3]*n[t-2],n[t-1]]:[...n.slice(0,-3),n[t-3],n[t-2]*n[t-1]]:!e&&t===1&&n[0]>1?[n[0],1]:null}function bF({x:n,filter:e,convInfo:t,backend:s,bias:r=null,preluActivationWeights:a=null,leakyreluAlpha:i=0,activation:o=null}){const l=n.shape,c=s.texData.get(n.dataId),f=t.inChannels,d=l[0]*l[1]*l[2],m=t.outChannels,g=t.dataFormat==="channelsLast",b=!1,x=!1;let v;const w=[];if(a!=null){const A=Pb(a.shape,g);A!=null&&(a=ct({inputs:{x:a},backend:s,attrs:{shape:A}}),w.push(a))}if(r!=null){const A=Pb(r.shape,g);A!=null&&(r=ct({inputs:{x:r},backend:s,attrs:{shape:A}}),w.push(r))}if(!((d===1||m===1)&&f>cF)&&c.isPacked&&g&&c.texture!=null&&l[2]%2!==0&&Nn(c.shape.slice(-3),l.slice(-3))){const A=l[0]*l[1]*(l[2]+1),R={dataId:n.dataId,shape:[1,A,t.inChannels],dtype:n.dtype},U=c.shape;c.shape=c.shape.slice(),c.shape[c.shape.length-2]++,Z(Mb(c.shape,R.shape),()=>`packed reshape ${c.shape} to ${R.shape} isn't free`);const V=ct({inputs:{x:e},backend:s,attrs:{shape:[1,t.inChannels,t.outChannels]}});w.push(V);const P=zb({a:R,b:V,backend:s,transposeA:b,transposeB:x,bias:r,activation:o,preluActivationWeights:a,leakyreluAlpha:i}),D=s.texData.get(P.dataId);Z(D.isPacked,()=>"batchMatMul result is expected to be packed"),c.shape=U,D.shape=t.outShape,v=zi({inputs:{x:P},backend:s}),v.shape=t.outShape,w.push(P)}else{const A=t.outHeight*t.outWidth,R=ct({inputs:{x:n},backend:s,attrs:{shape:g?[t.batchSize,A,t.inChannels]:[t.batchSize,t.inChannels,A]}}),U=ct({inputs:{x:e},backend:s,attrs:{shape:[1,t.inChannels,t.outChannels]}}),V=zb({a:g?R:U,b:g?U:R,transposeA:!g,transposeB:x,backend:s,bias:r,activation:o,preluActivationWeights:a,leakyreluAlpha:i});v=ct({inputs:{x:V},backend:s,attrs:{shape:t.outShape}}),w.push(R),w.push(U),w.push(V)}for(const A of w)s.disposeIntermediateTensorInfo(A);return v}function xF({x:n,filter:e,convInfo:t,backend:s,bias:r=null,preluActivationWeights:a=null,leakyreluAlpha:i=0,activation:o=null}){const{filterWidth:l,filterHeight:c,inChannels:f,outWidth:d,outHeight:m,dataFormat:g}=t,b=g==="channelsLast",x=l*c*f,v=m*d,w=[t.batchSize,x,v],k=!0,I=!1,A=[];if(a!=null){const ee=Pb(a.shape,b);ee!=null&&(a=ct({inputs:{x:a},backend:s,attrs:{shape:ee}}),A.push(a))}if(r!=null){const ee=Pb(r.shape,b);ee!=null&&(r=ct({inputs:{x:r},backend:s,attrs:{shape:ee}}),A.push(r))}const R=ct({inputs:{x:e},backend:s,attrs:{shape:[1,x,Be(e.shape)/x]}});A.push(R);const U=new wue(w,t),V=[n.shape,[t.padInfo.top,t.padInfo.left],[t.strideHeight,t.strideWidth],[t.dilationHeight,t.dilationWidth],[t.inChannels],[t.filterWidth*t.inChannels],[t.outWidth]],P=s.runWebGLProgram(U,[n],"float32",V),D=ct({inputs:{x:P},backend:s,attrs:{shape:w}});A.push(P),A.push(D);const B=r!=null,E=a!=null,M=o==="leakyrelu",K=o?R1(o,!0):null,X=new uF(b?D.shape:R.shape,b?R.shape:D.shape,b?[t.batchSize,v,t.outChannels]:[t.batchSize,t.outChannels,v],k,I,B,K,E,M),ae=b?[D,R]:[R,D];if(r&&ae.push(r),E&&ae.push(a),M){const ee=s.makeTensorInfo([],"float32",kc(i,"float32"));ae.push(ee),A.push(ee)}const W=s.runWebGLProgram(X,ae,"float32"),se=ct({inputs:{x:W},backend:s,attrs:{shape:t.outShape}});A.push(W);for(const ee of A)s.disposeIntermediateTensorInfo(ee);return se}function Sue(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:a}=e,{strides:i,pad:o,dataFormat:l,dilations:c,dimRoundingMode:f}=s,d=Tc(l),m=Yr(r.shape,a.shape,i,c,o,f,!1,d);let g;if(m.filterHeight===1&&m.filterWidth===1&&m.dilationHeight===1&&m.dilationWidth===1&&m.strideHeight===1&&m.strideWidth===1&&(m.padInfo.type==="SAME"||m.padInfo.type==="VALID"))g=bF({x:r,filter:a,convInfo:m,backend:t});else if(m.strideWidth<=2&&d==="channelsLast"&&De().getBool("WEBGL_EXP_CONV")){const x=new yF(m),v=[[m.padInfo.top,m.padInfo.left],[m.strideHeight,m.strideWidth],[m.dilationHeight,m.dilationWidth],[m.inHeight,m.inWidth]];g=t.runWebGLProgram(x,[r,a],"float32",v)}else if(De().getBool("WEBGL_CONV_IM2COL"))g=xF({x:r,filter:a,convInfo:m,backend:t});else{const x=new gF(m);g=t.runWebGLProgram(x,[r,a],"float32")}const b=ct({inputs:{x:g},backend:t,attrs:{shape:m.outShape}});return t.disposeIntermediateTensorInfo(g),b}const Nue={kernelName:Z1,backendName:"webgl",kernelFunc:Sue};class kue{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,s=e.strideWidth,r=e.padInfo.top,a=e.padInfo.left,i=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${t} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${a};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              ${i?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class Cue{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,s=e.filterWidth,r=e.strideHeight,a=e.strideWidth,i=e.dataFormat==="channelsLast",o=t-1-e.padInfo.top,l=s-1-e.padInfo.left,c=i?1:2,f=i?2:3,d=i?3:1;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${d}];

        ivec2 dyCorner = ivec2(coords[${c}], coords[${f}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${a}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${i}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class Tue{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideDepth,s=e.strideHeight,r=e.strideWidth,a=e.padInfo.front,i=e.padInfo.top,o=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${t} - ${a};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${s} - ${i};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${r} - ${o};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class Aue{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterDepth,s=e.filterHeight,r=e.filterWidth,a=e.strideDepth,i=e.strideHeight,o=e.strideWidth,l=t-1-e.padInfo.front,c=s-1-e.padInfo.top,f=r-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${c}, ${f});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${t}; wF++) {
          float dyF = float(dyFCorner + wF) / ${a}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${t} - 1 - wF;

          for (int wR = 0; wR < ${s}; wR++) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${s} - 1 - wR;

            for (int wC = 0; wC < ${r}; wC++) {
              float dyC = float(dyCCorner + wC) / ${o}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${r} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}function Iue(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,dy:a}=e,{strides:i,pad:o,dataFormat:l,dimRoundingMode:c,filterShape:f}=s,d=Tc(l),m=Yr(r.shape,f,i,1,o,c,!1,d),g=new kue(m);return t.runWebGLProgram(g,[r,a],"float32")}const Eue={kernelName:sx,backendName:"webgl",kernelFunc:Iue};class _ue{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=Ia(this.outputShape.length);const t=e.filterHeight,s=e.filterWidth,r=t-1-e.padInfo.top,a=s-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${r}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            int wCPerm = ${s} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}function $ue(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,filter:a}=e,{inputShape:i,strides:o,pad:l,dataFormat:c,dimRoundingMode:f}=s,d=Tc(c),m=Yr(i,a.shape,o,1,l,f,!1,d);if(De().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&d==="channelsLast"){const g=[[m.strideHeight,m.strideWidth]],b=new _ue(m);return t.runWebGLProgram(b,[r,a],"float32",g)}else{const g=new Cue(m);return t.runWebGLProgram(g,[r,a],"float32")}}const Rue={kernelName:J1,backendName:"webgl",kernelFunc:$ue};function Due(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:a}=e,{strides:i,pad:o,dilations:l}=s,c=Uh(r.shape,a.shape,i,l,o),f=new vue(c);return t.runWebGLProgram(f,[r,a],"float32")}const Oue={kernelName:Q1,backendName:"webgl",kernelFunc:Due};function Lue(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,dy:a}=e,{strides:i,pad:o,filterShape:l}=s,c=Uh(r.shape,l,i,1,o),f=new Tue(c);return t.runWebGLProgram(f,[r,a],"float32")}const Fue={kernelName:rx,backendName:"webgl",kernelFunc:Lue};function Mue(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,filter:a}=e,{pad:i,strides:o,inputShape:l}=s,c=Uh(l,a.shape,o,1,i),f=new Aue(c);return t.runWebGLProgram(f,[r,a],"float32")}const zue={kernelName:ax,backendName:"webgl",kernelFunc:Mue};const Pue=fg+`
  return cos(x);
`,Bue=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${Cd}
  return result;
`,Uue=zn({opSnippet:Pue,packedOpSnippet:Bue}),Vue={kernelName:fm,backendName:"webgl",kernelFunc:Uue};const jue=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,Wue=zn({opSnippet:jue}),Gue={kernelName:dm,backendName:"webgl",kernelFunc:Wue};class que{constructor(e,t,s,r,a){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[i,o,l,c]=e,[f]=t,[d,m]=s;this.outputShape=[f,d,m,c];const g=r==="bilinear"?1:0,[b,x]=[`${o-1}.0`,`${l-1}.0`],[v,w,k]=d>1?[`${(o-1)/(d-1)}`,"(y2-y1) * height_ratio",`y1*${b} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${b}`],[I,A,R]=m>1?[`${(l-1)/(m-1)}`,"(x2-x1) * width_ratio",`x1*${x} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${x}`];this.userCode=`
      const float height_ratio = float(${v});
      const float width_ratio = float(${I});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${i}) {
          return;
        }

        float height_scale = ${w};
        float width_scale = ${A};

        float in_y = ${k};
        if( in_y < 0.0 || in_y > ${b} ) {
          setOutput(float(${a}));
          return;
        }
        float in_x = ${R};
        if( in_x < 0.0 || in_x > ${x} ) {
          setOutput(float(${a}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${g} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}const Hue=n=>{const{inputs:e,backend:t,attrs:s}=n,{image:r,boxes:a,boxInd:i}=e,{cropSize:o,method:l,extrapolationValue:c}=s,f=new que(r.shape,a.shape,o,l,c);return t.runWebGLProgram(f,[r,a,i],"float32")},Kue={kernelName:ox,backendName:"webgl",kernelFunc:Hue};var O1;(function(n){n.Prod="*",n.Sum="+"})(O1||(O1={}));class PE{constructor(e,t,s,r){this.op=e,this.outputShape=t,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const a=this.outputShape.length,i=this.op===O1.Prod?"1.0":"0.0",o=s?i:`getX(${BE(a,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1];let c="",f="";s?(c=r?`end != ${l-1}`:"end != 0",f=r?"end + 1":"end - 1"):(c=r?`end + pow2 < ${l}`:"end >= pow2",f=r?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${os(a)} coords = getOutputCoords();
        int end = ${UE(a,"coords",this.op)};
        float val = ${o};
        int pow2 = int(pow(2.0, index));
        if (${c}) {
          int idx = ${f};
          ${UE(a,"coords",this.op)} = idx;
          val ${this.op}= getX(${BE(a,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function BE(n,e,t){if(n===1)return`${e}`;if(n===2)return`${e}.x, ${e}.y`;if(n===3)return`${e}.x, ${e}.y, ${e}.z`;if(n===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${t} for rank ${n} is not yet supported`)}function UE(n,e,t){if(n===1)return`${e}`;if(n===2)return`${e}.y`;if(n===3)return`${e}.z`;if(n===4)return`${e}.w`;throw new Error(`Cumulative ${t} for rank ${n} is not yet supported`)}function vF(n,e,t,s,r,a){const i=e.shape.length,o=js([s],i);let l=e;o!=null&&(l=Va({inputs:{x:e},backend:t,attrs:{perm:o}}));const c=hr(1,i)[0];if(c!==i-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${s}`);const f=l.shape[c];let d=zi({inputs:{x:l},backend:t});for(let m=0;m<=Math.ceil(Math.log2(f))-1;m++){const g=new PE(n,l.shape,!1,a),b=[[m]],x=d;d=t.runWebGLProgram(g,[d],d.dtype,b),t.disposeIntermediateTensorInfo(x)}if(r){const m=new PE(n,l.shape,r,a),g=d;d=t.runWebGLProgram(m,[d],d.dtype),t.disposeIntermediateTensorInfo(g)}if(o!=null){const m=Vh(o),g=Va({inputs:{x:d},backend:t,attrs:{perm:m}});return t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(l),g}return d}function Xue(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:a,exclusive:i,reverse:o}=s;return vF(O1.Prod,r,t,a,i,o)}const Yue={kernelName:ix,backendName:"webgl",kernelFunc:Xue};function Zue(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:a,exclusive:i,reverse:o}=s;return vF(O1.Sum,r,t,a,i,o)}const Jue={kernelName:e0,backendName:"webgl",kernelFunc:Zue};function Que(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,weights:a}=e,{size:i,binaryOutput:o}=s;if(r.shape.length===1){const l=t.readSync(r.dataId),c=t.readSync(a.dataId),f=eF(l,c,a.dtype,a.shape,i);return t.makeTensorInfo([i],a.dtype,f)}else if(r.shape.length===2){const l=t.bufferSync(r),c=t.bufferSync(a),f=sie(l,c,i,o);return t.makeTensorInfo(f.shape,a.dtype,f.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const ece={kernelName:lx,backendName:"webgl",kernelFunc:Que};class tce{constructor(e,t,s){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=s,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${t};
      int offset_h = imod(h, ${t});
      int in_w = w / ${t};
      int offset_w = imod(w, ${t});
      int offset_d = (offset_h * ${t} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}function nce(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{blockSize:a,dataFormat:i}=s,o=r.shape[0],l=i==="NHWC"?r.shape[1]:r.shape[2],c=i==="NHWC"?r.shape[2]:r.shape[3],f=i==="NHWC"?r.shape[3]:r.shape[1],d=l*a,m=c*a,g=f/(a*a),b=i==="NHWC"?[o,d,m,g]:[o,g,d,m],x=new tce(b,a,i);return t.runWebGLProgram(x,[r],r.dtype)}const sce={kernelName:ux,backendName:"webgl",kernelFunc:nce};class wF{constructor(e,t=!1,s=null,r=!1,a=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Ia(this.outputShape.length);const i=e.filterHeight,o=e.filterWidth,l=e.outChannels/e.inChannels;let c="",f="";s&&(r?c=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:a?c=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:c=`
          float activation(float x) {
            ${s}
          }
        `,f="result = activation(result);");const d=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${c}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${i}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${o}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${d}
        ${f}
        setOutput(result);
      }
    `}}class SF{constructor(e,t=!1,s=null,r=!1,a=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Ia(this.outputShape.length);const i=e.outChannels/e.inChannels,o=e.padInfo.left,l=e.strideWidth,c=e.dilationWidth,f=e.filterHeight,d=e.filterWidth,m=d;let g=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let w=0;w<d;w++)g+=`
          vec4 xTexelC${w*2};
          int xTexelC${w*2}Ready;
          vec4 xTexelC${w*2+1};
          int xTexelC${w*2+1}Ready;
          vec4 xC${w};`;g+=`
    for (int r = 0; r < ${f}; r++) {
      `;for(let w=0;w<d;w++)g+=`
          xTexelC${w*2} = vec4(0.0);
          xTexelC${w*2}Ready = 0;
          xTexelC${w*2+1} = vec4(0.0);
          xTexelC${w*2+1}Ready = 0;
          xC${w} = vec4(0.0);`;g+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let w=0;w<(m+1)/2;w++){const k=w*2;if(g+=`
          xC = xCCorner + ${k*c};
          `,l===1){if(k<d&&(o%2===1?(g+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${k}Ready == 0) {
                  xTexelC${k} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${k}.zw = vec2(0.0);
                  }
                  xTexelC${k}Ready = 1;
                }
              `,c===1&&k>0?g+=`
                xC${k} = vec4(xTexelC${k-2}.zw, xTexelC${k}.xy);
                `:g+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${k} = vec4(previous.zw, xTexelC${k}.xy);
                  } else {
                    xC${k} = vec4(0.0, 0.0, xTexelC${k}.xy);
                  }
                  `):g+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${k}Ready == 0) {
                  xTexelC${k} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${k}.zw = vec2(0.0);
                  }
                  xTexelC${k}Ready = 1;
                }

                xC${k} = xTexelC${k};
                `,k+1<d)){const I=o%2===0?Kb(c):c;c%2===0&&o%2===1||c%2!==0&&o%2!==1?(g+=`
                  xCOffset = xC + imod(pads[1], 2) + ${I};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${k+1}Ready == 0) {
                    xTexelC${k+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${k+1}.zw = vec2(0.0);
                    }
                    xTexelC${k+1}Ready = 1;
                  }
                  `,c>1?g+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${k+1} = vec4(previous.zw, xTexelC${k+1}.xy);
                    } else {
                     xC${k+1} = vec4(0.0, 0.0, xTexelC${k+1}.xy);
                    }
                    `:g+=`
                    xC${k+1} = vec4(xTexelC${k}.zw, xTexelC${k+1}.xy);
                    `):I===1?g+=`
                    xC${k+1} = xTexelC${k};
                    `:g+=`
                    xCOffset = xC + ${I};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${k+1}Ready == 0) {
                      xTexelC${k+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${k+1}.zw = vec2(0.0);
                      }
                      xTexelC${k+1}Ready = 1;
                    }

                    xC${k+1} = xTexelC${k+1};
                    `}}else k<d&&(o%2===1?(g+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${k}Ready == 0) {
                  xTexelC${k} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${k}.zw = vec2(0.0);
                  }
                  xTexelC${k}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${k+1}Ready == 0) {
                  xTexelC${k+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${k+1}.zw = vec2(0.0);
                  }
                  xTexelC${k+1}Ready = 1;
                }

                xC${k} = vec4(xTexelC${k}.zw, xTexelC${k+1}.zw);
              `,k+1<d&&(g+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${k+1} = vec4(xTexelC${k+1}.xy, final.xy);
                `)):(g+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${k}Ready == 0) {
                  xTexelC${k} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${k}.zw = vec2(0.0);
                  }
                  xTexelC${k}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${k+1}Ready == 0) {
                  xTexelC${k+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${k+1}.zw = vec2(0.);
                  }
                  xTexelC${k+1}Ready = 1;
                }

                xC${k} = vec4(
                  xTexelC${k}.xy, xTexelC${k+1}.xy);
              `,k+1<d&&(g+=`
                  xC${k+1} = vec4(xTexelC${k}.zw, xTexelC${k+1}.zw);
                `)));k<d&&(g+=`
            wTexel = getW(r, ${k}, d1, q);
            dotProd += xC${k} * vec4(wTexel.xz, wTexel.xz);
          `,k+1<d&&(g+=`
              wTexel = getW(r, ${k+1}, d1, q);
              dotProd += xC${k+1} * vec4(wTexel.xz, wTexel.xz);
            `))}g+=`
    }
  `,g+=`
      }
    `;let b="",x="";s&&(r?b=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:a?b=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:b=`vec4 activation(vec4 x) {
          ${s}
        }`,x="result = activation(result);");const v=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${b}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${i};
        int q = d2 - d1 * ${i};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${g}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${v}
        ${x}
        setOutput(result);
      }
    `}}function rce(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:a}=e,{strides:i,pad:o,dilations:l,dimRoundingMode:c}=s;let f=l;f==null&&(f=[1,1]),Z(fa(i,f),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${f}'`);const d=Yr(r.shape,a.shape,i,f,o,c,!0);let m;De().getBool("WEBGL_PACK_DEPTHWISECONV")&&d.strideWidth<=2&&d.outChannels/d.inChannels===1?m=new SF(d):m=new wF(d);const g=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];return t.runWebGLProgram(m,[r,a],"float32",g)}const ace={kernelName:t0,backendName:"webgl",kernelFunc:rce};class ice{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,s=e.strideWidth,r=e.padInfo.top,a=e.padInfo.left,i=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${i} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${t} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${a};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class oce{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,s=e.filterWidth,r=e.strideHeight,a=e.strideWidth,i=t-1-e.padInfo.top,o=s-1-e.padInfo.left,l=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${i}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${a}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}function lce(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,dy:a}=e,{strides:i,dilations:o,pad:l,dimRoundingMode:c,filterShape:f}=s,d=Yr(r.shape,f,i,o,l,c,!0),m=new ice(d);return t.runWebGLProgram(m,[r,a],"float32")}const uce={kernelName:cx,backendName:"webgl",kernelFunc:lce};function cce(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,filter:a}=e,{strides:i,dilations:o,pad:l,dimRoundingMode:c,inputShape:f}=s,d=Yr(f,a.shape,i,o,l,c,!0),m=new oce(d);return t.runWebGLProgram(m,[r,a],"float32")}const hce={kernelName:hx,backendName:"webgl",kernelFunc:cce};class fce{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}function dce(n){const{inputs:e,backend:t}=n,{x:s}=e,r=[...s.shape,...s.shape],a=Be(s.shape),i=ct({inputs:{x:s},backend:t,attrs:{shape:[a]}}),o=new fce(a),l=t.runWebGLProgram(o,[i],i.dtype),c=ct({inputs:{x:l},backend:t,attrs:{shape:r}});return t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(l),c}const pce={kernelName:fx,backendName:"webgl",kernelFunc:dce};class mce{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:t,inWidth:s,padInfo:r,strideHeight:a,strideWidth:i,filterHeight:o,filterWidth:l,dilationHeight:c,dilationWidth:f}=e,{top:d,left:m}=r;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${i});
      const ivec2 pads = ivec2(${d}, ${m});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${o}; h++) {
          int hIn = hBeg + h * ${c};

          if (hIn >= 0 && hIn < ${t}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${f};

              if (wIn >= 0 && wIn < ${s}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}function gce(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:a}=e,{strides:i,pad:o,dilations:l}=s,c=G0(r.shape,a.shape,i,o,"NHWC",l);let f;const d=new mce(c);f=t.runWebGLProgram(d,[r,a],"float32");const m=ct({inputs:{x:f},backend:t,attrs:{shape:c.outShape}});return t.disposeIntermediateTensorInfo(f),m}const yce={kernelName:n0,backendName:"webgl",kernelFunc:gce};function bce(n){const{inputs:e,backend:t,attrs:s}=n,{equation:r}=s,a=e,{allDims:i,summedDims:o,idDims:l}=A3(r,a.length);E3(i.length,l,a);const{path:c,steps:f}=_3(o,l),d=f.length;let m=null,g=i.length;const b=[];for(let x=0;x<d;++x){for(const v of f[x]){const{permutationIndices:w,expandDims:k}=I3(g,l[v]);let I;$3(w)?I=a[v]:(I=Va({inputs:{x:a[v]},backend:t,attrs:{perm:w}}),b.push(I));const A=I.shape.slice();for(let R=0;R<k.length;++R)A.splice(k[R],0,1);Nn(I.shape,A)||(I=ct({inputs:{x:I},backend:t,attrs:{shape:A}}),b.push(I)),m===null?m=I:(m=bC({inputs:{a:I,b:m},backend:t}),b.push(m))}x<d-1&&(c[x]>=0&&(m=iw({inputs:{x:m},backend:t,attrs:{axis:c[x]-(i.length-g),keepDims:!1}}),b.push(m)),g--)}for(const x of b)x!==m&&t.disposeIntermediateTensorInfo(x);return m}const xce={kernelName:px,backendName:"webgl",kernelFunc:bce};const vce="return (x >= 0.0) ? x : (exp(x) - 1.0);",wce=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Sce=zn({opSnippet:vce,packedOpSnippet:wce}),Nce={kernelName:mm,backendName:"webgl",kernelFunc:Sce};const kce="return (b >= 0.0) ? a : a * (b + 1.0);",Cce=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,Tce=n=>{const{inputs:e,backend:t}=n,{dy:s,y:r}=e,a=De().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new hg(Cce,s.shape,r.shape):new ud(kce,s.shape,r.shape);return t.runWebGLProgram(a,[s,r],s.dtype)},Ace={kernelName:mx,backendName:"webgl",kernelFunc:Tce};const Ice=`
  return vec4(equal(a, b));
`,Ece="return float(a == b);",_ce=ma({opSnippet:Ece,packedOpSnippet:Ice,dtype:"bool",cpuKernelImpl:lie}),$ce={kernelName:s0,backendName:"webgl",kernelFunc:_ce};const Rce=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${v3};
  float a1 = ${w3};
  float a2 = ${S3};
  float a3 = ${N3};
  float a4 = ${k3};
  float a5 = ${C3};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,Dce=zn({opSnippet:Rce}),Oce={kernelName:gm,backendName:"webgl",kernelFunc:Dce};const Lce=fg+`
  return exp(x);
`,Fce=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,NF=zn({opSnippet:Lce,packedOpSnippet:Fce,cpuKernelImpl:uie,dtype:"float32"}),Mce={kernelName:ym,backendName:"webgl",kernelFunc:NF};function mN(n){const{inputs:e,attrs:t,backend:s}=n,{dim:r}=t,{input:a}=e,i=a.shape.length,o=a.shape.slice();let l=r;return r<0&&(Z(-(i+1)<=r,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),l=i+r+1),o.splice(l,0,1),ct({inputs:{x:a},backend:s,attrs:{shape:o}})}const zce={kernelName:r0,backendName:"webgl",kernelFunc:mN};const VE="return exp(x) - 1.0;",Pce=zn({opSnippet:VE,packedOpSnippet:VE,cpuKernelImpl:cie}),Bce={kernelName:bm,backendName:"webgl",kernelFunc:Pce};class jE{constructor(e,t,s){this.variableNames=["real","imag"];const r=t[1];this.outputShape=t;const a=s?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,i=s?`${r}.0`:"1.0";let o;if(e==="real")o="return real * expR - imag * expI;";else if(e==="imag")o="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${a};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${o}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${r});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${r}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${i};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}function kF(n,e,t){const s=t.texData.get(n.dataId),r=Be(n.shape),a=n.shape[n.shape.length-1],i=r/a,o=ct({inputs:{x:n},backend:t,attrs:{shape:[i,a]}}),l=o.shape,c=new jE("real",l,e),f=new jE("imag",l,e),d=[{dataId:s.complexTensorInfos.real.dataId,dtype:s.complexTensorInfos.real.dtype,shape:l},{dataId:s.complexTensorInfos.imag.dataId,dtype:s.complexTensorInfos.imag.dtype,shape:l}],m=t.runWebGLProgram(c,d,"float32"),g=t.runWebGLProgram(f,d,"float32"),b=Kh({inputs:{real:m,imag:g},backend:t});t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(g);const x=ct({inputs:{x:b},backend:t,attrs:{shape:n.shape}});return t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(b),x}function Uce(n){const{inputs:e,backend:t}=n,{input:s}=e;return kF(s,!1,t)}const Vce={kernelName:gx,backendName:"webgl",kernelFunc:Uce};class jce{constructor(e,t){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}function ky(n){const{backend:e,attrs:t}=n,{shape:s,value:r}=t;let{dtype:a}=t;if(a=a||pd(r),a==="string"){const i=Ys(a,Be(s));return i.fill(r),e.makeTensorInfo(s,a,i)}else{const i=new jce(s,r),o=[[r]];return e.runWebGLProgram(i,[],a,o)}}const Wce={kernelName:yx,backendName:"webgl",kernelFunc:ky};class Gce{constructor(e){this.variableNames=["Image"],this.outputShape=[];const t=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${t} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${t}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}const qce={kernelName:bx,backendName:"webgl",kernelFunc:({inputs:n,backend:e})=>{const{image:t}=n,s=e,r=new Gce(t.shape);return s.runWebGLProgram(r,[t],t.dtype)}};const WE="return floor(x);",Hce=zn({opSnippet:WE,packedOpSnippet:WE,cpuKernelImpl:hie}),Kce={kernelName:xm,backendName:"webgl",kernelFunc:Hce};const Xce=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,Yce=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,Zce=ma({opSnippet:Xce,packedOpSnippet:Yce,dtype:"int32"}),Jce={kernelName:vm,backendName:"webgl",kernelFunc:Zce};class Qce{constructor(e){this.variableNames=["A"];const t=Wa(),[s,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}.0, ${s}.0);

        vec4 values = ${t.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}class ehe{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const t=Wa(),[s,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${r}.0, ${s}.0);
            vec4 values = ${t.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${t.output} = result;
      }
    `}}const the={kernelName:gb,backendName:"webgl",kernelFunc:nhe};let vp,X5=De().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function nhe(n){const{inputs:e,backend:t,attrs:s}=n;let{pixels:r}=e;const{numChannels:a}=s,i=typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement,o=typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement,[l,c]=i?[r.videoWidth,r.videoHeight]:[r.width,r.height],f=[c,l],d=[c,l,a];if(o||i){const x=De().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(vp==null||x!==X5)&&(X5=x,vp=document.createElement("canvas").getContext("2d",{willReadFrequently:X5})),vp.canvas.width=l,vp.canvas.height=c,vp.drawImage(r,0,0,l,c),r=vp.canvas}const m=t.makeTensorInfo(f,"int32");t.texData.get(m.dataId).usage=uo.PIXELS,t.gpgpu.uploadPixelDataToTexture(t.getTexture(m.dataId),r);const g=De().getBool("WEBGL_PACK")?new ehe(d):new Qce(d),b=t.runWebGLProgram(g,[m],"int32");return t.disposeData(m.dataId),b}function she(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:a,bias:i,preluActivationWeights:o}=e,{strides:l,pad:c,dataFormat:f,dilations:d,dimRoundingMode:m,activation:g,leakyreluAlpha:b}=s,x=Tc(f),v=Yr(r.shape,a.shape,l,d,c,m,!1,x);let w;const k=[],I=i!=null,A=o!=null,R=g==="leakyrelu",U=()=>{const P=[r,a],D=(B,E)=>{if(E==="NCHW"&&B.shape.length===1&&B.shape[0]!==1){const M=ct({inputs:{x:B},backend:t,attrs:{shape:[B.shape[0],1,1]}});return k.push(M),M}return B};if(I&&P.push(D(i,f)),A&&P.push(D(o,f)),R){const B=t.makeTensorInfo([],"float32",kc(b,"float32"));P.push(B),k.push(B)}return P};if(v.filterHeight===1&&v.filterWidth===1&&v.dilationHeight===1&&v.dilationWidth===1&&v.strideHeight===1&&v.strideWidth===1&&(v.padInfo.type==="SAME"||v.padInfo.type==="VALID"))w=bF({x:r,filter:a,convInfo:v,backend:t,bias:i,activation:g,preluActivationWeights:o,leakyreluAlpha:b});else if(v.strideWidth<=2&&x==="channelsLast"&&De().getBool("WEBGL_EXP_CONV")){const P=g?R1(g,!0):null,D=new yF(v,I,P,A,R),B=[[v.padInfo.top,v.padInfo.left],[v.strideHeight,v.strideWidth],[v.dilationHeight,v.dilationWidth],[v.inHeight,v.inWidth]],E=U();w=t.runWebGLProgram(D,E,"float32",B)}else if(De().getBool("WEBGL_CONV_IM2COL"))w=xF({x:r,filter:a,convInfo:v,backend:t,bias:i,activation:g,preluActivationWeights:o,leakyreluAlpha:b});else{const P=g?R1(g,!1):null,D=new gF(v,I,P,A,R),B=U();w=t.runWebGLProgram(D,B,"float32")}const V=ct({inputs:{x:w},backend:t,attrs:{shape:v.outShape}});return k.push(w),k.forEach(P=>t.disposeIntermediateTensorInfo(P)),V}const rhe={kernelName:y1,backendName:"webgl",kernelFunc:she};function ahe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:a,bias:i,preluActivationWeights:o}=e,{strides:l,pad:c,dilations:f,dimRoundingMode:d,activation:m,leakyreluAlpha:g}=s,b=[];let x=f;x==null&&(x=[1,1]),Z(fa(l,x),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${x}'`);const v=Yr(r.shape,a.shape,l,x,c,d,!0),w=De().getBool("WEBGL_PACK_DEPTHWISECONV")&&v.strideWidth<=2&&v.outChannels/v.inChannels===1,k=m?R1(m,w):null,I=[r,a],A=i!=null,R=o!=null,U=m==="leakyrelu";if(A&&I.push(i),R&&I.push(o),U){const B=t.makeTensorInfo([],"float32",kc(g,"float32"));I.push(B),b.push(B)}let V;w?V=new SF(v,A,k,R,U):V=new wF(v,A,k,R,U);const P=[[v.padInfo.top,v.padInfo.left],[v.strideHeight,v.strideWidth],[v.dilationHeight,v.dilationWidth],[v.inHeight,v.inWidth]],D=t.runWebGLProgram(V,I,"float32",P);return b.forEach(B=>t.disposeIntermediateTensorInfo(B)),D}const ihe={kernelName:b1,backendName:"webgl",kernelFunc:ahe};class ohe{constructor(e,t,s,r){this.sliceDim=e,this.strides=t,this.paramsShape=r,this.variableNames=["x","indices"],this.outputShape=s;const a=os(s.length);let i=`
    int index;`;for(let o=0;o<this.sliceDim;o++)i+=`
          index = round(getIndices(coords[0], ${o}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[o]};
          flattenIndex += index * ${this.strides[o]};`;this.userCode=`
         void main() {
          ${a} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${i}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}function lhe(n){const{inputs:e,backend:t}=n,{params:s,indices:r}=e,a=r.shape,i=a[a.length-1],o=Be(s.shape),[l,c,f,d]=Bv(s,r),m=ct({inputs:{x:r},backend:t,attrs:{shape:[c,i]}}),g=ct({inputs:{x:s},backend:t,attrs:{shape:[Be(s.shape)/f,f]}});if(t.shouldExecuteOnCPU([s,r])||s.dtype==="string"){const w=t.readSync(r.dataId),k=t.bufferSync(s),I=fie(w,k,s.dtype,c,i,f,d,s.shape,o);return t.makeTensorInfo(l,s.dtype,I.values)}const b=new ohe(i,d,[c,f],s.shape),x=t.runWebGLProgram(b,[g,m],g.dtype),v=ct({inputs:{x},backend:t,attrs:{shape:l}});return t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(x),v}const uhe={kernelName:xx,backendName:"webgl",kernelFunc:lhe};class che{constructor(e,t){this.variableNames=["A","indices"],this.outputShape=t,this.rank=t.length;const s=os(this.rank),r=hhe(e);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${r}));
      }
    `}}function hhe(n,e){const t=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[];for(let r=0;r<n.length;r++)r===2?s.push("index"):s.push(`${t[r]}`);return s.join()}function CF(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,indices:a}=e,{axis:i,batchDims:o}=s,l=vn(i,r.shape)[0];if(De().get("DEBUG")){const k=t.readSync(a.dataId),I=r.shape[l];for(let A=0;A<k.length;++A){const R=k[A];Z(R<=I-1&&R>=0,()=>`GatherV2: the index value ${R} is not in [0, ${I-1}]`)}}const c=D3(r,a,l,o),f=Be(a.shape),d=[],m=ct({inputs:{x:r},backend:t,attrs:{shape:[c.batchSize,c.outerSize,c.dimSize,c.sliceSize]}}),g=ct({inputs:{x:a},backend:t,attrs:{shape:[c.batchSize,f/c.batchSize]}});d.push(m),d.push(g);const b=[c.batchSize,c.outerSize,f/c.batchSize,c.sliceSize];if(t.shouldExecuteOnCPU([r,a])||r.dtype==="string"){const k=t.bufferSync(g),I=t.bufferSync(m),A=die(I,k,b);return d.forEach(R=>t.disposeIntermediateTensorInfo(R)),t.makeTensorInfo(c.outputShape,A.dtype,A.values)}const x=new che(m.shape,b),v=t.runWebGLProgram(x,[m,g],m.dtype);d.push(v);const w=ct({inputs:{x:v},backend:t,attrs:{shape:c.outputShape}});return d.forEach(k=>t.disposeIntermediateTensorInfo(k)),w}const fhe={kernelName:i0,backendName:"webgl",kernelFunc:CF};const dhe="return float(a > b);",phe=`
  return vec4(greaterThan(a, b));
`,mhe=ma({opSnippet:dhe,packedOpSnippet:phe,cpuKernelImpl:pie,dtype:"bool"}),ghe={kernelName:o0,backendName:"webgl",kernelFunc:mhe};const yhe="return float(a >= b);",bhe=`
  return vec4(greaterThanEqual(a, b));
`,xhe=ma({opSnippet:yhe,packedOpSnippet:bhe,dtype:"bool",cpuKernelImpl:mie}),vhe={kernelName:wm,backendName:"webgl",kernelFunc:xhe};function whe(n){const{inputs:e,backend:t}=n,{input:s}=e;return kF(s,!0,t)}const She={kernelName:vx,backendName:"webgl",kernelFunc:whe};const Nhe="return float(!isnan(x) && !isinf(x));",khe=zn({opSnippet:Nhe,dtype:"bool"}),Che={kernelName:Nm,backendName:"webgl",kernelFunc:khe};const The="return float(isinf(x));",Ahe=zn({opSnippet:The,dtype:"bool"}),Ihe={kernelName:km,backendName:"webgl",kernelFunc:Ahe};const Ehe="return float(isnan(x));",_he=zn({opSnippet:Ehe,dtype:"bool"}),$he={kernelName:Cm,backendName:"webgl",kernelFunc:_he};const Rhe="return float(a < b);",Dhe=`
  return vec4(lessThan(a, b));
`,Ohe=ma({opSnippet:Rhe,packedOpSnippet:Dhe,cpuKernelImpl:gie,dtype:"bool"}),Lhe={kernelName:u0,backendName:"webgl",kernelFunc:Ohe};const Fhe="return float(a <= b);",Mhe=`
  return vec4(lessThanEqual(a, b));
`,zhe=ma({opSnippet:Fhe,packedOpSnippet:Mhe,cpuKernelImpl:yie,dtype:"bool"}),Phe={kernelName:c0,backendName:"webgl",kernelFunc:zhe};function Bhe(n){const{backend:e,attrs:t}=n,{start:s,stop:r,num:a}=t,i=bie(s,r,a);return e.makeTensorInfo([i.length],"float32",i)}const Uhe={kernelName:Sx,backendName:"webgl",kernelFunc:Bhe};const Vhe=fg+`
  return x < 0.0 ? 0./0. : log(x);
`,jhe=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,Whe=zn({opSnippet:Vhe,packedOpSnippet:jhe,cpuKernelImpl:xie}),Ghe={kernelName:Tm,backendName:"webgl",kernelFunc:Whe};const qhe=fg+`
  return log(1.0 + x);
`,Hhe=zn({opSnippet:qhe}),Khe={kernelName:Am,backendName:"webgl",kernelFunc:Hhe};const Xhe="return float(a >= 1.0 && b >= 1.0);",Yhe=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,Zhe=ma({opSnippet:Xhe,packedOpSnippet:Yhe,dtype:"bool"}),Jhe={kernelName:h0,backendName:"webgl",kernelFunc:Zhe};const Qhe="return float(!(x >= 1.0));",efe=zn({opSnippet:Qhe}),tfe={kernelName:f0,backendName:"webgl",kernelFunc:efe};const nfe="return float(a >= 1.0 || b >= 1.0);",sfe=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,rfe=ma({opSnippet:nfe,packedOpSnippet:sfe,dtype:"bool"}),afe={kernelName:d0,backendName:"webgl",kernelFunc:rfe};class ife{constructor(e,t,s,r,a){this.variableNames=["x"],this.outputShape=[];const i=t,o=e[3]-1;this.outputShape=e;let l;const c=`float(${s}) + float(${r}) * sum`;a===.5?l=`inversesqrt(${c})`:a===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${a}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${i}; j <= ${i}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${o}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}}class ofe{constructor(e,t,s,r,a){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const i=t,o=e[3]-1;this.outputShape=e;let l;const c=`float(${s}) + float(${r}) * sum`;a===.5?l=`inversesqrt(${c})`:a===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${a}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${i};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${i}; j <= ${i}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${o}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}}const lfe=n=>{const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{depthRadius:a,bias:i,alpha:o,beta:l}=s,c=De().getBool("WEBGL_PACK_NORMALIZATION")?new ofe(r.shape,a,i,o,l):new ife(r.shape,a,i,o,l);return t.runWebGLProgram(c,[r],r.dtype)},ufe={kernelName:p0,backendName:"webgl",kernelFunc:lfe};class cfe{constructor(e,t,s,r,a){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=s,this.alpha=r,this.beta=a,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${t})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${t} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${r}) * norm + float(${s});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${r})
                * float(${a})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${a});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}const hfe=n=>{const{inputs:e,backend:t,attrs:s}=n,{x:r,y:a,dy:i}=e,{depthRadius:o,bias:l,alpha:c,beta:f}=s,d=new cfe(r.shape,o,l,c,f);return t.runWebGLProgram(d,[r,a,i],r.dtype)},ffe={kernelName:Nx,backendName:"webgl",kernelFunc:hfe};function dfe(n,e,t,s){const r=Be(e),i=Be(n.shape)/r,o=ct({inputs:{x:n},attrs:{shape:[i,r]},backend:s}),l=Td(o,n.dtype,"max",s),c=ct({inputs:{x:l},attrs:{shape:t},backend:s});return s.disposeIntermediateTensorInfo(o),s.disposeIntermediateTensorInfo(l),c}function TF(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{reductionIndices:a,keepDims:i}=s,o=r.shape.length,l=vn(a,r.shape);let c=l;const f=js(c,o),d=f!=null,m=t.shouldExecuteOnCPU([r]);let g=r;if(d){if(m){const I=t.texData.get(g.dataId).values,A=new Array(o);for(let V=0;V<A.length;V++)A[V]=r.shape[f[V]];const R=gC(I,r.shape,r.dtype,f,A);g=t.makeTensorInfo(A,r.dtype);const U=t.texData.get(g.dataId);U.values=R}else g=aw(r,f,t);c=hr(c.length,o)}da("max",c,o);const[b,x]=Zr(g.shape,c);let v=b;i&&(v=cr(b,l));let w;if(m){const I=t.texData.get(g.dataId).values,A=vie(I,Be(x),v,r.dtype);w=t.makeTensorInfo(v,r.dtype);const R=t.texData.get(w.dataId);R.values=A}else w=dfe(g,x,v,t);return d&&t.disposeIntermediateTensorInfo(g),w}const pfe={kernelName:m0,backendName:"webgl",kernelFunc:TF};const mfe=yC+`
  return max(a, b);
`,gfe=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Cd+`
  return result;
`,yfe=ma({opSnippet:mfe,packedOpSnippet:gfe,cpuKernelImpl:wie}),bfe={kernelName:Im,backendName:"webgl",kernelFunc:yfe};function xfe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e;wy(r,"maxPool");const{filterSize:a,strides:i,pad:o,dimRoundingMode:l}=s,c=1;Z(fa(i,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const f=qo(r.shape,a,i,c,o,l);if(f.filterWidth===1&&f.filterHeight===1&&Nn(f.inShape,f.outShape))return zi({inputs:{x:r},backend:t});const d=new D1(f,"max",!1);return t.runWebGLProgram(d,[r],r.dtype)}const vfe={kernelName:g0,backendName:"webgl",kernelFunc:xfe};function wfe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{filterSize:a,strides:i,pad:o,dataFormat:l,dimRoundingMode:c}=s,f=[1,1,1],d=Cc(r.shape,a,i,f,o,c,l),m=new xC(d,"max",!1);return t.runWebGLProgram(m,[r],r.dtype)}const Sfe={kernelName:y0,backendName:"webgl",kernelFunc:wfe};class Nfe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideHeight,s=e.strideWidth,r=e.dilationHeight,a=e.effectiveFilterHeight,i=e.effectiveFilterWidth,o=a-1-e.padInfo.top,l=i-1-e.padInfo.left,c=a*i-1;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${a};
          wR += ${r}) {
          float dyR = float(dyRCorner + wR) / ${t}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${i}; wC++) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${c} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${i} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class kfe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideDepth,s=e.strideHeight,r=e.strideWidth,a=e.dilationDepth,i=e.dilationHeight,o=e.dilationWidth,l=e.effectiveFilterDepth,c=e.effectiveFilterHeight,f=e.effectiveFilterWidth,d=l-1-e.padInfo.front,m=c-1-e.padInfo.top,g=f-1-e.padInfo.left,b=l*c*f-1;this.userCode=`
      const ivec3 pads = ivec3(${d}, ${m}, ${g});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${a}) {
          float dyD = float(dyDCorner + wD) / ${t}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${c};
              wR += ${i}) {
            float dyR = float(dyRCorner + wR) / ${s}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${f};
                wC += ${o}) {
              float dyC = float(dyCCorner + wC) / ${r}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${b} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${c} * ${f} +
                  wR * ${f} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}function Cfe(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,input:a}=e,i=a,{filterSize:o,strides:l,pad:c,dimRoundingMode:f}=s,d=[1,1,1],m=Cc(i.shape,o,l,d,c,f),g=new xC(m,"max",!0),b=t.runWebGLProgram(g,[i],i.dtype),x=new kfe(m),v=t.runWebGLProgram(x,[r,b],i.dtype);return t.disposeIntermediateTensorInfo(b),v}const Tfe={kernelName:Cx,backendName:"webgl",kernelFunc:Cfe};function Afe(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,input:a,output:i}=e,o=a;wy([a,i],"maxPoolGrad");const{filterSize:l,strides:c,pad:f,dimRoundingMode:d}=s,m=qo(o.shape,l,c,1,f,d),g=!0,b=new D1(m,"max",g),x=t.runWebGLProgram(b,[o],o.dtype),v=new Nfe(m),w=t.runWebGLProgram(v,[r,x],o.dtype);return t.disposeIntermediateTensorInfo(x),w}const Ife={kernelName:kx,backendName:"webgl",kernelFunc:Afe};function Efe(n,e,t,s){let r=new D1(t,"max",!1);const a=s.runWebGLProgram(r,[n],"float32");r=new D1(t,"max",!0,!0,e);const i=s.runWebGLProgram(r,[n],"float32");return[a,i]}const _fe={kernelName:Tx,backendName:"webgl",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{x:s}=n,{filterSize:r,strides:a,pad:i,includeBatchInIndex:o}=e,l=t;Z(s.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${s.shape.length}.`);const c=[1,1];Z(fa(a,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${c}'`);const f=qo(s.shape,r,a,c,i),[d,m]=Efe(s,o,f,l);return[d,m]}};function $fe(n,e,t,s){const r=Be(e),i=Be(n.shape)/r,o=ct({inputs:{x:n},attrs:{shape:[i,r]},backend:s}),l=Td(o,"float32","mean",s),c=ct({inputs:{x:l},attrs:{shape:t},backend:s});return s.disposeIntermediateTensorInfo(o),s.disposeIntermediateTensorInfo(l),c}const Rfe={kernelName:b0,backendName:"webgl",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{x:s}=n,{keepDims:r,axis:a}=e,i=t,o=s.shape.length,l=vn(a,s.shape);let c=l;const f=js(c,o),d=f!=null,m=i.shouldExecuteOnCPU([s]),g=[];let b=s;if(d){if(m){const A=i.texData.get(b.dataId).values,R=new Array(o);for(let P=0;P<R.length;P++)R[P]=s.shape[f[P]];const U=gC(A,s.shape,s.dtype,f,R);b=i.makeTensorInfo(R,s.dtype);const V=i.texData.get(b.dataId);V.values=U}else b=aw(s,f,i);g.push(b),c=hr(c.length,o)}da("sum",c,o);const[x,v]=Zr(b.shape,c);let w=x;r&&(w=cr(x,l));const k=$fe(b,v,w,i);for(const I of g)i.disposeIntermediateTensorInfo(I);return k}};function Dfe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:a,keepDims:i}=s,o=r.shape.length,l=vn(a,r.shape);let c=l;const f=js(c,o);let d=r;f!=null&&(d=Va({inputs:{x:r},backend:t,attrs:{perm:f}}),c=hr(c.length,r.shape.length)),da("min",c,o);const[m,g]=Zr(d.shape,c),b=Be(g),x=ct({inputs:{x:d},backend:t,attrs:{shape:[-1,b]}}),v=Td(x,x.dtype,"min",t);let w;if(i){const k=cr(m,l);w=ct({inputs:{x:v},backend:t,attrs:{shape:k}})}else w=ct({inputs:{x:v},backend:t,attrs:{shape:m}});return t.disposeIntermediateTensorInfo(x),t.disposeIntermediateTensorInfo(v),f!=null&&t.disposeIntermediateTensorInfo(d),w}const Ofe={kernelName:x0,backendName:"webgl",kernelFunc:Dfe};const Lfe=yC+`
  return min(a, b);
`,Ffe=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Cd+`
  return result;
`,Mfe=ma({opSnippet:Lfe,packedOpSnippet:Ffe,cpuKernelImpl:Sie}),zfe={kernelName:Em,backendName:"webgl",kernelFunc:Mfe};class Pfe{constructor(e,t,s){this.variableNames=["x"],this.outputShape=t.map((f,d)=>f[0]+e[d]+f[1]);const r=e.length,a=os(r),i=t.map(f=>f[0]).join(","),o=t.map((f,d)=>f[0]+e[d]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r),c=s==="reflect"?0:1;if(r===1){this.userCode=`
        int start = ${i};
        int end = ${o};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${c};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${c};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${a} start = ${a}(${i});
      ${a} end = ${a}(${o});

      void main() {
        ${a} outC = getOutputCoords();
        for (int i = 0; i < ${r}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${c};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${c};
          }
        }
        ${a} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}}class Bfe{constructor(e,t,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map((b,x)=>b[0]+e[x]+b[1]);const r=e.length,a=os(r),i=t.map(b=>b[0]).join(","),o=t.map((b,x)=>b[0]+e[x]).join(","),l=Ua("rc",r),c=Ua("source",r),f=`${l[r-1]} < ${this.outputShape[r-1]}`,d=r===1?"source":`vec2(${c.slice(-2).join()})`,m=s==="reflect"?0:1;let g="";if(r===1){const b=`
        ${a} source = rc;
        if (source < start) {
          source = start * 2 - source - ${m};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${m};
        }
        source -= start;
      `;g=`
        ${a} rc = outputLoc;
        ${b}
        result[0] = getChannel(getX(${c.join()}), ${d});
        ${l[r-1]} += 1;
        if(${f}) {
          ${b}
          result[1] = getChannel(getX(${c.join()}), ${d});
        }
      `}else{const b=`
        ${a} source = rc;
        ${a} lt = ${a}(lessThan(source, start));
        ${a} gte = ${a}(greaterThanEqual(source, end));
        ${a} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${m}) +
                gte * ((end - 1) * 2 - source + ${m});
        source -= start;
      `;g=`
        ${a} rc = outputLoc;
        ${b}
        result[0] = getChannel(getX(${c.join()}), ${d});
        ${l[r-1]} += 1;
        if(${f}) {
          ${b}
          result[1] = getChannel(getX(${c.join()}), ${d});
        }
        rc = outputLoc;
        ${l[r-2]} += 1;
        if(${l[r-2]} < ${this.outputShape[r-2]}) {
          ${b}
          result[2] = getChannel(getX(${c.join()}), ${d});
          ${l[r-1]} += 1;
          if(${f}) {
            ${b}
            result[3] = getChannel(getX(${c.join()}), ${d});
          }
        }
      `}this.userCode=`
      const ${a} start = ${a}(${i});
      const ${a} end = ${a}(${o});

      void main() {
        ${a} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${g}
        setOutput(result);
      }
    `}}const Ufe=({inputs:n,backend:e,attrs:t})=>{const{x:s}=n,{paddings:r,mode:a}=t,i=De().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Bfe(s.shape,r,a):new Pfe(s.shape,r,a);return e.runWebGLProgram(i,[s],s.dtype)},Vfe={kernelName:v0,backendName:"webgl",kernelFunc:Ufe};const jfe=`if (b == 0.0) return NAN;
  return mod(a, b);`,Wfe=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+Cd+`
  return result;
`,Gfe=ma({opSnippet:jfe,packedOpSnippet:Wfe}),qfe={kernelName:_m,backendName:"webgl",kernelFunc:Gfe};class Hfe{constructor(e,t,s){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,s],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${t-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${t-1}));
      }
    `}}const Kfe=`
if (a == b) {
  return 1.0;
};
return a / b;`,Xfe=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,AF=ma({opSnippet:Kfe,packedOpSnippet:Xfe,checkOutOfBounds:!0}),Yfe={kernelName:pm,backendName:"webgl",kernelFunc:AF};const GE="return a - b;",IF=ma({opSnippet:GE,packedOpSnippet:GE,supportsComplex:!0,cpuKernelImpl:jie}),Zfe={kernelName:qm,backendName:"webgl",kernelFunc:IF};function EF(n){const{inputs:e,backend:t,attrs:s}=n,{logits:r}=e,{dim:a}=s,i=vn([a],r.shape),o=TF({inputs:{x:r},backend:t,attrs:{reductionIndices:i,keepDims:!1}}),l=cr(o.shape,i),c=ct({inputs:{x:o},backend:t,attrs:{shape:l}}),f=IF({inputs:{a:r,b:c},backend:t}),d=NF({inputs:{x:f},backend:t}),m=iw({inputs:{x:d},backend:t,attrs:{axis:i,keepDims:!1}}),g=ct({inputs:{x:m},backend:t,attrs:{shape:l}}),b=AF({inputs:{a:d,b:g},backend:t});return t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(c),t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(g),b}const Jfe={kernelName:z0,backendName:"webgl",kernelFunc:EF};function Qfe(n){const{inputs:e,backend:t,attrs:s}=n,{logits:r}=e,{numSamples:a,seed:i,normalized:o}=s,l=o?r:EF({inputs:{logits:r},backend:t,attrs:{dim:r.shape.length-1}}),c=l.shape[0],f=l.shape[1],d=new Hfe(c,f,a),m=[[i]],g=t.runWebGLProgram(d,[l],"int32",m);return o||t.disposeIntermediateTensorInfo(l),g}const ede={kernelName:Ax,backendName:"webgl",kernelFunc:Qfe};const tde=Ko+`
  return -x;
`,nde=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function sde(n){const{inputs:e,backend:t}=n,{x:s}=e;if(t.shouldExecuteOnCPU([s])){const a=t.texData.get(s.dataId),[i,o]=kie(a.values,s.shape,s.dtype);return t.makeTensorInfo(o,s.dtype,i)}let r;return De().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new vh(s.shape,nde):r=new gu(s.shape,tde),t.runWebGLProgram(r,[s],s.dtype)}const rde={kernelName:w0,backendName:"webgl",kernelFunc:sde};const ade=Fv;function ide(n){io("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:s}=n,{boxes:r,scores:a}=e,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l}=s,c=t.readSync(r.dataId),f=t.readSync(a.dataId),{selectedIndices:d}=ade(c,f,i,o,l);return t.makeTensorInfo([d.length],"int32",new Int32Array(d))}const ode={kernelName:Ix,backendName:"webgl",kernelFunc:ide};const lde=Mv;function ude(n){io("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:s}=n,{boxes:r,scores:a}=e,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l,padToMaxOutputSize:c}=s,f=t.readSync(r.dataId),d=t.readSync(a.dataId),{selectedIndices:m,validOutputs:g}=lde(f,d,i,o,l,c);return[t.makeTensorInfo([m.length],"int32",new Int32Array(m)),t.makeTensorInfo([],"int32",new Int32Array([g]))]}const cde={kernelName:Ex,backendName:"webgl",kernelFunc:ude};const hde=zv;function fde(n){io("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:s}=n,{boxes:r,scores:a}=e,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l,softNmsSigma:c}=s,f=t.readSync(r.dataId),d=t.readSync(a.dataId),m=i,g=o,b=l,x=c,{selectedIndices:v,selectedScores:w}=hde(f,d,m,g,b,x);return[t.makeTensorInfo([v.length],"int32",new Int32Array(v)),t.makeTensorInfo([w.length],"float32",new Float32Array(w))]}const dde={kernelName:_x,backendName:"webgl",kernelFunc:fde};class pde{constructor(e,t,s,r){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${r}), float(${s}),
                      float(index == coords.y)));
      }
    `}}const mde=n=>{const{inputs:e,backend:t,attrs:s}=n,{indices:r}=e,{dtype:a,depth:i,onValue:o,offValue:l}=s,c=Be(r.shape),f=new pde(c,i,o,l),d=ct({inputs:{x:r},backend:t,attrs:{shape:[c]}}),m=t.runWebGLProgram(f,[d],a);t.disposeIntermediateTensorInfo(d);const g=[...r.shape,i],b=ct({inputs:{x:m},backend:t,attrs:{shape:g}});return t.disposeIntermediateTensorInfo(m),b},gde={kernelName:k0,backendName:"webgl",kernelFunc:mde};function Bb(n){const{inputs:e,backend:t}=n,{x:s}=e;if(s.dtype==="complex64"){const r=Ny({inputs:{input:s},backend:t}),a=Bb({inputs:{x:r},backend:t}),i=ow({inputs:{input:s},backend:t}),o=Bb({inputs:{x:i},backend:t}),l=Kh({inputs:{real:a,imag:o},backend:t});return t.disposeIntermediateTensorInfo(r),t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(o),l}else return ky({attrs:{shape:s.shape,dtype:s.dtype,value:s.dtype==="string"?"":0},backend:t})}const yde={kernelName:V0,backendName:"webgl",kernelFunc:Bb};function _F(n){const{inputs:e,backend:t}=n,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(s.dtype==="complex64"){const r=Ny({inputs:{input:s},backend:t}),a=_F({inputs:{x:r},backend:t}),i=ow({inputs:{input:s},backend:t}),o=Bb({inputs:{x:i},backend:t}),l=Kh({inputs:{real:a,imag:o},backend:t});return t.disposeIntermediateTensorInfo(r),t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(o),l}else return ky({attrs:{shape:s.shape,dtype:s.dtype,value:1},backend:t})}const bde={kernelName:N0,backendName:"webgl",kernelFunc:_F};function xde(n){const{inputs:e,backend:t,attrs:s}=n,{axis:r}=s;if(e.length===1)return mN({inputs:{input:e[0]},backend:t,attrs:{dim:r}});const a=e[0].shape,i=e[0].dtype;e.forEach(f=>{ha(a,f.shape,"All tensors passed to stack must have matching shapes"),Z(i===f.dtype,()=>"All tensors passed to stack must have matching dtypes")});const o=[],l=e.map(f=>{const d=mN({inputs:{input:f},backend:t,attrs:{dim:r}});return o.push(d),d}),c=mF({inputs:l,backend:t,attrs:{axis:r}});return o.forEach(f=>t.disposeIntermediateTensorInfo(f)),c}const vde={kernelName:C0,backendName:"webgl",kernelFunc:xde};class wde{constructor(e,t,s){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((c,f)=>c[0]+e[f]+c[1]);const r=e.length,a=os(r),i=t.map(c=>c[0]).join(","),o=t.map((c,f)=>c[0]+e[f]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);if(r===1){this.userCode=`
        int start = ${i};
        int end = ${o};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${a} start = ${a}(${i});
      ${a} end = ${a}(${o});

      void main() {
        ${a} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${a} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}}class Sde{constructor(e,t,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((x,v)=>x[0]+e[v]+x[1]);const r=e.length,a=os(r),i=t.map(x=>x[0]).join(","),o=t.map((x,v)=>x[0]+e[v]).join(","),l=Ua("rc",r),c=Ua("source",r),f=`${l[r-1]} < ${this.outputShape[r-1]}`,d=r===1?"source":`vec2(${c.slice(-2).join()})`,m=[`${a} rc = outputLoc;`,`${l[r-1]} += 1;
       if(${f}) {
      `,r===1?"":`}
       rc = outputLoc;
       ${l[r-2]} += 1;
       if(${l[r-2]} < ${this.outputShape[r-2]}) {`,r===1?"":`  ${l[r-1]} += 1;
         if(${f}) {`],g=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let b="";for(let x=0,v=r===1?2:4;x<v;x++)b+=`
        ${m[x]}
        if (${g}) {
          result[${x}] = float(value);
        } else {
          ${a} source = rc - start;
          result[${x}] = getChannel(getX(${c.join()}), ${d});
        }
      `;b+=r===1?"} ":"}}",this.userCode=`
      const ${a} start = ${a}(${i});
      const ${a} end = ${a}(${o});

      void main() {
        ${a} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${b}
        setOutput(result);
      }
    `}}const $F=n=>{const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{paddings:a,constantValue:i}=s;if(Be(r.shape)===0){const c=a.map((f,d)=>f[0]+r.shape[d]+f[1]);return ky({backend:t,attrs:{shape:c,value:i,dtype:r.dtype}})}const o=De().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Sde(r.shape,a,i):new wde(r.shape,a,i),l=[[i]];return t.runWebGLProgram(o,[r],r.dtype,l)},Nde={kernelName:T0,backendName:"webgl",kernelFunc:$F};const kde=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,Cde=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+Cd+`
  return result;
`,Tde=ma({opSnippet:kde,packedOpSnippet:Cde}),Ade={kernelName:Rm,backendName:"webgl",kernelFunc:Tde};function Ide(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:a,keepDims:i}=s,o=r.shape.length,l=[],c=vn(a,r.shape);let f=c;const d=js(f,o);let m=r;d!=null&&(m=Va({inputs:{x:r},backend:t,attrs:{perm:d}}),f=hr(f.length,o),l.push(m)),da("prod",f,o);let g;if(t.shouldExecuteOnCPU([m])){const b=t.texData.get(m.dataId).values,{outVals:x,outShape:v,outDtype:w}=Tie(m.shape,m.dtype,b,f);g=t.makeTensorInfo(v,w,x)}else{const[b,x]=Zr(m.shape,f),v=Be(x),w=ct({inputs:{x:m},backend:t,attrs:{shape:[-1,v]}}),k=nv(r.dtype),I=Td(w,k,"prod",t);g=ct({inputs:{x:I},backend:t,attrs:{shape:b}}),l.push(w),l.push(I)}if(i){l.push(g);const b=cr(g.shape,c);g=ct({inputs:{x:g},backend:t,attrs:{shape:b}})}return l.forEach(b=>t.disposeIntermediateTensorInfo(b)),g}const Ede={kernelName:I0,backendName:"webgl",kernelFunc:Ide};function _de(n){const{inputs:e,backend:t,attrs:s}=n,{paramsNestedSplits:r,paramsDenseValues:a,indices:i}=e,{outputRaggedRank:o}=s,l=r.map(w=>t.readSync(w.dataId)),c=r.map(w=>w.shape),f=t.readSync(a.dataId),d=t.readSync(i.dataId),[m,g,b]=Aie(l,c,f,a.shape,a.dtype,d,i.shape,o),x=m.map(w=>t.makeTensorInfo([w.length],"int32",w)),v=t.makeTensorInfo(b,a.dtype,g);return x.concat([v])}const $de={kernelName:$x,backendName:"webgl",kernelFunc:_de};function Rde(n){const{inputs:e,backend:t}=n,{starts:s,limits:r,deltas:a}=e,i=t.readSync(s.dataId),o=t.readSync(r.dataId),l=t.readSync(a.dataId),[c,f]=Iie(i,s.shape,s.dtype,o,r.shape,l,a.shape),d=t.makeTensorInfo([c.length],"int32",c),m=t.makeTensorInfo([f.length],s.dtype,f);return[d,m]}const Dde={kernelName:Rx,backendName:"webgl",kernelFunc:Rde};function Ode(n){const{inputs:e,backend:t,attrs:s}=n,{shape:r,values:a,defaultValue:i,rowPartitionTensors:o}=e,{rowPartitionTypes:l}=s,c=t.readSync(r.dataId),f=t.readSync(a.dataId),d=t.readSync(i.dataId),m=o.map(v=>t.readSync(v.dataId)),g=o.map(v=>v.shape),[b,x]=Eie(c,r.shape,f,a.shape,a.dtype,d,i.shape,m,g,l);return t.makeTensorInfo(b,a.dtype,x)}const Lde={kernelName:Dx,backendName:"webgl",kernelFunc:Ode};const RF=n=>{const{backend:e,attrs:t}=n,{start:s,stop:r,step:a,dtype:i}=t,o=_ie(s,r,a,i);return e.makeTensorInfo([o.length],i,o)},Fde={kernelName:Ox,backendName:"webgl",kernelFunc:RF};const Mde="return 1.0 / x;",zde=zn({opSnippet:Mde}),Pde={kernelName:Dm,backendName:"webgl",kernelFunc:zde};const Bde=Ko+`
  return (x < 0.0) ? 0.0 : x;
`,Ude=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Vde=zn({opSnippet:Bde,packedOpSnippet:Ude}),jde={kernelName:Om,backendName:"webgl",kernelFunc:Vde};const Wde=Ko+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Gde=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,qde=zn({opSnippet:Wde,packedOpSnippet:Gde}),Hde={kernelName:Lm,backendName:"webgl",kernelFunc:qde};class Kde{constructor(e,t,s,r,a){this.variableNames=["A"],this.outputShape=[];const[i,o,l,c]=e;this.outputShape=[i,t,s,c];const f=[r&&t>1?o-1:o,r&&s>1?l-1:l],d=[r&&t>1?t-1:t,r&&s>1?s-1:s];let m;a?m="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":m="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${f[0]/d[0]},
          ${f[1]/d[1]});
      const vec2 inputShapeRC = vec2(${o}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${m};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}class Xde{constructor(e,t,s,r,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,o,l,c]=e;this.outputShape=[i,t,s,c];const f=[r&&t>1?o-1:o,r&&s>1?l-1:l],d=[r&&t>1?t-1:t,r&&s>1?s-1:s];let m;a?m="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":m="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${f[0]/d[0]},
          ${f[1]/d[1]},
          ${f[1]/d[1]});
      const vec3 inputShapeRC = vec3(${o}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${m};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${s-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}function Yde(n){const{inputs:e,backend:t,attrs:s}=n,{images:r}=e,{alignCorners:a,halfPixelCenters:i,size:o}=s,[l,c]=o,f=De().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Xde(r.shape,l,c,a,i):new Kde(r.shape,l,c,a,i);return t.runWebGLProgram(f,[r],"float32")}const Zde={kernelName:$0,backendName:"webgl",kernelFunc:Yde};class Jde{constructor(e,t,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,r,a]=t,[,i,o]=e,l=[s&&i>1?r-1:r,s&&o>1?a-1:a],c=[s&&i>1?i-1:i,s&&o>1?o-1:o],f=l[0]/c[0],d=l[1]/c[1],m=1/f,g=1/d,b=Math.ceil(m)*2+2,x=Math.ceil(g)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${f});
        const float widthScale = float(${d});

        const float invHeightScale = float(${m});
        const float invWidthScale = float(${g});

        const int winHeight = int(${b});
        const int winWidth = int(${x});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${o}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${r-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${a-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}function Qde(n){const{inputs:e,backend:t,attrs:s}=n,{images:r,dy:a}=e,{alignCorners:i}=s,o=new Jde(a.shape,r.shape,i);return t.runWebGLProgram(o,[a],a.dtype)}const epe={kernelName:Mx,backendName:"webgl",kernelFunc:Qde};class tpe{constructor(e,t,s,r,a){this.variableNames=["A"],this.outputShape=[];const[i,o,l,c]=e;this.outputShape=[i,t,s,c];const f=[r&&t>1?o-1:o,r&&s>1?l-1:l],d=[r&&t>1?t-1:t,r&&s>1?s-1:s],m=r?"0.5":"0.0";let g;a?g="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":g="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${f[0]/d[0]},
          ${f[1]/d[1]});
      const vec2 inputShapeRC = vec2(${o}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${g};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${m})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}class npe{constructor(e,t,s,r,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,o,l,c]=e;this.outputShape=[i,t,s,c];const f=[r&&t>1?o-1:o,r&&s>1?l-1:l],d=[r&&t>1?t-1:t,r&&s>1?s-1:s],m=r?"0.5":"0.0";let g;a?g="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":g="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${f[0]/d[0]},
          ${f[1]/d[1]},
          ${f[1]/d[1]});
      const vec3 inputShapeRC = vec3(${o}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${g};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${m})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${s-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}function spe(n){const{inputs:e,backend:t,attrs:s}=n,{images:r}=e,{alignCorners:a,halfPixelCenters:i,size:o}=s,[l,c]=o,f=De().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new npe(r.shape,l,c,a,i):new tpe(r.shape,l,c,a,i);return t.runWebGLProgram(f,[r],r.dtype)}const rpe={kernelName:_0,backendName:"webgl",kernelFunc:spe};class ape{constructor(e,t,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,r,a]=t,[,i,o]=e,l=[s&&i>1?r-1:r,s&&o>1?a-1:a],c=[s&&i>1?i-1:i,s&&o>1?o-1:o],f=l[0]/c[0],d=l[1]/c[1],m=1/f,g=1/d,b=Math.ceil(m)*2+2,x=Math.ceil(g)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${f});
        const float widthScale = float(${d});

        const float invHeightScale = float(${m});
        const float invWidthScale = float(${g});

        const int winHeight = int(${b});
        const int winWidth = int(${x});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${o}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${c[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${c[1]}));

            int sourceNearestRow = int(min(
                float(int(${r}) - 1),
                ${s} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${a}) - 1),
                ${s} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}function ipe(n){const{inputs:e,backend:t,attrs:s}=n,{images:r,dy:a}=e,{alignCorners:i}=s,o=new ape(a.shape,r.shape,i);return t.runWebGLProgram(o,[a],a.dtype)}const ope={kernelName:Fx,backendName:"webgl",kernelFunc:ipe};class lpe{constructor(e,t){this.variableNames=["x"];const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);if(this.outputShape=e,s===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const r=o=>t.indexOf(o)!==-1&&e[o]!==1?`${e[o]} - coords[${o}] - 1`:`coords[${o}]`,a=e.map((o,l)=>r(l)).join(","),i=os(s);this.userCode=`
      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}}class upe{constructor(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);this.outputShape=e;const r=Ua("rc",s),a=`${r[s-1]} + 1 < ${this.outputShape[s-1]}`,i=`${r[s-2]} + 1 < ${this.outputShape[s-2]}`,o=os(s);s===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${a}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${o} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(r.slice())};
          if(${a}){
            result.g = ${c(r.slice())};
          }
          if(${i}) {
            result.b = ${f(r.slice())};
            if(${a}) {
              result.a = ${d(r.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(b){return m(b)}function c(b){return b[s-1]="("+b[s-1]+" + 1)",m(b)}function f(b){return b[s-2]="("+b[s-2]+" + 1)",m(b)}function d(b){return b[s-1]="("+b[s-1]+" + 1)",b[s-2]="("+b[s-2]+" + 1)",m(b)}function m(b){const x=e.map((k,I)=>g(I,b)),v=x.join(","),w=x.slice(-2).join(",");return`getChannel(getX(${v}), vec2(${w}))`}function g(b,x){return t.indexOf(b)!==-1&&e[b]!==1?`${e[b]} - ${x[b]} - 1`:`${x[b]}`}}}function cpe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{dims:a}=s,i=r.shape.length,o=vn(a,r.shape);if(i===0)return zi({inputs:{x:r},backend:t});const l=De().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new upe(r.shape,o):new lpe(r.shape,o);return t.runWebGLProgram(l,[r],r.dtype)}const hpe={kernelName:R0,backendName:"webgl",kernelFunc:cpe};class fpe{constructor(e,t){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const s=e[1],r=e[2];this.outputShape=e;let a="";typeof t=="number"?a=`float outputValue = ${t.toFixed(2)};`:a=`
        vec3 fill = vec3(${t.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${a}
          if(coordX >= 0 && coordX < ${r} && coordY >= 0 && coordY < ${s}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}const dpe={kernelName:ev,backendName:"webgl",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{image:s}=n,{radians:r,fillValue:a,center:i}=e,o=t,l=new fpe(s.shape,a),[c,f]=y3(i,s.shape[1],s.shape[2]),d=[[c,f,Math.sin(r),Math.cos(r)]];return o.runWebGLProgram(l,[s],s.dtype,d)}};const ppe=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,mpe=zn({opSnippet:ppe}),gpe={kernelName:Fm,backendName:"webgl",kernelFunc:mpe};const ype="return inversesqrt(x);",bpe=zn({opSnippet:ype,cpuKernelImpl:$ie}),xpe={kernelName:Mm,backendName:"webgl",kernelFunc:bpe};class vC{constructor(e,t,s,r,a,i,o=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;const c=os(a.length),f=os(i.length);let d="";s===1?d="i":s===2&&(d="i, j");const m=`getIndices(${d})`;let g="";r===1?g="i":r===2&&(g="i, coords[1]");const b=`getUpdates(${g})`;let x="";l&&(x="coords[0], coords[1]");const v=`getDefaultValue(${x})`,w=t>1?"strides[j]":"strides";this.userCode=`
        ${c} strides = ${c}(${a});

        void main() {
          ${f} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${t}; j++) {
              int index = round(${m});
              flattenedIndex += index * ${w};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${b};
              found = true;
            }
          }
          setOutput(mix(${v}, sum, float(found)));
        }
      `}}class vpe{constructor(e,t,s,r,a,i,o=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=i;const c=os(a.length),f=os(i.length);let d="";s===1?d="i":s===2&&(d="i, j");const m=`getIndices(${d})`;let g="";r===1?g="i":r===2&&(g="i, coords[1]");const b=`getUpdates(${g})`;let x="";l&&(x="coords[0], coords[1]");const v=`getDefaultValue(${x})`,w=t>1?"strides[j]":"strides",k=t>1?"strides[j + 1]":"strides";this.userCode=`
        ${c} strides = ${c}(${a});

        void main() {
          ${f} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${e}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${t}; j+=2) {
              ivec4 index = round(${m});
              flattenedIndex += index.xz * ${w};
              if (j + 1 < ${t}) {
                flattenedIndex += index.yw * ${k};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${b};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${v}, sum, found));
        }
      `}}function wpe(n){const{inputs:e,backend:t,attrs:s}=n,{indices:r,updates:a}=e,{shape:i}=s,{sliceRank:o,numUpdates:l,sliceSize:c,strides:f,outputSize:d}=Gh(a,r,i),m=[d/c,c];if(d===0)return t.makeTensorInfo(i,r.dtype);const g=ct({inputs:{x:r},backend:t,attrs:{shape:[l,o]}}),b=ct({inputs:{x:a},backend:t,attrs:{shape:[l,c]}}),x=t.makeTensorInfo([],"float32",new Float32Array([0]));let v;De().getBool("WEBGL_PACK")?v=new vpe(l,o,g.shape.length,b.shape.length,f,m):v=new vC(l,o,g.shape.length,b.shape.length,f,m);const w=t.runWebGLProgram(v,[b,g,x],b.dtype),k=ct({inputs:{x:w},backend:t,attrs:{shape:i}});return t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(b),t.disposeIntermediateTensorInfo(w),t.disposeIntermediateTensorInfo(x),k}const Spe={kernelName:zx,backendName:"webgl",kernelFunc:wpe};class Npe{constructor(e,t,s,r){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,s];const a="while (left < right) {",i=`for (int i = 0; i < ${Math.ceil(Math.log2(t+1))}; ++i) { if (left >= right) break;`,o=De().getNumber("WEBGL_VERSION")===2?a:i,l=r==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${o}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}function kpe(n){const{inputs:e,backend:t,attrs:s}=n,{sortedSequence:r,values:a}=e,{side:i}=s,o=new Npe(r.shape[0],r.shape[1],a.shape[1],i),l=[[r.shape[1]]];return t.runWebGLProgram(o,[r,a],"int32",l)}const Cpe={kernelName:Bx,backendName:"webgl",kernelFunc:kpe};class Tpe{constructor(e,t,s){this.variableNames=["c","a","b"],this.outputShape=t;let r,a;if(s>4)throw Error(`Where for rank ${s} is not yet supported`);if(s===1)a="resRC",r="resRC";else{const o=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],c=[];for(let f=0;f<t.length;f++)c.push(`${o[f]}`),f<e&&l.push(`${o[f]}`);r=l.join(),a=c.join()}const i=os(s);this.userCode=`
      void main() {
        ${i} resRC = getOutputCoords();
        float cVal = getC(${r});
        if (cVal >= 1.0) {
          setOutput(getA(${a}));
        } else {
          setOutput(getB(${a}));
        }
      }
    `}}function Ape(n){const{inputs:e,backend:t}=n,{condition:s,t:r,e:a}=e,i=new Tpe(s.shape.length,r.shape,r.shape.length);return t.runWebGLProgram(i,[s,r,a],ai(r.dtype,a.dtype))}const Ipe={kernelName:D0,backendName:"webgl",kernelFunc:Ape};const Epe=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${jv};
  float scale = ${Wv};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,_pe=zn({opSnippet:Epe}),$pe={kernelName:zm,backendName:"webgl",kernelFunc:_pe};const Rpe=fg+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,Dpe=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Ope=zn({opSnippet:Rpe,packedOpSnippet:Dpe,cpuKernelImpl:Die}),Lpe={kernelName:Vm,backendName:"webgl",kernelFunc:Ope};const Fpe=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,Mpe=zn({opSnippet:Fpe}),zpe={kernelName:Um,backendName:"webgl",kernelFunc:Mpe};const Ppe=fg+`
  return sin(x);
`,Bpe=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${Cd}
  return result;
`,Upe=zn({opSnippet:Ppe,packedOpSnippet:Bpe}),Vpe={kernelName:Pm,backendName:"webgl",kernelFunc:Upe};const jpe=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,Wpe=zn({opSnippet:jpe}),Gpe={kernelName:Bm,backendName:"webgl",kernelFunc:Wpe};const qpe=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,Hpe=zn({opSnippet:qpe}),Kpe={kernelName:jm,backendName:"webgl",kernelFunc:Hpe};const Xpe=n=>{const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{blockShape:a,paddings:i}=s;Z(r.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const o=a.reduce((w,k)=>w*k),l=[[0,0]];l.push(...i);for(let w=1+a.length;w<r.shape.length;++w)l.push([0,0]);const c=[],f=$F({inputs:{x:r},backend:t,attrs:{paddings:l,constantValue:0}}),d=ly(f.shape,a,o,!1),m=uy(d.length,a.length,!1),g=cy(f.shape,a,o,!1),b=ct({inputs:{x:f},backend:t,attrs:{shape:d}}),x=Va({inputs:{x:b},backend:t,attrs:{perm:m}}),v=ct({inputs:{x},backend:t,attrs:{shape:g}});return c.push(f),c.push(b),c.push(x),c.forEach(w=>t.disposeIntermediateTensorInfo(w)),v},Ype={kernelName:F0,backendName:"webgl",kernelFunc:Xpe};function Zpe(n){const{inputs:e,backend:t}=n,{indices:s,values:r,denseShape:a,defaultValue:i}=e;if(a.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${a.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${r.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);const o=t.readSync(s.dataId),l=t.readSync(r.dataId),c=t.readSync(a.dataId),f=t.readSync(i.dataId)[0],[d,m,g,b,x]=Lie(o,s.shape,s.dtype,l,r.dtype,c,f);return[t.makeTensorInfo(m,s.dtype,d),t.makeTensorInfo([m[0]],r.dtype,g),t.makeTensorInfo([b.length],"bool",new Uint8Array(b.map(v=>Number(v)))),t.makeTensorInfo([x.length],s.dtype,new Int32Array(x))]}const Jpe={kernelName:Ux,backendName:"webgl",kernelFunc:Zpe};function Qpe(n){const{inputs:e,backend:t}=n,{inputIndices:s,inputShape:r,newShape:a}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${r.shape}`);if(a.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${a.shape}`);const i=Array.from(t.readSync(r.dataId)),o=t.readSync(s.dataId),l=Array.from(t.readSync(a.dataId)),[c,f,d]=Fie(o,s.shape,s.dtype,i,l);return[t.makeTensorInfo(f,s.dtype,c),t.makeTensorInfo([d.length],a.dtype,new Int32Array(d))]}const eme={kernelName:Vx,backendName:"webgl",kernelFunc:Qpe};function tme(n){const{inputs:e,backend:t}=n,{data:s,indices:r,segmentIds:a}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${r.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${a.shape}`);const i=t.readSync(s.dataId),o=t.readSync(r.dataId),l=t.readSync(a.dataId),[c,f]=nF(i,s.shape,s.dtype,o,l,!0);return t.makeTensorInfo(f,s.dtype,c)}const nme={kernelName:jx,backendName:"webgl",kernelFunc:tme};function sme(n){const{inputs:e,backend:t}=n,{data:s,indices:r,segmentIds:a}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${r.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${a.shape}`);const i=t.readSync(s.dataId),o=t.readSync(r.dataId),l=t.readSync(a.dataId),[c,f]=nF(i,s.shape,s.dtype,o,l);return t.makeTensorInfo(f,s.dtype,c)}const rme={kernelName:Wx,backendName:"webgl",kernelFunc:sme};function ame(n){const{inputs:e,backend:t,attrs:s}=n,{sparseIndices:r,sparseValues:a,defaultValue:i}=e,{outputShape:o}=s,{sliceRank:l,numUpdates:c,sliceSize:f,strides:d,outputSize:m}=Gh(a,r,o),g=!1;if(a.dtype==="string"){const w=t.bufferSync(r),k=t.bufferSync(a),I=bc(t.readSync(i.dataId)[0]),A=Rie(w,k,o,m,f,c,l,d,I,g);return t.makeTensorInfo(o,A.dtype,A.values)}const b=new vC(c,l,r.shape.length,a.shape.length,d,[m,1],g),x=t.runWebGLProgram(b,[a,r,i],a.dtype),v=ct({inputs:{x},backend:t,attrs:{shape:o}});return t.disposeIntermediateTensorInfo(x),v}const ime={kernelName:Gx,backendName:"webgl",kernelFunc:ame};function ome(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{numOrSizeSplits:a,axis:i}=s,o=vn(i,r.shape)[0],l=R3(r,a,o),c=r.shape.length,f=new Array(c).fill(0),d=r.shape.slice();return l.map(m=>{const g=[...d];g[o]=m;const b=dg({inputs:{x:r},backend:t,attrs:{begin:f,size:g}});return f[o]+=m,b})}const lme={kernelName:M0,backendName:"webgl",kernelFunc:ome};const qE="return sqrt(x);",ume=zn({opSnippet:qE,packedOpSnippet:qE,cpuKernelImpl:Mie}),cme={kernelName:Wm,backendName:"webgl",kernelFunc:ume};const hme="return x * x;",fme=zn({opSnippet:hme}),dme={kernelName:qx,backendName:"webgl",kernelFunc:fme};const HE="return (a - b) * (a - b);",pme=ma({opSnippet:HE,packedOpSnippet:HE}),mme={kernelName:Gm,backendName:"webgl",kernelFunc:pme};function gme(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e;if(r.dtype!=="string")throw new Error("Input must be of datatype string");const a=t.readSync(r.dataId),i=Sc(a),o=zie(i,"string",s);return t.makeTensorInfo(r.shape,"string",o)}const yme={kernelName:P0,backendName:"webgl",kernelFunc:gme};function bme({inputs:n,attrs:e,backend:t}){const{x:s}=n,r=Ko+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,a=new gu(s.shape,r);return t.runWebGLProgram(a,[s],s.dtype)}const xme={kernelName:Ym,backendName:"webgl",kernelFunc:bme};class vme{constructor(e,t,s){this.variableNames=["x"],this.outputShape=s;const r=s.length,a=os(s.length),i=os(s.length);let o="";if(r===1)o="coords * strides + begin";else{let l=0;o=s.map((c,f)=>(l++,s.length===1?`coords * strides[${f}] + begin[${f}]`:`coords[${l-1}] * strides[${f}] + begin[${f}]`)).join(",")}this.userCode=`
      ${a} begin = ${a}(${e});
      ${a} strides = ${a}(${t});

      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${o}));
      }
    `}}function wme(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{begin:a,end:i,strides:o,beginMask:l,endMask:c,ellipsisMask:f,newAxisMask:d,shrinkAxisMask:m}=s,{finalShapeSparse:g,finalShape:b,isIdentity:x,sliceDim0:v,isSimpleSlice:w,begin:k,end:I,strides:A}=d3(r.shape,a,i,o,l,c,f,d,m);let R;if(x)R=ct({inputs:{x:r},backend:t,attrs:{shape:b}});else if(v||w){Z(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const V=c3(k,I,A),P=dg({inputs:{x:r},backend:t,attrs:{begin:k,size:V}});R=ct({inputs:{x:P},backend:t,attrs:{shape:b}}),t.disposeIntermediateTensorInfo(P)}else if(t.shouldExecuteOnCPU([r])){const P=t.readSync(r.dataId),D=mn(r.shape,r.dtype,P),B=Pie(g,D,A,k);R=t.makeTensorInfo(b,r.dtype,B.values)}else{const P=new vme(k,A,g);R=t.runWebGLProgram(P,[r],r.dtype)}const U=ct({inputs:{x:R},backend:t,attrs:{shape:b}});return t.disposeIntermediateTensorInfo(R),U}const Sme={kernelName:Hx,backendName:"webgl",kernelFunc:wme};function Nme(n){const{inputs:e,backend:t,attrs:s}=n,{separator:r,nGramWidths:a,leftPad:i,rightPad:o,padWidth:l,preserveShortSequences:c}=s,{data:f,dataSplits:d}=e,m=t.readSync(f.dataId),g=t.readSync(d.dataId),[b,x]=Bie(m,g,r,a,i,o,l,c);return[t.makeTensorInfo([b.length],"string",b),t.makeTensorInfo(d.shape,"int32",x)]}const kme={kernelName:Kx,backendName:"webgl",kernelFunc:Nme};function Cme(n){const{inputs:e,backend:t,attrs:s}=n,{skipEmpty:r}=s,{input:a,delimiter:i}=e;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(a.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${a.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);const o=t.readSync(a.dataId),l=t.readSync(i.dataId)[0],[c,f,d]=Uie(o,l,r),m=f.length;return[t.makeTensorInfo([m,2],"int32",c),t.makeTensorInfo([m],"string",f),t.makeTensorInfo([2],"int32",new Int32Array(d))]}const Tme={kernelName:Xx,backendName:"webgl",kernelFunc:Cme};function Ame(n){const{inputs:e,backend:t,attrs:s}=n,{numBuckets:r}=s,{input:a}=e;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const i=t.readSync(a.dataId),o=Vie(i,r);return t.makeTensorInfo(a.shape,"int32",o)}const Ime={kernelName:Yx,backendName:"webgl",kernelFunc:Ame};const Eme="return tan(x);",_me=zn({opSnippet:Eme}),$me={kernelName:Hm,backendName:"webgl",kernelFunc:_me};const Rme=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,Dme=zn({opSnippet:Rme}),Ome={kernelName:Km,backendName:"webgl",kernelFunc:Dme};function Lme(n){const{inputs:e,backend:t,attrs:s}=n,{tensor:r,indices:a,updates:i}=e,{sliceRank:o,numUpdates:l,sliceSize:c,strides:f,outputSize:d}=Gh(i,a,r.shape),m=[d/c,c];if(d===0)return t.makeTensorInfo(r.shape,a.dtype);const g=ct({inputs:{x:a},backend:t,attrs:{shape:[l,o]}}),b=ct({inputs:{x:i},backend:t,attrs:{shape:[l,c]}}),x=ct({inputs:{x:r},backend:t,attrs:{shape:m}}),v=new vC(l,o,g.shape.length,b.shape.length,f,m,!1,!0),w=t.runWebGLProgram(v,[b,g,x],x.dtype),k=ct({inputs:{x:w},backend:t,attrs:{shape:r.shape}});return t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(b),t.disposeIntermediateTensorInfo(x),t.disposeIntermediateTensorInfo(w),k}const Fme={kernelName:Px,backendName:"webgl",kernelFunc:Lme};class Mme{constructor(e,t){this.variableNames=["A"];const s=new Array(e.length);for(let i=0;i<s.length;i++)s[i]=e[i]*t[i];this.outputShape=s,this.rank=s.length;const r=os(this.rank),a=zme(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        setOutput(getA(${a}));
      }
    `}}function zme(n){const e=n.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${n[0]})`;const t=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],s=[];for(let r=0;r<n.length;r++)s.push(`imod(${t[r]}, ${n[r]})`);return s.join()}function DF(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{reps:a}=s;if(r.dtype==="string"||r.shape.length>5){const l=t.readSync(r.dataId),c=r.dtype==="string"?l.map(m=>bc(m)):l,f=mn(r.shape,r.dtype,c),d=Wie(f,a);return t.makeTensorInfo(d.shape,d.dtype,d.values)}const i=new Mme(r.shape,a);return t.runWebGLProgram(i,[r],r.dtype)}const Pme={kernelName:Xm,backendName:"webgl",kernelFunc:DF};class Bme{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class Ume{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}function _f(n,e){e!==null&&n.disposeIntermediateTensorInfo(e)}function KE(n){let e=1;for(;e<n;)e*=2;return e}function Vme(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{k:a,sorted:i}=s,o=De().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=De().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),c=r.shape,f=c[c.length-1];if(t.shouldExecuteOnCPU([r])||f<o||a>l){const B=t.readSync(r.dataId),[E,M]=Gie(B,c,r.dtype,a,i);return[t.makeTensorInfo(E.shape,E.dtype,E.values),t.makeTensorInfo(M.shape,M.dtype,M.values)]}if(a===0)return c[c.length-1]=0,[t.makeTensorInfo(c,r.dtype,[]),t.makeTensorInfo(c,"int32",[])];if(f===1)return[r,ky({attrs:{shape:c,dtype:"int32",value:0},backend:t})];const d=t.texData.get(r.dataId),m=d!==null&&d.isPacked,g=m?t.unpackTensor(r):r,x=Be(c)/f,v=ct({inputs:{x:g},attrs:{shape:[x,f]},backend:t});m&&_f(t,g);const w=KE(a),k=KE(f);let I=null;const A=()=>I===null?[v,v]:[v,I],R=(B,E,M)=>{const K=A(),X=new Bme(M),W=[[f],[I===null?1:0],[Number.NEGATIVE_INFINITY],[B],[E]],se=I;I=t.runWebGLProgram(X,K,"int32",W),_f(t,se)};for(let B=1;B<w;B*=2){const E=B*2;for(let M=B;M>=1;M/=2)R(E,M,[x,k])}for(let B=k;B>w;B/=2){const E=A(),M=new Ume([x,B/2]),X=[[f],[I===null?1:0],[w]],ae=I;I=t.runWebGLProgram(M,E,"int32",X),_f(t,ae);const W=w/2,se=W*2;for(let ee=W;ee>=1;ee/=2)R(se,ee,I.shape)}let U=I;I=dg({inputs:{x:I},backend:t,attrs:{begin:0,size:[x,a]}}),_f(t,U);let V=CF({inputs:{x:v,indices:I},backend:t,attrs:{axis:1,batchDims:1}});_f(t,v);const P=c.slice(0,-1);P.push(a),U=I,I=ct({inputs:{x:I},attrs:{shape:P},backend:t}),_f(t,U);const D=V;return V=ct({inputs:{x:V},attrs:{shape:P},backend:t}),_f(t,D),[V,I]}const jme={kernelName:Zx,backendName:"webgl",kernelFunc:Vme};class Wme{constructor(e,t,s,r,a,i){this.variableNames=["Image","Transforms"],this.outputShape=i;const o=s==="nearest"?1:2;let l;switch(r){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${t}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${a});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${a});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${t}));
                float mapY = mapCoord(inY, float(${e}));

                if (${o} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}function Gme(n){const{inputs:e,backend:t,attrs:s}=n,{image:r,transforms:a}=e,{interpolation:i,fillMode:o,fillValue:l,outputShape:c}=s,[f,d,m,g]=r.shape,[b,x]=c??[d,m],v=[f,b,x,g],w=new Wme(d,m,i,o,l,v);return t.runWebGLProgram(w,[r,a],"float32")}const qme={kernelName:Jx,backendName:"webgl",kernelFunc:Gme};function Hme(n){const{inputs:e,attrs:t,backend:s}=n,{axis:r}=t,{x:a}=e;wy(a,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const i=s.readSync(a.dataId),{outputValues:o,outputShape:l,indices:c}=qie(i,r,a.shape,a.dtype);return[s.makeTensorInfo(l,a.dtype,o),s.makeTensorInfo([c.length],"int32",c)]}const Kme={kernelName:Qx,backendName:"webgl",kernelFunc:Hme};function Xme(n){const{inputs:e,backend:t,attrs:s}=n,{value:r}=e;let{axis:a}=s;a<0&&(a+=r.shape.length);const i=r,o=i.shape.length,l=r.shape[a],c=new Array(o-1);let f=0;for(let x=0;x<o;x++)x!==a&&(c[f++]=i.shape[x]);const d=[],m=new Array(o).fill(0),g=i.shape.slice();g[a]=1;const b=new Array(l);for(let x=0;x<b.length;x++){m[a]=x;const v=dg({inputs:{x:i},backend:t,attrs:{begin:m,size:g}}),w=ct({inputs:{x:v},backend:t,attrs:{shape:c}});b[x]=w,d.push(v)}return d.forEach(x=>t.disposeIntermediateTensorInfo(x)),b}const Yme={kernelName:B0,backendName:"webgl",kernelFunc:Xme};class Zme{constructor(e,t){this.variableNames=["x","segmentIds"];const s=e.windowSize,r=e.batchSize,a=e.inSize,i=e.numSegments,o=i*Math.ceil(a/s);this.outputShape=[r,o];const l="0.0",c="sumValue",f=Math.floor(s/4)*4,d=s%4,m=`
        sumValue += dot(values, segFilter);
    `;let g="";a%s>0&&(g=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return initializationValue;
        }
      `);let b="";a%s>0&&(b=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${g}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${b}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${i})) * float(${s}));
        int currentSeg = int(mod(float(outIdx), float(${i})));

        float sumValue = 0.0;

        for (int i = 0; i < ${f}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${m}
        }

        int inIdx = inOffset + ${f};
        if (${d===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${m}
        } else if (${d===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${m}
        } else if (${d===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${m}
        }
        setOutput(${c});
      }
    `}}function Jme(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,segmentIds:a}=e,{numSegments:i}=s,o=r.shape.length,l=[];let c=0;const f=js([c],o);let d=r;f!=null&&(d=Va({inputs:{x:r},backend:t,attrs:{perm:f}}),l.push(d),c=hr(1,o)[0]);const m=cD(d.shape,c,i),g=Be([d.shape[c]]),b=ct({inputs:{x:d},backend:t,attrs:{shape:[-1,g]}});l.push(b);const x=nv(r.dtype),v=(A,R,U,V,P)=>{const D=A.shape[0],B=A.shape[1],E=uD(B,P),M={windowSize:E,inSize:B,batchSize:D,numSegments:P},K=new Zme(M,R),X=t.compileAndRun(K,[A,U],V);if(l.push(X),X.shape[1]===P)return X;const ae=RF({backend:t,attrs:{start:0,stop:P,step:1,dtype:"float32"}}),W=DF({inputs:{x:ae},backend:t,attrs:{reps:[B/E]}});return l.push(ae),l.push(W),v(X,R,W,V,P)},w=v(b,"unsortedSegmentSum",a,x,i),k=ct({inputs:{x:w},backend:t,attrs:{shape:m}});let I=k;if(f!=null){l.push(k);const A=Vh(f);I=Va({inputs:{x:I},backend:t,attrs:{perm:A}})}return l.forEach(A=>t.disposeIntermediateTensorInfo(A)),I}const Qme={kernelName:U0,backendName:"webgl",kernelFunc:Jme};const ege=[Moe,Poe,Voe,Goe,Hoe,Yoe,Joe,ele,rle,ile,ule,fle,mle,xle,Sle,kle,Tle,_le,Rle,Ole,zle,Gle,Hle,Zle,Qle,aue,oue,hue,voe,pue,xue,Nue,Eue,Rue,Oue,Fue,zue,Vue,Gue,Kue,Yue,Jue,ece,sce,ace,uce,hce,pce,yce,xce,Nce,Ace,$ce,Oce,Mce,zce,Bce,Vce,Wce,qce,Kce,Jce,the,rhe,ihe,uhe,fhe,ghe,vhe,xoe,She,yue,Che,Ihe,$he,Soe,Lhe,Phe,Uhe,Ghe,Khe,Jhe,tfe,afe,ufe,ffe,pfe,bfe,vfe,Sfe,Tfe,Ife,_fe,Rfe,Ofe,zfe,Vfe,qfe,ede,Coe,rde,ode,cde,dde,tue,gde,bde,vde,Nde,Ade,koe,Ede,$de,Dde,Lde,Fde,nue,Yfe,Pde,jde,Hde,Aoe,Zde,epe,rpe,ope,hpe,dpe,gpe,xpe,Spe,Cpe,Ipe,$pe,Lpe,zpe,Vpe,Gpe,jle,Jfe,Kpe,Ype,Jpe,eme,nme,rme,ime,lme,cme,dme,mme,yme,xme,Sme,kme,Tme,Ime,Zfe,Ooe,$me,Ome,Fme,Pme,jme,qme,Loe,Kme,Yme,Qme,yde];for(const n of ege)tv(n);let Y5=null;async function tge(){return Y5||(Y5=await FH({version:2,alpha:1})),Y5}async function nge(n){return(await(await tge()).classify(n))[0].className.toLowerCase()}function sge({setRecipes:n}){const[e,t]=We.useState([]),[s,r]=We.useState([""]),[a,i]=We.useState("none"),[o,l]=We.useState(!1),c=N_(),{theme:f}=We.useContext(zh),d=f==="dark";function m(v){const k=Array.from(v.target.files).map(I=>({file:I,url:URL.createObjectURL(I),detected:null}));t(I=>[...I,...k])}function g(v,w){const k=[...s];k[v]=w,r(k)}function b(){r(v=>[...v,""])}async function x(){const v=new FormData;l(!0),e.forEach(w=>v.append("images",w.file)),v.append("ingredientsText",s.filter(Boolean).join(",")),v.append("diet",a);try{const k=await(await fetch("undefined/recognize",{method:"POST",body:v})).json(),A=await(await fetch("undefined/recipes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ingredients:k.ingredients,diet:k.diet})})).json();n(A.recipes),c("/recipes")}catch(w){console.error(w),alert("Recognition failed.")}finally{l(!1)}}return $e.jsx("div",{className:"min-h-screen w-full flex items-center justify-center px-6 py-16",children:$e.jsxs("div",{className:`
          glass-panel p-10 rounded-3xl max-w-3xl w-full shadow-2xl backdrop-blur-xl 
          border ${d?"border-white/10":"border-white/20"}
        `,children:[$e.jsx("h2",{className:`
            text-4xl font-extrabold mb-6 text-center drop-shadow-lg
            ${d?"text-blue-300":"text-blue-700"}
          `,children:"Add Your Ingredients"}),o&&$e.jsx("p",{className:`
              mb-4 text-center animate-pulse text-lg font-semibold
              ${d?"text-blue-300":"text-blue-600"}
            `,children:"Generating recipes..."}),$e.jsxs("div",{className:"mb-8",children:[$e.jsx("label",{className:`
              block text-lg font-semibold mb-2
              ${d?"text-blue-200":"text-gray-800"}
            `,children:"Upload ingredient photos"}),$e.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:m,className:`
              w-full p-3 rounded-xl border transition
              ${d?"border-blue-500/30 bg-white/10 text-blue-100 focus:ring-blue-600":"border-blue-300/40 bg-white/50 text-gray-900 focus:ring-blue-400"}
            `}),$e.jsx("div",{className:"flex gap-4 mt-4 flex-wrap",children:e.map((v,w)=>$e.jsxs("div",{className:`
                  flex flex-col items-center p-3 rounded-xl shadow-md backdrop-blur-xl
                  ${d?"border border-blue-500/20 bg-white/5":"border border-blue-300/30 bg-white/60"}
                `,children:[$e.jsx("img",{src:v.url,alt:"preview",className:"w-24 h-24 object-cover rounded-lg border border-blue-400/50",onLoad:async k=>{if(!v.detected){const I=await nge(k.target);t(A=>{const R=[...A];return R[w]={...R[w],detected:I},R})}}}),v.detected&&$e.jsx("p",{className:"text-sm mt-2 text-green-500 dark:text-green-400",children:v.detected})]},w))})]}),$e.jsxs("div",{className:"mb-8",children:[$e.jsx("label",{className:`
              block text-lg font-semibold mb-2
              ${d?"text-blue-200":"text-gray-800"}
            `,children:"Type ingredients"}),s.map((v,w)=>$e.jsx("input",{value:v,placeholder:"e.g., tomato, onion",onChange:k=>g(w,k.target.value),className:`
                w-full p-3 mb-3 rounded-xl transition
                ${d?"bg-white/10 border border-blue-500/30 text-blue-100 placeholder-blue-300/40 focus:ring-blue-600":"bg-white/50 border border-blue-300/40 text-gray-800 placeholder-gray-500 focus:ring-blue-400"}
              `},w)),$e.jsx("button",{onClick:b,className:`
              text-sm font-semibold transition
              ${d?"text-blue-300":"text-blue-600"}
            `,children:"+ Add another ingredient"})]}),$e.jsxs("div",{className:"mb-8",children:[$e.jsx("label",{className:`
              block text-lg font-semibold mb-2
              ${d?"text-blue-200":"text-gray-800"}
            `,children:"Dietary preference"}),$e.jsxs("select",{value:a,onChange:v=>i(v.target.value),className:`
              w-full p-3 rounded-xl transition
              ${d?"bg-white/10 border border-blue-500/30 text-blue-100 focus:ring-blue-600":"bg-white/50 border border-blue-300/40 text-gray-800 focus:ring-blue-400"}
            `,children:[$e.jsx("option",{value:"none",children:"None"}),$e.jsx("option",{value:"vegetarian",children:"Vegetarian"}),$e.jsx("option",{value:"vegan",children:"Vegan"}),$e.jsx("option",{value:"gluten-free",children:"Gluten-free"})]})]}),$e.jsx("button",{onClick:x,className:`
            mt-4 w-full py-4 text-xl font-bold rounded-2xl shadow-lg
            transition-transform hover:scale-[1.03]
            ${d?"bg-blue-700 hover:bg-blue-800 text-white":"bg-blue-600 hover:bg-blue-700 text-white"}
          `,children:"Recognize & Suggest Recipes"})]})})}function rge({recipes:n=[]}){const{theme:e}=We.useContext(zh),t=e==="dark",s="/mnt/data/c95da042-e03f-49b5-b678-ea9f517293f5.png";return $e.jsxs("div",{className:`min-h-screen px-6 py-10 transition-colors duration-300
        ${t?"bg-[#071023] text-blue-100":"bg-transparent text-slate-900"}
      `,children:[$e.jsxs("header",{className:"max-w-6xl mx-auto mb-8",children:[$e.jsx("h1",{className:`text-3xl md:text-4xl font-extrabold drop-shadow mb-2 text-center
            ${t?"text-blue-200":"text-blue-600"}
          `,children:"Recipe Suggestions"}),$e.jsx("p",{className:`text-center max-w-2xl mx-auto text-sm md:text-base
            ${t?"text-blue-100/80":"text-blue-600/80"}
          `,children:"Based on the ingredients you provided  quick ideas you can cook right now."})]}),(!n||n.length===0)&&$e.jsxs("div",{className:"max-w-3xl mx-auto text-center py-20",children:[$e.jsx("p",{className:`mb-6 ${t?"text-blue-100/80":"text-slate-700"}`,children:"No recipes found. Try adding more ingredients or upload clearer photos."}),$e.jsx(Pp,{to:"/input",className:`inline-block px-6 py-3 rounded-lg font-semibold shadow
              bg-blue-600 hover:bg-blue-700 text-white
              transition
            `,children:"Add ingredients"})]}),$e.jsx("div",{className:"max-w-6xl mx-auto",children:$e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(r=>{const a=(r.usedIngredients||[]).map(o=>o.name).slice(0,4),i=(r.missedIngredients||[]).map(o=>o.name).slice(0,4);return $e.jsxs("article",{className:`group relative rounded-2xl overflow-hidden border transition-shadow transform hover:-translate-y-1 hover:shadow-2xl
                  ${t?"bg-white/3 border-white/6":"bg-white/50 border-blue-100"}
                `,"aria-labelledby":`title-${r.id}`,children:[$e.jsx("div",{className:"h-48 w-full overflow-hidden",children:$e.jsx("img",{src:r.image||s,alt:r.title,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-105",onError:o=>{o.currentTarget.onerror=null,o.currentTarget.src=s}})}),$e.jsxs("div",{className:"p-5",children:[$e.jsx("h2",{id:`title-${r.id}`,className:`text-lg md:text-xl font-semibold truncate
                      ${t?"text-blue-100":"text-slate-900"}
                    `,title:r.title,children:r.title}),$e.jsxs("div",{className:"mt-3 flex items-center justify-between text-sm",children:[$e.jsxs("div",{className:`flex items-center gap-3 ${t?"text-blue-200/90":"text-slate-600"}`,children:[$e.jsxs("span",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-blue-500/10 text-blue-400 text-xs font-medium",children:["Used: ",r.usedIngredients?.length??0]}),$e.jsxs("span",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-amber-500/5 text-amber-300 text-xs font-medium",children:["Missing: ",r.missedIngredients?.length??0]})]}),r.readyInMinutes&&$e.jsxs("div",{className:`text-xs px-2 py-1 rounded-md ${t?"bg-white/5 text-blue-200":"bg-slate-100 text-slate-800"}`,children:[r.readyInMinutes," min"]})]}),$e.jsxs("div",{className:"mt-4 text-sm leading-relaxed",children:[$e.jsxs("p",{className:`${t?"text-blue-200/80":"text-slate-700"}`,children:[$e.jsx("strong",{className:`${t?"text-blue-100":"text-slate-900"}`,children:"Used:"})," ",a.length?a.join(", "):""]}),$e.jsxs("p",{className:`mt-1 ${t?"text-blue-200/70":"text-slate-600"}`,children:[$e.jsx("strong",{className:`${t?"text-blue-100":"text-slate-900"}`,children:"Missing:"})," ",i.length?i.join(", "):"None"]})]}),$e.jsx("div",{className:"mt-5",children:$e.jsx(Pp,{to:`/recipe/${r.id}`,className:`block text-center px-4 py-2 rounded-lg font-semibold shadow-sm transition
                        ${t?"bg-blue-500 hover:bg-blue-600 text-white":"bg-blue-600 hover:bg-blue-700 text-white"}
                      `,children:"View Details"})})]})]},r.id)})})})]})}const age="modulepreload",ige=function(n){return"/"+n},XE={},Z5=function(e,t,s){let r=Promise.resolve();if(t&&t.length>0){let l=function(c){return Promise.all(c.map(f=>Promise.resolve(f).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),o=i?.nonce||i?.getAttribute("nonce");r=l(t.map(c=>{if(c=ige(c),c in XE)return;XE[c]=!0;const f=c.endsWith(".css"),d=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const m=document.createElement("link");if(m.rel=f?"stylesheet":age,f||(m.as="script"),m.crossOrigin="",m.href=c,o&&m.setAttribute("nonce",o),document.head.appendChild(m),f)return new Promise((g,b)=>{m.addEventListener("load",g),m.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${c}`)))})}))}function a(i){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i}return r.then(i=>{for(const o of i||[])o.status==="rejected"&&a(o.reason);return e().catch(a)})};function as(n){"@babel/helpers - typeof";return as=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},as(n)}var Ml=Uint8Array,co=Uint16Array,wC=Int32Array,SC=new Ml([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),NC=new Ml([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),YE=new Ml([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),OF=function(n,e){for(var t=new co(31),s=0;s<31;++s)t[s]=e+=1<<n[s-1];for(var r=new wC(t[30]),s=1;s<30;++s)for(var a=t[s];a<t[s+1];++a)r[a]=a-t[s]<<5|s;return{b:t,r}},LF=OF(SC,2),oge=LF.b,gN=LF.r;oge[28]=258,gN[258]=28;var lge=OF(NC,0),ZE=lge.r,yN=new co(32768);for(var $s=0;$s<32768;++$s){var ph=($s&43690)>>1|($s&21845)<<1;ph=(ph&52428)>>2|(ph&13107)<<2,ph=(ph&61680)>>4|(ph&3855)<<4,yN[$s]=((ph&65280)>>8|(ph&255)<<8)>>1}var f1=(function(n,e,t){for(var s=n.length,r=0,a=new co(e);r<s;++r)n[r]&&++a[n[r]-1];var i=new co(e);for(r=1;r<e;++r)i[r]=i[r-1]+a[r-1]<<1;var o;if(t){o=new co(1<<e);var l=15-e;for(r=0;r<s;++r)if(n[r])for(var c=r<<4|n[r],f=e-n[r],d=i[n[r]-1]++<<f,m=d|(1<<f)-1;d<=m;++d)o[yN[d]>>l]=c}else for(o=new co(s),r=0;r<s;++r)n[r]&&(o[r]=yN[i[n[r]-1]++]>>15-n[r]);return o}),cd=new Ml(288);for(var $s=0;$s<144;++$s)cd[$s]=8;for(var $s=144;$s<256;++$s)cd[$s]=9;for(var $s=256;$s<280;++$s)cd[$s]=7;for(var $s=280;$s<288;++$s)cd[$s]=8;var Ub=new Ml(32);for(var $s=0;$s<32;++$s)Ub[$s]=5;var uge=f1(cd,9,0),cge=f1(Ub,5,0),FF=function(n){return(n+7)/8|0},hge=function(n,e,t){return(t==null||t>n.length)&&(t=n.length),new Ml(n.subarray(e,t))},oc=function(n,e,t){t<<=e&7;var s=e/8|0;n[s]|=t,n[s+1]|=t>>8},s1=function(n,e,t){t<<=e&7;var s=e/8|0;n[s]|=t,n[s+1]|=t>>8,n[s+2]|=t>>16},J5=function(n,e){for(var t=[],s=0;s<n.length;++s)n[s]&&t.push({s,f:n[s]});var r=t.length,a=t.slice();if(!r)return{t:zF,l:0};if(r==1){var i=new Ml(t[0].s+1);return i[t[0].s]=1,{t:i,l:1}}t.sort(function(R,U){return R.f-U.f}),t.push({s:-1,f:25001});var o=t[0],l=t[1],c=0,f=1,d=2;for(t[0]={s:-1,f:o.f+l.f,l:o,r:l};f!=r-1;)o=t[t[c].f<t[d].f?c++:d++],l=t[c!=f&&t[c].f<t[d].f?c++:d++],t[f++]={s:-1,f:o.f+l.f,l:o,r:l};for(var m=a[0].s,s=1;s<r;++s)a[s].s>m&&(m=a[s].s);var g=new co(m+1),b=bN(t[f-1],g,0);if(b>e){var s=0,x=0,v=b-e,w=1<<v;for(a.sort(function(U,V){return g[V.s]-g[U.s]||U.f-V.f});s<r;++s){var k=a[s].s;if(g[k]>e)x+=w-(1<<b-g[k]),g[k]=e;else break}for(x>>=v;x>0;){var I=a[s].s;g[I]<e?x-=1<<e-g[I]++-1:++s}for(;s>=0&&x;--s){var A=a[s].s;g[A]==e&&(--g[A],++x)}b=e}return{t:new Ml(g),l:b}},bN=function(n,e,t){return n.s==-1?Math.max(bN(n.l,e,t+1),bN(n.r,e,t+1)):e[n.s]=t},JE=function(n){for(var e=n.length;e&&!n[--e];);for(var t=new co(++e),s=0,r=n[0],a=1,i=function(l){t[s++]=l},o=1;o<=e;++o)if(n[o]==r&&o!=e)++a;else{if(!r&&a>2){for(;a>138;a-=138)i(32754);a>2&&(i(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(i(r),--a;a>6;a-=6)i(8304);a>2&&(i(a-3<<5|8208),a=0)}for(;a--;)i(r);a=1,r=n[o]}return{c:t.subarray(0,s),n:e}},r1=function(n,e){for(var t=0,s=0;s<e.length;++s)t+=n[s]*e[s];return t},MF=function(n,e,t){var s=t.length,r=FF(e+2);n[r]=s&255,n[r+1]=s>>8,n[r+2]=n[r]^255,n[r+3]=n[r+1]^255;for(var a=0;a<s;++a)n[r+a+4]=t[a];return(r+4+s)*8},QE=function(n,e,t,s,r,a,i,o,l,c,f){oc(e,f++,t),++r[256];for(var d=J5(r,15),m=d.t,g=d.l,b=J5(a,15),x=b.t,v=b.l,w=JE(m),k=w.c,I=w.n,A=JE(x),R=A.c,U=A.n,V=new co(19),P=0;P<k.length;++P)++V[k[P]&31];for(var P=0;P<R.length;++P)++V[R[P]&31];for(var D=J5(V,7),B=D.t,E=D.l,M=19;M>4&&!B[YE[M-1]];--M);var K=c+5<<3,X=r1(r,cd)+r1(a,Ub)+i,ae=r1(r,m)+r1(a,x)+i+14+3*M+r1(V,B)+2*V[16]+3*V[17]+7*V[18];if(l>=0&&K<=X&&K<=ae)return MF(e,f,n.subarray(l,l+c));var W,se,ee,ce;if(oc(e,f,1+(ae<X)),f+=2,ae<X){W=f1(m,g,0),se=m,ee=f1(x,v,0),ce=x;var ye=f1(B,E,0);oc(e,f,I-257),oc(e,f+5,U-1),oc(e,f+10,M-4),f+=14;for(var P=0;P<M;++P)oc(e,f+3*P,B[YE[P]]);f+=3*M;for(var G=[k,R],O=0;O<2;++O)for(var j=G[O],P=0;P<j.length;++P){var Y=j[P]&31;oc(e,f,ye[Y]),f+=B[Y],Y>15&&(oc(e,f,j[P]>>5&127),f+=j[P]>>12)}}else W=uge,se=cd,ee=cge,ce=Ub;for(var P=0;P<o;++P){var ie=s[P];if(ie>255){var Y=ie>>18&31;s1(e,f,W[Y+257]),f+=se[Y+257],Y>7&&(oc(e,f,ie>>23&31),f+=SC[Y]);var ue=ie&31;s1(e,f,ee[ue]),f+=ce[ue],ue>3&&(s1(e,f,ie>>5&8191),f+=NC[ue])}else s1(e,f,W[ie]),f+=se[ie]}return s1(e,f,W[256]),f+se[256]},fge=new wC([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),zF=new Ml(0),dge=function(n,e,t,s,r,a){var i=a.z||n.length,o=new Ml(s+i+5*(1+Math.ceil(i/7e3))+r),l=o.subarray(s,o.length-r),c=a.l,f=(a.r||0)&7;if(e){f&&(l[0]=a.r>>3);for(var d=fge[e-1],m=d>>13,g=d&8191,b=(1<<t)-1,x=a.p||new co(32768),v=a.h||new co(b+1),w=Math.ceil(t/3),k=2*w,I=function(ot){return(n[ot]^n[ot+1]<<w^n[ot+2]<<k)&b},A=new wC(25e3),R=new co(288),U=new co(32),V=0,P=0,D=a.i||0,B=0,E=a.w||0,M=0;D+2<i;++D){var K=I(D),X=D&32767,ae=v[K];if(x[X]=ae,v[K]=X,E<=D){var W=i-D;if((V>7e3||B>24576)&&(W>423||!c)){f=QE(n,l,0,A,R,U,P,B,M,D-M,f),B=V=P=0,M=D;for(var se=0;se<286;++se)R[se]=0;for(var se=0;se<30;++se)U[se]=0}var ee=2,ce=0,ye=g,G=X-ae&32767;if(W>2&&K==I(D-G))for(var O=Math.min(m,W)-1,j=Math.min(32767,D),Y=Math.min(258,W);G<=j&&--ye&&X!=ae;){if(n[D+ee]==n[D+ee-G]){for(var ie=0;ie<Y&&n[D+ie]==n[D+ie-G];++ie);if(ie>ee){if(ee=ie,ce=G,ie>O)break;for(var ue=Math.min(G,ie-2),pe=0,se=0;se<ue;++se){var Ce=D-G+se&32767,Ne=x[Ce],Le=Ce-Ne&32767;Le>pe&&(pe=Le,ae=Ce)}}}X=ae,ae=x[X],G+=X-ae&32767}if(ce){A[B++]=268435456|gN[ee]<<18|ZE[ce];var Ve=gN[ee]&31,rt=ZE[ce]&31;P+=SC[Ve]+NC[rt],++R[257+Ve],++U[rt],E=D+ee,++V}else A[B++]=n[D],++R[n[D]]}}for(D=Math.max(D,E);D<i;++D)A[B++]=n[D],++R[n[D]];f=QE(n,l,c,A,R,U,P,B,M,D-M,f),c||(a.r=f&7|l[f/8|0]<<3,f-=7,a.h=v,a.p=x,a.i=D,a.w=E)}else{for(var D=a.w||0;D<i+c;D+=65535){var at=D+65535;at>=i&&(l[f/8|0]=c,at=i),f=MF(l,f+1,n.subarray(D,at))}a.i=i}return hge(o,0,s+FF(f)+r)},PF=function(){var n=1,e=0;return{p:function(t){for(var s=n,r=e,a=t.length|0,i=0;i!=a;){for(var o=Math.min(i+2655,a);i<o;++i)r+=s+=t[i];s=(s&65535)+15*(s>>16),r=(r&65535)+15*(r>>16)}n=s,e=r},d:function(){return n%=65521,e%=65521,(n&255)<<24|(n&65280)<<8|(e&255)<<8|e>>8}}},pge=function(n,e,t,s,r){if(!r&&(r={l:1},e.dictionary)){var a=e.dictionary.subarray(-32768),i=new Ml(a.length+n.length);i.set(a),i.set(n,a.length),n=i,r.w=a.length}return dge(n,e.level==null?6:e.level,e.mem==null?r.l?Math.ceil(Math.max(8,Math.min(13,Math.log(n.length)))*1.5):20:12+e.mem,t,s,r)},BF=function(n,e,t){for(;t;++e)n[e]=t,t>>>=8},mge=function(n,e){var t=e.level,s=t==0?0:t<6?1:t==9?3:2;if(n[0]=120,n[1]=s<<6|(e.dictionary&&32),n[1]|=31-(n[0]<<8|n[1])%31,e.dictionary){var r=PF();r.p(e.dictionary),BF(n,2,r.d())}};function xN(n,e){e||(e={});var t=PF();t.p(n);var s=pge(n,e,e.dictionary?6:2,4);return mge(s,e),BF(s,s.length-4,t.d()),s}var gge=typeof TextDecoder<"u"&&new TextDecoder,yge=0;try{gge.decode(zF,{stream:!0}),yge=1}catch{}function bge(n){if(Array.isArray(n))return n}function xge(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var s,r,a,i,o=[],l=!0,c=!1;try{if(a=(t=t.call(n)).next,e!==0)for(;!(l=(s=a.call(t)).done)&&(o.push(s.value),o.length!==e);l=!0);}catch(f){c=!0,r=f}finally{try{if(!l&&t.return!=null&&(i=t.return(),Object(i)!==i))return}finally{if(c)throw r}}return o}}function e4(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,s=Array(e);t<e;t++)s[t]=n[t];return s}function vge(n,e){if(n){if(typeof n=="string")return e4(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?e4(n,e):void 0}}function wge(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function t4(n,e){return bge(n)||xge(n,e)||vge(n,e)||wge()}function n4(n,e="utf8"){return new TextDecoder(e).decode(n)}const Sge=new TextEncoder;function Nge(n){return Sge.encode(n)}const kge=1024*8,Cge=(()=>{const n=new Uint8Array(4),e=new Uint32Array(n.buffer);return!((e[0]=1)&n[0])})(),Q5={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class kC{buffer;byteLength;byteOffset;length;offset;lastWrittenByte;littleEndian;_data;_mark;_marks;constructor(e=kge,t={}){let s=!1;typeof e=="number"?e=new ArrayBuffer(e):(s=!0,this.lastWrittenByte=e.byteLength);const r=t.offset?t.offset>>>0:0,a=e.byteLength-r;let i=r;(ArrayBuffer.isView(e)||e instanceof kC)&&(e.byteLength!==e.buffer.byteLength&&(i=e.byteOffset+r),e=e.buffer),s?this.lastWrittenByte=a:this.lastWrittenByte=0,this.buffer=e,this.length=a,this.byteLength=a,this.byteOffset=i,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,i,a),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const s=(this.offset+e)*2,r=new Uint8Array(s);r.set(new Uint8Array(this.buffer)),this.buffer=r.buffer,this.length=s,this.byteLength=s,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,t){const s=Q5[t].BYTES_PER_ELEMENT*e,r=this.byteOffset+this.offset,a=this.buffer.slice(r,r+s);if(this.littleEndian===Cge&&t!=="uint8"&&t!=="int8"){const o=new Uint8Array(this.buffer.slice(r,r+s));o.reverse();const l=new Q5[t](o.buffer);return this.offset+=s,l.reverse(),l}const i=new Q5[t](a);return this.offset+=s,i}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let t="";for(let s=0;s<e;s++)t+=this.readChar();return t}readUtf8(e=1){return n4(this.readBytes(e))}decodeText(e=1,t="utf8"){return n4(this.readBytes(e),t)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let t=0;t<e.length;t++)this._data.setUint8(this.offset++,e[t]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let t=0;t<e.length;t++)this.writeUint8(e.charCodeAt(t));return this}writeUtf8(e){return this.writeBytes(Nge(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function pg(n){let e=n.length;for(;--e>=0;)n[e]=0}const Tge=3,Age=258,UF=29,Ige=256,Ege=Ige+1+UF,VF=30,_ge=512,$ge=new Array((Ege+2)*2);pg($ge);const Rge=new Array(VF*2);pg(Rge);const Dge=new Array(_ge);pg(Dge);const Oge=new Array(Age-Tge+1);pg(Oge);const Lge=new Array(UF);pg(Lge);const Fge=new Array(VF);pg(Fge);const Mge=(n,e,t,s)=>{let r=n&65535|0,a=n>>>16&65535|0,i=0;for(;t!==0;){i=t>2e3?2e3:t,t-=i;do r=r+e[s++]|0,a=a+r|0;while(--i);r%=65521,a%=65521}return r|a<<16|0};var vN=Mge;const zge=()=>{let n,e=[];for(var t=0;t<256;t++){n=t;for(var s=0;s<8;s++)n=n&1?3988292384^n>>>1:n>>>1;e[t]=n}return e},Pge=new Uint32Array(zge()),Bge=(n,e,t,s)=>{const r=Pge,a=s+t;n^=-1;for(let i=s;i<a;i++)n=n>>>8^r[(n^e[i])&255];return n^-1};var cu=Bge,wN={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},jF={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const Uge=(n,e)=>Object.prototype.hasOwnProperty.call(n,e);var Vge=function(n){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const t=e.shift();if(t){if(typeof t!="object")throw new TypeError(t+"must be non-object");for(const s in t)Uge(t,s)&&(n[s]=t[s])}}return n},jge=n=>{let e=0;for(let s=0,r=n.length;s<r;s++)e+=n[s].length;const t=new Uint8Array(e);for(let s=0,r=0,a=n.length;s<a;s++){let i=n[s];t.set(i,r),r+=i.length}return t},WF={assign:Vge,flattenChunks:jge};let GF=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{GF=!1}const L1=new Uint8Array(256);for(let n=0;n<256;n++)L1[n]=n>=252?6:n>=248?5:n>=240?4:n>=224?3:n>=192?2:1;L1[254]=L1[254]=1;var Wge=n=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(n);let e,t,s,r,a,i=n.length,o=0;for(r=0;r<i;r++)t=n.charCodeAt(r),(t&64512)===55296&&r+1<i&&(s=n.charCodeAt(r+1),(s&64512)===56320&&(t=65536+(t-55296<<10)+(s-56320),r++)),o+=t<128?1:t<2048?2:t<65536?3:4;for(e=new Uint8Array(o),a=0,r=0;a<o;r++)t=n.charCodeAt(r),(t&64512)===55296&&r+1<i&&(s=n.charCodeAt(r+1),(s&64512)===56320&&(t=65536+(t-55296<<10)+(s-56320),r++)),t<128?e[a++]=t:t<2048?(e[a++]=192|t>>>6,e[a++]=128|t&63):t<65536?(e[a++]=224|t>>>12,e[a++]=128|t>>>6&63,e[a++]=128|t&63):(e[a++]=240|t>>>18,e[a++]=128|t>>>12&63,e[a++]=128|t>>>6&63,e[a++]=128|t&63);return e};const Gge=(n,e)=>{if(e<65534&&n.subarray&&GF)return String.fromCharCode.apply(null,n.length===e?n:n.subarray(0,e));let t="";for(let s=0;s<e;s++)t+=String.fromCharCode(n[s]);return t};var qge=(n,e)=>{const t=e||n.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(n.subarray(0,e));let s,r;const a=new Array(t*2);for(r=0,s=0;s<t;){let i=n[s++];if(i<128){a[r++]=i;continue}let o=L1[i];if(o>4){a[r++]=65533,s+=o-1;continue}for(i&=o===2?31:o===3?15:7;o>1&&s<t;)i=i<<6|n[s++]&63,o--;if(o>1){a[r++]=65533;continue}i<65536?a[r++]=i:(i-=65536,a[r++]=55296|i>>10&1023,a[r++]=56320|i&1023)}return Gge(a,r)},Hge=(n,e)=>{e=e||n.length,e>n.length&&(e=n.length);let t=e-1;for(;t>=0&&(n[t]&192)===128;)t--;return t<0||t===0?e:t+L1[n[t]]>e?t:e},SN={string2buf:Wge,buf2string:qge,utf8border:Hge};function Kge(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Xge=Kge;const O2=16209,Yge=16191;var Zge=function(e,t){let s,r,a,i,o,l,c,f,d,m,g,b,x,v,w,k,I,A,R,U,V,P,D,B;const E=e.state;s=e.next_in,D=e.input,r=s+(e.avail_in-5),a=e.next_out,B=e.output,i=a-(t-e.avail_out),o=a+(e.avail_out-257),l=E.dmax,c=E.wsize,f=E.whave,d=E.wnext,m=E.window,g=E.hold,b=E.bits,x=E.lencode,v=E.distcode,w=(1<<E.lenbits)-1,k=(1<<E.distbits)-1;e:do{b<15&&(g+=D[s++]<<b,b+=8,g+=D[s++]<<b,b+=8),I=x[g&w];t:for(;;){if(A=I>>>24,g>>>=A,b-=A,A=I>>>16&255,A===0)B[a++]=I&65535;else if(A&16){R=I&65535,A&=15,A&&(b<A&&(g+=D[s++]<<b,b+=8),R+=g&(1<<A)-1,g>>>=A,b-=A),b<15&&(g+=D[s++]<<b,b+=8,g+=D[s++]<<b,b+=8),I=v[g&k];n:for(;;){if(A=I>>>24,g>>>=A,b-=A,A=I>>>16&255,A&16){if(U=I&65535,A&=15,b<A&&(g+=D[s++]<<b,b+=8,b<A&&(g+=D[s++]<<b,b+=8)),U+=g&(1<<A)-1,U>l){e.msg="invalid distance too far back",E.mode=O2;break e}if(g>>>=A,b-=A,A=a-i,U>A){if(A=U-A,A>f&&E.sane){e.msg="invalid distance too far back",E.mode=O2;break e}if(V=0,P=m,d===0){if(V+=c-A,A<R){R-=A;do B[a++]=m[V++];while(--A);V=a-U,P=B}}else if(d<A){if(V+=c+d-A,A-=d,A<R){R-=A;do B[a++]=m[V++];while(--A);if(V=0,d<R){A=d,R-=A;do B[a++]=m[V++];while(--A);V=a-U,P=B}}}else if(V+=d-A,A<R){R-=A;do B[a++]=m[V++];while(--A);V=a-U,P=B}for(;R>2;)B[a++]=P[V++],B[a++]=P[V++],B[a++]=P[V++],R-=3;R&&(B[a++]=P[V++],R>1&&(B[a++]=P[V++]))}else{V=a-U;do B[a++]=B[V++],B[a++]=B[V++],B[a++]=B[V++],R-=3;while(R>2);R&&(B[a++]=B[V++],R>1&&(B[a++]=B[V++]))}}else if((A&64)===0){I=v[(I&65535)+(g&(1<<A)-1)];continue n}else{e.msg="invalid distance code",E.mode=O2;break e}break}}else if((A&64)===0){I=x[(I&65535)+(g&(1<<A)-1)];continue t}else if(A&32){E.mode=Yge;break e}else{e.msg="invalid literal/length code",E.mode=O2;break e}break}}while(s<r&&a<o);R=b>>3,s-=R,b-=R<<3,g&=(1<<b)-1,e.next_in=s,e.next_out=a,e.avail_in=s<r?5+(r-s):5-(s-r),e.avail_out=a<o?257+(o-a):257-(a-o),E.hold=g,E.bits=b};const wp=15,s4=852,r4=592,a4=0,eS=1,i4=2,Jge=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Qge=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),e1e=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),t1e=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),n1e=(n,e,t,s,r,a,i,o)=>{const l=o.bits;let c=0,f=0,d=0,m=0,g=0,b=0,x=0,v=0,w=0,k=0,I,A,R,U,V,P=null,D;const B=new Uint16Array(wp+1),E=new Uint16Array(wp+1);let M=null,K,X,ae;for(c=0;c<=wp;c++)B[c]=0;for(f=0;f<s;f++)B[e[t+f]]++;for(g=l,m=wp;m>=1&&B[m]===0;m--);if(g>m&&(g=m),m===0)return r[a++]=1<<24|64<<16|0,r[a++]=1<<24|64<<16|0,o.bits=1,0;for(d=1;d<m&&B[d]===0;d++);for(g<d&&(g=d),v=1,c=1;c<=wp;c++)if(v<<=1,v-=B[c],v<0)return-1;if(v>0&&(n===a4||m!==1))return-1;for(E[1]=0,c=1;c<wp;c++)E[c+1]=E[c]+B[c];for(f=0;f<s;f++)e[t+f]!==0&&(i[E[e[t+f]]++]=f);if(n===a4?(P=M=i,D=20):n===eS?(P=Jge,M=Qge,D=257):(P=e1e,M=t1e,D=0),k=0,f=0,c=d,V=a,b=g,x=0,R=-1,w=1<<g,U=w-1,n===eS&&w>s4||n===i4&&w>r4)return 1;for(;;){K=c-x,i[f]+1<D?(X=0,ae=i[f]):i[f]>=D?(X=M[i[f]-D],ae=P[i[f]-D]):(X=96,ae=0),I=1<<c-x,A=1<<b,d=A;do A-=I,r[V+(k>>x)+A]=K<<24|X<<16|ae|0;while(A!==0);for(I=1<<c-1;k&I;)I>>=1;if(I!==0?(k&=I-1,k+=I):k=0,f++,--B[c]===0){if(c===m)break;c=e[t+i[f]]}if(c>g&&(k&U)!==R){for(x===0&&(x=g),V+=d,b=c-x,v=1<<b;b+x<m&&(v-=B[b+x],!(v<=0));)b++,v<<=1;if(w+=1<<b,n===eS&&w>s4||n===i4&&w>r4)return 1;R=k&U,r[R]=g<<24|b<<16|V-a|0}}return k!==0&&(r[V+k]=c-x<<24|64<<16|0),o.bits=g,0};var d1=n1e;const s1e=0,qF=1,HF=2,{Z_FINISH:o4,Z_BLOCK:r1e,Z_TREES:L2,Z_OK:hd,Z_STREAM_END:a1e,Z_NEED_DICT:i1e,Z_STREAM_ERROR:Go,Z_DATA_ERROR:KF,Z_MEM_ERROR:XF,Z_BUF_ERROR:o1e,Z_DEFLATED:l4}=jF,lw=16180,u4=16181,c4=16182,h4=16183,f4=16184,d4=16185,p4=16186,m4=16187,g4=16188,y4=16189,Vb=16190,lc=16191,tS=16192,b4=16193,nS=16194,x4=16195,v4=16196,w4=16197,S4=16198,F2=16199,M2=16200,N4=16201,k4=16202,C4=16203,T4=16204,A4=16205,sS=16206,I4=16207,E4=16208,zs=16209,YF=16210,ZF=16211,l1e=852,u1e=592,c1e=15,h1e=c1e,_4=n=>(n>>>24&255)+(n>>>8&65280)+((n&65280)<<8)+((n&255)<<24);function f1e(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Ad=n=>{if(!n)return 1;const e=n.state;return!e||e.strm!==n||e.mode<lw||e.mode>ZF?1:0},JF=n=>{if(Ad(n))return Go;const e=n.state;return n.total_in=n.total_out=e.total=0,n.msg="",e.wrap&&(n.adler=e.wrap&1),e.mode=lw,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(l1e),e.distcode=e.distdyn=new Int32Array(u1e),e.sane=1,e.back=-1,hd},QF=n=>{if(Ad(n))return Go;const e=n.state;return e.wsize=0,e.whave=0,e.wnext=0,JF(n)},e8=(n,e)=>{let t;if(Ad(n))return Go;const s=n.state;return e<0?(t=0,e=-e):(t=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?Go:(s.window!==null&&s.wbits!==e&&(s.window=null),s.wrap=t,s.wbits=e,QF(n))},t8=(n,e)=>{if(!n)return Go;const t=new f1e;n.state=t,t.strm=n,t.window=null,t.mode=lw;const s=e8(n,e);return s!==hd&&(n.state=null),s},d1e=n=>t8(n,h1e);let $4=!0,rS,aS;const p1e=n=>{if($4){rS=new Int32Array(512),aS=new Int32Array(32);let e=0;for(;e<144;)n.lens[e++]=8;for(;e<256;)n.lens[e++]=9;for(;e<280;)n.lens[e++]=7;for(;e<288;)n.lens[e++]=8;for(d1(qF,n.lens,0,288,rS,0,n.work,{bits:9}),e=0;e<32;)n.lens[e++]=5;d1(HF,n.lens,0,32,aS,0,n.work,{bits:5}),$4=!1}n.lencode=rS,n.lenbits=9,n.distcode=aS,n.distbits=5},n8=(n,e,t,s)=>{let r;const a=n.state;return a.window===null&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),s>=a.wsize?(a.window.set(e.subarray(t-a.wsize,t),0),a.wnext=0,a.whave=a.wsize):(r=a.wsize-a.wnext,r>s&&(r=s),a.window.set(e.subarray(t-s,t-s+r),a.wnext),s-=r,s?(a.window.set(e.subarray(t-s,t),0),a.wnext=s,a.whave=a.wsize):(a.wnext+=r,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=r))),0},m1e=(n,e)=>{let t,s,r,a,i,o,l,c,f,d,m,g,b,x,v=0,w,k,I,A,R,U,V,P;const D=new Uint8Array(4);let B,E;const M=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Ad(n)||!n.output||!n.input&&n.avail_in!==0)return Go;t=n.state,t.mode===lc&&(t.mode=tS),i=n.next_out,r=n.output,l=n.avail_out,a=n.next_in,s=n.input,o=n.avail_in,c=t.hold,f=t.bits,d=o,m=l,P=hd;e:for(;;)switch(t.mode){case lw:if(t.wrap===0){t.mode=tS;break}for(;f<16;){if(o===0)break e;o--,c+=s[a++]<<f,f+=8}if(t.wrap&2&&c===35615){t.wbits===0&&(t.wbits=15),t.check=0,D[0]=c&255,D[1]=c>>>8&255,t.check=cu(t.check,D,2,0),c=0,f=0,t.mode=u4;break}if(t.head&&(t.head.done=!1),!(t.wrap&1)||(((c&255)<<8)+(c>>8))%31){n.msg="incorrect header check",t.mode=zs;break}if((c&15)!==l4){n.msg="unknown compression method",t.mode=zs;break}if(c>>>=4,f-=4,V=(c&15)+8,t.wbits===0&&(t.wbits=V),V>15||V>t.wbits){n.msg="invalid window size",t.mode=zs;break}t.dmax=1<<t.wbits,t.flags=0,n.adler=t.check=1,t.mode=c&512?y4:lc,c=0,f=0;break;case u4:for(;f<16;){if(o===0)break e;o--,c+=s[a++]<<f,f+=8}if(t.flags=c,(t.flags&255)!==l4){n.msg="unknown compression method",t.mode=zs;break}if(t.flags&57344){n.msg="unknown header flags set",t.mode=zs;break}t.head&&(t.head.text=c>>8&1),t.flags&512&&t.wrap&4&&(D[0]=c&255,D[1]=c>>>8&255,t.check=cu(t.check,D,2,0)),c=0,f=0,t.mode=c4;case c4:for(;f<32;){if(o===0)break e;o--,c+=s[a++]<<f,f+=8}t.head&&(t.head.time=c),t.flags&512&&t.wrap&4&&(D[0]=c&255,D[1]=c>>>8&255,D[2]=c>>>16&255,D[3]=c>>>24&255,t.check=cu(t.check,D,4,0)),c=0,f=0,t.mode=h4;case h4:for(;f<16;){if(o===0)break e;o--,c+=s[a++]<<f,f+=8}t.head&&(t.head.xflags=c&255,t.head.os=c>>8),t.flags&512&&t.wrap&4&&(D[0]=c&255,D[1]=c>>>8&255,t.check=cu(t.check,D,2,0)),c=0,f=0,t.mode=f4;case f4:if(t.flags&1024){for(;f<16;){if(o===0)break e;o--,c+=s[a++]<<f,f+=8}t.length=c,t.head&&(t.head.extra_len=c),t.flags&512&&t.wrap&4&&(D[0]=c&255,D[1]=c>>>8&255,t.check=cu(t.check,D,2,0)),c=0,f=0}else t.head&&(t.head.extra=null);t.mode=d4;case d4:if(t.flags&1024&&(g=t.length,g>o&&(g=o),g&&(t.head&&(V=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Uint8Array(t.head.extra_len)),t.head.extra.set(s.subarray(a,a+g),V)),t.flags&512&&t.wrap&4&&(t.check=cu(t.check,s,g,a)),o-=g,a+=g,t.length-=g),t.length))break e;t.length=0,t.mode=p4;case p4:if(t.flags&2048){if(o===0)break e;g=0;do V=s[a+g++],t.head&&V&&t.length<65536&&(t.head.name+=String.fromCharCode(V));while(V&&g<o);if(t.flags&512&&t.wrap&4&&(t.check=cu(t.check,s,g,a)),o-=g,a+=g,V)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=m4;case m4:if(t.flags&4096){if(o===0)break e;g=0;do V=s[a+g++],t.head&&V&&t.length<65536&&(t.head.comment+=String.fromCharCode(V));while(V&&g<o);if(t.flags&512&&t.wrap&4&&(t.check=cu(t.check,s,g,a)),o-=g,a+=g,V)break e}else t.head&&(t.head.comment=null);t.mode=g4;case g4:if(t.flags&512){for(;f<16;){if(o===0)break e;o--,c+=s[a++]<<f,f+=8}if(t.wrap&4&&c!==(t.check&65535)){n.msg="header crc mismatch",t.mode=zs;break}c=0,f=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),n.adler=t.check=0,t.mode=lc;break;case y4:for(;f<32;){if(o===0)break e;o--,c+=s[a++]<<f,f+=8}n.adler=t.check=_4(c),c=0,f=0,t.mode=Vb;case Vb:if(t.havedict===0)return n.next_out=i,n.avail_out=l,n.next_in=a,n.avail_in=o,t.hold=c,t.bits=f,i1e;n.adler=t.check=1,t.mode=lc;case lc:if(e===r1e||e===L2)break e;case tS:if(t.last){c>>>=f&7,f-=f&7,t.mode=sS;break}for(;f<3;){if(o===0)break e;o--,c+=s[a++]<<f,f+=8}switch(t.last=c&1,c>>>=1,f-=1,c&3){case 0:t.mode=b4;break;case 1:if(p1e(t),t.mode=F2,e===L2){c>>>=2,f-=2;break e}break;case 2:t.mode=v4;break;case 3:n.msg="invalid block type",t.mode=zs}c>>>=2,f-=2;break;case b4:for(c>>>=f&7,f-=f&7;f<32;){if(o===0)break e;o--,c+=s[a++]<<f,f+=8}if((c&65535)!==(c>>>16^65535)){n.msg="invalid stored block lengths",t.mode=zs;break}if(t.length=c&65535,c=0,f=0,t.mode=nS,e===L2)break e;case nS:t.mode=x4;case x4:if(g=t.length,g){if(g>o&&(g=o),g>l&&(g=l),g===0)break e;r.set(s.subarray(a,a+g),i),o-=g,a+=g,l-=g,i+=g,t.length-=g;break}t.mode=lc;break;case v4:for(;f<14;){if(o===0)break e;o--,c+=s[a++]<<f,f+=8}if(t.nlen=(c&31)+257,c>>>=5,f-=5,t.ndist=(c&31)+1,c>>>=5,f-=5,t.ncode=(c&15)+4,c>>>=4,f-=4,t.nlen>286||t.ndist>30){n.msg="too many length or distance symbols",t.mode=zs;break}t.have=0,t.mode=w4;case w4:for(;t.have<t.ncode;){for(;f<3;){if(o===0)break e;o--,c+=s[a++]<<f,f+=8}t.lens[M[t.have++]]=c&7,c>>>=3,f-=3}for(;t.have<19;)t.lens[M[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,B={bits:t.lenbits},P=d1(s1e,t.lens,0,19,t.lencode,0,t.work,B),t.lenbits=B.bits,P){n.msg="invalid code lengths set",t.mode=zs;break}t.have=0,t.mode=S4;case S4:for(;t.have<t.nlen+t.ndist;){for(;v=t.lencode[c&(1<<t.lenbits)-1],w=v>>>24,k=v>>>16&255,I=v&65535,!(w<=f);){if(o===0)break e;o--,c+=s[a++]<<f,f+=8}if(I<16)c>>>=w,f-=w,t.lens[t.have++]=I;else{if(I===16){for(E=w+2;f<E;){if(o===0)break e;o--,c+=s[a++]<<f,f+=8}if(c>>>=w,f-=w,t.have===0){n.msg="invalid bit length repeat",t.mode=zs;break}V=t.lens[t.have-1],g=3+(c&3),c>>>=2,f-=2}else if(I===17){for(E=w+3;f<E;){if(o===0)break e;o--,c+=s[a++]<<f,f+=8}c>>>=w,f-=w,V=0,g=3+(c&7),c>>>=3,f-=3}else{for(E=w+7;f<E;){if(o===0)break e;o--,c+=s[a++]<<f,f+=8}c>>>=w,f-=w,V=0,g=11+(c&127),c>>>=7,f-=7}if(t.have+g>t.nlen+t.ndist){n.msg="invalid bit length repeat",t.mode=zs;break}for(;g--;)t.lens[t.have++]=V}}if(t.mode===zs)break;if(t.lens[256]===0){n.msg="invalid code -- missing end-of-block",t.mode=zs;break}if(t.lenbits=9,B={bits:t.lenbits},P=d1(qF,t.lens,0,t.nlen,t.lencode,0,t.work,B),t.lenbits=B.bits,P){n.msg="invalid literal/lengths set",t.mode=zs;break}if(t.distbits=6,t.distcode=t.distdyn,B={bits:t.distbits},P=d1(HF,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,B),t.distbits=B.bits,P){n.msg="invalid distances set",t.mode=zs;break}if(t.mode=F2,e===L2)break e;case F2:t.mode=M2;case M2:if(o>=6&&l>=258){n.next_out=i,n.avail_out=l,n.next_in=a,n.avail_in=o,t.hold=c,t.bits=f,Zge(n,m),i=n.next_out,r=n.output,l=n.avail_out,a=n.next_in,s=n.input,o=n.avail_in,c=t.hold,f=t.bits,t.mode===lc&&(t.back=-1);break}for(t.back=0;v=t.lencode[c&(1<<t.lenbits)-1],w=v>>>24,k=v>>>16&255,I=v&65535,!(w<=f);){if(o===0)break e;o--,c+=s[a++]<<f,f+=8}if(k&&(k&240)===0){for(A=w,R=k,U=I;v=t.lencode[U+((c&(1<<A+R)-1)>>A)],w=v>>>24,k=v>>>16&255,I=v&65535,!(A+w<=f);){if(o===0)break e;o--,c+=s[a++]<<f,f+=8}c>>>=A,f-=A,t.back+=A}if(c>>>=w,f-=w,t.back+=w,t.length=I,k===0){t.mode=A4;break}if(k&32){t.back=-1,t.mode=lc;break}if(k&64){n.msg="invalid literal/length code",t.mode=zs;break}t.extra=k&15,t.mode=N4;case N4:if(t.extra){for(E=t.extra;f<E;){if(o===0)break e;o--,c+=s[a++]<<f,f+=8}t.length+=c&(1<<t.extra)-1,c>>>=t.extra,f-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=k4;case k4:for(;v=t.distcode[c&(1<<t.distbits)-1],w=v>>>24,k=v>>>16&255,I=v&65535,!(w<=f);){if(o===0)break e;o--,c+=s[a++]<<f,f+=8}if((k&240)===0){for(A=w,R=k,U=I;v=t.distcode[U+((c&(1<<A+R)-1)>>A)],w=v>>>24,k=v>>>16&255,I=v&65535,!(A+w<=f);){if(o===0)break e;o--,c+=s[a++]<<f,f+=8}c>>>=A,f-=A,t.back+=A}if(c>>>=w,f-=w,t.back+=w,k&64){n.msg="invalid distance code",t.mode=zs;break}t.offset=I,t.extra=k&15,t.mode=C4;case C4:if(t.extra){for(E=t.extra;f<E;){if(o===0)break e;o--,c+=s[a++]<<f,f+=8}t.offset+=c&(1<<t.extra)-1,c>>>=t.extra,f-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){n.msg="invalid distance too far back",t.mode=zs;break}t.mode=T4;case T4:if(l===0)break e;if(g=m-l,t.offset>g){if(g=t.offset-g,g>t.whave&&t.sane){n.msg="invalid distance too far back",t.mode=zs;break}g>t.wnext?(g-=t.wnext,b=t.wsize-g):b=t.wnext-g,g>t.length&&(g=t.length),x=t.window}else x=r,b=i-t.offset,g=t.length;g>l&&(g=l),l-=g,t.length-=g;do r[i++]=x[b++];while(--g);t.length===0&&(t.mode=M2);break;case A4:if(l===0)break e;r[i++]=t.length,l--,t.mode=M2;break;case sS:if(t.wrap){for(;f<32;){if(o===0)break e;o--,c|=s[a++]<<f,f+=8}if(m-=l,n.total_out+=m,t.total+=m,t.wrap&4&&m&&(n.adler=t.check=t.flags?cu(t.check,r,m,i-m):vN(t.check,r,m,i-m)),m=l,t.wrap&4&&(t.flags?c:_4(c))!==t.check){n.msg="incorrect data check",t.mode=zs;break}c=0,f=0}t.mode=I4;case I4:if(t.wrap&&t.flags){for(;f<32;){if(o===0)break e;o--,c+=s[a++]<<f,f+=8}if(t.wrap&4&&c!==(t.total&4294967295)){n.msg="incorrect length check",t.mode=zs;break}c=0,f=0}t.mode=E4;case E4:P=a1e;break e;case zs:P=KF;break e;case YF:return XF;case ZF:default:return Go}return n.next_out=i,n.avail_out=l,n.next_in=a,n.avail_in=o,t.hold=c,t.bits=f,(t.wsize||m!==n.avail_out&&t.mode<zs&&(t.mode<sS||e!==o4))&&n8(n,n.output,n.next_out,m-n.avail_out),d-=n.avail_in,m-=n.avail_out,n.total_in+=d,n.total_out+=m,t.total+=m,t.wrap&4&&m&&(n.adler=t.check=t.flags?cu(t.check,r,m,n.next_out-m):vN(t.check,r,m,n.next_out-m)),n.data_type=t.bits+(t.last?64:0)+(t.mode===lc?128:0)+(t.mode===F2||t.mode===nS?256:0),(d===0&&m===0||e===o4)&&P===hd&&(P=o1e),P},g1e=n=>{if(Ad(n))return Go;let e=n.state;return e.window&&(e.window=null),n.state=null,hd},y1e=(n,e)=>{if(Ad(n))return Go;const t=n.state;return(t.wrap&2)===0?Go:(t.head=e,e.done=!1,hd)},b1e=(n,e)=>{const t=e.length;let s,r,a;return Ad(n)||(s=n.state,s.wrap!==0&&s.mode!==Vb)?Go:s.mode===Vb&&(r=1,r=vN(r,e,t,0),r!==s.check)?KF:(a=n8(n,e,t,t),a?(s.mode=YF,XF):(s.havedict=1,hd))};var x1e=QF,v1e=e8,w1e=JF,S1e=d1e,N1e=t8,k1e=m1e,C1e=g1e,T1e=y1e,A1e=b1e,I1e="pako inflate (from Nodeca project)",fc={inflateReset:x1e,inflateReset2:v1e,inflateResetKeep:w1e,inflateInit:S1e,inflateInit2:N1e,inflate:k1e,inflateEnd:C1e,inflateGetHeader:T1e,inflateSetDictionary:A1e,inflateInfo:I1e};function E1e(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var _1e=E1e;const s8=Object.prototype.toString,{Z_NO_FLUSH:$1e,Z_FINISH:R1e,Z_OK:F1,Z_STREAM_END:iS,Z_NEED_DICT:oS,Z_STREAM_ERROR:D1e,Z_DATA_ERROR:R4,Z_MEM_ERROR:O1e}=jF;function Cy(n){this.options=WF.assign({chunkSize:1024*64,windowBits:15,to:""},n||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(n&&n.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)===0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Xge,this.strm.avail_out=0;let t=fc.inflateInit2(this.strm,e.windowBits);if(t!==F1)throw new Error(wN[t]);if(this.header=new _1e,fc.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=SN.string2buf(e.dictionary):s8.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(t=fc.inflateSetDictionary(this.strm,e.dictionary),t!==F1)))throw new Error(wN[t])}Cy.prototype.push=function(n,e){const t=this.strm,s=this.options.chunkSize,r=this.options.dictionary;let a,i,o;if(this.ended)return!1;for(e===~~e?i=e:i=e===!0?R1e:$1e,s8.call(n)==="[object ArrayBuffer]"?t.input=new Uint8Array(n):t.input=n,t.next_in=0,t.avail_in=t.input.length;;){for(t.avail_out===0&&(t.output=new Uint8Array(s),t.next_out=0,t.avail_out=s),a=fc.inflate(t,i),a===oS&&r&&(a=fc.inflateSetDictionary(t,r),a===F1?a=fc.inflate(t,i):a===R4&&(a=oS));t.avail_in>0&&a===iS&&t.state.wrap>0&&n[t.next_in]!==0;)fc.inflateReset(t),a=fc.inflate(t,i);switch(a){case D1e:case R4:case oS:case O1e:return this.onEnd(a),this.ended=!0,!1}if(o=t.avail_out,t.next_out&&(t.avail_out===0||a===iS))if(this.options.to==="string"){let l=SN.utf8border(t.output,t.next_out),c=t.next_out-l,f=SN.buf2string(t.output,l);t.next_out=c,t.avail_out=s-c,c&&t.output.set(t.output.subarray(l,l+c),0),this.onData(f)}else this.onData(t.output.length===t.next_out?t.output:t.output.subarray(0,t.next_out));if(!(a===F1&&o===0)){if(a===iS)return a=fc.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(t.avail_in===0)break}}return!0};Cy.prototype.onData=function(n){this.chunks.push(n)};Cy.prototype.onEnd=function(n){n===F1&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=WF.flattenChunks(this.chunks)),this.chunks=[],this.err=n,this.msg=this.strm.msg};function L1e(n,e){const t=new Cy(e);if(t.push(n),t.err)throw t.msg||wN[t.err];return t.result}var F1e=Cy,M1e=L1e,z1e={Inflate:F1e,inflate:M1e};const{Inflate:P1e,inflate:B1e}=z1e;var D4=P1e,U1e=B1e;const r8=[];for(let n=0;n<256;n++){let e=n;for(let t=0;t<8;t++)e&1?e=3988292384^e>>>1:e=e>>>1;r8[n]=e}const O4=4294967295;function V1e(n,e,t){let s=n;for(let r=0;r<t;r++)s=r8[(s^e[r])&255]^s>>>8;return s}function j1e(n,e){return(V1e(O4,n,e)^O4)>>>0}function L4(n,e,t){const s=n.readUint32(),r=j1e(new Uint8Array(n.buffer,n.byteOffset+n.offset-e-4,e),e);if(r!==s)throw new Error(`CRC mismatch for chunk ${t}. Expected ${s}, found ${r}`)}function a8(n,e,t){for(let s=0;s<t;s++)e[s]=n[s]}function i8(n,e,t,s){let r=0;for(;r<s;r++)e[r]=n[r];for(;r<t;r++)e[r]=n[r]+e[r-s]&255}function o8(n,e,t,s){let r=0;if(t.length===0)for(;r<s;r++)e[r]=n[r];else for(;r<s;r++)e[r]=n[r]+t[r]&255}function l8(n,e,t,s,r){let a=0;if(t.length===0){for(;a<r;a++)e[a]=n[a];for(;a<s;a++)e[a]=n[a]+(e[a-r]>>1)&255}else{for(;a<r;a++)e[a]=n[a]+(t[a]>>1)&255;for(;a<s;a++)e[a]=n[a]+(e[a-r]+t[a]>>1)&255}}function u8(n,e,t,s,r){let a=0;if(t.length===0){for(;a<r;a++)e[a]=n[a];for(;a<s;a++)e[a]=n[a]+e[a-r]&255}else{for(;a<r;a++)e[a]=n[a]+t[a]&255;for(;a<s;a++)e[a]=n[a]+W1e(e[a-r],t[a],t[a-r])&255}}function W1e(n,e,t){const s=n+e-t,r=Math.abs(s-n),a=Math.abs(s-e),i=Math.abs(s-t);return r<=a&&r<=i?n:a<=i?e:t}function G1e(n,e,t,s,r,a){switch(n){case 0:a8(e,t,r);break;case 1:i8(e,t,r,a);break;case 2:o8(e,t,s,r);break;case 3:l8(e,t,s,r,a);break;case 4:u8(e,t,s,r,a);break;default:throw new Error(`Unsupported filter: ${n}`)}}const q1e=new Uint16Array([255]),H1e=new Uint8Array(q1e.buffer),K1e=H1e[0]===255;function X1e(n){const{data:e,width:t,height:s,channels:r,depth:a}=n,i=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],o=Math.ceil(a/8)*r,l=new Uint8Array(s*t*o);let c=0;for(let f=0;f<7;f++){const d=i[f],m=Math.ceil((t-d.x)/d.xStep),g=Math.ceil((s-d.y)/d.yStep);if(m<=0||g<=0)continue;const b=m*o,x=new Uint8Array(b);for(let v=0;v<g;v++){const w=e[c++],k=e.subarray(c,c+b);c+=b;const I=new Uint8Array(b);G1e(w,k,I,x,b,o),x.set(I);for(let A=0;A<m;A++){const R=d.x+A*d.xStep,U=d.y+v*d.yStep;if(!(R>=t||U>=s))for(let V=0;V<o;V++)l[(U*t+R)*o+V]=I[A*o+V]}}}if(a===16){const f=new Uint16Array(l.buffer);if(K1e)for(let d=0;d<f.length;d++)f[d]=Y1e(f[d]);return f}else return l}function Y1e(n){return(n&255)<<8|n>>8&255}const Z1e=new Uint16Array([255]),J1e=new Uint8Array(Z1e.buffer),Q1e=J1e[0]===255,e0e=new Uint8Array(0);function F4(n){const{data:e,width:t,height:s,channels:r,depth:a}=n,i=Math.ceil(a/8)*r,o=Math.ceil(a/8*r*t),l=new Uint8Array(s*o);let c=e0e,f=0,d,m;for(let g=0;g<s;g++){switch(d=e.subarray(f+1,f+1+o),m=l.subarray(g*o,(g+1)*o),e[f]){case 0:a8(d,m,o);break;case 1:i8(d,m,o,i);break;case 2:o8(d,m,c,o);break;case 3:l8(d,m,c,o,i);break;case 4:u8(d,m,c,o,i);break;default:throw new Error(`Unsupported filter: ${e[f]}`)}c=m,f+=o+1}if(a===16){const g=new Uint16Array(l.buffer);if(Q1e)for(let b=0;b<g.length;b++)g[b]=t0e(g[b]);return g}else return l}function t0e(n){return(n&255)<<8|n>>8&255}const nb=Uint8Array.of(137,80,78,71,13,10,26,10);function M4(n){if(!n0e(n.readBytes(nb.length)))throw new Error("wrong PNG signature")}function n0e(n){if(n.length<nb.length)return!1;for(let e=0;e<nb.length;e++)if(n[e]!==nb[e])return!1;return!0}const s0e="tEXt",r0e=0,c8=new TextDecoder("latin1");function a0e(n){if(o0e(n),n.length===0||n.length>79)throw new Error("keyword length must be between 1 and 79")}const i0e=/^[\u0000-\u00FF]*$/;function o0e(n){if(!i0e.test(n))throw new Error("invalid latin1 text")}function l0e(n,e,t){const s=h8(e);n[s]=u0e(e,t-s.length-1)}function h8(n){for(n.mark();n.readByte()!==r0e;);const e=n.offset;n.reset();const t=c8.decode(n.readBytes(e-n.offset-1));return n.skip(1),a0e(t),t}function u0e(n,e){return c8.decode(n.readBytes(e))}const ao={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},lS={UNKNOWN:-1,DEFLATE:0},z4={UNKNOWN:-1,ADAPTIVE:0},uS={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},z2={NONE:0,BACKGROUND:1,PREVIOUS:2},cS={SOURCE:0,OVER:1};class c0e extends kC{_checkCrc;_inflator;_png;_apng;_end;_hasPalette;_palette;_hasTransparency;_transparency;_compressionMethod;_filterMethod;_interlaceMethod;_colorType;_isAnimated;_numberOfFrames;_numberOfPlays;_frames;_writingDataChunks;constructor(e,t={}){super(e);const{checkCrc:s=!1}=t;this._checkCrc=s,this._inflator=new D4,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=lS.UNKNOWN,this._filterMethod=z4.UNKNOWN,this._interlaceMethod=uS.UNKNOWN,this._colorType=ao.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(M4(this);!this._end;){const e=this.readUint32(),t=this.readChars(4);this.decodeChunk(e,t)}return this.decodeImage(),this._png}decodeApng(){for(M4(this);!this._end;){const e=this.readUint32(),t=this.readChars(4);this.decodeApngChunk(e,t)}return this.decodeApngImage(),this._apng}decodeChunk(e,t){const s=this.offset;switch(t){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(e);break;case"IDAT":this.decodeIDAT(e);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(e);break;case"iCCP":this.decodeiCCP(e);break;case s0e:l0e(this._png.text,this,e);break;case"pHYs":this.decodepHYs();break;default:this.skip(e);break}if(this.offset-s!==e)throw new Error(`Length mismatch while decoding chunk ${t}`);this._checkCrc?L4(this,e+4,t):this.skip(4)}decodeApngChunk(e,t){const s=this.offset;switch(t!=="fdAT"&&t!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),t){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(e);break;default:this.decodeChunk(e,t),this.offset=s+e;break}if(this.offset-s!==e)throw new Error(`Length mismatch while decoding chunk ${t}`);this._checkCrc?L4(this,e+4,t):this.skip(4)}decodeIHDR(){const e=this._png;e.width=this.readUint32(),e.height=this.readUint32(),e.depth=h0e(this.readUint8());const t=this.readUint8();this._colorType=t;let s;switch(t){case ao.GREYSCALE:s=1;break;case ao.TRUECOLOUR:s=3;break;case ao.INDEXED_COLOUR:s=1;break;case ao.GREYSCALE_ALPHA:s=2;break;case ao.TRUECOLOUR_ALPHA:s=4;break;case ao.UNKNOWN:default:throw new Error(`Unknown color type: ${t}`)}if(this._png.channels=s,this._compressionMethod=this.readUint8(),this._compressionMethod!==lS.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const e={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(e)}decodePLTE(e){if(e%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${e}`);const t=e/3;this._hasPalette=!0;const s=[];this._palette=s;for(let r=0;r<t;r++)s.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(e){this._writingDataChunks=!0;const t=e,s=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,s,t)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodeFDAT(e){this._writingDataChunks=!0;let t=e,s=this.offset+this.byteOffset;if(s+=4,t-=4,this._inflator.push(new Uint8Array(this.buffer,s,t)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodetRNS(e){switch(this._colorType){case ao.GREYSCALE:case ao.TRUECOLOUR:{if(e%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${e}`);if(e/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${e/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(e/2);for(let t=0;t<e/2;t++)this._transparency[t]=this.readUint16();break}case ao.INDEXED_COLOUR:{if(e>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${e} vs ${this._palette.length})`);let t=0;for(;t<e;t++){const s=this.readByte();this._palette[t].push(s)}for(;t<this._palette.length;t++)this._palette[t].push(255);break}case ao.UNKNOWN:case ao.GREYSCALE_ALPHA:case ao.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(e){const t=h8(this),s=this.readUint8();if(s!==lS.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${s}`);const r=this.readBytes(e-t.length-2);this._png.iccEmbeddedProfile={name:t,profile:U1e(r)}}decodepHYs(){const e=this.readUint32(),t=this.readUint32(),s=this.readByte();this._png.resolution={x:e,y:t,unit:s}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let e=0;e<this._numberOfFrames;e++){const t={sequenceNumber:this._frames[e].sequenceNumber,delayNumber:this._frames[e].delayNumber,delayDenominator:this._frames[e].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},s=this._frames.at(e);if(s){if(s.data=F4({data:s.data,width:s.width,height:s.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),e===0||s.xOffset===0&&s.yOffset===0&&s.width===this._png.width&&s.height===this._png.height)t.data=s.data;else{const r=this._apng.frames.at(e-1);this.disposeFrame(s,r,t),this.addFrameDataToCanvas(t,s)}this._apng.frames.push(t)}}return this._apng}disposeFrame(e,t,s){switch(e.disposeOp){case z2.NONE:break;case z2.BACKGROUND:for(let r=0;r<this._png.height;r++)for(let a=0;a<this._png.width;a++){const i=(r*e.width+a)*this._png.channels;for(let o=0;o<this._png.channels;o++)s.data[i+o]=0}break;case z2.PREVIOUS:s.data.set(t.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(e,t){const s=1<<this._png.depth,r=(a,i)=>{const o=((a+t.yOffset)*this._png.width+t.xOffset+i)*this._png.channels,l=(a*t.width+i)*this._png.channels;return{index:o,frameIndex:l}};switch(t.blendOp){case cS.SOURCE:for(let a=0;a<t.height;a++)for(let i=0;i<t.width;i++){const{index:o,frameIndex:l}=r(a,i);for(let c=0;c<this._png.channels;c++)e.data[o+c]=t.data[l+c]}break;case cS.OVER:for(let a=0;a<t.height;a++)for(let i=0;i<t.width;i++){const{index:o,frameIndex:l}=r(a,i);for(let c=0;c<this._png.channels;c++){const f=t.data[l+this._png.channels-1]/s,d=c%(this._png.channels-1)===0?1:t.data[l+c],m=Math.floor(f*d+(1-f)*e.data[o+c]);e.data[o+c]+=m}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const e=this._isAnimated?(this._frames?.at(0)).data:this._inflator.result;if(this._filterMethod!==z4.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===uS.NO_INTERLACE)this._png.data=F4({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===uS.ADAM7)this._png.data=X1e({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const e=this._inflator.result,t=this._frames.at(-1);t?t.data=e:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:z2.NONE,blendOp:cS.SOURCE,data:e}),this._inflator=new D4,this._writingDataChunks=!1}}function h0e(n){if(n!==1&&n!==2&&n!==4&&n!==8&&n!==16)throw new Error(`invalid bit depth: ${n}`);return n}var P4;(function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.METRE=1]="METRE"})(P4||(P4={}));function f0e(n,e){return new c0e(n,e).decode()}var an=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function hS(){an.console&&typeof an.console.log=="function"&&an.console.log.apply(an.console,arguments)}var xs={log:hS,warn:function(n){an.console&&(typeof an.console.warn=="function"?an.console.warn.apply(an.console,arguments):hS.call(null,arguments))},error:function(n){an.console&&(typeof an.console.error=="function"?an.console.error.apply(an.console,arguments):hS(n))}};function fS(n,e,t){var s=new XMLHttpRequest;s.open("GET",n),s.responseType="blob",s.onload=function(){Df(s.response,e,t)},s.onerror=function(){xs.error("could not download file")},s.send()}function B4(n){var e=new XMLHttpRequest;e.open("HEAD",n,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function P2(n){try{n.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),n.dispatchEvent(e)}}var Df=an.saveAs||((typeof window>"u"?"undefined":as(window))!=="object"||window!==an?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(n,e,t){var s=an.URL||an.webkitURL,r=document.createElement("a");e=e||n.name||"download",r.download=e,r.rel="noopener",typeof n=="string"?(r.href=n,r.origin!==location.origin?B4(r.href)?fS(n,e,t):P2(r,r.target="_blank"):P2(r)):(r.href=s.createObjectURL(n),setTimeout(function(){s.revokeObjectURL(r.href)},4e4),setTimeout(function(){P2(r)},0))}:"msSaveOrOpenBlob"in navigator?function(n,e,t){if(e=e||n.name||"download",typeof n=="string")if(B4(n))fS(n,e,t);else{var s=document.createElement("a");s.href=n,s.target="_blank",setTimeout(function(){P2(s)})}else navigator.msSaveOrOpenBlob((function(r,a){return a===void 0?a={autoBom:!1}:as(a)!=="object"&&(xs.warn("Deprecated: Expected third argument to be a object"),a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(r.type)?new Blob(["\uFEFF",r],{type:r.type}):r})(n,t),e)}:function(n,e,t,s){if((s=s||open("","_blank"))&&(s.document.title=s.document.body.innerText="downloading..."),typeof n=="string")return fS(n,e,t);var r=n.type==="application/octet-stream",a=/constructor/i.test(an.HTMLElement)||an.safari,i=/CriOS\/[\d]+/.test(navigator.userAgent);if((i||r&&a)&&(typeof FileReader>"u"?"undefined":as(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var f=o.result;f=i?f:f.replace(/^data:[^;]*;/,"data:attachment/file;"),s?s.location.href=f:location=f,s=null},o.readAsDataURL(n)}else{var l=an.URL||an.webkitURL,c=l.createObjectURL(n);s?s.location=c:location.href=c,s=null,setTimeout(function(){l.revokeObjectURL(c)},4e4)}});function f8(n){var e;n=n||"",this.ok=!1,n.charAt(0)=="#"&&(n=n.substr(1,6)),n={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[n=(n=n.replace(/ /g,"")).toLowerCase()]||n;for(var t=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],s=0;s<t.length;s++){var r=t[s].re,a=t[s].process,i=r.exec(n);i&&(e=a(i),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),l=this.g.toString(16),c=this.b.toString(16);return o.length==1&&(o="0"+o),l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),"#"+o+l+c}}var sb=an.atob.bind(an),U4=an.btoa.bind(an);function dS(n,e){var t=n[0],s=n[1],r=n[2],a=n[3];t=Da(t,s,r,a,e[0],7,-680876936),a=Da(a,t,s,r,e[1],12,-389564586),r=Da(r,a,t,s,e[2],17,606105819),s=Da(s,r,a,t,e[3],22,-1044525330),t=Da(t,s,r,a,e[4],7,-176418897),a=Da(a,t,s,r,e[5],12,1200080426),r=Da(r,a,t,s,e[6],17,-1473231341),s=Da(s,r,a,t,e[7],22,-45705983),t=Da(t,s,r,a,e[8],7,1770035416),a=Da(a,t,s,r,e[9],12,-1958414417),r=Da(r,a,t,s,e[10],17,-42063),s=Da(s,r,a,t,e[11],22,-1990404162),t=Da(t,s,r,a,e[12],7,1804603682),a=Da(a,t,s,r,e[13],12,-40341101),r=Da(r,a,t,s,e[14],17,-1502002290),t=Oa(t,s=Da(s,r,a,t,e[15],22,1236535329),r,a,e[1],5,-165796510),a=Oa(a,t,s,r,e[6],9,-1069501632),r=Oa(r,a,t,s,e[11],14,643717713),s=Oa(s,r,a,t,e[0],20,-373897302),t=Oa(t,s,r,a,e[5],5,-701558691),a=Oa(a,t,s,r,e[10],9,38016083),r=Oa(r,a,t,s,e[15],14,-660478335),s=Oa(s,r,a,t,e[4],20,-405537848),t=Oa(t,s,r,a,e[9],5,568446438),a=Oa(a,t,s,r,e[14],9,-1019803690),r=Oa(r,a,t,s,e[3],14,-187363961),s=Oa(s,r,a,t,e[8],20,1163531501),t=Oa(t,s,r,a,e[13],5,-1444681467),a=Oa(a,t,s,r,e[2],9,-51403784),r=Oa(r,a,t,s,e[7],14,1735328473),t=La(t,s=Oa(s,r,a,t,e[12],20,-1926607734),r,a,e[5],4,-378558),a=La(a,t,s,r,e[8],11,-2022574463),r=La(r,a,t,s,e[11],16,1839030562),s=La(s,r,a,t,e[14],23,-35309556),t=La(t,s,r,a,e[1],4,-1530992060),a=La(a,t,s,r,e[4],11,1272893353),r=La(r,a,t,s,e[7],16,-155497632),s=La(s,r,a,t,e[10],23,-1094730640),t=La(t,s,r,a,e[13],4,681279174),a=La(a,t,s,r,e[0],11,-358537222),r=La(r,a,t,s,e[3],16,-722521979),s=La(s,r,a,t,e[6],23,76029189),t=La(t,s,r,a,e[9],4,-640364487),a=La(a,t,s,r,e[12],11,-421815835),r=La(r,a,t,s,e[15],16,530742520),t=Fa(t,s=La(s,r,a,t,e[2],23,-995338651),r,a,e[0],6,-198630844),a=Fa(a,t,s,r,e[7],10,1126891415),r=Fa(r,a,t,s,e[14],15,-1416354905),s=Fa(s,r,a,t,e[5],21,-57434055),t=Fa(t,s,r,a,e[12],6,1700485571),a=Fa(a,t,s,r,e[3],10,-1894986606),r=Fa(r,a,t,s,e[10],15,-1051523),s=Fa(s,r,a,t,e[1],21,-2054922799),t=Fa(t,s,r,a,e[8],6,1873313359),a=Fa(a,t,s,r,e[15],10,-30611744),r=Fa(r,a,t,s,e[6],15,-1560198380),s=Fa(s,r,a,t,e[13],21,1309151649),t=Fa(t,s,r,a,e[4],6,-145523070),a=Fa(a,t,s,r,e[11],10,-1120210379),r=Fa(r,a,t,s,e[2],15,718787259),s=Fa(s,r,a,t,e[9],21,-343485551),n[0]=wh(t,n[0]),n[1]=wh(s,n[1]),n[2]=wh(r,n[2]),n[3]=wh(a,n[3])}function uw(n,e,t,s,r,a){return e=wh(wh(e,n),wh(s,a)),wh(e<<r|e>>>32-r,t)}function Da(n,e,t,s,r,a,i){return uw(e&t|~e&s,n,e,r,a,i)}function Oa(n,e,t,s,r,a,i){return uw(e&s|t&~s,n,e,r,a,i)}function La(n,e,t,s,r,a,i){return uw(e^t^s,n,e,r,a,i)}function Fa(n,e,t,s,r,a,i){return uw(t^(e|~s),n,e,r,a,i)}function d8(n){var e,t=n.length,s=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=n.length;e+=64)dS(s,d0e(n.substring(e-64,e)));n=n.substring(e-64);var r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<n.length;e++)r[e>>2]|=n.charCodeAt(e)<<(e%4<<3);if(r[e>>2]|=128<<(e%4<<3),e>55)for(dS(s,r),e=0;e<16;e++)r[e]=0;return r[14]=8*t,dS(s,r),s}function d0e(n){var e,t=[];for(e=0;e<64;e+=4)t[e>>2]=n.charCodeAt(e)+(n.charCodeAt(e+1)<<8)+(n.charCodeAt(e+2)<<16)+(n.charCodeAt(e+3)<<24);return t}var V4="0123456789abcdef".split("");function p0e(n){for(var e="",t=0;t<4;t++)e+=V4[n>>8*t+4&15]+V4[n>>8*t&15];return e}function m0e(n){return String.fromCharCode(255&n,(65280&n)>>8,(16711680&n)>>16,(4278190080&n)>>24)}function NN(n){return d8(n).map(m0e).join("")}var g0e=(function(n){for(var e=0;e<n.length;e++)n[e]=p0e(n[e]);return n.join("")})(d8("hello"))!="5d41402abc4b2a76b9719d911017c592";function wh(n,e){if(g0e){var t=(65535&n)+(65535&e);return(n>>16)+(e>>16)+(t>>16)<<16|65535&t}return n+e&4294967295}function kN(n,e){var t,s,r,a;if(n!==t){for(var i=(r=n,a=1+(256/n.length|0),new Array(a+1).join(r)),o=[],l=0;l<256;l++)o[l]=l;var c=0;for(l=0;l<256;l++){var f=o[l];c=(c+f+i.charCodeAt(l))%256,o[l]=o[c],o[c]=f}t=n,s=o}else o=s;var d=e.length,m=0,g=0,b="";for(l=0;l<d;l++)g=(g+(f=o[m=(m+1)%256]))%256,o[m]=o[g],o[g]=f,i=o[(o[m]+o[g])%256],b+=String.fromCharCode(e.charCodeAt(l)^i);return b}var j4={print:4,modify:8,copy:16,"annot-forms":32};function Ap(n,e,t,s){this.v=1,this.r=2;var r=192;n.forEach(function(o){if(j4.perm!==void 0)throw new Error("Invalid permission: "+o);r+=j4[o]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var a=(e+this.padding).substr(0,32),i=(t+this.padding).substr(0,32);this.O=this.processOwnerPassword(a,i),this.P=-(1+(255^r)),this.encryptionKey=NN(a+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(s)).substr(0,5),this.U=kN(this.encryptionKey,this.padding)}function Ip(n){if(/[^\u0000-\u00ff]/.test(n))throw new Error("Invalid PDF Name Object: "+n+", Only accept ASCII characters.");for(var e="",t=n.length,s=0;s<t;s++){var r=n.charCodeAt(s);e+=r<33||r===35||r===37||r===40||r===41||r===47||r===60||r===62||r===91||r===93||r===123||r===125||r>126?"#"+("0"+r.toString(16)).slice(-2):n[s]}return e}function W4(n){if(as(n)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(t,s,r){if(r=r||!1,typeof t!="string"||typeof s!="function"||typeof r!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(t)||(e[t]={});var a=Math.random().toString(35);return e[t][a]=[s,!!r],a},this.unsubscribe=function(t){for(var s in e)if(e[s][t])return delete e[s][t],Object.keys(e[s]).length===0&&delete e[s],!0;return!1},this.publish=function(t){if(e.hasOwnProperty(t)){var s=Array.prototype.slice.call(arguments,1),r=[];for(var a in e[t]){var i=e[t][a];try{i[0].apply(n,s)}catch(o){an.console&&xs.error("jsPDF PubSub Error",o.message,o)}i[1]&&r.push(a)}r.length&&r.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function jb(n){if(!(this instanceof jb))return new jb(n);var e="opacity,stroke-opacity".split(",");for(var t in n)n.hasOwnProperty(t)&&e.indexOf(t)>=0&&(this[t]=n[t]);this.id="",this.objectNumber=-1}function p8(n,e){this.gState=n,this.matrix=e,this.id="",this.objectNumber=-1}function Pf(n,e,t,s,r){if(!(this instanceof Pf))return new Pf(n,e,t,s,r);this.type=n==="axial"?2:3,this.coords=e,this.colors=t,p8.call(this,s,r)}function Ep(n,e,t,s,r){if(!(this instanceof Ep))return new Ep(n,e,t,s,r);this.boundingBox=n,this.xStep=e,this.yStep=t,this.stream="",this.cloneIndex=0,p8.call(this,s,r)}function Ft(n){var e,t=typeof arguments[0]=="string"?arguments[0]:"p",s=arguments[1],r=arguments[2],a=arguments[3],i=[],o=1,l=16,c="S",f=null;as(n=n||{})==="object"&&(t=n.orientation,s=n.unit||s,r=n.format||r,a=n.compress||n.compressPdf||a,(f=n.encryption||null)!==null&&(f.userPassword=f.userPassword||"",f.ownerPassword=f.ownerPassword||"",f.userPermissions=f.userPermissions||[]),o=typeof n.userUnit=="number"?Math.abs(n.userUnit):1,n.precision!==void 0&&(e=n.precision),n.floatPrecision!==void 0&&(l=n.floatPrecision),c=n.defaultPathOperation||"S"),i=n.filters||(a===!0?["FlateEncode"]:i),s=s||"mm",t=(""+(t||"P")).toLowerCase();var d=n.putOnlyUsedFonts||!1,m={},g={internal:{},__private__:{}};g.__private__.PubSub=W4;var b="1.3",x=g.__private__.getPdfVersion=function(){return b};g.__private__.setPdfVersion=function(_){b=_};var v={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};g.__private__.getPageFormats=function(){return v};var w=g.__private__.getPageFormat=function(_){return v[_]};r=r||"a4";var k="compat",I="advanced",A=k;function R(){this.saveGraphicsState(),oe(new Pt(en,0,0,-en,0,rl()*en).toString()+" cm"),this.setFontSize(this.getFontSize()/en),c="n",A=I}function U(){this.restoreGraphicsState(),c="S",A=k}var V=g.__private__.combineFontStyleAndFontWeight=function(_,q){if(_=="bold"&&q=="normal"||_=="bold"&&q==400||_=="normal"&&q=="italic"||_=="bold"&&q=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return q&&(_=q==400||q==="normal"?_==="italic"?"italic":"normal":q!=700&&q!=="bold"||_!=="normal"?(q==700?"bold":q)+""+_:"bold"),_};g.advancedAPI=function(_){var q=A===k;return q&&R.call(this),typeof _!="function"||(_(this),q&&U.call(this)),this},g.compatAPI=function(_){var q=A===I;return q&&U.call(this),typeof _!="function"||(_(this),q&&R.call(this)),this},g.isAdvancedAPI=function(){return A===I};var P,D=function(_){if(A!==I)throw new Error(_+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},B=g.roundToPrecision=g.__private__.roundToPrecision=function(_,q){var de=e||q;if(isNaN(_)||isNaN(de))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return _.toFixed(de).replace(/0+$/,"")};P=g.hpf=g.__private__.hpf=typeof l=="number"?function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.hpf");return B(_,l)}:l==="smart"?function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.hpf");return B(_,_>-1&&_<1?16:5)}:function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.hpf");return B(_,16)};var E=g.f2=g.__private__.f2=function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.f2");return B(_,2)},M=g.__private__.f3=function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.f3");return B(_,3)},K=g.scale=g.__private__.scale=function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.scale");return A===k?_*en:A===I?_:void 0},X=function(_){return K((function(q){return A===k?rl()-q:A===I?q:void 0})(_))};g.__private__.setPrecision=g.setPrecision=function(_){typeof parseInt(_,10)=="number"&&(e=parseInt(_,10))};var ae,W="00000000000000000000000000000000",se=g.__private__.getFileId=function(){return W},ee=g.__private__.setFileId=function(_){return W=_!==void 0&&/^[a-fA-F0-9]{32}$/.test(_)?_.toUpperCase():W.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),f!==null&&(pr=new Ap(f.userPermissions,f.userPassword,f.ownerPassword,W)),W};g.setFileId=function(_){return ee(_),this},g.getFileId=function(){return se()};var ce=g.__private__.convertDateToPDFDate=function(_){var q=_.getTimezoneOffset(),de=q<0?"+":"-",ve=Math.floor(Math.abs(q/60)),Ie=Math.abs(q%60),Ke=[de,Y(ve),"'",Y(Ie),"'"].join("");return["D:",_.getFullYear(),Y(_.getMonth()+1),Y(_.getDate()),Y(_.getHours()),Y(_.getMinutes()),Y(_.getSeconds()),Ke].join("")},ye=g.__private__.convertPDFDateToDate=function(_){var q=parseInt(_.substr(2,4),10),de=parseInt(_.substr(6,2),10)-1,ve=parseInt(_.substr(8,2),10),Ie=parseInt(_.substr(10,2),10),Ke=parseInt(_.substr(12,2),10),nt=parseInt(_.substr(14,2),10);return new Date(q,de,ve,Ie,Ke,nt,0)},G=g.__private__.setCreationDate=function(_){var q;if(_===void 0&&(_=new Date),_ instanceof Date)q=ce(_);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(_))throw new Error("Invalid argument passed to jsPDF.setCreationDate");q=_}return ae=q},O=g.__private__.getCreationDate=function(_){var q=ae;return _==="jsDate"&&(q=ye(ae)),q};g.setCreationDate=function(_){return G(_),this},g.getCreationDate=function(_){return O(_)};var j,Y=g.__private__.padd2=function(_){return("0"+parseInt(_)).slice(-2)},ie=g.__private__.padd2Hex=function(_){return("00"+(_=_.toString())).substr(_.length)},ue=0,pe=[],Ce=[],Ne=0,Le=[],Ve=[],rt=!1,at=Ce;g.__private__.setCustomOutputDestination=function(_){rt=!0,at=_};var ot=function(_){rt||(at=_)};g.__private__.resetCustomOutputDestination=function(){rt=!1,at=Ce};var oe=g.__private__.out=function(_){return _=_.toString(),Ne+=_.length+1,at.push(_),at},tt=g.__private__.write=function(_){return oe(arguments.length===1?_.toString():Array.prototype.join.call(arguments," "))},xt=g.__private__.getArrayBuffer=function(_){for(var q=_.length,de=new ArrayBuffer(q),ve=new Uint8Array(de);q--;)ve[q]=_.charCodeAt(q);return de},ht=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];g.__private__.getStandardFonts=function(){return ht};var Je=n.fontSize||16;g.__private__.setFontSize=g.setFontSize=function(_){return Je=A===I?_/en:_,this};var dt,ft=g.__private__.getFontSize=g.getFontSize=function(){return A===k?Je:Je*en},bt=n.R2L||!1;g.__private__.setR2L=g.setR2L=function(_){return bt=_,this},g.__private__.getR2L=g.getR2L=function(){return bt};var Tt,zt=g.__private__.setZoomMode=function(_){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(_))dt=_;else if(isNaN(_)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(_)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+_+'" is not recognized.');dt=_}else dt=parseInt(_,10)};g.__private__.getZoomMode=function(){return dt};var tn,Ut=g.__private__.setPageMode=function(_){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(_)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+_+'" is not recognized.');Tt=_};g.__private__.getPageMode=function(){return Tt};var sn=g.__private__.setLayoutMode=function(_){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(_)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+_+'" is not recognized.');tn=_};g.__private__.getLayoutMode=function(){return tn},g.__private__.setDisplayMode=g.setDisplayMode=function(_,q,de){return zt(_),sn(q),Ut(de),this};var Yt={title:"",subject:"",author:"",keywords:"",creator:""};g.__private__.getDocumentProperty=function(_){if(Object.keys(Yt).indexOf(_)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Yt[_]},g.__private__.getDocumentProperties=function(){return Yt},g.__private__.setDocumentProperties=g.setProperties=g.setDocumentProperties=function(_){for(var q in Yt)Yt.hasOwnProperty(q)&&_[q]&&(Yt[q]=_[q]);return this},g.__private__.setDocumentProperty=function(_,q){if(Object.keys(Yt).indexOf(_)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Yt[_]=q};var vt,en,_t,ks,ln,Vt={},Zt={},kn=[],jt={},ls={},Kt={},nn={},es=null,dn=0,Lt=[],On=new W4(g),Ui=n.hotfixes||[],Jr={},yo={},fi=[],Pt=function _(q,de,ve,Ie,Ke,nt){if(!(this instanceof _))return new _(q,de,ve,Ie,Ke,nt);isNaN(q)&&(q=1),isNaN(de)&&(de=0),isNaN(ve)&&(ve=0),isNaN(Ie)&&(Ie=1),isNaN(Ke)&&(Ke=0),isNaN(nt)&&(nt=0),this._matrix=[q,de,ve,Ie,Ke,nt]};Object.defineProperty(Pt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(_){this._matrix[0]=_}}),Object.defineProperty(Pt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(_){this._matrix[1]=_}}),Object.defineProperty(Pt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(_){this._matrix[2]=_}}),Object.defineProperty(Pt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(_){this._matrix[3]=_}}),Object.defineProperty(Pt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(_){this._matrix[4]=_}}),Object.defineProperty(Pt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(_){this._matrix[5]=_}}),Object.defineProperty(Pt.prototype,"a",{get:function(){return this._matrix[0]},set:function(_){this._matrix[0]=_}}),Object.defineProperty(Pt.prototype,"b",{get:function(){return this._matrix[1]},set:function(_){this._matrix[1]=_}}),Object.defineProperty(Pt.prototype,"c",{get:function(){return this._matrix[2]},set:function(_){this._matrix[2]=_}}),Object.defineProperty(Pt.prototype,"d",{get:function(){return this._matrix[3]},set:function(_){this._matrix[3]=_}}),Object.defineProperty(Pt.prototype,"e",{get:function(){return this._matrix[4]},set:function(_){this._matrix[4]=_}}),Object.defineProperty(Pt.prototype,"f",{get:function(){return this._matrix[5]},set:function(_){this._matrix[5]=_}}),Object.defineProperty(Pt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Pt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Pt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Pt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Pt.prototype.join=function(_){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(P).join(_)},Pt.prototype.multiply=function(_){var q=_.sx*this.sx+_.shy*this.shx,de=_.sx*this.shy+_.shy*this.sy,ve=_.shx*this.sx+_.sy*this.shx,Ie=_.shx*this.shy+_.sy*this.sy,Ke=_.tx*this.sx+_.ty*this.shx+this.tx,nt=_.tx*this.shy+_.ty*this.sy+this.ty;return new Pt(q,de,ve,Ie,Ke,nt)},Pt.prototype.decompose=function(){var _=this.sx,q=this.shy,de=this.shx,ve=this.sy,Ie=this.tx,Ke=this.ty,nt=Math.sqrt(_*_+q*q),Nt=(_/=nt)*de+(q/=nt)*ve;de-=_*Nt,ve-=q*Nt;var Rt=Math.sqrt(de*de+ve*ve);return Nt/=Rt,_*(ve/=Rt)<q*(de/=Rt)&&(_=-_,q=-q,Nt=-Nt,nt=-nt),{scale:new Pt(nt,0,0,Rt,0,0),translate:new Pt(1,0,0,1,Ie,Ke),rotate:new Pt(_,q,-q,_,0,0),skew:new Pt(1,0,Nt,1,0,0)}},Pt.prototype.toString=function(_){return this.join(" ")},Pt.prototype.inversed=function(){var _=this.sx,q=this.shy,de=this.shx,ve=this.sy,Ie=this.tx,Ke=this.ty,nt=1/(_*ve-q*de),Nt=ve*nt,Rt=-q*nt,Jt=-de*nt,un=_*nt;return new Pt(Nt,Rt,Jt,un,-Nt*Ie-Jt*Ke,-Rt*Ie-un*Ke)},Pt.prototype.applyToPoint=function(_){var q=_.x*this.sx+_.y*this.shx+this.tx,de=_.x*this.shy+_.y*this.sy+this.ty;return new mi(q,de)},Pt.prototype.applyToRectangle=function(_){var q=this.applyToPoint(_),de=this.applyToPoint(new mi(_.x+_.w,_.y+_.h));return new Qo(q.x,q.y,de.x-q.x,de.y-q.y)},Pt.prototype.clone=function(){var _=this.sx,q=this.shy,de=this.shx,ve=this.sy,Ie=this.tx,Ke=this.ty;return new Pt(_,q,de,ve,Ie,Ke)},g.Matrix=Pt;var Xo=g.matrixMult=function(_,q){return q.multiply(_)},bo=new Pt(1,0,0,1,0,0);g.unitMatrix=g.identityMatrix=bo;var Ga=function(_,q){if(!ls[_]){var de=(q instanceof Pf?"Sh":"P")+(Object.keys(jt).length+1).toString(10);q.id=de,ls[_]=de,jt[de]=q,On.publish("addPattern",q)}};g.ShadingPattern=Pf,g.TilingPattern=Ep,g.addShadingPattern=function(_,q){return D("addShadingPattern()"),Ga(_,q),this},g.beginTilingPattern=function(_){D("beginTilingPattern()"),Pu(_.boundingBox[0],_.boundingBox[1],_.boundingBox[2]-_.boundingBox[0],_.boundingBox[3]-_.boundingBox[1],_.matrix)},g.endTilingPattern=function(_,q){D("endTilingPattern()"),q.stream=Ve[j].join(`
`),Ga(_,q),On.publish("endTilingPattern",q),fi.pop().restore()};var qa,Ns=g.__private__.newObject=function(){var _=Js();return kr(_,!0),_},Js=g.__private__.newObjectDeferred=function(){return ue++,pe[ue]=function(){return Ne},ue},kr=function(_,q){return q=typeof q=="boolean"&&q,pe[_]=Ne,q&&oe(_+" 0 obj"),_},Wl=g.__private__.newAdditionalObject=function(){var _={objId:Js(),content:""};return Le.push(_),_},ga=Js(),ts=Js(),Cs=g.__private__.decodeColorString=function(_){var q=_.split(" ");if(q.length!==2||q[1]!=="g"&&q[1]!=="G")q.length!==5||q[4]!=="k"&&q[4]!=="K"||(q=[(1-q[0])*(1-q[3]),(1-q[1])*(1-q[3]),(1-q[2])*(1-q[3]),"r"]);else{var de=parseFloat(q[0]);q=[de,de,de,"r"]}for(var ve="#",Ie=0;Ie<3;Ie++)ve+=("0"+Math.floor(255*parseFloat(q[Ie])).toString(16)).slice(-2);return ve},Qr=g.__private__.encodeColorString=function(_){var q;typeof _=="string"&&(_={ch1:_});var de=_.ch1,ve=_.ch2,Ie=_.ch3,Ke=_.ch4,nt=_.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof de=="string"&&de.charAt(0)!=="#"){var Nt=new f8(de);if(Nt.ok)de=Nt.toHex();else if(!/^\d*\.?\d*$/.test(de))throw new Error('Invalid color "'+de+'" passed to jsPDF.encodeColorString.')}if(typeof de=="string"&&/^#[0-9A-Fa-f]{3}$/.test(de)&&(de="#"+de[1]+de[1]+de[2]+de[2]+de[3]+de[3]),typeof de=="string"&&/^#[0-9A-Fa-f]{6}$/.test(de)){var Rt=parseInt(de.substr(1),16);de=Rt>>16&255,ve=Rt>>8&255,Ie=255&Rt}if(ve===void 0||Ke===void 0&&de===ve&&ve===Ie)q=typeof de=="string"?de+" "+nt[0]:_.precision===2?E(de/255)+" "+nt[0]:M(de/255)+" "+nt[0];else if(Ke===void 0||as(Ke)==="object"){if(Ke&&!isNaN(Ke.a)&&Ke.a===0)return["1.","1.","1.",nt[1]].join(" ");q=typeof de=="string"?[de,ve,Ie,nt[1]].join(" "):_.precision===2?[E(de/255),E(ve/255),E(Ie/255),nt[1]].join(" "):[M(de/255),M(ve/255),M(Ie/255),nt[1]].join(" ")}else q=typeof de=="string"?[de,ve,Ie,Ke,nt[2]].join(" "):_.precision===2?[E(de),E(ve),E(Ie),E(Ke),nt[2]].join(" "):[M(de),M(ve),M(Ie),M(Ke),nt[2]].join(" ");return q},Ha=g.__private__.getFilters=function(){return i},di=g.__private__.putStream=function(_){var q=(_=_||{}).data||"",de=_.filters||Ha(),ve=_.alreadyAppliedFilters||[],Ie=_.addLength1||!1,Ke=q.length,nt=_.objectId,Nt=function(mr){return mr};if(f!==null&&nt===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");f!==null&&(Nt=pr.encryptor(nt,0));var Rt={};de===!0&&(de=["FlateEncode"]);var Jt=_.additionalKeyValues||[],un=(Rt=Ft.API.processDataByFilters!==void 0?Ft.API.processDataByFilters(q,de):{data:q,reverseChain:[]}).reverseChain+(Array.isArray(ve)?ve.join(" "):ve.toString());if(Rt.data.length!==0&&(Jt.push({key:"Length",value:Rt.data.length}),Ie===!0&&Jt.push({key:"Length1",value:Ke})),un.length!=0)if(un.split("/").length-1==1)Jt.push({key:"Filter",value:un});else{Jt.push({key:"Filter",value:"["+un+"]"});for(var Ln=0;Ln<Jt.length;Ln+=1)if(Jt[Ln].key==="DecodeParms"){for(var Ts=[],Gs=0;Gs<Rt.reverseChain.split("/").length-1;Gs+=1)Ts.push("null");Ts.push(Jt[Ln].value),Jt[Ln].value="["+Ts.join(" ")+"]"}}oe("<<");for(var us=0;us<Jt.length;us++)oe("/"+Jt[us].key+" "+Jt[us].value);oe(">>"),Rt.data.length!==0&&(oe("stream"),oe(Nt(Rt.data)),oe("endstream"))},Du=g.__private__.putPage=function(_){var q=_.number,de=_.data,ve=_.objId,Ie=_.contentsObjId;kr(ve,!0),oe("<</Type /Page"),oe("/Parent "+_.rootDictionaryObjId+" 0 R"),oe("/Resources "+_.resourceDictionaryObjId+" 0 R"),oe("/MediaBox ["+parseFloat(P(_.mediaBox.bottomLeftX))+" "+parseFloat(P(_.mediaBox.bottomLeftY))+" "+P(_.mediaBox.topRightX)+" "+P(_.mediaBox.topRightY)+"]"),_.cropBox!==null&&oe("/CropBox ["+P(_.cropBox.bottomLeftX)+" "+P(_.cropBox.bottomLeftY)+" "+P(_.cropBox.topRightX)+" "+P(_.cropBox.topRightY)+"]"),_.bleedBox!==null&&oe("/BleedBox ["+P(_.bleedBox.bottomLeftX)+" "+P(_.bleedBox.bottomLeftY)+" "+P(_.bleedBox.topRightX)+" "+P(_.bleedBox.topRightY)+"]"),_.trimBox!==null&&oe("/TrimBox ["+P(_.trimBox.bottomLeftX)+" "+P(_.trimBox.bottomLeftY)+" "+P(_.trimBox.topRightX)+" "+P(_.trimBox.topRightY)+"]"),_.artBox!==null&&oe("/ArtBox ["+P(_.artBox.bottomLeftX)+" "+P(_.artBox.bottomLeftY)+" "+P(_.artBox.topRightX)+" "+P(_.artBox.topRightY)+"]"),typeof _.userUnit=="number"&&_.userUnit!==1&&oe("/UserUnit "+_.userUnit),On.publish("putPage",{objId:ve,pageContext:Lt[q],pageNumber:q,page:de}),oe("/Contents "+Ie+" 0 R"),oe(">>"),oe("endobj");var Ke=de.join(`
`);return A===I&&(Ke+=`
Q`),kr(Ie,!0),di({data:Ke,filters:Ha(),objectId:Ie}),oe("endobj"),ve},Vi=g.__private__.putPages=function(){var _,q,de=[];for(_=1;_<=dn;_++)Lt[_].objId=Js(),Lt[_].contentsObjId=Js();for(_=1;_<=dn;_++)de.push(Du({number:_,data:Ve[_],objId:Lt[_].objId,contentsObjId:Lt[_].contentsObjId,mediaBox:Lt[_].mediaBox,cropBox:Lt[_].cropBox,bleedBox:Lt[_].bleedBox,trimBox:Lt[_].trimBox,artBox:Lt[_].artBox,userUnit:Lt[_].userUnit,rootDictionaryObjId:ga,resourceDictionaryObjId:ts}));kr(ga,!0),oe("<</Type /Pages");var ve="/Kids [";for(q=0;q<dn;q++)ve+=de[q]+" 0 R ";oe(ve+"]"),oe("/Count "+dn),oe(">>"),oe("endobj"),On.publish("postPutPages")},ji=function(_){On.publish("putFont",{font:_,out:oe,newObject:Ns,putStream:di}),_.isAlreadyPutted!==!0&&(_.objectNumber=Ns(),oe("<<"),oe("/Type /Font"),oe("/BaseFont /"+Ip(_.postScriptName)),oe("/Subtype /Type1"),typeof _.encoding=="string"&&oe("/Encoding /"+_.encoding),oe("/FirstChar 32"),oe("/LastChar 255"),oe(">>"),oe("endobj"))},Gl=function(_){_.objectNumber=Ns();var q=[];q.push({key:"Type",value:"/XObject"}),q.push({key:"Subtype",value:"/Form"}),q.push({key:"BBox",value:"["+[P(_.x),P(_.y),P(_.x+_.width),P(_.y+_.height)].join(" ")+"]"}),q.push({key:"Matrix",value:"["+_.matrix.toString()+"]"});var de=_.pages[1].join(`
`);di({data:de,additionalKeyValues:q,objectId:_.objectNumber}),oe("endobj")},Wi=function(_,q){q||(q=21);var de=Ns(),ve=(function(nt,Nt){var Rt,Jt=[],un=1/(Nt-1);for(Rt=0;Rt<1;Rt+=un)Jt.push(Rt);if(Jt.push(1),nt[0].offset!=0){var Ln={offset:0,color:nt[0].color};nt.unshift(Ln)}if(nt[nt.length-1].offset!=1){var Ts={offset:1,color:nt[nt.length-1].color};nt.push(Ts)}for(var Gs="",us=0,mr=0;mr<Jt.length;mr++){for(Rt=Jt[mr];Rt>nt[us+1].offset;)us++;var er=nt[us].offset,Mr=(Rt-er)/(nt[us+1].offset-er),al=nt[us].color,Yi=nt[us+1].color;Gs+=ie(Math.round((1-Mr)*al[0]+Mr*Yi[0]).toString(16))+ie(Math.round((1-Mr)*al[1]+Mr*Yi[1]).toString(16))+ie(Math.round((1-Mr)*al[2]+Mr*Yi[2]).toString(16))}return Gs.trim()})(_.colors,q),Ie=[];Ie.push({key:"FunctionType",value:"0"}),Ie.push({key:"Domain",value:"[0.0 1.0]"}),Ie.push({key:"Size",value:"["+q+"]"}),Ie.push({key:"BitsPerSample",value:"8"}),Ie.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ie.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),di({data:ve,additionalKeyValues:Ie,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:de}),oe("endobj"),_.objectNumber=Ns(),oe("<< /ShadingType "+_.type),oe("/ColorSpace /DeviceRGB");var Ke="/Coords ["+P(parseFloat(_.coords[0]))+" "+P(parseFloat(_.coords[1]))+" ";_.type===2?Ke+=P(parseFloat(_.coords[2]))+" "+P(parseFloat(_.coords[3])):Ke+=P(parseFloat(_.coords[2]))+" "+P(parseFloat(_.coords[3]))+" "+P(parseFloat(_.coords[4]))+" "+P(parseFloat(_.coords[5])),oe(Ke+="]"),_.matrix&&oe("/Matrix ["+_.matrix.toString()+"]"),oe("/Function "+de+" 0 R"),oe("/Extend [true true]"),oe(">>"),oe("endobj")},Gi=function(_,q){var de=Js(),ve=Ns();q.push({resourcesOid:de,objectOid:ve}),_.objectNumber=ve;var Ie=[];Ie.push({key:"Type",value:"/Pattern"}),Ie.push({key:"PatternType",value:"1"}),Ie.push({key:"PaintType",value:"1"}),Ie.push({key:"TilingType",value:"1"}),Ie.push({key:"BBox",value:"["+_.boundingBox.map(P).join(" ")+"]"}),Ie.push({key:"XStep",value:P(_.xStep)}),Ie.push({key:"YStep",value:P(_.yStep)}),Ie.push({key:"Resources",value:de+" 0 R"}),_.matrix&&Ie.push({key:"Matrix",value:"["+_.matrix.toString()+"]"}),di({data:_.stream,additionalKeyValues:Ie,objectId:_.objectNumber}),oe("endobj")},Ou=function(_){for(var q in _.objectNumber=Ns(),oe("<<"),_)switch(q){case"opacity":oe("/ca "+E(_[q]));break;case"stroke-opacity":oe("/CA "+E(_[q]))}oe(">>"),oe("endobj")},xo=function(_){kr(_.resourcesOid,!0),oe("<<"),oe("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var q in oe("/Font <<"),Vt)Vt.hasOwnProperty(q)&&(d===!1||d===!0&&m.hasOwnProperty(q))&&oe("/"+q+" "+Vt[q].objectNumber+" 0 R");oe(">>")})(),(function(){if(Object.keys(jt).length>0){for(var q in oe("/Shading <<"),jt)jt.hasOwnProperty(q)&&jt[q]instanceof Pf&&jt[q].objectNumber>=0&&oe("/"+q+" "+jt[q].objectNumber+" 0 R");On.publish("putShadingPatternDict"),oe(">>")}})(),(function(q){if(Object.keys(jt).length>0){for(var de in oe("/Pattern <<"),jt)jt.hasOwnProperty(de)&&jt[de]instanceof g.TilingPattern&&jt[de].objectNumber>=0&&jt[de].objectNumber<q&&oe("/"+de+" "+jt[de].objectNumber+" 0 R");On.publish("putTilingPatternDict"),oe(">>")}})(_.objectOid),(function(){if(Object.keys(Kt).length>0){var q;for(q in oe("/ExtGState <<"),Kt)Kt.hasOwnProperty(q)&&Kt[q].objectNumber>=0&&oe("/"+q+" "+Kt[q].objectNumber+" 0 R");On.publish("putGStateDict"),oe(">>")}})(),(function(){for(var q in oe("/XObject <<"),Jr)Jr.hasOwnProperty(q)&&Jr[q].objectNumber>=0&&oe("/"+q+" "+Jr[q].objectNumber+" 0 R");On.publish("putXobjectDict"),oe(">>")})(),oe(">>"),oe("endobj")},Ws=function(_){Zt[_.fontName]=Zt[_.fontName]||{},Zt[_.fontName][_.fontStyle]=_.id},Xh=function(_,q,de,ve,Ie){var Ke={id:"F"+(Object.keys(Vt).length+1).toString(10),postScriptName:_,fontName:q,fontStyle:de,encoding:ve,isStandardFont:Ie||!1,metadata:{}};return On.publish("addFont",{font:Ke,instance:this}),Vt[Ke.id]=Ke,Ws(Ke),Ke.id},Ka=g.__private__.pdfEscape=g.pdfEscape=function(_,q){return(function(de,ve){var Ie,Ke,nt,Nt,Rt,Jt,un,Ln,Ts;if(nt=(ve=ve||{}).sourceEncoding||"Unicode",Rt=ve.outputEncoding,(ve.autoencode||Rt)&&Vt[vt].metadata&&Vt[vt].metadata[nt]&&Vt[vt].metadata[nt].encoding&&(Nt=Vt[vt].metadata[nt].encoding,!Rt&&Vt[vt].encoding&&(Rt=Vt[vt].encoding),!Rt&&Nt.codePages&&(Rt=Nt.codePages[0]),typeof Rt=="string"&&(Rt=Nt[Rt]),Rt)){for(un=!1,Jt=[],Ie=0,Ke=de.length;Ie<Ke;Ie++)(Ln=Rt[de.charCodeAt(Ie)])?Jt.push(String.fromCharCode(Ln)):Jt.push(de[Ie]),Jt[Ie].charCodeAt(0)>>8&&(un=!0);de=Jt.join("")}for(Ie=de.length;un===void 0&&Ie!==0;)de.charCodeAt(Ie-1)>>8&&(un=!0),Ie--;if(!un)return de;for(Jt=ve.noBOM?[]:[254,255],Ie=0,Ke=de.length;Ie<Ke;Ie++){if((Ts=(Ln=de.charCodeAt(Ie))>>8)>>8)throw new Error("Character at position "+Ie+" of string '"+de+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Jt.push(Ts),Jt.push(Ln-(Ts<<8))}return String.fromCharCode.apply(void 0,Jt)})(_,q).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},qi=g.__private__.beginPage=function(_){Ve[++dn]=[],Lt[dn]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(_[0]),topRightY:Number(_[1])}},Zh(dn),ot(Ve[j])},Yo=function(_,q){var de,ve,Ie;switch(t=q||t,typeof _=="string"&&(de=w(_.toLowerCase()),Array.isArray(de)&&(ve=de[0],Ie=de[1])),Array.isArray(_)&&(ve=_[0]*en,Ie=_[1]*en),isNaN(ve)&&(ve=r[0],Ie=r[1]),(ve>14400||Ie>14400)&&(xs.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),ve=Math.min(14400,ve),Ie=Math.min(14400,Ie)),r=[ve,Ie],t.substr(0,1)){case"l":Ie>ve&&(r=[Ie,ve]);break;case"p":ve>Ie&&(r=[Ie,ve])}qi(r),qt(Fu),oe(Za),Lc!==0&&oe(Lc+" J"),Cr!==0&&oe(Cr+" j"),On.publish("addPage",{pageNumber:dn})},Yh=function(_){_>0&&_<=dn&&(Ve.splice(_,1),Lt.splice(_,1),dn--,j>dn&&(j=dn),this.setPage(j))},Zh=function(_){_>0&&_<=dn&&(j=_)},Jh=g.__private__.getNumberOfPages=g.getNumberOfPages=function(){return Ve.length-1},Ed=function(_,q,de){var ve,Ie=void 0;return de=de||{},_=_!==void 0?_:Vt[vt].fontName,q=q!==void 0?q:Vt[vt].fontStyle,ve=_.toLowerCase(),Zt[ve]!==void 0&&Zt[ve][q]!==void 0?Ie=Zt[ve][q]:Zt[_]!==void 0&&Zt[_][q]!==void 0?Ie=Zt[_][q]:de.disableWarning===!1&&xs.warn("Unable to look up font label for font '"+_+"', '"+q+"'. Refer to getFontList() for available fonts."),Ie||de.noFallback||(Ie=Zt.times[q])==null&&(Ie=Zt.times.normal),Ie},Xa=g.__private__.putInfo=function(){var _=Ns(),q=function(ve){return ve};for(var de in f!==null&&(q=pr.encryptor(_,0)),oe("<<"),oe("/Producer ("+Ka(q("jsPDF "+Ft.version))+")"),Yt)Yt.hasOwnProperty(de)&&Yt[de]&&oe("/"+de.substr(0,1).toUpperCase()+de.substr(1)+" ("+Ka(q(Yt[de]))+")");oe("/CreationDate ("+Ka(q(ae))+")"),oe(">>"),oe("endobj")},Zo=g.__private__.putCatalog=function(_){var q=(_=_||{}).rootDictionaryObjId||ga;switch(Ns(),oe("<<"),oe("/Type /Catalog"),oe("/Pages "+q+" 0 R"),dt||(dt="fullwidth"),dt){case"fullwidth":oe("/OpenAction [3 0 R /FitH null]");break;case"fullheight":oe("/OpenAction [3 0 R /FitV null]");break;case"fullpage":oe("/OpenAction [3 0 R /Fit]");break;case"original":oe("/OpenAction [3 0 R /XYZ null null 1]");break;default:var de=""+dt;de.substr(de.length-1)==="%"&&(dt=parseInt(dt)/100),typeof dt=="number"&&oe("/OpenAction [3 0 R /XYZ null null "+E(dt)+"]")}switch(tn||(tn="continuous"),tn){case"continuous":oe("/PageLayout /OneColumn");break;case"single":oe("/PageLayout /SinglePage");break;case"two":case"twoleft":oe("/PageLayout /TwoColumnLeft");break;case"tworight":oe("/PageLayout /TwoColumnRight")}Tt&&oe("/PageMode /"+Tt),On.publish("putCatalog"),oe(">>"),oe("endobj")},Hi=g.__private__.putTrailer=function(){oe("trailer"),oe("<<"),oe("/Size "+(ue+1)),oe("/Root "+ue+" 0 R"),oe("/Info "+(ue-1)+" 0 R"),f!==null&&oe("/Encrypt "+pr.oid+" 0 R"),oe("/ID [ <"+W+"> <"+W+"> ]"),oe(">>")},jn=g.__private__.putHeader=function(){oe("%PDF-"+b),oe("%")},Qh=g.__private__.putXRef=function(){var _="0000000000";oe("xref"),oe("0 "+(ue+1)),oe("0000000000 65535 f ");for(var q=1;q<=ue;q++)typeof pe[q]=="function"?oe((_+pe[q]()).slice(-10)+" 00000 n "):pe[q]!==void 0?oe((_+pe[q]).slice(-10)+" 00000 n "):oe("0000000000 00000 n ")},vo=g.__private__.buildDocument=function(){var _;ue=0,Ne=0,Ce=[],pe=[],Le=[],ga=Js(),ts=Js(),ot(Ce),On.publish("buildDocument"),jn(),Vi(),(function(){On.publish("putAdditionalObjects");for(var de=0;de<Le.length;de++){var ve=Le[de];kr(ve.objId,!0),oe(ve.content),oe("endobj")}On.publish("postPutAdditionalObjects")})(),_=[],(function(){for(var de in Vt)Vt.hasOwnProperty(de)&&(d===!1||d===!0&&m.hasOwnProperty(de))&&ji(Vt[de])})(),(function(){var de;for(de in Kt)Kt.hasOwnProperty(de)&&Ou(Kt[de])})(),(function(){for(var de in Jr)Jr.hasOwnProperty(de)&&Gl(Jr[de])})(),(function(de){var ve;for(ve in jt)jt.hasOwnProperty(ve)&&(jt[ve]instanceof Pf?Wi(jt[ve]):jt[ve]instanceof Ep&&Gi(jt[ve],de))})(_),On.publish("putResources"),_.forEach(xo),xo({resourcesOid:ts,objectOid:Number.MAX_SAFE_INTEGER}),On.publish("postPutResources"),f!==null&&(pr.oid=Ns(),oe("<<"),oe("/Filter /Standard"),oe("/V "+pr.v),oe("/R "+pr.r),oe("/U <"+pr.toHexString(pr.U)+">"),oe("/O <"+pr.toHexString(pr.O)+">"),oe("/P "+pr.P),oe(">>"),oe("endobj")),Xa(),Zo();var q=Ne;return Qh(),Hi(),oe("startxref"),oe(""+q),oe("%%EOF"),ot(Ve[j]),Ce.join(`
`)},ql=g.__private__.getBlob=function(_){return new Blob([xt(_)],{type:"application/pdf"})},ef=g.output=g.__private__.output=(qa=function(_,q){switch(typeof(q=q||{})=="string"?q={filename:q}:q.filename=q.filename||"generated.pdf",_){case void 0:return vo();case"save":g.save(q.filename);break;case"arraybuffer":return xt(vo());case"blob":return ql(vo());case"bloburi":case"bloburl":if(an.URL!==void 0&&typeof an.URL.createObjectURL=="function")return an.URL&&an.URL.createObjectURL(ql(vo()))||void 0;xs.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var de="",ve=vo();try{de=U4(ve)}catch{de=U4(unescape(encodeURIComponent(ve)))}return"data:application/pdf;filename="+q.filename+";base64,"+de;case"pdfobjectnewwindow":if(Object.prototype.toString.call(an)==="[object Window]"){var Ie="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Ke=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';q.pdfObjectUrl&&(Ie=q.pdfObjectUrl,Ke="");var nt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Ie+'"'+Ke+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(q)+");<\/script></body></html>",Nt=an.open();return Nt!==null&&Nt.document.write(nt),Nt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(an)==="[object Window]"){var Rt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(q.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+q.filename+'" width="500px" height="400px" /></body></html>',Jt=an.open();if(Jt!==null){Jt.document.write(Rt);var un=this;Jt.document.documentElement.querySelector("#pdfViewer").onload=function(){Jt.document.title=q.filename,Jt.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(un.output("bloburl"))}}return Jt}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(an)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Ln='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",q)+'"></iframe></body></html>',Ts=an.open();if(Ts!==null&&(Ts.document.write(Ln),Ts.document.title=q.filename),Ts||typeof safari>"u")return Ts;break;case"datauri":case"dataurl":return an.document.location.href=this.output("datauristring",q);default:return null}},qa.foo=function(){try{return qa.apply(this,arguments)}catch(de){var _=de.stack||"";~_.indexOf(" at ")&&(_=_.split(" at ")[1]);var q="Error in function "+_.split(`
`)[0].split("<")[0]+": "+de.message;if(!an.console)throw new Error(q);an.console.error(q,de),an.alert&&alert(q)}},qa.foo.bar=qa,qa.foo),ya=function(_){return Array.isArray(Ui)===!0&&Ui.indexOf(_)>-1};switch(s){case"pt":en=1;break;case"mm":en=72/25.4;break;case"cm":en=72/2.54;break;case"in":en=72;break;case"px":en=ya("px_scaling")==1?.75:96/72;break;case"pc":case"em":en=12;break;case"ex":en=6;break;default:if(typeof s!="number")throw new Error("Invalid unit: "+s);en=s}var pr=null;G(),ee();var Qs=g.__private__.getPageInfo=g.getPageInfo=function(_){if(isNaN(_)||_%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Lt[_].objId,pageNumber:_,pageContext:Lt[_]}},Dc=g.__private__.getPageInfoByObjId=function(_){if(isNaN(_)||_%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var q in Lt)if(Lt[q].objId===_)break;return Qs(q)},_d=g.__private__.getCurrentPageInfo=g.getCurrentPageInfo=function(){return{objId:Lt[j].objId,pageNumber:j,pageContext:Lt[j]}};g.addPage=function(){return Yo.apply(this,arguments),this},g.setPage=function(){return Zh.apply(this,arguments),ot.call(this,Ve[j]),this},g.insertPage=function(_){return this.addPage(),this.movePage(j,_),this},g.movePage=function(_,q){var de,ve;if(_>q){de=Ve[_],ve=Lt[_];for(var Ie=_;Ie>q;Ie--)Ve[Ie]=Ve[Ie-1],Lt[Ie]=Lt[Ie-1];Ve[q]=de,Lt[q]=ve,this.setPage(q)}else if(_<q){de=Ve[_],ve=Lt[_];for(var Ke=_;Ke<q;Ke++)Ve[Ke]=Ve[Ke+1],Lt[Ke]=Lt[Ke+1];Ve[q]=de,Lt[q]=ve,this.setPage(q)}return this},g.deletePage=function(){return Yh.apply(this,arguments),this},g.__private__.text=g.text=function(_,q,de,ve,Ie){var Ke,nt,Nt,Rt,Jt,un,Ln,Ts,Gs,us=(ve=ve||{}).scope||this;if(typeof _=="number"&&typeof q=="number"&&(typeof de=="string"||Array.isArray(de))){var mr=de;de=q,q=_,_=mr}if(arguments[3]instanceof Pt==0?(Nt=arguments[4],Rt=arguments[5],as(Ln=arguments[3])==="object"&&Ln!==null||(typeof Nt=="string"&&(Rt=Nt,Nt=null),typeof Ln=="string"&&(Rt=Ln,Ln=null),typeof Ln=="number"&&(Nt=Ln,Ln=null),ve={flags:Ln,angle:Nt,align:Rt})):(D("The transform parameter of text() with a Matrix value"),Gs=Ie),isNaN(q)||isNaN(de)||_==null)throw new Error("Invalid arguments passed to jsPDF.text");if(_.length===0)return us;var er,Mr="",al=typeof ve.lineHeightFactor=="number"?ve.lineHeightFactor:Jo,Yi=us.internal.scaleFactor;function il(Wn){return Wn=Wn.split("	").join(Array(ve.TabLen||9).join(" ")),Ka(Wn,Ln)}function cf(Wn){for(var Fn,cs=Wn.concat(),Hs=[],_o=cs.length;_o--;)typeof(Fn=cs.shift())=="string"?Hs.push(Fn):Array.isArray(Wn)&&(Fn.length===1||Fn[1]===void 0&&Fn[2]===void 0)?Hs.push(Fn[0]):Hs.push([Fn[0],Fn[1],Fn[2]]);return Hs}function Mc(Wn,Fn){var cs;if(typeof Wn=="string")cs=Fn(Wn)[0];else if(Array.isArray(Wn)){for(var Hs,_o,eo=Wn.concat(),ju=[],df=eo.length;df--;)typeof(Hs=eo.shift())=="string"?ju.push(Fn(Hs)[0]):Array.isArray(Hs)&&typeof Hs[0]=="string"&&(_o=Fn(Hs[0],Hs[1],Hs[2]),ju.push([_o[0],_o[1],_o[2]]));cs=ju}return cs}var No=!1,Zi=!0;if(typeof _=="string")No=!0;else if(Array.isArray(_)){var Uu=_.concat();nt=[];for(var ol,Tr=Uu.length;Tr--;)(typeof(ol=Uu.shift())!="string"||Array.isArray(ol)&&typeof ol[0]!="string")&&(Zi=!1);No=Zi}if(No===!1)throw new Error('Type of text must be string or Array. "'+_+'" is not recognized.');typeof _=="string"&&(_=_.match(/[\r?\n]/)?_.split(/\r\n|\r|\n/g):[_]);var Kl=Je/us.internal.scaleFactor,Xl=Kl*(al-1);switch(ve.baseline){case"bottom":de-=Xl;break;case"top":de+=Kl-Xl;break;case"hanging":de+=Kl-2*Xl;break;case"middle":de+=Kl/2-Xl}if((un=ve.maxWidth||0)>0&&(typeof _=="string"?_=us.splitTextToSize(_,un):Object.prototype.toString.call(_)==="[object Array]"&&(_=_.reduce(function(Wn,Fn){return Wn.concat(us.splitTextToSize(Fn,un))},[]))),Ke={text:_,x:q,y:de,options:ve,mutex:{pdfEscape:Ka,activeFontKey:vt,fonts:Vt,activeFontSize:Je}},On.publish("preProcessText",Ke),_=Ke.text,Nt=(ve=Ke.options).angle,Gs instanceof Pt==0&&Nt&&typeof Nt=="number"){Nt*=Math.PI/180,ve.rotationDirection===0&&(Nt=-Nt),A===I&&(Nt=-Nt);var zc=Math.cos(Nt),ko=Math.sin(Nt);Gs=new Pt(zc,ko,-ko,zc,0,0)}else Nt&&Nt instanceof Pt&&(Gs=Nt);A!==I||Gs||(Gs=bo),(Jt=ve.charSpace||pi)!==void 0&&(Mr+=P(K(Jt))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Ts=ve.horizontalScale)!==void 0&&(Mr+=P(100*Ts)+` Tz
`),ve.lang;var xa=-1,ll=ve.renderingMode!==void 0?ve.renderingMode:ve.stroke,Pc=us.internal.getCurrentPageInfo().pageContext;switch(ll){case 0:case!1:case"fill":xa=0;break;case 1:case!0:case"stroke":xa=1;break;case 2:case"fillThenStroke":xa=2;break;case 3:case"invisible":xa=3;break;case 4:case"fillAndAddForClipping":xa=4;break;case 5:case"strokeAndAddPathForClipping":xa=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":xa=6;break;case 7:case"addToPathForClipping":xa=7}var hf=Pc.usedRenderingMode!==void 0?Pc.usedRenderingMode:-1;xa!==-1?Mr+=xa+` Tr
`:hf!==-1&&(Mr+=`0 Tr
`),xa!==-1&&(Pc.usedRenderingMode=xa),Rt=ve.align||"left";var Ja,Ji=Je*al,ul=us.internal.pageSize.getWidth(),ff=Vt[vt];Jt=ve.charSpace||pi,un=ve.maxWidth||0,Ln=Object.assign({autoencode:!0,noBOM:!0},ve.flags);var Qi=[],Yl=function(Wn){return us.getStringUnitWidth(Wn,{font:ff,charSpace:Jt,fontSize:Je,doKerning:!1})*Je/Yi};if(Object.prototype.toString.call(_)==="[object Array]"){var _a;nt=cf(_),Rt!=="left"&&(Ja=nt.map(Yl));var va,Co=0;if(Rt==="right"){q-=Ja[0],_=[],Tr=nt.length;for(var To=0;To<Tr;To++)To===0?(va=Ya(q),_a=Fr(de)):(va=K(Co-Ja[To]),_a=-Ji),_.push([nt[To],va,_a]),Co=Ja[To]}else if(Rt==="center"){q-=Ja[0]/2,_=[],Tr=nt.length;for(var cl=0;cl<Tr;cl++)cl===0?(va=Ya(q),_a=Fr(de)):(va=K((Co-Ja[cl])/2),_a=-Ji),_.push([nt[cl],va,_a]),Co=Ja[cl]}else if(Rt==="left"){_=[],Tr=nt.length;for(var Bc=0;Bc<Tr;Bc++)_.push(nt[Bc])}else if(Rt==="justify"&&ff.encoding==="Identity-H"){_=[],Tr=nt.length,un=un!==0?un:ul;for(var Uc=0,qs=0;qs<Tr;qs++)if(_a=qs===0?Fr(de):-Ji,va=qs===0?Ya(q):Uc,qs<Tr-1){var Pd=K((un-Ja[qs])/(nt[qs].split(" ").length-1)),Ao=nt[qs].split(" ");_.push([Ao[0]+" ",va,_a]),Uc=0;for(var Io=1;Io<Ao.length;Io++){var zr=(Yl(Ao[Io-1]+" "+Ao[Io])-Yl(Ao[Io]))*Yi+Pd;Io==Ao.length-1?_.push([Ao[Io],zr,0]):_.push([Ao[Io]+" ",zr,0]),Uc-=zr}}else _.push([nt[qs],va,_a]);_.push(["",Uc,0])}else{if(Rt!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(_=[],Tr=nt.length,un=un!==0?un:ul,qs=0;qs<Tr;qs++){_a=qs===0?Fr(de):-Ji,va=qs===0?Ya(q):0;var hl=nt[qs].split(" ").length-1,Vc=hl>0?(un-Ja[qs])/hl:0;qs<Tr-1?Qi.push(P(K(Vc))):Qi.push(0),_.push([nt[qs],va,_a])}}}(typeof ve.R2L=="boolean"?ve.R2L:bt)===!0&&(_=Mc(_,function(Wn,Fn,cs){return[Wn.split("").reverse().join(""),Fn,cs]})),Ke={text:_,x:q,y:de,options:ve,mutex:{pdfEscape:Ka,activeFontKey:vt,fonts:Vt,activeFontSize:Je}},On.publish("postProcessText",Ke),_=Ke.text,er=Ke.mutex.isHex||!1;var jc=Vt[vt].encoding;jc!=="WinAnsiEncoding"&&jc!=="StandardEncoding"||(_=Mc(_,function(Wn,Fn,cs){return[il(Wn),Fn,cs]})),nt=cf(_),_=[];for(var fl,dl,Eo,Vu=Array.isArray(nt[0])?1:0,Qa="",pl=function(Wn,Fn,cs){var Hs="";return cs instanceof Pt?(cs=typeof ve.angle=="number"?Xo(cs,new Pt(1,0,0,1,Wn,Fn)):Xo(new Pt(1,0,0,1,Wn,Fn),cs),A===I&&(cs=Xo(new Pt(1,0,0,-1,0,0),cs)),Hs=cs.join(" ")+` Tm
`):Hs=P(Wn)+" "+P(Fn)+` Td
`,Hs},ea=0;ea<nt.length;ea++){switch(Qa="",Vu){case 1:Eo=(er?"<":"(")+nt[ea][0]+(er?">":")"),fl=parseFloat(nt[ea][1]),dl=parseFloat(nt[ea][2]);break;case 0:Eo=(er?"<":"(")+nt[ea]+(er?">":")"),fl=Ya(q),dl=Fr(de)}Qi!==void 0&&Qi[ea]!==void 0&&(Qa=Qi[ea]+` Tw
`),ea===0?_.push(Qa+pl(fl,dl,Gs)+Eo):Vu===0?_.push(Qa+Eo):Vu===1&&_.push(Qa+pl(fl,dl,Gs)+Eo)}_=Vu===0?_.join(` Tj
T* `):_.join(` Tj
`),_+=` Tj
`;var gi=`BT
/`;return gi+=vt+" "+Je+` Tf
`,gi+=P(Je*al)+` TL
`,gi+=wo+`
`,gi+=Mr,gi+=_,oe(gi+="ET"),m[vt]=!0,us};var tf=g.__private__.clip=g.clip=function(_){return oe(_==="evenodd"?"W*":"W"),this};g.clipEvenOdd=function(){return tf("evenodd")},g.__private__.discardPath=g.discardPath=function(){return oe("n"),this};var ba=g.__private__.isValidStyle=function(_){var q=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(_)!==-1&&(q=!0),q};g.__private__.setDefaultPathOperation=g.setDefaultPathOperation=function(_){return ba(_)&&(c=_),this};var nf=g.__private__.getStyle=g.getStyle=function(_){var q=c;switch(_){case"D":case"S":q="S";break;case"F":q="f";break;case"FD":case"DF":q="B";break;case"f":case"f*":case"B":case"B*":q=_}return q},sf=g.close=function(){return oe("h"),this};g.stroke=function(){return oe("S"),this},g.fill=function(_){return Ki("f",_),this},g.fillEvenOdd=function(_){return Ki("f*",_),this},g.fillStroke=function(_){return Ki("B",_),this},g.fillStrokeEvenOdd=function(_){return Ki("B*",_),this};var Ki=function(_,q){as(q)==="object"?Rd(q,_):oe(_)},Lu=function(_){_===null||A===I&&_===void 0||(_=nf(_),oe(_))};function $d(_,q,de,ve,Ie){var Ke=new Ep(q||this.boundingBox,de||this.xStep,ve||this.yStep,this.gState,Ie||this.matrix);Ke.stream=this.stream;var nt=_+"$$"+this.cloneIndex+++"$$";return Ga(nt,Ke),Ke}var Rd=function(_,q){var de=ls[_.key],ve=jt[de];if(ve instanceof Pf)oe("q"),oe(rf(q)),ve.gState&&g.setGState(ve.gState),oe(_.matrix.toString()+" cm"),oe("/"+de+" sh"),oe("Q");else if(ve instanceof Ep){var Ie=new Pt(1,0,0,-1,0,rl());_.matrix&&(Ie=Ie.multiply(_.matrix||bo),de=$d.call(ve,_.key,_.boundingBox,_.xStep,_.yStep,Ie).id),oe("q"),oe("/Pattern cs"),oe("/"+de+" scn"),ve.gState&&g.setGState(ve.gState),oe(q),oe("Q")}},rf=function(_){switch(_){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},af=g.moveTo=function(_,q){return oe(P(K(_))+" "+P(X(q))+" m"),this},Dd=g.lineTo=function(_,q){return oe(P(K(_))+" "+P(X(q))+" l"),this},Ea=g.curveTo=function(_,q,de,ve,Ie,Ke){return oe([P(K(_)),P(X(q)),P(K(de)),P(X(ve)),P(K(Ie)),P(X(Ke)),"c"].join(" ")),this};g.__private__.line=g.line=function(_,q,de,ve,Ie){if(isNaN(_)||isNaN(q)||isNaN(de)||isNaN(ve)||!ba(Ie))throw new Error("Invalid arguments passed to jsPDF.line");return A===k?this.lines([[de-_,ve-q]],_,q,[1,1],Ie||"S"):this.lines([[de-_,ve-q]],_,q,[1,1]).stroke()},g.__private__.lines=g.lines=function(_,q,de,ve,Ie,Ke){var nt,Nt,Rt,Jt,un,Ln,Ts,Gs,us,mr,er,Mr;if(typeof _=="number"&&(Mr=de,de=q,q=_,_=Mr),ve=ve||[1,1],Ke=Ke||!1,isNaN(q)||isNaN(de)||!Array.isArray(_)||!Array.isArray(ve)||!ba(Ie)||typeof Ke!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(af(q,de),nt=ve[0],Nt=ve[1],Jt=_.length,mr=q,er=de,Rt=0;Rt<Jt;Rt++)(un=_[Rt]).length===2?(mr=un[0]*nt+mr,er=un[1]*Nt+er,Dd(mr,er)):(Ln=un[0]*nt+mr,Ts=un[1]*Nt+er,Gs=un[2]*nt+mr,us=un[3]*Nt+er,mr=un[4]*nt+mr,er=un[5]*Nt+er,Ea(Ln,Ts,Gs,us,mr,er));return Ke&&sf(),Lu(Ie),this},g.path=function(_){for(var q=0;q<_.length;q++){var de=_[q],ve=de.c;switch(de.op){case"m":af(ve[0],ve[1]);break;case"l":Dd(ve[0],ve[1]);break;case"c":Ea.apply(this,ve);break;case"h":sf()}}return this},g.__private__.rect=g.rect=function(_,q,de,ve,Ie){if(isNaN(_)||isNaN(q)||isNaN(de)||isNaN(ve)||!ba(Ie))throw new Error("Invalid arguments passed to jsPDF.rect");return A===k&&(ve=-ve),oe([P(K(_)),P(X(q)),P(K(de)),P(K(ve)),"re"].join(" ")),Lu(Ie),this},g.__private__.triangle=g.triangle=function(_,q,de,ve,Ie,Ke,nt){if(isNaN(_)||isNaN(q)||isNaN(de)||isNaN(ve)||isNaN(Ie)||isNaN(Ke)||!ba(nt))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[de-_,ve-q],[Ie-de,Ke-ve],[_-Ie,q-Ke]],_,q,[1,1],nt,!0),this},g.__private__.roundedRect=g.roundedRect=function(_,q,de,ve,Ie,Ke,nt){if(isNaN(_)||isNaN(q)||isNaN(de)||isNaN(ve)||isNaN(Ie)||isNaN(Ke)||!ba(nt))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Nt=4/3*(Math.SQRT2-1);return Ie=Math.min(Ie,.5*de),Ke=Math.min(Ke,.5*ve),this.lines([[de-2*Ie,0],[Ie*Nt,0,Ie,Ke-Ke*Nt,Ie,Ke],[0,ve-2*Ke],[0,Ke*Nt,-Ie*Nt,Ke,-Ie,Ke],[2*Ie-de,0],[-Ie*Nt,0,-Ie,-Ke*Nt,-Ie,-Ke],[0,2*Ke-ve],[0,-Ke*Nt,Ie*Nt,-Ke,Ie,-Ke]],_+Ie,q,[1,1],nt,!0),this},g.__private__.ellipse=g.ellipse=function(_,q,de,ve,Ie){if(isNaN(_)||isNaN(q)||isNaN(de)||isNaN(ve)||!ba(Ie))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Ke=4/3*(Math.SQRT2-1)*de,nt=4/3*(Math.SQRT2-1)*ve;return af(_+de,q),Ea(_+de,q-nt,_+Ke,q-ve,_,q-ve),Ea(_-Ke,q-ve,_-de,q-nt,_-de,q),Ea(_-de,q+nt,_-Ke,q+ve,_,q+ve),Ea(_+Ke,q+ve,_+de,q+nt,_+de,q),Lu(Ie),this},g.__private__.circle=g.circle=function(_,q,de,ve){if(isNaN(_)||isNaN(q)||isNaN(de)||!ba(ve))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(_,q,de,de,ve)},g.setFont=function(_,q,de){return de&&(q=V(q,de)),vt=Ed(_,q,{disableWarning:!1}),this};var Xi=g.__private__.getFont=g.getFont=function(){return Vt[Ed.apply(g,arguments)]};g.__private__.getFontList=g.getFontList=function(){var _,q,de={};for(_ in Zt)if(Zt.hasOwnProperty(_))for(q in de[_]=[],Zt[_])Zt[_].hasOwnProperty(q)&&de[_].push(q);return de},g.addFont=function(_,q,de,ve,Ie){var Ke=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Ke.indexOf(arguments[3])!==-1?Ie=arguments[3]:arguments[3]&&Ke.indexOf(arguments[3])==-1&&(de=V(de,ve)),Xh.call(this,_,q,de,Ie=Ie||"Identity-H")};var Jo,Fu=n.lineWidth||.200025,Hl=g.__private__.getLineWidth=g.getLineWidth=function(){return Fu},qt=g.__private__.setLineWidth=g.setLineWidth=function(_){return Fu=_,oe(P(K(_))+" w"),this};g.__private__.setLineDash=Ft.API.setLineDash=Ft.API.setLineDashPattern=function(_,q){if(_=_||[],q=q||0,isNaN(q)||!Array.isArray(_))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return _=_.map(function(de){return P(K(de))}).join(" "),q=P(K(q)),oe("["+_+"] "+q+" d"),this};var Od=g.__private__.getLineHeight=g.getLineHeight=function(){return Je*Jo};g.__private__.getLineHeight=g.getLineHeight=function(){return Je*Jo};var of=g.__private__.setLineHeightFactor=g.setLineHeightFactor=function(_){return typeof(_=_||1.15)=="number"&&(Jo=_),this},Ld=g.__private__.getLineHeightFactor=g.getLineHeightFactor=function(){return Jo};of(n.lineHeight);var Ya=g.__private__.getHorizontalCoordinate=function(_){return K(_)},Fr=g.__private__.getVerticalCoordinate=function(_){return A===I?_:Lt[j].mediaBox.topRightY-Lt[j].mediaBox.bottomLeftY-K(_)},lf=g.__private__.getHorizontalCoordinateString=g.getHorizontalCoordinateString=function(_){return P(Ya(_))},Mu=g.__private__.getVerticalCoordinateString=g.getVerticalCoordinateString=function(_){return P(Fr(_))},Za=n.strokeColor||"0 G";g.__private__.getStrokeColor=g.getDrawColor=function(){return Cs(Za)},g.__private__.setStrokeColor=g.setDrawColor=function(_,q,de,ve){return Za=Qr({ch1:_,ch2:q,ch3:de,ch4:ve,pdfColorType:"draw",precision:2}),oe(Za),this};var zu=n.fillColor||"0 g";g.__private__.getFillColor=g.getFillColor=function(){return Cs(zu)},g.__private__.setFillColor=g.setFillColor=function(_,q,de,ve){return zu=Qr({ch1:_,ch2:q,ch3:de,ch4:ve,pdfColorType:"fill",precision:2}),oe(zu),this};var wo=n.textColor||"0 g",Fd=g.__private__.getTextColor=g.getTextColor=function(){return Cs(wo)};g.__private__.setTextColor=g.setTextColor=function(_,q,de,ve){return wo=Qr({ch1:_,ch2:q,ch3:de,ch4:ve,pdfColorType:"text",precision:3}),this};var pi=n.charSpace,Oc=g.__private__.getCharSpace=g.getCharSpace=function(){return parseFloat(pi||0)};g.__private__.setCharSpace=g.setCharSpace=function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return pi=_,this};var Lc=0;g.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},g.__private__.setLineCap=g.setLineCap=function(_){var q=g.CapJoinStyles[_];if(q===void 0)throw new Error("Line cap style of '"+_+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Lc=q,oe(q+" J"),this};var Cr=0;g.__private__.setLineJoin=g.setLineJoin=function(_){var q=g.CapJoinStyles[_];if(q===void 0)throw new Error("Line join style of '"+_+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Cr=q,oe(q+" j"),this},g.__private__.setLineMiterLimit=g.__private__.setMiterLimit=g.setLineMiterLimit=g.setMiterLimit=function(_){if(_=_||0,isNaN(_))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return oe(P(K(_))+" M"),this},g.GState=jb,g.setGState=function(_){(_=typeof _=="string"?Kt[nn[_]]:So(null,_)).equals(es)||(oe("/"+_.id+" gs"),es=_)};var So=function(_,q){if(!_||!nn[_]){var de=!1;for(var ve in Kt)if(Kt.hasOwnProperty(ve)&&Kt[ve].equals(q)){de=!0;break}if(de)q=Kt[ve];else{var Ie="GS"+(Object.keys(Kt).length+1).toString(10);Kt[Ie]=q,q.id=Ie}return _&&(nn[_]=q.id),On.publish("addGState",q),q}};g.addGState=function(_,q){return So(_,q),this},g.saveGraphicsState=function(){return oe("q"),kn.push({key:vt,size:Je,color:wo}),this},g.restoreGraphicsState=function(){oe("Q");var _=kn.pop();return vt=_.key,Je=_.size,wo=_.color,es=null,this},g.setCurrentTransformationMatrix=function(_){return oe(_.toString()+" cm"),this},g.comment=function(_){return oe("#"+_),this};var mi=function(_,q){var de=_||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return de},set:function(Ke){isNaN(Ke)||(de=parseFloat(Ke))}});var ve=q||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return ve},set:function(Ke){isNaN(Ke)||(ve=parseFloat(Ke))}});var Ie="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Ie},set:function(Ke){Ie=Ke.toString()}}),this},Qo=function(_,q,de,ve){mi.call(this,_,q),this.type="rect";var Ie=de||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Ie},set:function(nt){isNaN(nt)||(Ie=parseFloat(nt))}});var Ke=ve||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Ke},set:function(nt){isNaN(nt)||(Ke=parseFloat(nt))}}),this},Fc=function(){this.page=dn,this.currentPage=j,this.pages=Ve.slice(0),this.pagesContext=Lt.slice(0),this.x=_t,this.y=ks,this.matrix=ln,this.width=tl(j),this.height=uf(j),this.outputDestination=at,this.id="",this.objectNumber=-1};Fc.prototype.restore=function(){dn=this.page,j=this.currentPage,Lt=this.pagesContext,Ve=this.pages,_t=this.x,ks=this.y,ln=this.matrix,Bu(j,this.width),nl(j,this.height),at=this.outputDestination};var Pu=function(_,q,de,ve,Ie){fi.push(new Fc),dn=j=0,Ve=[],_t=_,ks=q,ln=Ie,qi([de,ve])};for(var el in g.beginFormObject=function(_,q,de,ve,Ie){return Pu(_,q,de,ve,Ie),this},g.endFormObject=function(_){return(function(q){if(yo[q])fi.pop().restore();else{var de=new Fc,ve="Xo"+(Object.keys(Jr).length+1).toString(10);de.id=ve,yo[q]=ve,Jr[ve]=de,On.publish("addFormObject",de),fi.pop().restore()}})(_),this},g.doFormObject=function(_,q){var de=Jr[yo[_]];return oe("q"),oe(q.toString()+" cm"),oe("/"+de.id+" Do"),oe("Q"),this},g.getFormObject=function(_){var q=Jr[yo[_]];return{x:q.x,y:q.y,width:q.width,height:q.height,matrix:q.matrix}},g.save=function(_,q){return _=_||"generated.pdf",(q=q||{}).returnPromise=q.returnPromise||!1,q.returnPromise===!1?(Df(ql(vo()),_),typeof Df.unload=="function"&&an.setTimeout&&setTimeout(Df.unload,911),this):new Promise(function(de,ve){try{var Ie=Df(ql(vo()),_);typeof Df.unload=="function"&&an.setTimeout&&setTimeout(Df.unload,911),de(Ie)}catch(Ke){ve(Ke.message)}})},Ft.API)Ft.API.hasOwnProperty(el)&&(el==="events"&&Ft.API.events.length?(function(_,q){var de,ve,Ie;for(Ie=q.length-1;Ie!==-1;Ie--)de=q[Ie][0],ve=q[Ie][1],_.subscribe.apply(_,[de].concat(typeof ve=="function"?[ve]:ve))})(On,Ft.API.events):g[el]=Ft.API[el]);function tl(_){return Lt[_].mediaBox.topRightX-Lt[_].mediaBox.bottomLeftX}function Bu(_,q){Lt[_].mediaBox.topRightX=q+Lt[_].mediaBox.bottomLeftX}function uf(_){return Lt[_].mediaBox.topRightY-Lt[_].mediaBox.bottomLeftY}function nl(_,q){Lt[_].mediaBox.topRightY=q+Lt[_].mediaBox.bottomLeftY}var sl=g.getPageWidth=function(_){return tl(_=_||j)/en},Md=g.setPageWidth=function(_,q){Bu(_,q*en)},rl=g.getPageHeight=function(_){return uf(_=_||j)/en},zd=g.setPageHeight=function(_,q){nl(_,q*en)};return g.internal={pdfEscape:Ka,getStyle:nf,getFont:Xi,getFontSize:ft,getCharSpace:Oc,getTextColor:Fd,getLineHeight:Od,getLineHeightFactor:Ld,getLineWidth:Hl,write:tt,getHorizontalCoordinate:Ya,getVerticalCoordinate:Fr,getCoordinateString:lf,getVerticalCoordinateString:Mu,collections:{},newObject:Ns,newAdditionalObject:Wl,newObjectDeferred:Js,newObjectDeferredBegin:kr,getFilters:Ha,putStream:di,events:On,scaleFactor:en,pageSize:{getWidth:function(){return sl(j)},setWidth:function(_){Md(j,_)},getHeight:function(){return rl(j)},setHeight:function(_){zd(j,_)}},encryptionOptions:f,encryption:pr,getEncryptor:function(_){return f!==null?pr.encryptor(_,0):function(q){return q}},output:ef,getNumberOfPages:Jh,get pages(){return Ve},out:oe,f2:E,f3:M,getPageInfo:Qs,getPageInfoByObjId:Dc,getCurrentPageInfo:_d,getPDFVersion:x,Point:mi,Rectangle:Qo,Matrix:Pt,hasHotfix:ya},Object.defineProperty(g.internal.pageSize,"width",{get:function(){return sl(j)},set:function(_){Md(j,_)},enumerable:!0,configurable:!0}),Object.defineProperty(g.internal.pageSize,"height",{get:function(){return rl(j)},set:function(_){zd(j,_)},enumerable:!0,configurable:!0}),(function(_){for(var q=0,de=ht.length;q<de;q++){var ve=Xh.call(this,_[q][0],_[q][1],_[q][2],ht[q][3],!0);d===!1&&(m[ve]=!0);var Ie=_[q][0].split("-");Ws({id:ve,fontName:Ie[0],fontStyle:Ie[1]||""})}On.publish("addFonts",{fonts:Vt,dictionary:Zt})}).call(g,ht),vt="F1",Yo(r,t),On.publish("initialized"),g}Ap.prototype.lsbFirstWord=function(n){return String.fromCharCode(255&n,n>>8&255,n>>16&255,n>>24&255)},Ap.prototype.toHexString=function(n){return n.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Ap.prototype.hexToBytes=function(n){for(var e=[],t=0;t<n.length;t+=2)e.push(String.fromCharCode(parseInt(n.substr(t,2),16)));return e.join("")},Ap.prototype.processOwnerPassword=function(n,e){return kN(NN(e).substr(0,5),n)},Ap.prototype.encryptor=function(n,e){var t=NN(this.encryptionKey+String.fromCharCode(255&n,n>>8&255,n>>16&255,255&e,e>>8&255)).substr(0,10);return function(s){return kN(t,s)}},jb.prototype.equals=function(n){var e,t="id,objectNumber,equals";if(!n||as(n)!==as(this))return!1;var s=0;for(e in this)if(!(t.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!n.hasOwnProperty(e)||this[e]!==n[e])return!1;s++}for(e in n)n.hasOwnProperty(e)&&t.indexOf(e)<0&&s--;return s===0},Ft.API={events:[]},Ft.version="3.0.4";var or=Ft.API,CC=1,Id=function(n){return n.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Sp=function(n){return n.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},fn=function(n){return n.toFixed(2)},mh=function(n){return n.toFixed(5)};or.__acroform__={};var Bi=function(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n},G4=function(n){return n*CC},hu=function(n){var e=new g8,t=It.internal.getHeight(n)||0,s=It.internal.getWidth(n)||0;return e.BBox=[0,0,Number(fn(s)),Number(fn(t))],e},y0e=or.__acroform__.setBit=function(n,e){if(n=n||0,e=e||0,isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return n|1<<e},b0e=or.__acroform__.clearBit=function(n,e){if(n=n||0,e=e||0,isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return n&~(1<<e)},x0e=or.__acroform__.getBit=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return n&1<<e?1:0},xr=or.__acroform__.getBitForPdf=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return x0e(n,e-1)},vr=or.__acroform__.setBitForPdf=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return y0e(n,e-1)},wr=or.__acroform__.clearBitForPdf=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return b0e(n,e-1)},v0e=or.__acroform__.calculateCoordinates=function(n,e){var t=e.internal.getHorizontalCoordinate,s=e.internal.getVerticalCoordinate,r=n[0],a=n[1],i=n[2],o=n[3],l={};return l.lowerLeft_X=t(r)||0,l.lowerLeft_Y=s(a+o)||0,l.upperRight_X=t(r+i)||0,l.upperRight_Y=s(a)||0,[Number(fn(l.lowerLeft_X)),Number(fn(l.lowerLeft_Y)),Number(fn(l.upperRight_X)),Number(fn(l.upperRight_Y))]},w0e=function(n){if(n.appearanceStreamContent)return n.appearanceStreamContent;if(n.V||n.DV){var e=[],t=n._V||n.DV,s=CN(n,t),r=n.scope.internal.getFont(n.fontName,n.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(n.scope.__private__.encodeColorString(n.color)),e.push("/"+r+" "+fn(s.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(s.text),e.push("ET"),e.push("Q"),e.push("EMC");var a=hu(n);return a.scope=n.scope,a.stream=e.join(`
`),a}},CN=function(n,e){var t=n.fontSize===0?n.maxFontSize:n.fontSize,s={text:"",fontSize:""},r=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");r=n.multiline?r.map(function(E){return E.split(`
`)}):r.map(function(E){return[E]});var a=t,i=It.internal.getHeight(n)||0;i=i<0?-i:i;var o=It.internal.getWidth(n)||0;o=o<0?-o:o;var l=function(E,M,K){if(E+1<r.length){var X=M+" "+r[E+1][0];return B2(X,n,K).width<=o-4}return!1};a++;e:for(;a>0;){e="",a--;var c,f,d=B2("3",n,a).height,m=n.multiline?i-a:(i-d)/2,g=m+=2,b=0,x=0,v=0;if(a<=0){e=`(...) Tj
`,e+="% Width of Text: "+B2(e,n,a=12).width+", FieldWidth:"+o+`
`;break}for(var w="",k=0,I=0;I<r.length;I++)if(r.hasOwnProperty(I)){var A=!1;if(r[I].length!==1&&v!==r[I].length-1){if((d+2)*(k+2)+2>i)continue e;w+=r[I][v],A=!0,x=I,I--}else{w=(w+=r[I][v]+" ").substr(w.length-1)==" "?w.substr(0,w.length-1):w;var R=parseInt(I),U=l(R,w,a),V=I>=r.length-1;if(U&&!V){w+=" ",v=0;continue}if(U||V){if(V)x=R;else if(n.multiline&&(d+2)*(k+2)+2>i)continue e}else{if(!n.multiline||(d+2)*(k+2)+2>i)continue e;x=R}}for(var P="",D=b;D<=x;D++){var B=r[D];if(n.multiline){if(D===x){P+=B[v]+" ",v=(v+1)%B.length;continue}if(D===b){P+=B[B.length-1]+" ";continue}}P+=B[0]+" "}switch(P=P.substr(P.length-1)==" "?P.substr(0,P.length-1):P,f=B2(P,n,a).width,n.textAlign){case"right":c=o-f-2;break;case"center":c=(o-f)/2;break;default:c=2}e+=fn(c)+" "+fn(g)+` Td
`,e+="("+Id(P)+`) Tj
`,e+=-fn(c)+` 0 Td
`,g=-(a+2),f=0,b=A?x:x+1,k++,w=""}break}return s.text=e,s.fontSize=a,s},B2=function(n,e,t){var s=e.scope.internal.getFont(e.fontName,e.fontStyle),r=e.scope.getStringUnitWidth(n,{font:s,fontSize:parseFloat(t),charSpace:0})*parseFloat(t);return{height:e.scope.getStringUnitWidth("3",{font:s,fontSize:parseFloat(t),charSpace:0})*parseFloat(t)*1.5,width:r}},S0e={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},N0e=function(n,e){var t={type:"reference",object:n};e.internal.getPageInfo(n.page).pageContext.annotations.find(function(s){return s.type===t.type&&s.object===t.object})===void 0&&e.internal.getPageInfo(n.page).pageContext.annotations.push(t)},k0e=function(n,e){if(e.scope=n,n.internal!==void 0&&(n.internal.acroformPlugin===void 0||n.internal.acroformPlugin.isInitialized===!1)){if(Vl.FieldNum=0,n.internal.acroformPlugin=JSON.parse(JSON.stringify(S0e)),n.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");CC=n.internal.scaleFactor,n.internal.acroformPlugin.acroFormDictionaryRoot=new y8,n.internal.acroformPlugin.acroFormDictionaryRoot.scope=n,n.internal.acroformPlugin.acroFormDictionaryRoot._eventID=n.internal.events.subscribe("postPutResources",function(){(function(t){t.internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0})(n)}),n.internal.events.subscribe("buildDocument",function(){(function(t){t.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var s=t.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var r in s)if(s.hasOwnProperty(r)){var a=s[r];a.objId=void 0,a.hasAnnotation&&N0e(a,t)}})(n)}),n.internal.events.subscribe("putCatalog",function(){(function(t){if(t.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");t.internal.write("/AcroForm "+t.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(n)}),n.internal.events.subscribe("postPutPages",function(t){(function(s,r){var a=!s;for(var i in s||(r.internal.newObjectDeferredBegin(r.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),r.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),s=s||r.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(s.hasOwnProperty(i)){var o=s[i],l=[],c=o.Rect;if(o.Rect&&(o.Rect=v0e(o.Rect,r)),r.internal.newObjectDeferredBegin(o.objId,!0),o.DA=It.createDefaultAppearanceStream(o),as(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(l=o.getKeyValueListForStream()),o.Rect=c,o.hasAppearanceStream&&!o.appearanceStreamContent){var f=w0e(o);l.push({key:"AP",value:"<</N "+f+">>"}),r.internal.acroformPlugin.xForms.push(f)}if(o.appearanceStreamContent){var d="";for(var m in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(m)){var g=o.appearanceStreamContent[m];if(d+="/"+m+" ",d+="<<",Object.keys(g).length>=1||Array.isArray(g)){for(var i in g)if(g.hasOwnProperty(i)){var b=g[i];typeof b=="function"&&(b=b.call(r,o)),d+="/"+i+" "+b+" ",r.internal.acroformPlugin.xForms.indexOf(b)>=0||r.internal.acroformPlugin.xForms.push(b)}}else typeof(b=g)=="function"&&(b=b.call(r,o)),d+="/"+i+" "+b,r.internal.acroformPlugin.xForms.indexOf(b)>=0||r.internal.acroformPlugin.xForms.push(b);d+=">>"}l.push({key:"AP",value:`<<
`+d+">>"})}r.internal.putStream({additionalKeyValues:l,objectId:o.objId}),r.internal.out("endobj")}a&&(function(x,v){for(var w in x)if(x.hasOwnProperty(w)){var k=w,I=x[w];v.internal.newObjectDeferredBegin(I.objId,!0),as(I)==="object"&&typeof I.putStream=="function"&&I.putStream(),delete x[k]}})(r.internal.acroformPlugin.xForms,r)})(t,n)}),n.internal.acroformPlugin.isInitialized=!0}},m8=or.__acroform__.arrayToPdfArray=function(n,e,t){var s=function(i){return i};if(Array.isArray(n)){for(var r="[",a=0;a<n.length;a++)switch(a!==0&&(r+=" "),as(n[a])){case"boolean":case"number":case"object":r+=n[a].toString();break;case"string":n[a].substr(0,1)!=="/"?(e!==void 0&&t&&(s=t.internal.getEncryptor(e)),r+="("+Id(s(n[a].toString()))+")"):r+=n[a].toString()}return r+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},pS=function(n,e,t){var s=function(r){return r};return e!==void 0&&t&&(s=t.internal.getEncryptor(e)),(n=n||"").toString(),"("+Id(s(n))+")"},yu=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(n){this._objId=n}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};yu.prototype.toString=function(){return this.objId+" 0 R"},yu.prototype.putStream=function(){var n=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:n,objectId:this.objId}),this.scope.internal.out("endobj")},yu.prototype.getKeyValueListForStream=function(){var n=[],e=Object.getOwnPropertyNames(this).filter(function(a){return a!="content"&&a!="appearanceStreamContent"&&a!="scope"&&a!="objId"&&a.substring(0,1)!="_"});for(var t in e)if(Object.getOwnPropertyDescriptor(this,e[t]).configurable===!1){var s=e[t],r=this[s];r&&(Array.isArray(r)?n.push({key:s,value:m8(r,this.objId,this.scope)}):r instanceof yu?(r.scope=this.scope,n.push({key:s,value:r.objId+" 0 R"})):typeof r!="function"&&n.push({key:s,value:r}))}return n};var g8=function(){yu.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var n,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){n=t.trim()},get:function(){return n||null}})};Bi(g8,yu);var y8=function(){yu.call(this);var n,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(n){var t=function(s){return s};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+Id(t(n))+")"}},set:function(t){n=t}})};Bi(y8,yu);var Vl=function n(){yu.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(w){if(isNaN(w))throw new Error('Invalid value "'+w+'" for attribute F supplied.');e=w}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!xr(e,3)},set:function(w){w?this.F=vr(e,3):this.F=wr(e,3)}});var t=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return t},set:function(w){if(isNaN(w))throw new Error('Invalid value "'+w+'" for attribute Ff supplied.');t=w}});var s=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(s.length!==0)return s},set:function(w){s=w!==void 0?w:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[0])?0:s[0]},set:function(w){s[0]=w}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[1])?0:s[1]},set:function(w){s[1]=w}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[2])?0:s[2]},set:function(w){s[2]=w}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[3])?0:s[3]},set:function(w){s[3]=w}});var r="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return r},set:function(w){switch(w){case"/Btn":case"/Tx":case"/Ch":case"/Sig":r=w;break;default:throw new Error('Invalid value "'+w+'" for attribute FT supplied.')}}});var a=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!a||a.length<1){if(this instanceof Wb)return;a="FieldObject"+n.FieldNum++}var w=function(k){return k};return this.scope&&(w=this.scope.internal.getEncryptor(this.objId)),"("+Id(w(a))+")"},set:function(w){a=w.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return a},set:function(w){a=w}});var i="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return i},set:function(w){i=w}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(w){o=w}});var l=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return l},set:function(w){l=w}});var c=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return c===void 0?50/CC:c},set:function(w){c=w}});var f="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return f},set:function(w){f=w}});var d="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!d||this instanceof Wb||this instanceof Kf))return pS(d,this.objId,this.scope)},set:function(w){w=w.toString(),d=w}});var m=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(m)return this instanceof ia==0?pS(m,this.objId,this.scope):m},set:function(w){w=w.toString(),m=this instanceof ia==0?w.substr(0,1)==="("?Sp(w.substr(1,w.length-2)):Sp(w):w}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof ia==1?Sp(m.substr(1,m.length-1)):m},set:function(w){w=w.toString(),m=this instanceof ia==1?"/"+w:w}});var g=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(g)return g},set:function(w){this.V=w}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(g)return this instanceof ia==0?pS(g,this.objId,this.scope):g},set:function(w){w=w.toString(),g=this instanceof ia==0?w.substr(0,1)==="("?Sp(w.substr(1,w.length-2)):Sp(w):w}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof ia==1?Sp(g.substr(1,g.length-1)):g},set:function(w){w=w.toString(),g=this instanceof ia==1?"/"+w:w}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var b,x=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return x},set:function(w){w=!!w,x=w}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(b)return b},set:function(w){b=w}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!xr(this.Ff,1)},set:function(w){w?this.Ff=vr(this.Ff,1):this.Ff=wr(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!xr(this.Ff,2)},set:function(w){w?this.Ff=vr(this.Ff,2):this.Ff=wr(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!xr(this.Ff,3)},set:function(w){w?this.Ff=vr(this.Ff,3):this.Ff=wr(this.Ff,3)}});var v=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(v!==null)return v},set:function(w){if([0,1,2].indexOf(w)===-1)throw new Error('Invalid value "'+w+'" for attribute Q supplied.');v=w}}),Object.defineProperty(this,"textAlign",{get:function(){var w;switch(v){case 0:default:w="left";break;case 1:w="center";break;case 2:w="right"}return w},configurable:!0,enumerable:!0,set:function(w){switch(w){case"right":case 2:v=2;break;case"center":case 1:v=1;break;default:v=0}}})};Bi(Vl,yu);var Lp=function(){Vl.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var n=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return n},set:function(t){n=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return n},set:function(t){n=t}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return m8(e,this.objId,this.scope)},set:function(t){var s,r;r=[],typeof(s=t)=="string"&&(r=(function(a,i,o){o||(o=1);for(var l,c=[];l=i.exec(a);)c.push(l[o]);return c})(s,/\((.*?)\)/g)),e=r}}),this.getOptions=function(){return e},this.setOptions=function(t){e=t,this.sort&&e.sort()},this.addOption=function(t){t=(t=t||"").toString(),e.push(t),this.sort&&e.sort()},this.removeOption=function(t,s){for(s=s||!1,t=(t=t||"").toString();e.indexOf(t)!==-1&&(e.splice(e.indexOf(t),1),s!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!xr(this.Ff,18)},set:function(t){t?this.Ff=vr(this.Ff,18):this.Ff=wr(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!xr(this.Ff,19)},set:function(t){this.combo===!0&&(t?this.Ff=vr(this.Ff,19):this.Ff=wr(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!xr(this.Ff,20)},set:function(t){t?(this.Ff=vr(this.Ff,20),e.sort()):this.Ff=wr(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!xr(this.Ff,22)},set:function(t){t?this.Ff=vr(this.Ff,22):this.Ff=wr(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!xr(this.Ff,23)},set:function(t){t?this.Ff=vr(this.Ff,23):this.Ff=wr(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!xr(this.Ff,27)},set:function(t){t?this.Ff=vr(this.Ff,27):this.Ff=wr(this.Ff,27)}}),this.hasAppearanceStream=!1};Bi(Lp,Vl);var Fp=function(){Lp.call(this),this.fontName="helvetica",this.combo=!1};Bi(Fp,Lp);var Mp=function(){Fp.call(this),this.combo=!0};Bi(Mp,Fp);var rb=function(){Mp.call(this),this.edit=!0};Bi(rb,Mp);var ia=function(){Vl.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!xr(this.Ff,15)},set:function(t){t?this.Ff=vr(this.Ff,15):this.Ff=wr(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!xr(this.Ff,16)},set:function(t){t?this.Ff=vr(this.Ff,16):this.Ff=wr(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!xr(this.Ff,17)},set:function(t){t?this.Ff=vr(this.Ff,17):this.Ff=wr(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!xr(this.Ff,26)},set:function(t){t?this.Ff=vr(this.Ff,26):this.Ff=wr(this.Ff,26)}});var n,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t=function(a){return a};if(this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var s,r=[];for(s in r.push("<<"),e)r.push("/"+s+" ("+Id(t(e[s]))+")");return r.push(">>"),r.join(`
`)}},set:function(t){as(t)==="object"&&(e=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(t){typeof t=="string"&&(e.CA=t)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(t){n=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(t){n="/"+t}})};Bi(ia,Vl);var ab=function(){ia.call(this),this.pushButton=!0};Bi(ab,ia);var zp=function(){ia.call(this),this.radio=!0,this.pushButton=!1;var n=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return n},set:function(e){n=e!==void 0?e:[]}})};Bi(zp,ia);var Wb=function(){var n,e;Vl.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return n},set:function(r){n=r}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(r){e=r}});var t,s={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(o){return o};this.scope&&(r=this.scope.internal.getEncryptor(this.objId));var a,i=[];for(a in i.push("<<"),s)i.push("/"+a+" ("+Id(r(s[a]))+")");return i.push(">>"),i.join(`
`)},set:function(r){as(r)==="object"&&(s=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return s.CA||""},set:function(r){typeof r=="string"&&(s.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(r){t="/"+r}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=It.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Bi(Wb,Vl),zp.prototype.setAppearance=function(n){if(!("createAppearanceStream"in n)||!("getCA"in n))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var t=this.Kids[e];t.appearanceStreamContent=n.createAppearanceStream(t.optionName),t.caption=n.getCA()}},zp.prototype.createOption=function(n){var e=new Wb;return e.Parent=this,e.optionName=n,this.Kids.push(e),C0e.call(this.scope,e),e};var ib=function(){ia.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=It.CheckBox.createAppearanceStream()};Bi(ib,ia);var Kf=function(){Vl.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!xr(this.Ff,13)},set:function(e){e?this.Ff=vr(this.Ff,13):this.Ff=wr(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!xr(this.Ff,21)},set:function(e){e?this.Ff=vr(this.Ff,21):this.Ff=wr(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!xr(this.Ff,23)},set:function(e){e?this.Ff=vr(this.Ff,23):this.Ff=wr(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!xr(this.Ff,24)},set:function(e){e?this.Ff=vr(this.Ff,24):this.Ff=wr(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!xr(this.Ff,25)},set:function(e){e?this.Ff=vr(this.Ff,25):this.Ff=wr(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!xr(this.Ff,26)},set:function(e){e?this.Ff=vr(this.Ff,26):this.Ff=wr(this.Ff,26)}});var n=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return n},set:function(e){n=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return n},set:function(e){Number.isInteger(e)&&(n=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Bi(Kf,Vl);var ob=function(){Kf.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!xr(this.Ff,14)},set:function(n){n?this.Ff=vr(this.Ff,14):this.Ff=wr(this.Ff,14)}}),this.password=!0};Bi(ob,Kf);var It={CheckBox:{createAppearanceStream:function(){return{N:{On:It.CheckBox.YesNormal},D:{On:It.CheckBox.YesPushDown,Off:It.CheckBox.OffPushDown}}},YesPushDown:function(n){var e=hu(n);e.scope=n.scope;var t=[],s=n.scope.internal.getFont(n.fontName,n.fontStyle).id,r=n.scope.__private__.encodeColorString(n.color),a=CN(n,n.caption);return t.push("0.749023 g"),t.push("0 0 "+fn(It.internal.getWidth(n))+" "+fn(It.internal.getHeight(n))+" re"),t.push("f"),t.push("BMC"),t.push("q"),t.push("0 0 1 rg"),t.push("/"+s+" "+fn(a.fontSize)+" Tf "+r),t.push("BT"),t.push(a.text),t.push("ET"),t.push("Q"),t.push("EMC"),e.stream=t.join(`
`),e},YesNormal:function(n){var e=hu(n);e.scope=n.scope;var t=n.scope.internal.getFont(n.fontName,n.fontStyle).id,s=n.scope.__private__.encodeColorString(n.color),r=[],a=It.internal.getHeight(n),i=It.internal.getWidth(n),o=CN(n,n.caption);return r.push("1 g"),r.push("0 0 "+fn(i)+" "+fn(a)+" re"),r.push("f"),r.push("q"),r.push("0 0 1 rg"),r.push("0 0 "+fn(i-1)+" "+fn(a-1)+" re"),r.push("W"),r.push("n"),r.push("0 g"),r.push("BT"),r.push("/"+t+" "+fn(o.fontSize)+" Tf "+s),r.push(o.text),r.push("ET"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(n){var e=hu(n);e.scope=n.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+fn(It.internal.getWidth(n))+" "+fn(It.internal.getHeight(n))+" re"),t.push("f"),e.stream=t.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(n){var e={D:{Off:It.RadioButton.Circle.OffPushDown},N:{}};return e.N[n]=It.RadioButton.Circle.YesNormal,e.D[n]=It.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(n){var e=hu(n);e.scope=n.scope;var t=[],s=It.internal.getWidth(n)<=It.internal.getHeight(n)?It.internal.getWidth(n)/4:It.internal.getHeight(n)/4;s=Number((.9*s).toFixed(5));var r=It.internal.Bezier_C,a=Number((s*r).toFixed(5));return t.push("q"),t.push("1 0 0 1 "+mh(It.internal.getWidth(n)/2)+" "+mh(It.internal.getHeight(n)/2)+" cm"),t.push(s+" 0 m"),t.push(s+" "+a+" "+a+" "+s+" 0 "+s+" c"),t.push("-"+a+" "+s+" -"+s+" "+a+" -"+s+" 0 c"),t.push("-"+s+" -"+a+" -"+a+" -"+s+" 0 -"+s+" c"),t.push(a+" -"+s+" "+s+" -"+a+" "+s+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(n){var e=hu(n);e.scope=n.scope;var t=[],s=It.internal.getWidth(n)<=It.internal.getHeight(n)?It.internal.getWidth(n)/4:It.internal.getHeight(n)/4;s=Number((.9*s).toFixed(5));var r=Number((2*s).toFixed(5)),a=Number((r*It.internal.Bezier_C).toFixed(5)),i=Number((s*It.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+mh(It.internal.getWidth(n)/2)+" "+mh(It.internal.getHeight(n)/2)+" cm"),t.push(r+" 0 m"),t.push(r+" "+a+" "+a+" "+r+" 0 "+r+" c"),t.push("-"+a+" "+r+" -"+r+" "+a+" -"+r+" 0 c"),t.push("-"+r+" -"+a+" -"+a+" -"+r+" 0 -"+r+" c"),t.push(a+" -"+r+" "+r+" -"+a+" "+r+" 0 c"),t.push("f"),t.push("Q"),t.push("0 g"),t.push("q"),t.push("1 0 0 1 "+mh(It.internal.getWidth(n)/2)+" "+mh(It.internal.getHeight(n)/2)+" cm"),t.push(s+" 0 m"),t.push(s+" "+i+" "+i+" "+s+" 0 "+s+" c"),t.push("-"+i+" "+s+" -"+s+" "+i+" -"+s+" 0 c"),t.push("-"+s+" -"+i+" -"+i+" -"+s+" 0 -"+s+" c"),t.push(i+" -"+s+" "+s+" -"+i+" "+s+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},OffPushDown:function(n){var e=hu(n);e.scope=n.scope;var t=[],s=It.internal.getWidth(n)<=It.internal.getHeight(n)?It.internal.getWidth(n)/4:It.internal.getHeight(n)/4;s=Number((.9*s).toFixed(5));var r=Number((2*s).toFixed(5)),a=Number((r*It.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+mh(It.internal.getWidth(n)/2)+" "+mh(It.internal.getHeight(n)/2)+" cm"),t.push(r+" 0 m"),t.push(r+" "+a+" "+a+" "+r+" 0 "+r+" c"),t.push("-"+a+" "+r+" -"+r+" "+a+" -"+r+" 0 c"),t.push("-"+r+" -"+a+" -"+a+" -"+r+" 0 -"+r+" c"),t.push(a+" -"+r+" "+r+" -"+a+" "+r+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e}},Cross:{createAppearanceStream:function(n){var e={D:{Off:It.RadioButton.Cross.OffPushDown},N:{}};return e.N[n]=It.RadioButton.Cross.YesNormal,e.D[n]=It.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(n){var e=hu(n);e.scope=n.scope;var t=[],s=It.internal.calculateCross(n);return t.push("q"),t.push("1 1 "+fn(It.internal.getWidth(n)-2)+" "+fn(It.internal.getHeight(n)-2)+" re"),t.push("W"),t.push("n"),t.push(fn(s.x1.x)+" "+fn(s.x1.y)+" m"),t.push(fn(s.x2.x)+" "+fn(s.x2.y)+" l"),t.push(fn(s.x4.x)+" "+fn(s.x4.y)+" m"),t.push(fn(s.x3.x)+" "+fn(s.x3.y)+" l"),t.push("s"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(n){var e=hu(n);e.scope=n.scope;var t=It.internal.calculateCross(n),s=[];return s.push("0.749023 g"),s.push("0 0 "+fn(It.internal.getWidth(n))+" "+fn(It.internal.getHeight(n))+" re"),s.push("f"),s.push("q"),s.push("1 1 "+fn(It.internal.getWidth(n)-2)+" "+fn(It.internal.getHeight(n)-2)+" re"),s.push("W"),s.push("n"),s.push(fn(t.x1.x)+" "+fn(t.x1.y)+" m"),s.push(fn(t.x2.x)+" "+fn(t.x2.y)+" l"),s.push(fn(t.x4.x)+" "+fn(t.x4.y)+" m"),s.push(fn(t.x3.x)+" "+fn(t.x3.y)+" l"),s.push("s"),s.push("Q"),e.stream=s.join(`
`),e},OffPushDown:function(n){var e=hu(n);e.scope=n.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+fn(It.internal.getWidth(n))+" "+fn(It.internal.getHeight(n))+" re"),t.push("f"),e.stream=t.join(`
`),e}}},createDefaultAppearanceStream:function(n){var e=n.scope.internal.getFont(n.fontName,n.fontStyle).id,t=n.scope.__private__.encodeColorString(n.color);return"/"+e+" "+n.fontSize+" Tf "+t}};It.internal={Bezier_C:.551915024494,calculateCross:function(n){var e=It.internal.getWidth(n),t=It.internal.getHeight(n),s=Math.min(e,t);return{x1:{x:(e-s)/2,y:(t-s)/2+s},x2:{x:(e-s)/2+s,y:(t-s)/2},x3:{x:(e-s)/2,y:(t-s)/2},x4:{x:(e-s)/2+s,y:(t-s)/2+s}}}},It.internal.getWidth=function(n){var e=0;return as(n)==="object"&&(e=G4(n.Rect[2])),e},It.internal.getHeight=function(n){var e=0;return as(n)==="object"&&(e=G4(n.Rect[3])),e};var C0e=or.addField=function(n){if(k0e(this,n),!(n instanceof Vl))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=n).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),n.page=n.scope.internal.getCurrentPageInfo().pageNumber,this};or.AcroFormChoiceField=Lp,or.AcroFormListBox=Fp,or.AcroFormComboBox=Mp,or.AcroFormEditBox=rb,or.AcroFormButton=ia,or.AcroFormPushButton=ab,or.AcroFormRadioButton=zp,or.AcroFormCheckBox=ib,or.AcroFormTextField=Kf,or.AcroFormPasswordField=ob,or.AcroFormAppearance=It,or.AcroForm={ChoiceField:Lp,ListBox:Fp,ComboBox:Mp,EditBox:rb,Button:ia,PushButton:ab,RadioButton:zp,CheckBox:ib,TextField:Kf,PasswordField:ob,Appearance:It},Ft.AcroForm={ChoiceField:Lp,ListBox:Fp,ComboBox:Mp,EditBox:rb,Button:ia,PushButton:ab,RadioButton:zp,CheckBox:ib,TextField:Kf,PasswordField:ob,Appearance:It};Ft.AcroForm;function b8(n){return n.reduce(function(e,t,s){return e[t]=s,e},{})}(function(n){var e="addImage_";n.__addimage__={};var t="UNKNOWN",s={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},r=n.__addimage__.getImageFileTypeByImageData=function(E,M){var K,X,ae,W,se,ee=t;if((M=M||t)==="RGBA"||E.data!==void 0&&E.data instanceof Uint8ClampedArray&&"height"in E&&"width"in E)return"RGBA";if(U(E))for(se in s)for(ae=s[se],K=0;K<ae.length;K+=1){for(W=!0,X=0;X<ae[K].length;X+=1)if(ae[K][X]!==void 0&&ae[K][X]!==E[X]){W=!1;break}if(W===!0){ee=se;break}}else for(se in s)for(ae=s[se],K=0;K<ae.length;K+=1){for(W=!0,X=0;X<ae[K].length;X+=1)if(ae[K][X]!==void 0&&ae[K][X]!==E.charCodeAt(X)){W=!1;break}if(W===!0){ee=se;break}}return ee===t&&M!==t&&(ee=M),ee},a=function E(M){for(var K=this.internal.write,X=this.internal.putStream,ae=(0,this.internal.getFilters)();ae.indexOf("FlateEncode")!==-1;)ae.splice(ae.indexOf("FlateEncode"),1);M.objectId=this.internal.newObject();var W=[];if(W.push({key:"Type",value:"/XObject"}),W.push({key:"Subtype",value:"/Image"}),W.push({key:"Width",value:M.width}),W.push({key:"Height",value:M.height}),M.colorSpace===w.INDEXED?W.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(M.palette.length/3-1)+" "+("sMask"in M&&M.sMask!==void 0?M.objectId+2:M.objectId+1)+" 0 R]"}):(W.push({key:"ColorSpace",value:"/"+M.colorSpace}),M.colorSpace===w.DEVICE_CMYK&&W.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),W.push({key:"BitsPerComponent",value:M.bitsPerComponent}),"decodeParameters"in M&&M.decodeParameters!==void 0&&W.push({key:"DecodeParms",value:"<<"+M.decodeParameters+">>"}),"transparency"in M&&Array.isArray(M.transparency)&&M.transparency.length>0){for(var se="",ee=0,ce=M.transparency.length;ee<ce;ee++)se+=M.transparency[ee]+" "+M.transparency[ee]+" ";W.push({key:"Mask",value:"["+se+"]"})}M.sMask!==void 0&&W.push({key:"SMask",value:M.objectId+1+" 0 R"});var ye=M.filter!==void 0?["/"+M.filter]:void 0;if(X({data:M.data,additionalKeyValues:W,alreadyAppliedFilters:ye,objectId:M.objectId}),K("endobj"),"sMask"in M&&M.sMask!==void 0){var G,O=(G=M.sMaskBitsPerComponent)!==null&&G!==void 0?G:M.bitsPerComponent,j={width:M.width,height:M.height,colorSpace:"DeviceGray",bitsPerComponent:O,data:M.sMask};"filter"in M&&(j.decodeParameters="/Predictor ".concat(M.predictor," /Colors 1 /BitsPerComponent ").concat(O," /Columns ").concat(M.width),j.filter=M.filter),E.call(this,j)}if(M.colorSpace===w.INDEXED){var Y=this.internal.newObject();X({data:P(new Uint8Array(M.palette)),objectId:Y}),K("endobj")}},i=function(){var E=this.internal.collections[e+"images"];for(var M in E)a.call(this,E[M])},o=function(){var E,M=this.internal.collections[e+"images"],K=this.internal.write;for(var X in M)K("/I"+(E=M[X]).index,E.objectId,"0","R")},l=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",i),this.internal.events.subscribe("putXobjectDict",o))},c=function(){var E=this.internal.collections[e+"images"];return l.call(this),E},f=function(){return Object.keys(this.internal.collections[e+"images"]).length},d=function(E){return typeof n["process"+E.toUpperCase()]=="function"},m=function(E){return as(E)==="object"&&E.nodeType===1},g=function(E,M){if(E.nodeName==="IMG"&&E.hasAttribute("src")){var K=""+E.getAttribute("src");if(K.indexOf("data:image/")===0)return sb(unescape(K).split("base64,").pop());var X=n.loadFile(K,!0);if(X!==void 0)return X}if(E.nodeName==="CANVAS"){if(E.width===0||E.height===0)throw new Error("Given canvas must have data. Canvas width: "+E.width+", height: "+E.height);var ae;switch(M){case"PNG":ae="image/png";break;case"WEBP":ae="image/webp";break;default:ae="image/jpeg"}return sb(E.toDataURL(ae,1).split("base64,").pop())}},b=function(E){var M=this.internal.collections[e+"images"];if(M){for(var K in M)if(E===M[K].alias)return M[K]}},x=function(E,M,K){return E||M||(E=-96,M=-96),E<0&&(E=-1*K.width*72/E/this.internal.scaleFactor),M<0&&(M=-1*K.height*72/M/this.internal.scaleFactor),E===0&&(E=M*K.width/K.height),M===0&&(M=E*K.height/K.width),[E,M]},v=function(E,M,K,X,ae,W){var se=x.call(this,K,X,ae),ee=this.internal.getCoordinateString,ce=this.internal.getVerticalCoordinateString,ye=c.call(this);if(K=se[0],X=se[1],ye[ae.index]=ae,W){W*=Math.PI/180;var G=Math.cos(W),O=Math.sin(W),j=function(ie){return ie.toFixed(4)},Y=[j(G),j(O),j(-1*O),j(G),0,0,"cm"]}this.internal.write("q"),W?(this.internal.write([1,"0","0",1,ee(E),ce(M+X),"cm"].join(" ")),this.internal.write(Y.join(" ")),this.internal.write([ee(K),"0","0",ee(X),"0","0","cm"].join(" "))):this.internal.write([ee(K),"0","0",ee(X),ee(E),ce(M+X),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+ae.index+" Do"),this.internal.write("Q")},w=n.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};n.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var k=n.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},I=n.__addimage__.sHashCode=function(E){var M,K,X=0;if(typeof E=="string")for(K=E.length,M=0;M<K;M++)X=(X<<5)-X+E.charCodeAt(M),X|=0;else if(U(E))for(K=E.byteLength/2,M=0;M<K;M++)X=(X<<5)-X+E[M],X|=0;return X},A=n.__addimage__.validateStringAsBase64=function(E){(E=E||"").toString().trim();var M=!0;return E.length===0&&(M=!1),E.length%4!=0&&(M=!1),/^[A-Za-z0-9+/]+$/.test(E.substr(0,E.length-2))===!1&&(M=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(E.substr(-2))===!1&&(M=!1),M},R=n.__addimage__.extractImageFromDataUrl=function(E){if(E==null||!(E=E.trim()).startsWith("data:"))return null;var M=E.indexOf(",");return M<0?null:E.substring(0,M).trim().endsWith("base64")?E.substring(M+1):null};n.__addimage__.isArrayBuffer=function(E){return E instanceof ArrayBuffer};var U=n.__addimage__.isArrayBufferView=function(E){return E instanceof Int8Array||E instanceof Uint8Array||E instanceof Uint8ClampedArray||E instanceof Int16Array||E instanceof Uint16Array||E instanceof Int32Array||E instanceof Uint32Array||E instanceof Float32Array||E instanceof Float64Array},V=n.__addimage__.binaryStringToUint8Array=function(E){for(var M=E.length,K=new Uint8Array(M),X=0;X<M;X++)K[X]=E.charCodeAt(X);return K},P=n.__addimage__.arrayBufferToBinaryString=function(E){for(var M="",K=U(E)?E:new Uint8Array(E),X=0;X<K.length;X+=8192)M+=String.fromCharCode.apply(null,K.subarray(X,X+8192));return M};n.addImage=function(){var E,M,K,X,ae,W,se,ee,ce;if(typeof arguments[1]=="number"?(M=t,K=arguments[1],X=arguments[2],ae=arguments[3],W=arguments[4],se=arguments[5],ee=arguments[6],ce=arguments[7]):(M=arguments[1],K=arguments[2],X=arguments[3],ae=arguments[4],W=arguments[5],se=arguments[6],ee=arguments[7],ce=arguments[8]),as(E=arguments[0])==="object"&&!m(E)&&"imageData"in E){var ye=E;E=ye.imageData,M=ye.format||M||t,K=ye.x||K||0,X=ye.y||X||0,ae=ye.w||ye.width||ae,W=ye.h||ye.height||W,se=ye.alias||se,ee=ye.compression||ee,ce=ye.rotation||ye.angle||ce}var G=this.internal.getFilters();if(ee===void 0&&G.indexOf("FlateEncode")!==-1&&(ee="SLOW"),isNaN(K)||isNaN(X))throw new Error("Invalid coordinates passed to jsPDF.addImage");l.call(this);var O=D.call(this,E,M,se,ee);return v.call(this,K,X,ae,W,O,ce),this};var D=function(E,M,K,X){var ae,W,se;if(typeof E=="string"&&r(E)===t){E=unescape(E);var ee=B(E,!1);(ee!==""||(ee=n.loadFile(E,!0))!==void 0)&&(E=ee)}if(m(E)&&(E=g(E,M)),M=r(E,M),!d(M))throw new Error("addImage does not support files of type '"+M+"', please ensure that a plugin for '"+M+"' support is added.");if(((se=K)==null||se.length===0)&&(K=(function(ce){return typeof ce=="string"||U(ce)?I(ce):U(ce.data)?I(ce.data):null})(E)),(ae=b.call(this,K))||(E instanceof Uint8Array||M==="RGBA"||(W=E,E=V(E)),ae=this["process"+M.toUpperCase()](E,f.call(this),K,(function(ce){return ce&&typeof ce=="string"&&(ce=ce.toUpperCase()),ce in n.image_compression?ce:k.NONE})(X),W)),!ae)throw new Error("An unknown error occurred whilst processing the image.");return ae},B=n.__addimage__.convertBase64ToBinaryString=function(E,M){M=typeof M!="boolean"||M;var K,X="";if(typeof E=="string"){var ae;K=(ae=R(E))!==null&&ae!==void 0?ae:E;try{X=sb(K)}catch(W){if(M)throw A(K)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+W.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return X};n.getImageProperties=function(E){var M,K,X="";if(m(E)&&(E=g(E)),typeof E=="string"&&r(E)===t&&((X=B(E,!1))===""&&(X=n.loadFile(E)||""),E=X),K=r(E),!d(K))throw new Error("addImage does not support files of type '"+K+"', please ensure that a plugin for '"+K+"' support is added.");if(E instanceof Uint8Array||(E=V(E)),!(M=this["process"+K.toUpperCase()](E)))throw new Error("An unknown error occurred whilst processing the image");return M.fileType=K,M}})(Ft.API),(function(n){var e=function(t){if(t!==void 0&&t!="")return!0};Ft.API.events.push(["addPage",function(t){this.internal.getPageInfo(t.pageNumber).pageContext.annotations=[]}]),n.events.push(["putPage",function(t){for(var s,r,a,i=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,l=this.internal.getPageInfoByObjId(t.objId),c=t.pageContext.annotations,f=!1,d=0;d<c.length&&!f;d++)switch((s=c[d]).type){case"link":(e(s.options.url)||e(s.options.pageNumber))&&(f=!0);break;case"reference":case"text":case"freetext":f=!0}if(f!=0){this.internal.write("/Annots [");for(var m=0;m<c.length;m++){s=c[m];var g=this.internal.pdfEscape,b=this.internal.getEncryptor(t.objId);switch(s.type){case"reference":this.internal.write(" "+s.object.objId+" 0 R ");break;case"text":var x=this.internal.newAdditionalObject(),v=this.internal.newAdditionalObject(),w=this.internal.getEncryptor(x.objId),k=s.title||"Note";a="<</Type /Annot /Subtype /Text "+(r="/Rect ["+i(s.bounds.x)+" "+o(s.bounds.y+s.bounds.h)+" "+i(s.bounds.x+s.bounds.w)+" "+o(s.bounds.y)+"] ")+"/Contents ("+g(w(s.contents))+")",a+=" /Popup "+v.objId+" 0 R",a+=" /P "+l.objId+" 0 R",a+=" /T ("+g(w(k))+") >>",x.content=a;var I=x.objId+" 0 R";a="<</Type /Annot /Subtype /Popup "+(r="/Rect ["+i(s.bounds.x+30)+" "+o(s.bounds.y+s.bounds.h)+" "+i(s.bounds.x+s.bounds.w+30)+" "+o(s.bounds.y)+"] ")+" /Parent "+I,s.open&&(a+=" /Open true"),a+=" >>",v.content=a,this.internal.write(x.objId,"0 R",v.objId,"0 R");break;case"freetext":r="/Rect ["+i(s.bounds.x)+" "+o(s.bounds.y)+" "+i(s.bounds.x+s.bounds.w)+" "+o(s.bounds.y+s.bounds.h)+"] ";var A=s.color||"#000000";a="<</Type /Annot /Subtype /FreeText "+r+"/Contents ("+g(b(s.contents))+")",a+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+A+")",a+=" /Border [0 0 0]",a+=" >>",this.internal.write(a);break;case"link":if(s.options.name){var R=this.annotations._nameMap[s.options.name];s.options.pageNumber=R.page,s.options.top=R.y}else s.options.top||(s.options.top=0);if(r="/Rect ["+s.finalBounds.x+" "+s.finalBounds.y+" "+s.finalBounds.w+" "+s.finalBounds.h+"] ",a="",s.options.url)a="<</Type /Annot /Subtype /Link "+r+"/Border [0 0 0] /A <</S /URI /URI ("+g(b(s.options.url))+") >>";else if(s.options.pageNumber)switch(a="<</Type /Annot /Subtype /Link "+r+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(s.options.pageNumber).objId+" 0 R",s.options.magFactor=s.options.magFactor||"XYZ",s.options.magFactor){case"Fit":a+=" /Fit]";break;case"FitH":a+=" /FitH "+s.options.top+"]";break;case"FitV":s.options.left=s.options.left||0,a+=" /FitV "+s.options.left+"]";break;default:var U=o(s.options.top);s.options.left=s.options.left||0,s.options.zoom===void 0&&(s.options.zoom=0),a+=" /XYZ "+s.options.left+" "+U+" "+s.options.zoom+"]"}a!=""&&(a+=" >>",this.internal.write(a))}}this.internal.write("]")}}]),n.createAnnotation=function(t){var s=this.internal.getCurrentPageInfo();switch(t.type){case"link":this.link(t.bounds.x,t.bounds.y,t.bounds.w,t.bounds.h,t);break;case"text":case"freetext":s.pageContext.annotations.push(t)}},n.link=function(t,s,r,a,i){var o=this.internal.getCurrentPageInfo(),l=this.internal.getCoordinateString,c=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:l(t),y:c(s),w:l(t+r),h:c(s+a)},options:i,type:"link"})},n.textWithLink=function(t,s,r,a){var i,o,l=this.getTextWidth(t),c=this.internal.getLineHeight()/this.internal.scaleFactor;if(a.maxWidth!==void 0){o=a.maxWidth;var f=this.splitTextToSize(t,o).length;i=Math.ceil(c*f)}else o=l,i=c;return this.text(t,s,r,a),r+=.2*c,a.align==="center"&&(s-=l/2),a.align==="right"&&(s-=l),this.link(s,r-c,o,i,a),l},n.getTextWidth=function(t){var s=this.internal.getFontSize();return this.getStringUnitWidth(t)*s/this.internal.scaleFactor}})(Ft.API),(function(n){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},t={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},s={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},r=[1570,1571,1573,1575];n.__arabicParser__={};var a=n.__arabicParser__.isInArabicSubstitutionA=function(x){return e[x.charCodeAt(0)]!==void 0},i=n.__arabicParser__.isArabicLetter=function(x){return typeof x=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(x)},o=n.__arabicParser__.isArabicEndLetter=function(x){return i(x)&&a(x)&&e[x.charCodeAt(0)].length<=2},l=n.__arabicParser__.isArabicAlfLetter=function(x){return i(x)&&r.indexOf(x.charCodeAt(0))>=0};n.__arabicParser__.arabicLetterHasIsolatedForm=function(x){return i(x)&&a(x)&&e[x.charCodeAt(0)].length>=1};var c=n.__arabicParser__.arabicLetterHasFinalForm=function(x){return i(x)&&a(x)&&e[x.charCodeAt(0)].length>=2};n.__arabicParser__.arabicLetterHasInitialForm=function(x){return i(x)&&a(x)&&e[x.charCodeAt(0)].length>=3};var f=n.__arabicParser__.arabicLetterHasMedialForm=function(x){return i(x)&&a(x)&&e[x.charCodeAt(0)].length==4},d=n.__arabicParser__.resolveLigatures=function(x){var v=0,w=t,k="",I=0;for(v=0;v<x.length;v+=1)w[x.charCodeAt(v)]!==void 0?(I++,typeof(w=w[x.charCodeAt(v)])=="number"&&(k+=String.fromCharCode(w),w=t,I=0),v===x.length-1&&(w=t,k+=x.charAt(v-(I-1)),v-=I-1,I=0)):(w=t,k+=x.charAt(v-I),v-=I,I=0);return k};n.__arabicParser__.isArabicDiacritic=function(x){return x!==void 0&&s[x.charCodeAt(0)]!==void 0};var m=n.__arabicParser__.getCorrectForm=function(x,v,w){return i(x)?a(x)===!1?-1:!c(x)||!i(v)&&!i(w)||!i(w)&&o(v)||o(x)&&!i(v)||o(x)&&l(v)||o(x)&&o(v)?0:f(x)&&i(v)&&!o(v)&&i(w)&&c(w)?3:o(x)||!i(w)?1:2:-1},g=function(x){var v=0,w=0,k=0,I="",A="",R="",U=(x=x||"").split("\\s+"),V=[];for(v=0;v<U.length;v+=1){for(V.push(""),w=0;w<U[v].length;w+=1)I=U[v][w],A=U[v][w-1],R=U[v][w+1],i(I)?(k=m(I,A,R),V[v]+=k!==-1?String.fromCharCode(e[I.charCodeAt(0)][k]):I):V[v]+=I;V[v]=d(V[v])}return V.join(" ")},b=n.__arabicParser__.processArabic=n.processArabic=function(){var x,v=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,w=[];if(Array.isArray(v)){var k=0;for(w=[],k=0;k<v.length;k+=1)Array.isArray(v[k])?w.push([g(v[k][0]),v[k][1],v[k][2]]):w.push([g(v[k])]);x=w}else x=g(v);return typeof arguments[0]=="string"?x:(arguments[0].text=x,arguments[0])};n.events.push(["preProcessText",b])})(Ft.API),Ft.API.autoPrint=function(n){var e;return(n=n||{}).variant=n.variant||"non-conform",n.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},(function(n){var e=function(){var t=void 0;Object.defineProperty(this,"pdf",{get:function(){return t},set:function(o){t=o}});var s=150;Object.defineProperty(this,"width",{get:function(){return s},set:function(o){s=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=s+1)}});var r=300;Object.defineProperty(this,"height",{get:function(){return r},set:function(o){r=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=r+1)}});var a=[];Object.defineProperty(this,"childNodes",{get:function(){return a},set:function(o){a=o}});var i={};Object.defineProperty(this,"style",{get:function(){return i},set:function(o){i=o}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(t,s){var r;if((t=t||"2d")!=="2d")return null;for(r in s)this.pdf.context2d.hasOwnProperty(r)&&(this.pdf.context2d[r]=s[r]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},n.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])})(Ft.API),(function(n){var e={left:0,top:0,bottom:0,right:0},t=!1,s=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),r.call(this))},r=function(){this.internal.__cell__.lastCell=new a,this.internal.__cell__.pages=1},a=function(){var l=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return l},set:function(x){l=x}});var c=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return c},set:function(x){c=x}});var f=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return f},set:function(x){f=x}});var d=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return d},set:function(x){d=x}});var m=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return m},set:function(x){m=x}});var g=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return g},set:function(x){g=x}});var b=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return b},set:function(x){b=x}}),this};a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},a.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},n.setHeaderFunction=function(l){return s.call(this),this.internal.__cell__.headerFunction=typeof l=="function"?l:void 0,this},n.getTextDimensions=function(l,c){s.call(this);var f=(c=c||{}).fontSize||this.getFontSize(),d=c.font||this.getFont(),m=c.scaleFactor||this.internal.scaleFactor,g=0,b=0,x=0,v=this;if(!Array.isArray(l)&&typeof l!="string"){if(typeof l!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");l=String(l)}var w=c.maxWidth;w>0?typeof l=="string"?l=this.splitTextToSize(l,w):Object.prototype.toString.call(l)==="[object Array]"&&(l=l.reduce(function(I,A){return I.concat(v.splitTextToSize(A,w))},[])):l=Array.isArray(l)?l:[l];for(var k=0;k<l.length;k++)g<(x=this.getStringUnitWidth(l[k],{font:d})*f)&&(g=x);return g!==0&&(b=l.length),{w:g/=m,h:Math.max((b*f*this.getLineHeightFactor()-f*(this.getLineHeightFactor()-1))/m,0)}},n.cellAddPage=function(){s.call(this),this.addPage();var l=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new a(l.left,l.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var i=n.cell=function(){var l;l=arguments[0]instanceof a?arguments[0]:new a(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),s.call(this);var c=this.internal.__cell__.lastCell,f=this.internal.__cell__.padding,d=this.internal.__cell__.margins||e,m=this.internal.__cell__.tableHeaderRow,g=this.internal.__cell__.printHeaders;return c.lineNumber!==void 0&&(c.lineNumber===l.lineNumber?(l.x=(c.x||0)+(c.width||0),l.y=c.y||0):c.y+c.height+l.height+d.bottom>this.getPageHeight()?(this.cellAddPage(),l.y=d.top,g&&m&&(this.printHeaderRow(l.lineNumber,!0),l.y+=m[0].height)):l.y=c.y+c.height||l.y),l.text[0]!==void 0&&(this.rect(l.x,l.y,l.width,l.height,t===!0?"FD":void 0),l.align==="right"?this.text(l.text,l.x+l.width-f,l.y+f,{align:"right",baseline:"top"}):l.align==="center"?this.text(l.text,l.x+l.width/2,l.y+f,{align:"center",baseline:"top",maxWidth:l.width-f-f}):this.text(l.text,l.x+f,l.y+f,{align:"left",baseline:"top",maxWidth:l.width-f-f})),this.internal.__cell__.lastCell=l,this};n.table=function(l,c,f,d,m){if(s.call(this),!f)throw new Error("No data for PDF table.");var g,b,x,v,w=[],k=[],I=[],A={},R={},U=[],V=[],P=(m=m||{}).autoSize||!1,D=m.printHeaders!==!1,B=m.css&&m.css["font-size"]!==void 0?16*m.css["font-size"]:m.fontSize||12,E=m.margins||Object.assign({width:this.getPageWidth()},e),M=typeof m.padding=="number"?m.padding:3,K=m.headerBackgroundColor||"#c8c8c8",X=m.headerTextColor||"#000";if(r.call(this),this.internal.__cell__.printHeaders=D,this.internal.__cell__.margins=E,this.internal.__cell__.table_font_size=B,this.internal.__cell__.padding=M,this.internal.__cell__.headerBackgroundColor=K,this.internal.__cell__.headerTextColor=X,this.setFontSize(B),d==null)k=w=Object.keys(f[0]),I=w.map(function(){return"left"});else if(Array.isArray(d)&&as(d[0])==="object")for(w=d.map(function(ye){return ye.name}),k=d.map(function(ye){return ye.prompt||ye.name||""}),I=d.map(function(ye){return ye.align||"left"}),g=0;g<d.length;g+=1)R[d[g].name]=.7499990551181103*d[g].width;else Array.isArray(d)&&typeof d[0]=="string"&&(k=w=d,I=w.map(function(){return"left"}));if(P||Array.isArray(d)&&typeof d[0]=="string")for(g=0;g<w.length;g+=1){for(A[v=w[g]]=f.map(function(ye){return ye[v]}),this.setFont(void 0,"bold"),U.push(this.getTextDimensions(k[g],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),b=A[v],this.setFont(void 0,"normal"),x=0;x<b.length;x+=1)U.push(this.getTextDimensions(b[x],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);R[v]=Math.max.apply(null,U)+M+M,U=[]}if(D){var ae={};for(g=0;g<w.length;g+=1)ae[w[g]]={},ae[w[g]].text=k[g],ae[w[g]].align=I[g];var W=o.call(this,ae,R);V=w.map(function(ye){return new a(l,c,R[ye],W,ae[ye].text,void 0,ae[ye].align)}),this.setTableHeaderRow(V),this.printHeaderRow(1,!1)}var se=d.reduce(function(ye,G){return ye[G.name]=G.align,ye},{});for(g=0;g<f.length;g+=1){"rowStart"in m&&m.rowStart instanceof Function&&m.rowStart({row:g,data:f[g]},this);var ee=o.call(this,f[g],R);for(x=0;x<w.length;x+=1){var ce=f[g][w[x]];"cellStart"in m&&m.cellStart instanceof Function&&m.cellStart({row:g,col:x,data:ce},this),i.call(this,new a(l,c,R[w[x]],ee,ce,g+2,se[w[x]]))}}return this.internal.__cell__.table_x=l,this.internal.__cell__.table_y=c,this};var o=function(l,c){var f=this.internal.__cell__.padding,d=this.internal.__cell__.table_font_size,m=this.internal.scaleFactor;return Object.keys(l).map(function(g){var b=l[g];return this.splitTextToSize(b.hasOwnProperty("text")?b.text:b,c[g]-f-f)},this).map(function(g){return this.getLineHeightFactor()*g.length*d/m+f+f},this).reduce(function(g,b){return Math.max(g,b)},0)};n.setTableHeaderRow=function(l){s.call(this),this.internal.__cell__.tableHeaderRow=l},n.printHeaderRow=function(l,c){if(s.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var f;if(t=!0,typeof this.internal.__cell__.headerFunction=="function"){var d=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new a(d[0],d[1],d[2],d[3],void 0,-1)}this.setFont(void 0,"bold");for(var m=[],g=0;g<this.internal.__cell__.tableHeaderRow.length;g+=1){f=this.internal.__cell__.tableHeaderRow[g].clone(),c&&(f.y=this.internal.__cell__.margins.top||0,m.push(f)),f.lineNumber=l;var b=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),i.call(this,f),this.setTextColor(b)}m.length>0&&this.setTableHeaderRow(m),this.setFont(void 0,"normal"),t=!1}})(Ft.API);var x8={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},v8=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],TN=b8(v8),w8=[100,200,300,400,500,600,700,800,900],T0e=b8(w8);function mS(n){var e=n.family.replace(/"|'/g,"").toLowerCase(),t=(function(a){return x8[a=a||"normal"]?a:"normal"})(n.style),s=(function(a){return a?typeof a=="number"?a>=100&&a<=900&&a%100==0?a:400:/^\d00$/.test(a)?parseInt(a):a==="bold"?700:400:400})(n.weight),r=(function(a){return typeof TN[a=a||"normal"]=="number"?a:"normal"})(n.stretch);return{family:e,style:t,weight:s,stretch:r,src:n.src||[],ref:n.ref||{name:e,style:[r,t,s].join(" ")}}}function q4(n,e,t,s){var r;for(r=t;r>=0&&r<e.length;r+=s)if(n[e[r]])return n[e[r]];for(r=t;r>=0&&r<e.length;r-=s)if(n[e[r]])return n[e[r]]}var A0e={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},H4={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function K4(n){return[n.stretch,n.style,n.weight,n.family].join(" ")}function X4(n){return n.trimLeft()}function I0e(n,e){for(var t=0;t<n.length;){if(n.charAt(t)===e)return[n.substring(0,t),n.substring(t+1)];t+=1}return null}function E0e(n){var e=n.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],n.substring(e[0].length)]}var U2,Y4,Z4,Np,V2,J4,Q4,e_,gS=["times"];function t_(n,e,t,s,r){var a=4,i=s_;switch(r){case Ft.API.image_compression.FAST:a=1,i=n_;break;case Ft.API.image_compression.MEDIUM:a=6,i=r_;break;case Ft.API.image_compression.SLOW:a=9,i=a_}n=(function(l,c,f,d){for(var m,g=l.length/c,b=new Uint8Array(l.length+g),x=[_0e,n_,s_,r_,a_],v=0;v<g;v+=1){var w=v*c,k=l.subarray(w,w+c);if(d)b.set(d(k,f,m),w+v);else{for(var I=x.length,A=[],R=0;R<I;R+=1)A[R]=x[R](k,f,m);var U=R0e(A.concat());b.set(A[U],w+v)}m=k}return b})(n,e,Math.ceil(t*s/8),i);var o=xN(n,{level:a});return Ft.API.__addimage__.arrayBufferToBinaryString(o)}function _0e(n){var e=Array.apply([],n);return e.unshift(0),e}function n_(n,e){var t=n.length,s=[];s[0]=1;for(var r=0;r<t;r+=1){var a=n[r-e]||0;s[r+1]=n[r]-a+256&255}return s}function s_(n,e,t){var s=n.length,r=[];r[0]=2;for(var a=0;a<s;a+=1){var i=t&&t[a]||0;r[a+1]=n[a]-i+256&255}return r}function r_(n,e,t){var s=n.length,r=[];r[0]=3;for(var a=0;a<s;a+=1){var i=n[a-e]||0,o=t&&t[a]||0;r[a+1]=n[a]+256-(i+o>>>1)&255}return r}function a_(n,e,t){var s=n.length,r=[];r[0]=4;for(var a=0;a<s;a+=1){var i=$0e(n[a-e]||0,t&&t[a]||0,t&&t[a-e]||0);r[a+1]=n[a]-i+256&255}return r}function $0e(n,e,t){if(n===e&&e===t)return n;var s=Math.abs(e-t),r=Math.abs(n-t),a=Math.abs(n+e-t-t);return s<=r&&s<=a?n:r<=a?e:t}function R0e(n){var e=n.map(function(t){return t.reduce(function(s,r){return s+Math.abs(r)},0)});return e.indexOf(Math.min.apply(null,e))}function yS(n,e,t){var s=e*t,r=Math.floor(s/8),a=16-(s-8*r+t),i=(1<<t)-1;return S8(n,r)>>a&i}function i_(n,e,t,s){var r=t*s,a=Math.floor(r/8),i=16-(r-8*a+s),o=(1<<s)-1,l=(e&o)<<i;(function(c,f,d){if(f+1<c.byteLength)c.setUint16(f,d,!1);else{var m=d>>8&255;c.setUint8(f,m)}})(n,a,S8(n,a)&~(o<<i)&65535|l)}function S8(n,e){return e+1<n.byteLength?n.getUint16(e,!1):n.getUint8(e)<<8}function D0e(n){var e=0;if(n[e++]!==71||n[e++]!==73||n[e++]!==70||n[e++]!==56||(n[e++]+1&253)!=56||n[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var t=n[e++]|n[e++]<<8,s=n[e++]|n[e++]<<8,r=n[e++],a=r>>7,i=1<<1+(7&r);n[e++],n[e++];var o=null,l=null;a&&(o=e,l=i,e+=3*i);var c=!0,f=[],d=0,m=null,g=0,b=null;for(this.width=t,this.height=s;c&&e<n.length;)switch(n[e++]){case 33:switch(n[e++]){case 255:if(n[e]!==11||n[e+1]==78&&n[e+2]==69&&n[e+3]==84&&n[e+4]==83&&n[e+5]==67&&n[e+6]==65&&n[e+7]==80&&n[e+8]==69&&n[e+9]==50&&n[e+10]==46&&n[e+11]==48&&n[e+12]==3&&n[e+13]==1&&n[e+16]==0)e+=14,b=n[e++]|n[e++]<<8,e++;else for(e+=12;;){if(!((E=n[e++])>=0))throw Error("Invalid block size");if(E===0)break;e+=E}break;case 249:if(n[e++]!==4||n[e+4]!==0)throw new Error("Invalid graphics extension block.");var x=n[e++];d=n[e++]|n[e++]<<8,m=n[e++],1&x||(m=null),g=x>>2&7,e++;break;case 254:for(;;){if(!((E=n[e++])>=0))throw Error("Invalid block size");if(E===0)break;e+=E}break;default:throw new Error("Unknown graphic control label: 0x"+n[e-1].toString(16))}break;case 44:var v=n[e++]|n[e++]<<8,w=n[e++]|n[e++]<<8,k=n[e++]|n[e++]<<8,I=n[e++]|n[e++]<<8,A=n[e++],R=A>>6&1,U=1<<1+(7&A),V=o,P=l,D=!1;A>>7&&(D=!0,V=e,P=U,e+=3*U);var B=e;for(e++;;){var E;if(!((E=n[e++])>=0))throw Error("Invalid block size");if(E===0)break;e+=E}f.push({x:v,y:w,width:k,height:I,has_local_palette:D,palette_offset:V,palette_size:P,data_offset:B,data_length:e-B,transparent_index:m,interlaced:!!R,delay:d,disposal:g});break;case 59:c=!1;break;default:throw new Error("Unknown gif block: 0x"+n[e-1].toString(16))}this.numFrames=function(){return f.length},this.loopCount=function(){return b},this.frameInfo=function(M){if(M<0||M>=f.length)throw new Error("Frame index out of range.");return f[M]},this.decodeAndBlitFrameBGRA=function(M,K){var X=this.frameInfo(M),ae=X.width*X.height,W=new Uint8Array(ae);o_(n,X.data_offset,W,ae);var se=X.palette_offset,ee=X.transparent_index;ee===null&&(ee=256);var ce=X.width,ye=t-ce,G=ce,O=4*(X.y*t+X.x),j=4*((X.y+X.height)*t+X.x),Y=O,ie=4*ye;X.interlaced===!0&&(ie+=4*t*7);for(var ue=8,pe=0,Ce=W.length;pe<Ce;++pe){var Ne=W[pe];if(G===0&&(G=ce,(Y+=ie)>=j&&(ie=4*ye+4*t*(ue-1),Y=O+(ce+ye)*(ue<<1),ue>>=1)),Ne===ee)Y+=4;else{var Le=n[se+3*Ne],Ve=n[se+3*Ne+1],rt=n[se+3*Ne+2];K[Y++]=rt,K[Y++]=Ve,K[Y++]=Le,K[Y++]=255}--G}},this.decodeAndBlitFrameRGBA=function(M,K){var X=this.frameInfo(M),ae=X.width*X.height,W=new Uint8Array(ae);o_(n,X.data_offset,W,ae);var se=X.palette_offset,ee=X.transparent_index;ee===null&&(ee=256);var ce=X.width,ye=t-ce,G=ce,O=4*(X.y*t+X.x),j=4*((X.y+X.height)*t+X.x),Y=O,ie=4*ye;X.interlaced===!0&&(ie+=4*t*7);for(var ue=8,pe=0,Ce=W.length;pe<Ce;++pe){var Ne=W[pe];if(G===0&&(G=ce,(Y+=ie)>=j&&(ie=4*ye+4*t*(ue-1),Y=O+(ce+ye)*(ue<<1),ue>>=1)),Ne===ee)Y+=4;else{var Le=n[se+3*Ne],Ve=n[se+3*Ne+1],rt=n[se+3*Ne+2];K[Y++]=Le,K[Y++]=Ve,K[Y++]=rt,K[Y++]=255}--G}}}function o_(n,e,t,s){for(var r=n[e++],a=1<<r,i=a+1,o=i+1,l=r+1,c=(1<<l)-1,f=0,d=0,m=0,g=n[e++],b=new Int32Array(4096),x=null;;){for(;f<16&&g!==0;)d|=n[e++]<<f,f+=8,g===1?g=n[e++]:--g;if(f<l)break;var v=d&c;if(d>>=l,f-=l,v!==a){if(v===i)break;for(var w=v<o?v:x,k=0,I=w;I>a;)I=b[I]>>8,++k;var A=I;if(m+k+(w!==v?1:0)>s)return void xs.log("Warning, gif stream longer than expected.");t[m++]=A;var R=m+=k;for(w!==v&&(t[m++]=A),I=w;k--;)I=b[I],t[--R]=255&I,I>>=8;x!==null&&o<4096&&(b[o++]=x<<8|A,o>=c+1&&l<12&&(++l,c=c<<1|1)),x=v}else o=i+1,c=(1<<(l=r+1))-1,x=null}return m!==s&&xs.log("Warning, gif stream shorter than expected."),t}function bS(n){var e,t,s,r,a,i=Math.floor,o=new Array(64),l=new Array(64),c=new Array(64),f=new Array(64),d=new Array(65535),m=new Array(65535),g=new Array(64),b=new Array(64),x=[],v=0,w=7,k=new Array(64),I=new Array(64),A=new Array(64),R=new Array(256),U=new Array(2048),V=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],P=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],D=[0,1,2,3,4,5,6,7,8,9,10,11],B=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],E=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],M=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],K=[0,1,2,3,4,5,6,7,8,9,10,11],X=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],ae=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function W(O,j){for(var Y=0,ie=0,ue=new Array,pe=1;pe<=16;pe++){for(var Ce=1;Ce<=O[pe];Ce++)ue[j[ie]]=[],ue[j[ie]][0]=Y,ue[j[ie]][1]=pe,ie++,Y++;Y*=2}return ue}function se(O){for(var j=O[0],Y=O[1]-1;Y>=0;)j&1<<Y&&(v|=1<<w),Y--,--w<0&&(v==255?(ee(255),ee(0)):ee(v),w=7,v=0)}function ee(O){x.push(O)}function ce(O){ee(O>>8&255),ee(255&O)}function ye(O,j,Y,ie,ue){for(var pe,Ce=ue[0],Ne=ue[240],Le=(function(Je,dt){var ft,bt,Tt,zt,tn,Ut,sn,Yt,vt,en,_t=0;for(vt=0;vt<8;++vt){ft=Je[_t],bt=Je[_t+1],Tt=Je[_t+2],zt=Je[_t+3],tn=Je[_t+4],Ut=Je[_t+5],sn=Je[_t+6];var ks=ft+(Yt=Je[_t+7]),ln=ft-Yt,Vt=bt+sn,Zt=bt-sn,kn=Tt+Ut,jt=Tt-Ut,ls=zt+tn,Kt=zt-tn,nn=ks+ls,es=ks-ls,dn=Vt+kn,Lt=Vt-kn;Je[_t]=nn+dn,Je[_t+4]=nn-dn;var On=.707106781*(Lt+es);Je[_t+2]=es+On,Je[_t+6]=es-On;var Ui=.382683433*((nn=Kt+jt)-(Lt=Zt+ln)),Jr=.5411961*nn+Ui,yo=1.306562965*Lt+Ui,fi=.707106781*(dn=jt+Zt),Pt=ln+fi,Xo=ln-fi;Je[_t+5]=Xo+Jr,Je[_t+3]=Xo-Jr,Je[_t+1]=Pt+yo,Je[_t+7]=Pt-yo,_t+=8}for(_t=0,vt=0;vt<8;++vt){ft=Je[_t],bt=Je[_t+8],Tt=Je[_t+16],zt=Je[_t+24],tn=Je[_t+32],Ut=Je[_t+40],sn=Je[_t+48];var bo=ft+(Yt=Je[_t+56]),Ga=ft-Yt,qa=bt+sn,Ns=bt-sn,Js=Tt+Ut,kr=Tt-Ut,Wl=zt+tn,ga=zt-tn,ts=bo+Wl,Cs=bo-Wl,Qr=qa+Js,Ha=qa-Js;Je[_t]=ts+Qr,Je[_t+32]=ts-Qr;var di=.707106781*(Ha+Cs);Je[_t+16]=Cs+di,Je[_t+48]=Cs-di;var Du=.382683433*((ts=ga+kr)-(Ha=Ns+Ga)),Vi=.5411961*ts+Du,ji=1.306562965*Ha+Du,Gl=.707106781*(Qr=kr+Ns),Wi=Ga+Gl,Gi=Ga-Gl;Je[_t+40]=Gi+Vi,Je[_t+24]=Gi-Vi,Je[_t+8]=Wi+ji,Je[_t+56]=Wi-ji,_t++}for(vt=0;vt<64;++vt)en=Je[vt]*dt[vt],g[vt]=en>0?en+.5|0:en-.5|0;return g})(O,j),Ve=0;Ve<64;++Ve)b[V[Ve]]=Le[Ve];var rt=b[0]-Y;Y=b[0],rt==0?se(ie[0]):(se(ie[m[pe=32767+rt]]),se(d[pe]));for(var at=63;at>0&&b[at]==0;)at--;if(at==0)return se(Ce),Y;for(var ot,oe=1;oe<=at;){for(var tt=oe;b[oe]==0&&oe<=at;)++oe;var xt=oe-tt;if(xt>=16){ot=xt>>4;for(var ht=1;ht<=ot;++ht)se(Ne);xt&=15}pe=32767+b[oe],se(ue[(xt<<4)+m[pe]]),se(d[pe]),oe++}return at!=63&&se(Ce),Y}function G(O){O=Math.min(Math.max(O,1),100),a!=O&&((function(j){for(var Y=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],ie=0;ie<64;ie++){var ue=i((Y[ie]*j+50)/100);ue=Math.min(Math.max(ue,1),255),o[V[ie]]=ue}for(var pe=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],Ce=0;Ce<64;Ce++){var Ne=i((pe[Ce]*j+50)/100);Ne=Math.min(Math.max(Ne,1),255),l[V[Ce]]=Ne}for(var Le=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Ve=0,rt=0;rt<8;rt++)for(var at=0;at<8;at++)c[Ve]=1/(o[V[Ve]]*Le[rt]*Le[at]*8),f[Ve]=1/(l[V[Ve]]*Le[rt]*Le[at]*8),Ve++})(O<50?Math.floor(5e3/O):Math.floor(200-2*O)),a=O)}this.encode=function(O,j){j&&G(j),x=new Array,v=0,w=7,ce(65496),ce(65504),ce(16),ee(74),ee(70),ee(73),ee(70),ee(0),ee(1),ee(1),ee(0),ce(1),ce(1),ee(0),ee(0),(function(){ce(65499),ce(132),ee(0);for(var bt=0;bt<64;bt++)ee(o[bt]);ee(1);for(var Tt=0;Tt<64;Tt++)ee(l[Tt])})(),(function(bt,Tt){ce(65472),ce(17),ee(8),ce(Tt),ce(bt),ee(3),ee(1),ee(17),ee(0),ee(2),ee(17),ee(1),ee(3),ee(17),ee(1)})(O.width,O.height),(function(){ce(65476),ce(418),ee(0);for(var bt=0;bt<16;bt++)ee(P[bt+1]);for(var Tt=0;Tt<=11;Tt++)ee(D[Tt]);ee(16);for(var zt=0;zt<16;zt++)ee(B[zt+1]);for(var tn=0;tn<=161;tn++)ee(E[tn]);ee(1);for(var Ut=0;Ut<16;Ut++)ee(M[Ut+1]);for(var sn=0;sn<=11;sn++)ee(K[sn]);ee(17);for(var Yt=0;Yt<16;Yt++)ee(X[Yt+1]);for(var vt=0;vt<=161;vt++)ee(ae[vt])})(),ce(65498),ce(12),ee(3),ee(1),ee(0),ee(2),ee(17),ee(3),ee(17),ee(0),ee(63),ee(0);var Y=0,ie=0,ue=0;v=0,w=7,this.encode.displayName="_encode_";for(var pe,Ce,Ne,Le,Ve,rt,at,ot,oe,tt=O.data,xt=O.width,ht=O.height,Je=4*xt,dt=0;dt<ht;){for(pe=0;pe<Je;){for(Ve=Je*dt+pe,at=-1,ot=0,oe=0;oe<64;oe++)rt=Ve+(ot=oe>>3)*Je+(at=4*(7&oe)),dt+ot>=ht&&(rt-=Je*(dt+1+ot-ht)),pe+at>=Je&&(rt-=pe+at-Je+4),Ce=tt[rt++],Ne=tt[rt++],Le=tt[rt++],k[oe]=(U[Ce]+U[Ne+256|0]+U[Le+512|0]>>16)-128,I[oe]=(U[Ce+768|0]+U[Ne+1024|0]+U[Le+1280|0]>>16)-128,A[oe]=(U[Ce+1280|0]+U[Ne+1536|0]+U[Le+1792|0]>>16)-128;Y=ye(k,c,Y,e,s),ie=ye(I,f,ie,t,r),ue=ye(A,f,ue,t,r),pe+=32}dt+=8}if(w>=0){var ft=[];ft[1]=w+1,ft[0]=(1<<w+1)-1,se(ft)}return ce(65497),new Uint8Array(x)},n=n||50,(function(){for(var O=String.fromCharCode,j=0;j<256;j++)R[j]=O(j)})(),e=W(P,D),t=W(M,K),s=W(B,E),r=W(X,ae),(function(){for(var O=1,j=2,Y=1;Y<=15;Y++){for(var ie=O;ie<j;ie++)m[32767+ie]=Y,d[32767+ie]=[],d[32767+ie][1]=Y,d[32767+ie][0]=ie;for(var ue=-(j-1);ue<=-O;ue++)m[32767+ue]=Y,d[32767+ue]=[],d[32767+ue][1]=Y,d[32767+ue][0]=j-1+ue;O<<=1,j<<=1}})(),(function(){for(var O=0;O<256;O++)U[O]=19595*O,U[O+256|0]=38470*O,U[O+512|0]=7471*O+32768,U[O+768|0]=-11059*O,U[O+1024|0]=-21709*O,U[O+1280|0]=32768*O+8421375,U[O+1536|0]=-27439*O,U[O+1792|0]=-5329*O})(),G(n)}function kl(n,e){if(this.pos=0,this.buffer=n,this.datav=new DataView(n.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function l_(n){function e(D){if(!D)throw Error("assert :P")}function t(D,B,E){for(var M=0;4>M;M++)if(D[B+M]!=E.charCodeAt(M))return!0;return!1}function s(D,B,E,M,K){for(var X=0;X<K;X++)D[B+X]=E[M+X]}function r(D,B,E,M){for(var K=0;K<M;K++)D[B+K]=E}function a(D){return new Int32Array(D)}function i(D,B){for(var E=[],M=0;M<D;M++)E.push(new B);return E}function o(D,B){var E=[];return(function M(K,X,ae){for(var W=ae[X],se=0;se<W&&(K.push(ae.length>X+1?[]:new B),!(ae.length<X+1));se++)M(K[se],X+1,ae)})(E,0,D),E}var l=function(){var D=this;function B(S,C){for(var $=1<<C-1>>>0;S&$;)$>>>=1;return $?(S&$-1)+$:S}function E(S,C,$,F,H){e(!(F%$));do S[C+(F-=$)]=H;while(0<F)}function M(S,C,$,F,H){if(e(2328>=H),512>=H)var J=a(512);else if((J=a(H))==null)return 0;return(function(Q,re,le,fe,Se,Fe){var he,Ae,Re=re,qe=1<<le,Oe=a(16),Ge=a(16);for(e(Se!=0),e(fe!=null),e(Q!=null),e(0<le),Ae=0;Ae<Se;++Ae){if(15<fe[Ae])return 0;++Oe[fe[Ae]]}if(Oe[0]==Se)return 0;for(Ge[1]=0,he=1;15>he;++he){if(Oe[he]>1<<he)return 0;Ge[he+1]=Ge[he]+Oe[he]}for(Ae=0;Ae<Se;++Ae)he=fe[Ae],0<fe[Ae]&&(Fe[Ge[he]++]=Ae);if(Ge[15]==1)return(fe=new K).g=0,fe.value=Fe[0],E(Q,Re,1,qe,fe),qe;var Xe,it=-1,Qe=qe-1,At=0,gt=1,rn=1,wt=1<<le;for(Ae=0,he=1,Se=2;he<=le;++he,Se<<=1){if(gt+=rn<<=1,0>(rn-=Oe[he]))return 0;for(;0<Oe[he];--Oe[he])(fe=new K).g=he,fe.value=Fe[Ae++],E(Q,Re+At,Se,wt,fe),At=B(At,he)}for(he=le+1,Se=2;15>=he;++he,Se<<=1){if(gt+=rn<<=1,0>(rn-=Oe[he]))return 0;for(;0<Oe[he];--Oe[he]){if(fe=new K,(At&Qe)!=it){for(Re+=wt,Xe=1<<(it=he)-le;15>it&&!(0>=(Xe-=Oe[it]));)++it,Xe<<=1;qe+=wt=1<<(Xe=it-le),Q[re+(it=At&Qe)].g=Xe+le,Q[re+it].value=Re-re-it}fe.g=he-le,fe.value=Fe[Ae++],E(Q,Re+(At>>le),Se,wt,fe),At=B(At,he)}}return gt!=2*Ge[15]-1?0:qe})(S,C,$,F,H,J)}function K(){this.value=this.g=0}function X(){this.value=this.g=0}function ae(){this.G=i(5,K),this.H=a(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=i(Yl,X)}function W(S,C,$,F){e(S!=null),e(C!=null),e(2147483648>F),S.Ca=254,S.I=0,S.b=-8,S.Ka=0,S.oa=C,S.pa=$,S.Jd=C,S.Yc=$+F,S.Zc=4<=F?$+F-4+1:$,Ce(S)}function se(S,C){for(var $=0;0<C--;)$|=Le(S,128)<<C;return $}function ee(S,C){var $=se(S,C);return Ne(S)?-$:$}function ce(S,C,$,F){var H,J=0;for(e(S!=null),e(C!=null),e(4294967288>F),S.Sb=F,S.Ra=0,S.u=0,S.h=0,4<F&&(F=4),H=0;H<F;++H)J+=C[$+H]<<8*H;S.Ra=J,S.bb=F,S.oa=C,S.pa=$}function ye(S){for(;8<=S.u&&S.bb<S.Sb;)S.Ra>>>=8,S.Ra+=S.oa[S.pa+S.bb]<<Co-8>>>0,++S.bb,S.u-=8;ie(S)&&(S.h=1,S.u=0)}function G(S,C){if(e(0<=C),!S.h&&C<=va){var $=Y(S)&_a[C];return S.u+=C,ye(S),$}return S.h=1,S.u=0}function O(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function j(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function Y(S){return S.Ra>>>(S.u&Co-1)>>>0}function ie(S){return e(S.bb<=S.Sb),S.h||S.bb==S.Sb&&S.u>Co}function ue(S,C){S.u=C,S.h=ie(S)}function pe(S){S.u>=To&&(e(S.u>=To),ye(S))}function Ce(S){e(S!=null&&S.oa!=null),S.pa<S.Zc?(S.I=(S.oa[S.pa++]|S.I<<8)>>>0,S.b+=8):(e(S!=null&&S.oa!=null),S.pa<S.Yc?(S.b+=8,S.I=S.oa[S.pa++]|S.I<<8):S.Ka?S.b=0:(S.I<<=8,S.b+=8,S.Ka=1))}function Ne(S){return se(S,1)}function Le(S,C){var $=S.Ca;0>S.b&&Ce(S);var F=S.b,H=$*C>>>8,J=(S.I>>>F>H)+0;for(J?($-=H,S.I-=H+1<<F>>>0):$=H+1,F=$,H=0;256<=F;)H+=8,F>>=8;return F=7^H+cl[F],S.b-=F,S.Ca=($<<F)-1,J}function Ve(S,C,$){S[C+0]=$>>24&255,S[C+1]=$>>16&255,S[C+2]=$>>8&255,S[C+3]=255&$}function rt(S,C){return S[C+0]|S[C+1]<<8}function at(S,C){return rt(S,C)|S[C+2]<<16}function ot(S,C){return rt(S,C)|rt(S,C+2)<<16}function oe(S,C){var $=1<<C;return e(S!=null),e(0<C),S.X=a($),S.X==null?0:(S.Mb=32-C,S.Xa=C,1)}function tt(S,C){e(S!=null),e(C!=null),e(S.Xa==C.Xa),s(C.X,0,S.X,0,1<<C.Xa)}function xt(){this.X=[],this.Xa=this.Mb=0}function ht(S,C,$,F){e($!=null),e(F!=null);var H=$[0],J=F[0];return H==0&&(H=(S*J+C/2)/C),J==0&&(J=(C*H+S/2)/S),0>=H||0>=J?0:($[0]=H,F[0]=J,1)}function Je(S,C){return S+(1<<C)-1>>>C}function dt(S,C){return((4278255360&S)+(4278255360&C)>>>0&4278255360)+((16711935&S)+(16711935&C)>>>0&16711935)>>>0}function ft(S,C){D[C]=function($,F,H,J,Q,re,le){var fe;for(fe=0;fe<Q;++fe){var Se=D[S](re[le+fe-1],H,J+fe);re[le+fe]=dt($[F+fe],Se)}}}function bt(){this.ud=this.hd=this.jd=0}function Tt(S,C){return((4278124286&(S^C))>>>1)+(S&C)>>>0}function zt(S){return 0<=S&&256>S?S:0>S?0:255<S?255:void 0}function tn(S,C){return zt(S+(S-C+.5>>1))}function Ut(S,C,$){return Math.abs(C-$)-Math.abs(S-$)}function sn(S,C,$,F,H,J,Q){for(F=J[Q-1],$=0;$<H;++$)J[Q+$]=F=dt(S[C+$],F)}function Yt(S,C,$,F,H){var J;for(J=0;J<$;++J){var Q=S[C+J],re=Q>>8&255,le=16711935&(le=(le=16711935&Q)+((re<<16)+re));F[H+J]=(4278255360&Q)+le>>>0}}function vt(S,C){C.jd=255&S,C.hd=S>>8&255,C.ud=S>>16&255}function en(S,C,$,F,H,J){var Q;for(Q=0;Q<F;++Q){var re=C[$+Q],le=re>>>8,fe=re,Se=255&(Se=(Se=re>>>16)+((S.jd<<24>>24)*(le<<24>>24)>>>5));fe=255&(fe=(fe+=(S.hd<<24>>24)*(le<<24>>24)>>>5)+((S.ud<<24>>24)*(Se<<24>>24)>>>5)),H[J+Q]=(4278255360&re)+(Se<<16)+fe}}function _t(S,C,$,F,H){D[C]=function(J,Q,re,le,fe,Se,Fe,he,Ae){for(le=Fe;le<he;++le)for(Fe=0;Fe<Ae;++Fe)fe[Se++]=H(re[F(J[Q++])])},D[S]=function(J,Q,re,le,fe,Se,Fe){var he=8>>J.b,Ae=J.Ea,Re=J.K[0],qe=J.w;if(8>he)for(J=(1<<J.b)-1,qe=(1<<he)-1;Q<re;++Q){var Oe,Ge=0;for(Oe=0;Oe<Ae;++Oe)Oe&J||(Ge=F(le[fe++])),Se[Fe++]=H(Re[Ge&qe]),Ge>>=he}else D["VP8LMapColor"+$](le,fe,Re,qe,Se,Fe,Q,re,Ae)}}function ks(S,C,$,F,H){for($=C+$;C<$;){var J=S[C++];F[H++]=J>>16&255,F[H++]=J>>8&255,F[H++]=255&J}}function ln(S,C,$,F,H){for($=C+$;C<$;){var J=S[C++];F[H++]=J>>16&255,F[H++]=J>>8&255,F[H++]=255&J,F[H++]=J>>24&255}}function Vt(S,C,$,F,H){for($=C+$;C<$;){var J=(Q=S[C++])>>16&240|Q>>12&15,Q=240&Q|Q>>28&15;F[H++]=J,F[H++]=Q}}function Zt(S,C,$,F,H){for($=C+$;C<$;){var J=(Q=S[C++])>>16&248|Q>>13&7,Q=Q>>5&224|Q>>3&31;F[H++]=J,F[H++]=Q}}function kn(S,C,$,F,H){for($=C+$;C<$;){var J=S[C++];F[H++]=255&J,F[H++]=J>>8&255,F[H++]=J>>16&255}}function jt(S,C,$,F,H,J){if(J==0)for($=C+$;C<$;)Ve(F,((J=S[C++])[0]>>24|J[1]>>8&65280|J[2]<<8&16711680|J[3]<<24)>>>0),H+=32;else s(F,H,S,C,$)}function ls(S,C){D[C][0]=D[S+"0"],D[C][1]=D[S+"1"],D[C][2]=D[S+"2"],D[C][3]=D[S+"3"],D[C][4]=D[S+"4"],D[C][5]=D[S+"5"],D[C][6]=D[S+"6"],D[C][7]=D[S+"7"],D[C][8]=D[S+"8"],D[C][9]=D[S+"9"],D[C][10]=D[S+"10"],D[C][11]=D[S+"11"],D[C][12]=D[S+"12"],D[C][13]=D[S+"13"],D[C][14]=D[S+"0"],D[C][15]=D[S+"0"]}function Kt(S){return S==xf||S==Wd||S==Gc||S==Gd}function nn(){this.eb=[],this.size=this.A=this.fb=0}function es(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function dn(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new nn,this.f.kb=new es,this.sd=null}function Lt(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function On(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Ui(S){return alert("todo:WebPSamplerProcessPlane"),S.T}function Jr(S,C){var $=S.T,F=C.ba.f.RGBA,H=F.eb,J=F.fb+S.ka*F.A,Q=Ur[C.ba.S],re=S.y,le=S.O,fe=S.f,Se=S.N,Fe=S.ea,he=S.W,Ae=C.cc,Re=C.dc,qe=C.Mc,Oe=C.Nc,Ge=S.ka,Xe=S.ka+S.T,it=S.U,Qe=it+1>>1;for(Ge==0?Q(re,le,null,null,fe,Se,Fe,he,fe,Se,Fe,he,H,J,null,null,it):(Q(C.ec,C.fc,re,le,Ae,Re,qe,Oe,fe,Se,Fe,he,H,J-F.A,H,J,it),++$);Ge+2<Xe;Ge+=2)Ae=fe,Re=Se,qe=Fe,Oe=he,Se+=S.Rc,he+=S.Rc,J+=2*F.A,Q(re,(le+=2*S.fa)-S.fa,re,le,Ae,Re,qe,Oe,fe,Se,Fe,he,H,J-F.A,H,J,it);return le+=S.fa,S.j+Xe<S.o?(s(C.ec,C.fc,re,le,it),s(C.cc,C.dc,fe,Se,Qe),s(C.Mc,C.Nc,Fe,he,Qe),$--):1&Xe||Q(re,le,null,null,fe,Se,Fe,he,fe,Se,Fe,he,H,J+F.A,null,null,it),$}function yo(S,C,$){var F=S.F,H=[S.J];if(F!=null){var J=S.U,Q=C.ba.S,re=Q==bf||Q==Gc;C=C.ba.f.RGBA;var le=[0],fe=S.ka;le[0]=S.T,S.Kb&&(fe==0?--le[0]:(--fe,H[0]-=S.width),S.j+S.ka+S.T==S.o&&(le[0]=S.o-S.j-fe));var Se=C.eb;fe=C.fb+fe*C.A,S=pf(F,H[0],S.width,J,le,Se,fe+(re?0:3),C.A),e($==le),S&&Kt(Q)&&Wu(Se,fe,re,J,le,C.A)}return 0}function fi(S){var C=S.ma,$=C.ba.S,F=11>$,H=$==na||$==bi||$==bf||$==Wc||$==12||Kt($);if(C.memory=null,C.Ib=null,C.Jb=null,C.Nd=null,!ul(C.Oa,S,H?11:12))return 0;if(H&&Kt($)&&cf(),S.da)alert("todo:use_scaling");else{if(F){if(C.Ib=Ui,S.Kb){if($=S.U+1>>1,C.memory=a(S.U+2*$),C.memory==null)return 0;C.ec=C.memory,C.fc=0,C.cc=C.ec,C.dc=C.fc+S.U,C.Mc=C.cc,C.Nc=C.dc+$,C.Ib=Jr,cf()}}else alert("todo:EmitYUV");H&&(C.Jb=yo,F&&Yi())}if(F&&!su){for(S=0;256>S;++S)Vr[S]=89858*(S-128)+Kc>>ki,cw[S]=-22014*(S-128)+Kc,$y[S]=-45773*(S-128),Yd[S]=113618*(S-128)+Kc>>ki;for(S=Ku;S<nu;++S)C=76283*(S-16)+Kc>>ki,hw[S-Ku]=Xa(C,255),fw[S-Ku]=Xa(C+8>>4,15);su=1}return 1}function Pt(S){var C=S.ma,$=S.U,F=S.T;return e(!(1&S.ka)),0>=$||0>=F?0:($=C.Ib(S,C),C.Jb!=null&&C.Jb(S,C,$),C.Dc+=$,1)}function Xo(S){S.ma.memory=null}function bo(S,C,$,F){return G(S,8)!=47?0:(C[0]=G(S,14)+1,$[0]=G(S,14)+1,F[0]=G(S,1),G(S,3)!=0?0:!S.h)}function Ga(S,C){if(4>S)return S+1;var $=S-2>>1;return(2+(1&S)<<$)+G(C,$)+1}function qa(S,C){return 120<C?C-120:1<=($=(($=vi[C-1])>>4)*S+(8-(15&$)))?$:1;var $}function Ns(S,C,$){var F=Y($),H=S[C+=255&F].g-8;return 0<H&&(ue($,$.u+8),F=Y($),C+=S[C].value,C+=F&(1<<H)-1),ue($,$.u+S[C].g),S[C].value}function Js(S,C,$){return $.g+=S.g,$.value+=S.value<<C>>>0,e(8>=$.g),S.g}function kr(S,C,$){var F=S.xc;return e((C=F==0?0:S.vc[S.md*($>>F)+(C>>F)])<S.Wb),S.Ya[C]}function Wl(S,C,$,F){var H=S.ab,J=S.c*C,Q=S.C;C=Q+C;var re=$,le=F;for(F=S.Ta,$=S.Ua;0<H--;){var fe=S.gc[H],Se=Q,Fe=C,he=re,Ae=le,Re=(le=F,re=$,fe.Ea);switch(e(Se<Fe),e(Fe<=fe.nc),fe.hc){case 2:qs(he,Ae,(Fe-Se)*Re,le,re);break;case 0:var qe=Se,Oe=Fe,Ge=le,Xe=re,it=(wt=fe).Ea;qe==0&&(Bc(he,Ae,null,null,1,Ge,Xe),sn(he,Ae+1,0,0,it-1,Ge,Xe+1),Ae+=it,Xe+=it,++qe);for(var Qe=1<<wt.b,At=Qe-1,gt=Je(it,wt.b),rn=wt.K,wt=wt.w+(qe>>wt.b)*gt;qe<Oe;){var Cn=rn,ys=wt,cn=1;for(Uc(he,Ae,Ge,Xe-it,1,Ge,Xe);cn<it;){var yt=(cn&~At)+Qe;yt>it&&(yt=it),(0,hl[Cn[ys++]>>8&15])(he,Ae+ +cn,Ge,Xe+cn-it,yt-cn,Ge,Xe+cn),cn=yt}Ae+=it,Xe+=it,++qe&At||(wt+=gt)}Fe!=fe.nc&&s(le,re-Re,le,re+(Fe-Se-1)*Re,Re);break;case 1:for(Re=he,Oe=Ae,it=(he=fe.Ea)-(Xe=he&~(Ge=(Ae=1<<fe.b)-1)),qe=Je(he,fe.b),Qe=fe.K,fe=fe.w+(Se>>fe.b)*qe;Se<Fe;){for(At=Qe,gt=fe,rn=new bt,wt=Oe+Xe,Cn=Oe+he;Oe<wt;)vt(At[gt++],rn),Vc(rn,Re,Oe,Ae,le,re),Oe+=Ae,re+=Ae;Oe<Cn&&(vt(At[gt++],rn),Vc(rn,Re,Oe,it,le,re),Oe+=it,re+=it),++Se&Ge||(fe+=qe)}break;case 3:if(he==le&&Ae==re&&0<fe.b){for(Oe=le,he=Re=re+(Fe-Se)*Re-(Xe=(Fe-Se)*Je(fe.Ea,fe.b)),Ae=le,Ge=re,qe=[],Xe=(it=Xe)-1;0<=Xe;--Xe)qe[Xe]=Ae[Ge+Xe];for(Xe=it-1;0<=Xe;--Xe)Oe[he+Xe]=qe[Xe];Pd(fe,Se,Fe,le,Re,le,re)}else Pd(fe,Se,Fe,he,Ae,le,re)}re=F,le=$}le!=$&&s(F,$,re,le,J)}function ga(S,C){var $=S.V,F=S.Ba+S.c*S.C,H=C-S.C;if(e(C<=S.l.o),e(16>=H),0<H){var J=S.l,Q=S.Ta,re=S.Ua,le=J.width;if(Wl(S,H,$,F),H=re=[re],e(($=S.C)<(F=C)),e(J.v<J.va),F>J.o&&(F=J.o),$<J.j){var fe=J.j-$;$=J.j,H[0]+=fe*le}if($>=F?$=0:(H[0]+=4*J.v,J.ka=$-J.j,J.U=J.va-J.v,J.T=F-$,$=1),$){if(re=re[0],11>($=S.ca).S){var Se=$.f.RGBA,Fe=(F=$.S,H=J.U,J=J.T,fe=Se.eb,Se.A),he=J;for(Se=Se.fb+S.Ma*Se.A;0<he--;){var Ae=Q,Re=re,qe=H,Oe=fe,Ge=Se;switch(F){case Vd:jc(Ae,Re,qe,Oe,Ge);break;case na:fl(Ae,Re,qe,Oe,Ge);break;case xf:fl(Ae,Re,qe,Oe,Ge),Wu(Oe,Ge,0,qe,1,0);break;case jd:Vu(Ae,Re,qe,Oe,Ge);break;case bi:jt(Ae,Re,qe,Oe,Ge,1);break;case Wd:jt(Ae,Re,qe,Oe,Ge,1),Wu(Oe,Ge,0,qe,1,0);break;case bf:jt(Ae,Re,qe,Oe,Ge,0);break;case Gc:jt(Ae,Re,qe,Oe,Ge,0),Wu(Oe,Ge,1,qe,1,0);break;case Wc:dl(Ae,Re,qe,Oe,Ge);break;case Gd:dl(Ae,Re,qe,Oe,Ge),yi(Oe,Ge,qe,1,0);break;case Zl:Eo(Ae,Re,qe,Oe,Ge);break;default:e(0)}re+=le,Se+=Fe}S.Ma+=J}else alert("todo:EmitRescaledRowsYUVA");e(S.Ma<=$.height)}}S.C=C,e(S.C<=S.i)}function ts(S){var C;if(0<S.ua)return 0;for(C=0;C<S.Wb;++C){var $=S.Ya[C].G,F=S.Ya[C].H;if(0<$[1][F[1]+0].g||0<$[2][F[2]+0].g||0<$[3][F[3]+0].g)return 0}return 1}function Cs(S,C,$,F,H,J){if(S.Z!=0){var Q=S.qd,re=S.rd;for(e(gl[S.Z]!=null);C<$;++C)gl[S.Z](Q,re,F,H,F,H,J),Q=F,re=H,H+=J;S.qd=Q,S.rd=re}}function Qr(S,C){var $=S.l.ma,F=$.Z==0||$.Z==1?S.l.j:S.C;if(F=S.C<F?F:S.C,e(C<=S.l.o),C>F){var H=S.l.width,J=$.ca,Q=$.tb+H*F,re=S.V,le=S.Ba+S.c*F,fe=S.gc;e(S.ab==1),e(fe[0].hc==3),Io(fe[0],F,C,re,le,J,Q),Cs($,F,C,J,Q,H)}S.C=S.Ma=C}function Ha(S,C,$,F,H,J,Q){var re=S.$/F,le=S.$%F,fe=S.m,Se=S.s,Fe=$+S.$,he=Fe;H=$+F*H;var Ae=$+F*J,Re=280+Se.ua,qe=S.Pb?re:16777216,Oe=0<Se.ua?Se.Wa:null,Ge=Se.wc,Xe=Fe<Ae?kr(Se,le,re):null;e(S.C<J),e(Ae<=H);var it=!1;e:for(;;){for(;it||Fe<Ae;){var Qe=0;if(re>=qe){var At=Fe-$;e((qe=S).Pb),qe.wd=qe.m,qe.xd=At,0<qe.s.ua&&tt(qe.s.Wa,qe.s.vb),qe=re+Jl}if(le&Ge||(Xe=kr(Se,le,re)),e(Xe!=null),Xe.Qb&&(C[Fe]=Xe.qb,it=!0),!it)if(pe(fe),Xe.jc){Qe=fe,At=C;var gt=Fe,rn=Xe.pd[Y(Qe)&Yl-1];e(Xe.jc),256>rn.g?(ue(Qe,Qe.u+rn.g),At[gt]=rn.value,Qe=0):(ue(Qe,Qe.u+rn.g-256),e(256<=rn.value),Qe=rn.value),Qe==0&&(it=!0)}else Qe=Ns(Xe.G[0],Xe.H[0],fe);if(fe.h)break;if(it||256>Qe){if(!it)if(Xe.nd)C[Fe]=(Xe.qb|Qe<<8)>>>0;else{if(pe(fe),it=Ns(Xe.G[1],Xe.H[1],fe),pe(fe),At=Ns(Xe.G[2],Xe.H[2],fe),gt=Ns(Xe.G[3],Xe.H[3],fe),fe.h)break;C[Fe]=(gt<<24|it<<16|Qe<<8|At)>>>0}if(it=!1,++Fe,++le>=F&&(le=0,++re,Q!=null&&re<=J&&!(re%16)&&Q(S,re),Oe!=null))for(;he<Fe;)Qe=C[he++],Oe.X[(506832829*Qe&4294967295)>>>Oe.Mb]=Qe}else if(280>Qe){if(Qe=Ga(Qe-256,fe),At=Ns(Xe.G[4],Xe.H[4],fe),pe(fe),At=qa(F,At=Ga(At,fe)),fe.h)break;if(Fe-$<At||H-Fe<Qe)break e;for(gt=0;gt<Qe;++gt)C[Fe+gt]=C[Fe+gt-At];for(Fe+=Qe,le+=Qe;le>=F;)le-=F,++re,Q!=null&&re<=J&&!(re%16)&&Q(S,re);if(e(Fe<=H),le&Ge&&(Xe=kr(Se,le,re)),Oe!=null)for(;he<Fe;)Qe=C[he++],Oe.X[(506832829*Qe&4294967295)>>>Oe.Mb]=Qe}else{if(!(Qe<Re))break e;for(it=Qe-280,e(Oe!=null);he<Fe;)Qe=C[he++],Oe.X[(506832829*Qe&4294967295)>>>Oe.Mb]=Qe;Qe=Fe,e(!(it>>>(At=Oe).Xa)),C[Qe]=At.X[it],it=!0}it||e(fe.h==ie(fe))}if(S.Pb&&fe.h&&Fe<H)e(S.m.h),S.a=5,S.m=S.wd,S.$=S.xd,0<S.s.ua&&tt(S.s.vb,S.s.Wa);else{if(fe.h)break e;Q?.(S,re>J?J:re),S.a=0,S.$=Fe-$}return 1}return S.a=3,0}function di(S){e(S!=null),S.vc=null,S.yc=null,S.Ya=null;var C=S.Wa;C!=null&&(C.X=null),S.vb=null,e(S!=null)}function Du(){var S=new Jt;return S==null?null:(S.a=0,S.xb=xg,ls("Predictor","VP8LPredictors"),ls("Predictor","VP8LPredictors_C"),ls("PredictorAdd","VP8LPredictorsAdd"),ls("PredictorAdd","VP8LPredictorsAdd_C"),qs=Yt,Vc=en,jc=ks,fl=ln,dl=Vt,Eo=Zt,Vu=kn,D.VP8LMapColor32b=Ao,D.VP8LMapColor8b=zr,S)}function Vi(S,C,$,F,H){var J=1,Q=[S],re=[C],le=F.m,fe=F.s,Se=null,Fe=0;e:for(;;){if($)for(;J&&G(le,1);){var he=Q,Ae=re,Re=F,qe=1,Oe=Re.m,Ge=Re.gc[Re.ab],Xe=G(Oe,2);if(Re.Oc&1<<Xe)J=0;else{switch(Re.Oc|=1<<Xe,Ge.hc=Xe,Ge.Ea=he[0],Ge.nc=Ae[0],Ge.K=[null],++Re.ab,e(4>=Re.ab),Xe){case 0:case 1:Ge.b=G(Oe,3)+2,qe=Vi(Je(Ge.Ea,Ge.b),Je(Ge.nc,Ge.b),0,Re,Ge.K),Ge.K=Ge.K[0];break;case 3:var it,Qe=G(Oe,8)+1,At=16<Qe?0:4<Qe?1:2<Qe?2:3;if(he[0]=Je(Ge.Ea,At),Ge.b=At,it=qe=Vi(Qe,1,0,Re,Ge.K)){var gt,rn=Qe,wt=Ge,Cn=1<<(8>>wt.b),ys=a(Cn);if(ys==null)it=0;else{var cn=wt.K[0],yt=wt.w;for(ys[0]=wt.K[0][0],gt=1;gt<1*rn;++gt)ys[gt]=dt(cn[yt+gt],ys[gt-1]);for(;gt<4*Cn;++gt)ys[gt]=0;wt.K[0]=null,wt.K[0]=ys,it=1}}qe=it;break;case 2:break;default:e(0)}J=qe}}if(Q=Q[0],re=re[0],J&&G(le,1)&&!(J=1<=(Fe=G(le,4))&&11>=Fe)){F.a=3;break e}var ut;if(ut=J)t:{var As,Ht,pn,Xn=F,gr=Q,jr=re,hs=Fe,tr=$,sa=Xn.m,nr=Xn.s,wn=[null],Pn=1,Is=0,Gn=wi[hs];n:for(;;){if(tr&&G(sa,1)){var yr=G(sa,3)+2,Es=Je(gr,yr),Bn=Je(jr,yr),Xs=Es*Bn;if(!Vi(Es,Bn,0,Xn,wn))break n;for(wn=wn[0],nr.xc=yr,As=0;As<Xs;++As){var Yn=wn[As]>>8&65535;wn[As]=Yn,Yn>=Pn&&(Pn=Yn+1)}}if(sa.h)break n;for(Ht=0;5>Ht;++Ht){var sr=qu[Ht];!Ht&&0<hs&&(sr+=1<<hs),Is<sr&&(Is=sr)}var rr=i(Pn*Gn,K),ns=Pn,Mn=i(ns,ae);if(Mn==null)var ra=null;else e(65536>=ns),ra=Mn;var Ls=a(Is);if(ra==null||Ls==null||rr==null){Xn.a=1;break n}var Bt=rr;for(As=pn=0;As<Pn;++As){var Wt=ra[As],Un=Wt.G,$a=Wt.H,Ci=0,Sa=1,ar=0;for(Ht=0;5>Ht;++Ht){sr=qu[Ht],Un[Ht]=Bt,$a[Ht]=pn,!Ht&&0<hs&&(sr+=1<<hs);r:{var ru,au=sr,Jd=Xn,fs=Ls,wg=Bt,Sg=pn,Qd=0,yl=Jd.m,dw=G(yl,1);if(r(fs,0,0,au),dw){var Ng=G(yl,1)+1,kg=G(yl,1),ep=G(yl,kg==0?1:8);fs[ep]=1,Ng==2&&(fs[ep=G(yl,8)]=1);var Ar=1}else{var Fs=a(19),Nf=G(yl,4)+4;if(19<Nf){Jd.a=3;var iu=0;break r}for(ru=0;ru<Nf;++ru)Fs[vf[ru]]=G(yl,3);var Yc=void 0,Xu=void 0,Ro=Jd,tp=Fs,Zc=au,np=fs,sp=0,bl=Ro.m,Cg=8,Tg=i(128,K);s:for(;M(Tg,0,7,tp,19);){if(G(bl,1)){var Ry=2+2*G(bl,3);if((Yc=2+G(bl,Ry))>Zc)break s}else Yc=Zc;for(Xu=0;Xu<Zc&&Yc--;){pe(bl);var Ag=Tg[0+(127&Y(bl))];ue(bl,bl.u+Ag.g);var ou=Ag.value;if(16>ou)np[Xu++]=ou,ou!=0&&(Cg=ou);else{var Dy=ou==16,Oy=ou-16,Ly=qc[Oy],Ig=G(bl,xi[Oy])+Ly;if(Xu+Ig>Zc)break s;for(var Fy=Dy?Cg:0;0<Ig--;)np[Xu++]=Fy}}sp=1;break s}sp||(Ro.a=3),Ar=sp}(Ar=Ar&&!yl.h)&&(Qd=M(wg,Sg,8,fs,au)),Ar&&Qd!=0?iu=Qd:(Jd.a=3,iu=0)}if(iu==0)break n;if(Sa&&qd[Ht]==1&&(Sa=Bt[pn].g==0),Ci+=Bt[pn].g,pn+=iu,3>=Ht){var Yu,rp=Ls[0];for(Yu=1;Yu<sr;++Yu)Ls[Yu]>rp&&(rp=Ls[Yu]);ar+=rp}}if(Wt.nd=Sa,Wt.Qb=0,Sa&&(Wt.qb=(Un[3][$a[3]+0].value<<24|Un[1][$a[1]+0].value<<16|Un[2][$a[2]+0].value)>>>0,Ci==0&&256>Un[0][$a[0]+0].value&&(Wt.Qb=1,Wt.qb+=Un[0][$a[0]+0].value<<8)),Wt.jc=!Wt.Qb&&6>ar,Wt.jc){var kf,Do=Wt;for(kf=0;kf<Yl;++kf){var xl=kf,vl=Do.pd[xl],ap=Do.G[0][Do.H[0]+xl];256<=ap.value?(vl.g=ap.g+256,vl.value=ap.value):(vl.g=0,vl.value=0,xl>>=Js(ap,8,vl),xl>>=Js(Do.G[1][Do.H[1]+xl],16,vl),xl>>=Js(Do.G[2][Do.H[2]+xl],0,vl),Js(Do.G[3][Do.H[3]+xl],24,vl))}}}nr.vc=wn,nr.Wb=Pn,nr.Ya=ra,nr.yc=rr,ut=1;break t}ut=0}if(!(J=ut)){F.a=3;break e}if(0<Fe){if(fe.ua=1<<Fe,!oe(fe.Wa,Fe)){F.a=1,J=0;break e}}else fe.ua=0;var ip=F,Zu=Q,My=re,Jc=ip.s,Qc=Jc.xc;if(ip.c=Zu,ip.i=My,Jc.md=Je(Zu,Qc),Jc.wc=Qc==0?-1:(1<<Qc)-1,$){F.xb=Ql;break e}if((Se=a(Q*re))==null){F.a=1,J=0;break e}J=(J=Ha(F,Se,0,Q,re,re,null))&&!le.h;break e}return J?(H!=null?H[0]=Se:(e(Se==null),e($)),F.$=0,$||di(fe)):di(fe),J}function ji(S,C){var $=S.c*S.i,F=$+C+16*C;return e(S.c<=C),S.V=a(F),S.V==null?(S.Ta=null,S.Ua=0,S.a=1,0):(S.Ta=S.V,S.Ua=S.Ba+$+C,1)}function Gl(S,C){var $=S.C,F=C-$,H=S.V,J=S.Ba+S.c*$;for(e(C<=S.l.o);0<F;){var Q=16<F?16:F,re=S.l.ma,le=S.l.width,fe=le*Q,Se=re.ca,Fe=re.tb+le*$,he=S.Ta,Ae=S.Ua;Wl(S,Q,H,J),ei(he,Ae,Se,Fe,fe),Cs(re,$,$+Q,Se,Fe,le),F-=Q,H+=Q*S.c,$+=Q}e($==C),S.C=S.Ma=C}function Wi(){this.ub=this.yd=this.td=this.Rb=0}function Gi(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Ou(){this.Fb=this.Bb=this.Cb=0,this.Zb=a(4),this.Lb=a(4)}function xo(){this.Yb=(function(){var S=[];return(function C($,F,H){for(var J=H[F],Q=0;Q<J&&($.push(H.length>F+1?[]:0),!(H.length<F+1));Q++)C($[Q],F+1,H)})(S,0,[3,11]),S})()}function Ws(){this.jb=a(3),this.Wc=o([4,8],xo),this.Xc=o([4,17],xo)}function Xh(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new a(4),this.od=new a(4)}function Ka(){this.ld=this.La=this.dd=this.tc=0}function qi(){this.Na=this.la=0}function Yo(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Yh(){this.ad=a(384),this.Za=0,this.Ob=a(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Zh(){this.uc=this.M=this.Nb=0,this.wa=Array(new Ka),this.Y=0,this.ya=Array(new Yh),this.aa=0,this.l=new Zo}function Jh(){this.y=a(16),this.f=a(8),this.ea=a(8)}function Ed(){this.cb=this.a=0,this.sc="",this.m=new O,this.Od=new Wi,this.Kc=new Gi,this.ed=new Xh,this.Qa=new Ou,this.Ic=this.$c=this.Aa=0,this.D=new Zh,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=i(8,O),this.ia=0,this.pb=i(4,Yo),this.Pa=new Ws,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Jh),this.Hd=0,this.rb=Array(new qi),this.sb=0,this.wa=Array(new Ka),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Yh),this.L=this.aa=0,this.gd=o([4,2],Ka),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Xa(S,C){return 0>S?0:S>C?C:S}function Zo(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Hi(){var S=new Ed;return S!=null&&(S.a=0,S.sc="OK",S.cb=0,S.Xb=0,ti||(ti=ql)),S}function jn(S,C,$){return S.a==0&&(S.a=C,S.sc=$,S.cb=0),0}function Qh(S,C,$){return 3<=$&&S[C+0]==157&&S[C+1]==1&&S[C+2]==42}function vo(S,C){if(S==null)return 0;if(S.a=0,S.sc="OK",C==null)return jn(S,2,"null VP8Io passed to VP8GetHeaders()");var $=C.data,F=C.w,H=C.ha;if(4>H)return jn(S,7,"Truncated header.");var J=$[F+0]|$[F+1]<<8|$[F+2]<<16,Q=S.Od;if(Q.Rb=!(1&J),Q.td=J>>1&7,Q.yd=J>>4&1,Q.ub=J>>5,3<Q.td)return jn(S,3,"Incorrect keyframe parameters.");if(!Q.yd)return jn(S,4,"Frame not displayable.");F+=3,H-=3;var re=S.Kc;if(Q.Rb){if(7>H)return jn(S,7,"cannot parse picture header");if(!Qh($,F,H))return jn(S,3,"Bad code word");re.c=16383&($[F+4]<<8|$[F+3]),re.Td=$[F+4]>>6,re.i=16383&($[F+6]<<8|$[F+5]),re.Ud=$[F+6]>>6,F+=7,H-=7,S.za=re.c+15>>4,S.Ub=re.i+15>>4,C.width=re.c,C.height=re.i,C.Da=0,C.j=0,C.v=0,C.va=C.width,C.o=C.height,C.da=0,C.ib=C.width,C.hb=C.height,C.U=C.width,C.T=C.height,r((J=S.Pa).jb,0,255,J.jb.length),e((J=S.Qa)!=null),J.Cb=0,J.Bb=0,J.Fb=1,r(J.Zb,0,0,J.Zb.length),r(J.Lb,0,0,J.Lb)}if(Q.ub>H)return jn(S,7,"bad partition length");W(J=S.m,$,F,Q.ub),F+=Q.ub,H-=Q.ub,Q.Rb&&(re.Ld=Ne(J),re.Kd=Ne(J)),re=S.Qa;var le,fe=S.Pa;if(e(J!=null),e(re!=null),re.Cb=Ne(J),re.Cb){if(re.Bb=Ne(J),Ne(J)){for(re.Fb=Ne(J),le=0;4>le;++le)re.Zb[le]=Ne(J)?ee(J,7):0;for(le=0;4>le;++le)re.Lb[le]=Ne(J)?ee(J,6):0}if(re.Bb)for(le=0;3>le;++le)fe.jb[le]=Ne(J)?se(J,8):255}else re.Bb=0;if(J.Ka)return jn(S,3,"cannot parse segment header");if((re=S.ed).zd=Ne(J),re.Tb=se(J,6),re.wb=se(J,3),re.Pc=Ne(J),re.Pc&&Ne(J)){for(fe=0;4>fe;++fe)Ne(J)&&(re.vd[fe]=ee(J,6));for(fe=0;4>fe;++fe)Ne(J)&&(re.od[fe]=ee(J,6))}if(S.L=re.Tb==0?0:re.zd?1:2,J.Ka)return jn(S,3,"cannot parse filter header");var Se=H;if(H=le=F,F=le+Se,re=Se,S.Xb=(1<<se(S.m,2))-1,Se<3*(fe=S.Xb))$=7;else{for(le+=3*fe,re-=3*fe,Se=0;Se<fe;++Se){var Fe=$[H+0]|$[H+1]<<8|$[H+2]<<16;Fe>re&&(Fe=re),W(S.Jc[+Se],$,le,Fe),le+=Fe,re-=Fe,H+=3}W(S.Jc[+fe],$,le,re),$=le<F?0:5}if($!=0)return jn(S,$,"cannot parse partitions");for($=se(le=S.m,7),H=Ne(le)?ee(le,4):0,F=Ne(le)?ee(le,4):0,re=Ne(le)?ee(le,4):0,fe=Ne(le)?ee(le,4):0,le=Ne(le)?ee(le,4):0,Se=S.Qa,Fe=0;4>Fe;++Fe){if(Se.Cb){var he=Se.Zb[Fe];Se.Fb||(he+=$)}else{if(0<Fe){S.pb[Fe]=S.pb[0];continue}he=$}var Ae=S.pb[Fe];Ae.Sc[0]=Si[Xa(he+H,127)],Ae.Sc[1]=Ni[Xa(he+0,127)],Ae.Eb[0]=2*Si[Xa(he+F,127)],Ae.Eb[1]=101581*Ni[Xa(he+re,127)]>>16,8>Ae.Eb[1]&&(Ae.Eb[1]=8),Ae.Qc[0]=Si[Xa(he+fe,117)],Ae.Qc[1]=Ni[Xa(he+le,127)],Ae.lc=he+le}if(!Q.Rb)return jn(S,4,"Not a key frame.");for(Ne(J),Q=S.Pa,$=0;4>$;++$){for(H=0;8>H;++H)for(F=0;3>F;++F)for(re=0;11>re;++re)fe=Le(J,gs[$][H][F][re])?se(J,8):_y[$][H][F][re],Q.Wc[$][H].Yb[F][re]=fe;for(H=0;17>H;++H)Q.Xc[$][H]=Q.Wc[$][In[H]]}return S.kc=Ne(J),S.kc&&(S.Bd=se(J,8)),S.cb=1}function ql(S,C,$,F,H,J,Q){var re=C[H].Yb[$];for($=0;16>H;++H){if(!Le(S,re[$+0]))return H;for(;!Le(S,re[$+1]);)if(re=C[++H].Yb[0],$=0,H==16)return 16;var le=C[H+1].Yb;if(Le(S,re[$+2])){var fe=S,Se=0;if(Le(fe,(he=re)[(Fe=$)+3]))if(Le(fe,he[Fe+6])){for(re=0,Fe=2*(Se=Le(fe,he[Fe+8]))+(he=Le(fe,he[Fe+9+Se])),Se=0,he=Ey[Fe];he[re];++re)Se+=Se+Le(fe,he[re]);Se+=3+(8<<Fe)}else Le(fe,he[Fe+7])?(Se=7+2*Le(fe,165),Se+=Le(fe,145)):Se=5+Le(fe,159);else Se=Le(fe,he[Fe+4])?3+Le(fe,he[Fe+5]):2;re=le[2]}else Se=1,re=le[1];le=Q+bg[H],0>(fe=S).b&&Ce(fe);var Fe,he=fe.b,Ae=(Fe=fe.Ca>>1)-(fe.I>>he)>>31;--fe.b,fe.Ca+=Ae,fe.Ca|=1,fe.I-=(Fe+1&Ae)<<he,J[le]=((Se^Ae)-Ae)*F[(0<H)+0]}return 16}function ef(S){var C=S.rb[S.sb-1];C.la=0,C.Na=0,r(S.zc,0,0,S.zc.length),S.ja=0}function ya(S,C,$,F,H){H=S[C+$+32*F]+(H>>3),S[C+$+32*F]=-256&H?0>H?0:255:H}function pr(S,C,$,F,H,J){ya(S,C,0,$,F+H),ya(S,C,1,$,F+J),ya(S,C,2,$,F-J),ya(S,C,3,$,F-H)}function Qs(S){return(20091*S>>16)+S}function Dc(S,C,$,F){var H,J=0,Q=a(16);for(H=0;4>H;++H){var re=S[C+0]+S[C+8],le=S[C+0]-S[C+8],fe=(35468*S[C+4]>>16)-Qs(S[C+12]),Se=Qs(S[C+4])+(35468*S[C+12]>>16);Q[J+0]=re+Se,Q[J+1]=le+fe,Q[J+2]=le-fe,Q[J+3]=re-Se,J+=4,C++}for(H=J=0;4>H;++H)re=(S=Q[J+0]+4)+Q[J+8],le=S-Q[J+8],fe=(35468*Q[J+4]>>16)-Qs(Q[J+12]),ya($,F,0,0,re+(Se=Qs(Q[J+4])+(35468*Q[J+12]>>16))),ya($,F,1,0,le+fe),ya($,F,2,0,le-fe),ya($,F,3,0,re-Se),J++,F+=32}function _d(S,C,$,F){var H=S[C+0]+4,J=35468*S[C+4]>>16,Q=Qs(S[C+4]),re=35468*S[C+1]>>16;pr($,F,0,H+Q,S=Qs(S[C+1]),re),pr($,F,1,H+J,S,re),pr($,F,2,H-J,S,re),pr($,F,3,H-Q,S,re)}function tf(S,C,$,F,H){Dc(S,C,$,F),H&&Dc(S,C+16,$,F+4)}function ba(S,C,$,F){pl(S,C+0,$,F,1),pl(S,C+32,$,F+128,1)}function nf(S,C,$,F){var H;for(S=S[C+0]+4,H=0;4>H;++H)for(C=0;4>C;++C)ya($,F,C,H,S)}function sf(S,C,$,F){S[C+0]&&Wn(S,C+0,$,F),S[C+16]&&Wn(S,C+16,$,F+4),S[C+32]&&Wn(S,C+32,$,F+128),S[C+48]&&Wn(S,C+48,$,F+128+4)}function Ki(S,C,$,F){var H,J=a(16);for(H=0;4>H;++H){var Q=S[C+0+H]+S[C+12+H],re=S[C+4+H]+S[C+8+H],le=S[C+4+H]-S[C+8+H],fe=S[C+0+H]-S[C+12+H];J[0+H]=Q+re,J[8+H]=Q-re,J[4+H]=fe+le,J[12+H]=fe-le}for(H=0;4>H;++H)Q=(S=J[0+4*H]+3)+J[3+4*H],re=J[1+4*H]+J[2+4*H],le=J[1+4*H]-J[2+4*H],fe=S-J[3+4*H],$[F+0]=Q+re>>3,$[F+16]=fe+le>>3,$[F+32]=Q-re>>3,$[F+48]=fe-le>>3,F+=64}function Lu(S,C,$){var F,H=C-32,J=ta,Q=255-S[H-1];for(F=0;F<$;++F){var re,le=J,fe=Q+S[C-1];for(re=0;re<$;++re)S[C+re]=le[fe+S[H+re]];C+=32}}function $d(S,C){Lu(S,C,4)}function Rd(S,C){Lu(S,C,8)}function rf(S,C){Lu(S,C,16)}function af(S,C){var $;for($=0;16>$;++$)s(S,C+32*$,S,C-32,16)}function Dd(S,C){var $;for($=16;0<$;--$)r(S,C,S[C-1],16),C+=32}function Ea(S,C,$){var F;for(F=0;16>F;++F)r(C,$+32*F,S,16)}function Xi(S,C){var $,F=16;for($=0;16>$;++$)F+=S[C-1+32*$]+S[C+$-32];Ea(F>>5,S,C)}function Jo(S,C){var $,F=8;for($=0;16>$;++$)F+=S[C-1+32*$];Ea(F>>4,S,C)}function Fu(S,C){var $,F=8;for($=0;16>$;++$)F+=S[C+$-32];Ea(F>>4,S,C)}function Hl(S,C){Ea(128,S,C)}function qt(S,C,$){return S+2*C+$+2>>2}function Od(S,C){var $,F=C-32;for(F=new Uint8Array([qt(S[F-1],S[F+0],S[F+1]),qt(S[F+0],S[F+1],S[F+2]),qt(S[F+1],S[F+2],S[F+3]),qt(S[F+2],S[F+3],S[F+4])]),$=0;4>$;++$)s(S,C+32*$,F,0,F.length)}function of(S,C){var $=S[C-1],F=S[C-1+32],H=S[C-1+64],J=S[C-1+96];Ve(S,C+0,16843009*qt(S[C-1-32],$,F)),Ve(S,C+32,16843009*qt($,F,H)),Ve(S,C+64,16843009*qt(F,H,J)),Ve(S,C+96,16843009*qt(H,J,J))}function Ld(S,C){var $,F=4;for($=0;4>$;++$)F+=S[C+$-32]+S[C-1+32*$];for(F>>=3,$=0;4>$;++$)r(S,C+32*$,F,4)}function Ya(S,C){var $=S[C-1+0],F=S[C-1+32],H=S[C-1+64],J=S[C-1-32],Q=S[C+0-32],re=S[C+1-32],le=S[C+2-32],fe=S[C+3-32];S[C+0+96]=qt(F,H,S[C-1+96]),S[C+1+96]=S[C+0+64]=qt($,F,H),S[C+2+96]=S[C+1+64]=S[C+0+32]=qt(J,$,F),S[C+3+96]=S[C+2+64]=S[C+1+32]=S[C+0+0]=qt(Q,J,$),S[C+3+64]=S[C+2+32]=S[C+1+0]=qt(re,Q,J),S[C+3+32]=S[C+2+0]=qt(le,re,Q),S[C+3+0]=qt(fe,le,re)}function Fr(S,C){var $=S[C+1-32],F=S[C+2-32],H=S[C+3-32],J=S[C+4-32],Q=S[C+5-32],re=S[C+6-32],le=S[C+7-32];S[C+0+0]=qt(S[C+0-32],$,F),S[C+1+0]=S[C+0+32]=qt($,F,H),S[C+2+0]=S[C+1+32]=S[C+0+64]=qt(F,H,J),S[C+3+0]=S[C+2+32]=S[C+1+64]=S[C+0+96]=qt(H,J,Q),S[C+3+32]=S[C+2+64]=S[C+1+96]=qt(J,Q,re),S[C+3+64]=S[C+2+96]=qt(Q,re,le),S[C+3+96]=qt(re,le,le)}function lf(S,C){var $=S[C-1+0],F=S[C-1+32],H=S[C-1+64],J=S[C-1-32],Q=S[C+0-32],re=S[C+1-32],le=S[C+2-32],fe=S[C+3-32];S[C+0+0]=S[C+1+64]=J+Q+1>>1,S[C+1+0]=S[C+2+64]=Q+re+1>>1,S[C+2+0]=S[C+3+64]=re+le+1>>1,S[C+3+0]=le+fe+1>>1,S[C+0+96]=qt(H,F,$),S[C+0+64]=qt(F,$,J),S[C+0+32]=S[C+1+96]=qt($,J,Q),S[C+1+32]=S[C+2+96]=qt(J,Q,re),S[C+2+32]=S[C+3+96]=qt(Q,re,le),S[C+3+32]=qt(re,le,fe)}function Mu(S,C){var $=S[C+0-32],F=S[C+1-32],H=S[C+2-32],J=S[C+3-32],Q=S[C+4-32],re=S[C+5-32],le=S[C+6-32],fe=S[C+7-32];S[C+0+0]=$+F+1>>1,S[C+1+0]=S[C+0+64]=F+H+1>>1,S[C+2+0]=S[C+1+64]=H+J+1>>1,S[C+3+0]=S[C+2+64]=J+Q+1>>1,S[C+0+32]=qt($,F,H),S[C+1+32]=S[C+0+96]=qt(F,H,J),S[C+2+32]=S[C+1+96]=qt(H,J,Q),S[C+3+32]=S[C+2+96]=qt(J,Q,re),S[C+3+64]=qt(Q,re,le),S[C+3+96]=qt(re,le,fe)}function Za(S,C){var $=S[C-1+0],F=S[C-1+32],H=S[C-1+64],J=S[C-1+96];S[C+0+0]=$+F+1>>1,S[C+2+0]=S[C+0+32]=F+H+1>>1,S[C+2+32]=S[C+0+64]=H+J+1>>1,S[C+1+0]=qt($,F,H),S[C+3+0]=S[C+1+32]=qt(F,H,J),S[C+3+32]=S[C+1+64]=qt(H,J,J),S[C+3+64]=S[C+2+64]=S[C+0+96]=S[C+1+96]=S[C+2+96]=S[C+3+96]=J}function zu(S,C){var $=S[C-1+0],F=S[C-1+32],H=S[C-1+64],J=S[C-1+96],Q=S[C-1-32],re=S[C+0-32],le=S[C+1-32],fe=S[C+2-32];S[C+0+0]=S[C+2+32]=$+Q+1>>1,S[C+0+32]=S[C+2+64]=F+$+1>>1,S[C+0+64]=S[C+2+96]=H+F+1>>1,S[C+0+96]=J+H+1>>1,S[C+3+0]=qt(re,le,fe),S[C+2+0]=qt(Q,re,le),S[C+1+0]=S[C+3+32]=qt($,Q,re),S[C+1+32]=S[C+3+64]=qt(F,$,Q),S[C+1+64]=S[C+3+96]=qt(H,F,$),S[C+1+96]=qt(J,H,F)}function wo(S,C){var $;for($=0;8>$;++$)s(S,C+32*$,S,C-32,8)}function Fd(S,C){var $;for($=0;8>$;++$)r(S,C,S[C-1],8),C+=32}function pi(S,C,$){var F;for(F=0;8>F;++F)r(C,$+32*F,S,8)}function Oc(S,C){var $,F=8;for($=0;8>$;++$)F+=S[C+$-32]+S[C-1+32*$];pi(F>>4,S,C)}function Lc(S,C){var $,F=4;for($=0;8>$;++$)F+=S[C+$-32];pi(F>>3,S,C)}function Cr(S,C){var $,F=4;for($=0;8>$;++$)F+=S[C-1+32*$];pi(F>>3,S,C)}function So(S,C){pi(128,S,C)}function mi(S,C,$){var F=S[C-$],H=S[C+0],J=3*(H-F)+ml[1020+S[C-2*$]-S[C+$]],Q=yf[112+(J+4>>3)];S[C-$]=ta[255+F+yf[112+(J+3>>3)]],S[C+0]=ta[255+H-Q]}function Qo(S,C,$,F){var H=S[C+0],J=S[C+$];return Pr[255+S[C-2*$]-S[C-$]]>F||Pr[255+J-H]>F}function Fc(S,C,$,F){return 4*Pr[255+S[C-$]-S[C+0]]+Pr[255+S[C-2*$]-S[C+$]]<=F}function Pu(S,C,$,F,H){var J=S[C-3*$],Q=S[C-2*$],re=S[C-$],le=S[C+0],fe=S[C+$],Se=S[C+2*$],Fe=S[C+3*$];return 4*Pr[255+re-le]+Pr[255+Q-fe]>F?0:Pr[255+S[C-4*$]-J]<=H&&Pr[255+J-Q]<=H&&Pr[255+Q-re]<=H&&Pr[255+Fe-Se]<=H&&Pr[255+Se-fe]<=H&&Pr[255+fe-le]<=H}function el(S,C,$,F){var H=2*F+1;for(F=0;16>F;++F)Fc(S,C+F,$,H)&&mi(S,C+F,$)}function tl(S,C,$,F){var H=2*F+1;for(F=0;16>F;++F)Fc(S,C+F*$,1,H)&&mi(S,C+F*$,1)}function Bu(S,C,$,F){var H;for(H=3;0<H;--H)el(S,C+=4*$,$,F)}function uf(S,C,$,F){var H;for(H=3;0<H;--H)tl(S,C+=4,$,F)}function nl(S,C,$,F,H,J,Q,re){for(J=2*J+1;0<H--;){if(Pu(S,C,$,J,Q))if(Qo(S,C,$,re))mi(S,C,$);else{var le=S,fe=C,Se=$,Fe=le[fe-2*Se],he=le[fe-Se],Ae=le[fe+0],Re=le[fe+Se],qe=le[fe+2*Se],Oe=27*(Xe=ml[1020+3*(Ae-he)+ml[1020+Fe-Re]])+63>>7,Ge=18*Xe+63>>7,Xe=9*Xe+63>>7;le[fe-3*Se]=ta[255+le[fe-3*Se]+Xe],le[fe-2*Se]=ta[255+Fe+Ge],le[fe-Se]=ta[255+he+Oe],le[fe+0]=ta[255+Ae-Oe],le[fe+Se]=ta[255+Re-Ge],le[fe+2*Se]=ta[255+qe-Xe]}C+=F}}function sl(S,C,$,F,H,J,Q,re){for(J=2*J+1;0<H--;){if(Pu(S,C,$,J,Q))if(Qo(S,C,$,re))mi(S,C,$);else{var le=S,fe=C,Se=$,Fe=le[fe-Se],he=le[fe+0],Ae=le[fe+Se],Re=yf[112+(4+(qe=3*(he-Fe))>>3)],qe=yf[112+(qe+3>>3)],Oe=Re+1>>1;le[fe-2*Se]=ta[255+le[fe-2*Se]+Oe],le[fe-Se]=ta[255+Fe+qe],le[fe+0]=ta[255+he-Re],le[fe+Se]=ta[255+Ae-Oe]}C+=F}}function Md(S,C,$,F,H,J){nl(S,C,$,1,16,F,H,J)}function rl(S,C,$,F,H,J){nl(S,C,1,$,16,F,H,J)}function zd(S,C,$,F,H,J){var Q;for(Q=3;0<Q;--Q)sl(S,C+=4*$,$,1,16,F,H,J)}function _(S,C,$,F,H,J){var Q;for(Q=3;0<Q;--Q)sl(S,C+=4,1,$,16,F,H,J)}function q(S,C,$,F,H,J,Q,re){nl(S,C,H,1,8,J,Q,re),nl($,F,H,1,8,J,Q,re)}function de(S,C,$,F,H,J,Q,re){nl(S,C,1,H,8,J,Q,re),nl($,F,1,H,8,J,Q,re)}function ve(S,C,$,F,H,J,Q,re){sl(S,C+4*H,H,1,8,J,Q,re),sl($,F+4*H,H,1,8,J,Q,re)}function Ie(S,C,$,F,H,J,Q,re){sl(S,C+4,1,H,8,J,Q,re),sl($,F+4,1,H,8,J,Q,re)}function Ke(){this.ba=new dn,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new On,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function nt(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Nt(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Rt(){this.ua=0,this.Wa=new xt,this.vb=new xt,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new ae,this.yc=new K}function Jt(){this.xb=this.a=0,this.l=new Zo,this.ca=new dn,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new j,this.Pb=0,this.wd=new j,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Rt,this.ab=0,this.gc=i(4,Nt),this.Oc=0}function un(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Zo,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Ln(S,C,$,F,H,J,Q){for(S=S==null?0:S[C+0],C=0;C<Q;++C)H[J+C]=S+$[F+C]&255,S=H[J+C]}function Ts(S,C,$,F,H,J,Q){var re;if(S==null)Ln(null,null,$,F,H,J,Q);else for(re=0;re<Q;++re)H[J+re]=S[C+re]+$[F+re]&255}function Gs(S,C,$,F,H,J,Q){if(S==null)Ln(null,null,$,F,H,J,Q);else{var re,le=S[C+0],fe=le,Se=le;for(re=0;re<Q;++re)fe=Se+(le=S[C+re])-fe,Se=$[F+re]+(-256&fe?0>fe?0:255:fe)&255,fe=le,H[J+re]=Se}}function us(S,C,$,F){var H=C.width,J=C.o;if(e(S!=null&&C!=null),0>$||0>=F||$+F>J)return null;if(!S.Cc){if(S.ga==null){var Q;if(S.ga=new un,(Q=S.ga==null)||(Q=C.width*C.o,e(S.Gb.length==0),S.Gb=a(Q),S.Uc=0,S.Gb==null?Q=0:(S.mb=S.Gb,S.nb=S.Uc,S.rc=null,Q=1),Q=!Q),!Q){Q=S.ga;var re=S.Fa,le=S.P,fe=S.qc,Se=S.mb,Fe=S.nb,he=le+1,Ae=fe-1,Re=Q.l;if(e(re!=null&&Se!=null&&C!=null),gl[0]=null,gl[1]=Ln,gl[2]=Ts,gl[3]=Gs,Q.ca=Se,Q.tb=Fe,Q.c=C.width,Q.i=C.height,e(0<Q.c&&0<Q.i),1>=fe)C=0;else if(Q.$a=3&re[le+0],Q.Z=re[le+0]>>2&3,Q.Lc=re[le+0]>>4&3,le=re[le+0]>>6&3,0>Q.$a||1<Q.$a||4<=Q.Z||1<Q.Lc||le)C=0;else if(Re.put=Pt,Re.ac=fi,Re.bc=Xo,Re.ma=Q,Re.width=C.width,Re.height=C.height,Re.Da=C.Da,Re.v=C.v,Re.va=C.va,Re.j=C.j,Re.o=C.o,Q.$a)e:{e(Q.$a==1),C=Du();t:for(;;){if(C==null){C=0;break e}if(e(Q!=null),Q.mc=C,C.c=Q.c,C.i=Q.i,C.l=Q.l,C.l.ma=Q,C.l.width=Q.c,C.l.height=Q.i,C.a=0,ce(C.m,re,he,Ae),!Vi(Q.c,Q.i,1,C,null)||(C.ab==1&&C.gc[0].hc==3&&ts(C.s)?(Q.ic=1,re=C.c*C.i,C.Ta=null,C.Ua=0,C.V=a(re),C.Ba=0,C.V==null?(C.a=1,C=0):C=1):(Q.ic=0,C=ji(C,Q.c)),!C))break t;C=1;break e}Q.mc=null,C=0}else C=Ae>=Q.c*Q.i;Q=!C}if(Q)return null;S.ga.Lc!=1?S.Ga=0:F=J-$}e(S.ga!=null),e($+F<=J);e:{if(C=(re=S.ga).c,J=re.l.o,re.$a==0){if(he=S.rc,Ae=S.Vc,Re=S.Fa,le=S.P+1+$*C,fe=S.mb,Se=S.nb+$*C,e(le<=S.P+S.qc),re.Z!=0)for(e(gl[re.Z]!=null),Q=0;Q<F;++Q)gl[re.Z](he,Ae,Re,le,fe,Se,C),he=fe,Ae=Se,Se+=C,le+=C;else for(Q=0;Q<F;++Q)s(fe,Se,Re,le,C),he=fe,Ae=Se,Se+=C,le+=C;S.rc=he,S.Vc=Ae}else{if(e(re.mc!=null),C=$+F,e((Q=re.mc)!=null),e(C<=Q.i),Q.C>=C)C=1;else if(re.ic||Yi(),re.ic){re=Q.V,he=Q.Ba,Ae=Q.c;var qe=Q.i,Oe=(Re=1,le=Q.$/Ae,fe=Q.$%Ae,Se=Q.m,Fe=Q.s,Q.$),Ge=Ae*qe,Xe=Ae*C,it=Fe.wc,Qe=Oe<Xe?kr(Fe,fe,le):null;e(Oe<=Ge),e(C<=qe),e(ts(Fe));t:for(;;){for(;!Se.h&&Oe<Xe;){if(fe&it||(Qe=kr(Fe,fe,le)),e(Qe!=null),pe(Se),256>(qe=Ns(Qe.G[0],Qe.H[0],Se)))re[he+Oe]=qe,++Oe,++fe>=Ae&&(fe=0,++le<=C&&!(le%16)&&Qr(Q,le));else{if(!(280>qe)){Re=0;break t}qe=Ga(qe-256,Se);var At,gt=Ns(Qe.G[4],Qe.H[4],Se);if(pe(Se),!(Oe>=(gt=qa(Ae,gt=Ga(gt,Se)))&&Ge-Oe>=qe)){Re=0;break t}for(At=0;At<qe;++At)re[he+Oe+At]=re[he+Oe+At-gt];for(Oe+=qe,fe+=qe;fe>=Ae;)fe-=Ae,++le<=C&&!(le%16)&&Qr(Q,le);Oe<Xe&&fe&it&&(Qe=kr(Fe,fe,le))}e(Se.h==ie(Se))}Qr(Q,le>C?C:le);break t}!Re||Se.h&&Oe<Ge?(Re=0,Q.a=Se.h?5:3):Q.$=Oe,C=Re}else C=Ha(Q,Q.V,Q.Ba,Q.c,Q.i,C,Gl);if(!C){F=0;break e}}$+F>=J&&(S.Cc=1),F=1}if(!F)return null;if(S.Cc&&((F=S.ga)!=null&&(F.mc=null),S.ga=null,0<S.Ga))return alert("todo:WebPDequantizeLevels"),null}return S.nb+$*H}function mr(S,C,$,F,H,J){for(;0<H--;){var Q,re=S,le=C+($?1:0),fe=S,Se=C+($?0:3);for(Q=0;Q<F;++Q){var Fe=fe[Se+4*Q];Fe!=255&&(Fe*=32897,re[le+4*Q+0]=re[le+4*Q+0]*Fe>>23,re[le+4*Q+1]=re[le+4*Q+1]*Fe>>23,re[le+4*Q+2]=re[le+4*Q+2]*Fe>>23)}C+=J}}function er(S,C,$,F,H){for(;0<F--;){var J;for(J=0;J<$;++J){var Q=S[C+2*J+0],re=15&(fe=S[C+2*J+1]),le=4369*re,fe=(240&fe|fe>>4)*le>>16;S[C+2*J+0]=(240&Q|Q>>4)*le>>16&240|(15&Q|Q<<4)*le>>16>>4&15,S[C+2*J+1]=240&fe|re}C+=H}}function Mr(S,C,$,F,H,J,Q,re){var le,fe,Se=255;for(fe=0;fe<H;++fe){for(le=0;le<F;++le){var Fe=S[C+le];J[Q+4*le]=Fe,Se&=Fe}C+=$,Q+=re}return Se!=255}function al(S,C,$,F,H){var J;for(J=0;J<H;++J)$[F+J]=S[C+J]>>8}function Yi(){Wu=mr,yi=er,pf=Mr,ei=al}function il(S,C,$){D[S]=function(F,H,J,Q,re,le,fe,Se,Fe,he,Ae,Re,qe,Oe,Ge,Xe,it){var Qe,At=it-1>>1,gt=re[le+0]|fe[Se+0]<<16,rn=Fe[he+0]|Ae[Re+0]<<16;e(F!=null);var wt=3*gt+rn+131074>>2;for(C(F[H+0],255&wt,wt>>16,qe,Oe),J!=null&&(wt=3*rn+gt+131074>>2,C(J[Q+0],255&wt,wt>>16,Ge,Xe)),Qe=1;Qe<=At;++Qe){var Cn=re[le+Qe]|fe[Se+Qe]<<16,ys=Fe[he+Qe]|Ae[Re+Qe]<<16,cn=gt+Cn+rn+ys+524296,yt=cn+2*(Cn+rn)>>3;wt=yt+gt>>1,gt=(cn=cn+2*(gt+ys)>>3)+Cn>>1,C(F[H+2*Qe-1],255&wt,wt>>16,qe,Oe+(2*Qe-1)*$),C(F[H+2*Qe-0],255&gt,gt>>16,qe,Oe+(2*Qe-0)*$),J!=null&&(wt=cn+rn>>1,gt=yt+ys>>1,C(J[Q+2*Qe-1],255&wt,wt>>16,Ge,Xe+(2*Qe-1)*$),C(J[Q+2*Qe+0],255&gt,gt>>16,Ge,Xe+(2*Qe+0)*$)),gt=Cn,rn=ys}1&it||(wt=3*gt+rn+131074>>2,C(F[H+it-1],255&wt,wt>>16,qe,Oe+(it-1)*$),J!=null&&(wt=3*rn+gt+131074>>2,C(J[Q+it-1],255&wt,wt>>16,Ge,Xe+(it-1)*$)))}}function cf(){Ur[Vd]=Hu,Ur[na]=Hc,Ur[jd]=vg,Ur[bi]=Kd,Ur[bf]=eu,Ur[Wc]=$o,Ur[Zl]=tu,Ur[xf]=Hc,Ur[Wd]=Kd,Ur[Gc]=eu,Ur[Gd]=$o}function Mc(S){return S&-16384?0>S?0:255:S>>Xd}function No(S,C){return Mc((19077*S>>8)+(26149*C>>8)-14234)}function Zi(S,C,$){return Mc((19077*S>>8)-(6419*C>>8)-(13320*$>>8)+8708)}function Uu(S,C){return Mc((19077*S>>8)+(33050*C>>8)-17685)}function ol(S,C,$,F,H){F[H+0]=No(S,$),F[H+1]=Zi(S,C,$),F[H+2]=Uu(S,C)}function Tr(S,C,$,F,H){F[H+0]=Uu(S,C),F[H+1]=Zi(S,C,$),F[H+2]=No(S,$)}function Kl(S,C,$,F,H){var J=Zi(S,C,$);C=J<<3&224|Uu(S,C)>>3,F[H+0]=248&No(S,$)|J>>5,F[H+1]=C}function Xl(S,C,$,F,H){var J=240&Uu(S,C)|15;F[H+0]=240&No(S,$)|Zi(S,C,$)>>4,F[H+1]=J}function zc(S,C,$,F,H){F[H+0]=255,ol(S,C,$,F,H+1)}function ko(S,C,$,F,H){Tr(S,C,$,F,H),F[H+3]=255}function xa(S,C,$,F,H){ol(S,C,$,F,H),F[H+3]=255}function ll(S,C,$){D[S]=function(F,H,J,Q,re,le,fe,Se,Fe){for(var he=Se+(-2&Fe)*$;Se!=he;)C(F[H+0],J[Q+0],re[le+0],fe,Se),C(F[H+1],J[Q+0],re[le+0],fe,Se+$),H+=2,++Q,++le,Se+=2*$;1&Fe&&C(F[H+0],J[Q+0],re[le+0],fe,Se)}}function Pc(S,C,$){return $==0?S==0?C==0?6:5:C==0?4:0:$}function hf(S,C,$,F,H){switch(S>>>30){case 3:pl(C,$,F,H,0);break;case 2:ea(C,$,F,H);break;case 1:Wn(C,$,F,H)}}function Ja(S,C){var $,F,H=C.M,J=C.Nb,Q=S.oc,re=S.pc+40,le=S.oc,fe=S.pc+584,Se=S.oc,Fe=S.pc+600;for($=0;16>$;++$)Q[re+32*$-1]=129;for($=0;8>$;++$)le[fe+32*$-1]=129,Se[Fe+32*$-1]=129;for(0<H?Q[re-1-32]=le[fe-1-32]=Se[Fe-1-32]=129:(r(Q,re-32-1,127,21),r(le,fe-32-1,127,9),r(Se,Fe-32-1,127,9)),F=0;F<S.za;++F){var he=C.ya[C.aa+F];if(0<F){for($=-1;16>$;++$)s(Q,re+32*$-4,Q,re+32*$+12,4);for($=-1;8>$;++$)s(le,fe+32*$-4,le,fe+32*$+4,4),s(Se,Fe+32*$-4,Se,Fe+32*$+4,4)}var Ae=S.Gd,Re=S.Hd+F,qe=he.ad,Oe=he.Hc;if(0<H&&(s(Q,re-32,Ae[Re].y,0,16),s(le,fe-32,Ae[Re].f,0,8),s(Se,Fe-32,Ae[Re].ea,0,8)),he.Za){var Ge=Q,Xe=re-32+16;for(0<H&&(F>=S.za-1?r(Ge,Xe,Ae[Re].y[15],4):s(Ge,Xe,Ae[Re+1].y,0,4)),$=0;4>$;$++)Ge[Xe+128+$]=Ge[Xe+256+$]=Ge[Xe+384+$]=Ge[Xe+0+$];for($=0;16>$;++$,Oe<<=2)Ge=Q,Xe=re+Ks[$],Os[he.Ob[$]](Ge,Xe),hf(Oe,qe,16*+$,Ge,Xe)}else if(Ge=Pc(F,H,he.Ob[0]),wa[Ge](Q,re),Oe!=0)for($=0;16>$;++$,Oe<<=2)hf(Oe,qe,16*+$,Q,re+Ks[$]);for($=he.Gc,Ge=Pc(F,H,he.Dd),to[Ge](le,fe),to[Ge](Se,Fe),Oe=qe,Ge=le,Xe=fe,255&(he=0|$)&&(170&he?gi(Oe,256,Ge,Xe):Fn(Oe,256,Ge,Xe)),he=Se,Oe=Fe,255&($>>=8)&&(170&$?gi(qe,320,he,Oe):Fn(qe,320,he,Oe)),H<S.Ub-1&&(s(Ae[Re].y,0,Q,re+480,16),s(Ae[Re].f,0,le,fe+224,8),s(Ae[Re].ea,0,Se,Fe+224,8)),$=8*J*S.B,Ae=S.sa,Re=S.ta+16*F+16*J*S.R,qe=S.qa,he=S.ra+8*F+$,Oe=S.Ha,Ge=S.Ia+8*F+$,$=0;16>$;++$)s(Ae,Re+$*S.R,Q,re+32*$,16);for($=0;8>$;++$)s(qe,he+$*S.B,le,fe+32*$,8),s(Oe,Ge+$*S.B,Se,Fe+32*$,8)}}function Ji(S,C,$,F,H,J,Q,re,le){var fe=[0],Se=[0],Fe=0,he=le!=null?le.kd:0,Ae=le??new nt;if(S==null||12>$)return 7;Ae.data=S,Ae.w=C,Ae.ha=$,C=[C],$=[$],Ae.gb=[Ae.gb];e:{var Re=C,qe=$,Oe=Ae.gb;if(e(S!=null),e(qe!=null),e(Oe!=null),Oe[0]=0,12<=qe[0]&&!t(S,Re[0],"RIFF")){if(t(S,Re[0]+8,"WEBP")){Oe=3;break e}var Ge=ot(S,Re[0]+4);if(12>Ge||4294967286<Ge){Oe=3;break e}if(he&&Ge>qe[0]-8){Oe=7;break e}Oe[0]=Ge,Re[0]+=12,qe[0]-=12}Oe=0}if(Oe!=0)return Oe;for(Ge=0<Ae.gb[0],$=$[0];;){e:{var Xe=S;qe=C,Oe=$;var it=fe,Qe=Se,At=Re=[0];if((wt=Fe=[Fe])[0]=0,8>Oe[0])Oe=7;else{if(!t(Xe,qe[0],"VP8X")){if(ot(Xe,qe[0]+4)!=10){Oe=3;break e}if(18>Oe[0]){Oe=7;break e}var gt=ot(Xe,qe[0]+8),rn=1+at(Xe,qe[0]+12);if(2147483648<=rn*(Xe=1+at(Xe,qe[0]+15))){Oe=3;break e}At!=null&&(At[0]=gt),it!=null&&(it[0]=rn),Qe!=null&&(Qe[0]=Xe),qe[0]+=18,Oe[0]-=18,wt[0]=1}Oe=0}}if(Fe=Fe[0],Re=Re[0],Oe!=0)return Oe;if(qe=!!(2&Re),!Ge&&Fe)return 3;if(J!=null&&(J[0]=!!(16&Re)),Q!=null&&(Q[0]=qe),re!=null&&(re[0]=0),Q=fe[0],Re=Se[0],Fe&&qe&&le==null){Oe=0;break}if(4>$){Oe=7;break}if(Ge&&Fe||!Ge&&!Fe&&!t(S,C[0],"ALPH")){$=[$],Ae.na=[Ae.na],Ae.P=[Ae.P],Ae.Sa=[Ae.Sa];e:{gt=S,Oe=C,Ge=$;var wt=Ae.gb;it=Ae.na,Qe=Ae.P,At=Ae.Sa,rn=22,e(gt!=null),e(Ge!=null),Xe=Oe[0];var Cn=Ge[0];for(e(it!=null),e(At!=null),it[0]=null,Qe[0]=null,At[0]=0;;){if(Oe[0]=Xe,Ge[0]=Cn,8>Cn){Oe=7;break e}var ys=ot(gt,Xe+4);if(4294967286<ys){Oe=3;break e}var cn=8+ys+1&-2;if(rn+=cn,0<wt&&rn>wt){Oe=3;break e}if(!t(gt,Xe,"VP8 ")||!t(gt,Xe,"VP8L")){Oe=0;break e}if(Cn[0]<cn){Oe=7;break e}t(gt,Xe,"ALPH")||(it[0]=gt,Qe[0]=Xe+8,At[0]=ys),Xe+=cn,Cn-=cn}}if($=$[0],Ae.na=Ae.na[0],Ae.P=Ae.P[0],Ae.Sa=Ae.Sa[0],Oe!=0)break}$=[$],Ae.Ja=[Ae.Ja],Ae.xa=[Ae.xa];e:if(wt=S,Oe=C,Ge=$,it=Ae.gb[0],Qe=Ae.Ja,At=Ae.xa,gt=Oe[0],Xe=!t(wt,gt,"VP8 "),rn=!t(wt,gt,"VP8L"),e(wt!=null),e(Ge!=null),e(Qe!=null),e(At!=null),8>Ge[0])Oe=7;else{if(Xe||rn){if(wt=ot(wt,gt+4),12<=it&&wt>it-12){Oe=3;break e}if(he&&wt>Ge[0]-8){Oe=7;break e}Qe[0]=wt,Oe[0]+=8,Ge[0]-=8,At[0]=rn}else At[0]=5<=Ge[0]&&wt[gt+0]==47&&!(wt[gt+4]>>5),Qe[0]=Ge[0];Oe=0}if($=$[0],Ae.Ja=Ae.Ja[0],Ae.xa=Ae.xa[0],C=C[0],Oe!=0)break;if(4294967286<Ae.Ja)return 3;if(re==null||qe||(re[0]=Ae.xa?2:1),Q=[Q],Re=[Re],Ae.xa){if(5>$){Oe=7;break}re=Q,he=Re,qe=J,S==null||5>$?S=0:5<=$&&S[C+0]==47&&!(S[C+4]>>5)?(Ge=[0],wt=[0],it=[0],ce(Qe=new j,S,C,$),bo(Qe,Ge,wt,it)?(re!=null&&(re[0]=Ge[0]),he!=null&&(he[0]=wt[0]),qe!=null&&(qe[0]=it[0]),S=1):S=0):S=0}else{if(10>$){Oe=7;break}re=Re,S==null||10>$||!Qh(S,C+3,$-3)?S=0:(he=S[C+0]|S[C+1]<<8|S[C+2]<<16,qe=16383&(S[C+7]<<8|S[C+6]),S=16383&(S[C+9]<<8|S[C+8]),1&he||3<(he>>1&7)||!(he>>4&1)||he>>5>=Ae.Ja||!qe||!S?S=0:(Q&&(Q[0]=qe),re&&(re[0]=S),S=1))}if(!S||(Q=Q[0],Re=Re[0],Fe&&(fe[0]!=Q||Se[0]!=Re)))return 3;le!=null&&(le[0]=Ae,le.offset=C-le.w,e(4294967286>C-le.w),e(le.offset==le.ha-$));break}return Oe==0||Oe==7&&Fe&&le==null?(J!=null&&(J[0]|=Ae.na!=null&&0<Ae.na.length),F!=null&&(F[0]=Q),H!=null&&(H[0]=Re),0):Oe}function ul(S,C,$){var F=C.width,H=C.height,J=0,Q=0,re=F,le=H;if(C.Da=S!=null&&0<S.Da,C.Da&&(re=S.cd,le=S.bd,J=S.v,Q=S.j,11>$||(J&=-2,Q&=-2),0>J||0>Q||0>=re||0>=le||J+re>F||Q+le>H))return 0;if(C.v=J,C.j=Q,C.va=J+re,C.o=Q+le,C.U=re,C.T=le,C.da=S!=null&&0<S.da,C.da){if(!ht(re,le,$=[S.ib],J=[S.hb]))return 0;C.ib=$[0],C.hb=J[0]}return C.ob=S!=null&&S.ob,C.Kb=S==null||!S.Sd,C.da&&(C.ob=C.ib<3*F/4&&C.hb<3*H/4,C.Kb=0),1}function ff(S){if(S==null)return 2;if(11>S.S){var C=S.f.RGBA;C.fb+=(S.height-1)*C.A,C.A=-C.A}else C=S.f.kb,S=S.height,C.O+=(S-1)*C.fa,C.fa=-C.fa,C.N+=(S-1>>1)*C.Ab,C.Ab=-C.Ab,C.W+=(S-1>>1)*C.Db,C.Db=-C.Db,C.F!=null&&(C.J+=(S-1)*C.lb,C.lb=-C.lb);return 0}function Qi(S,C,$,F){if(F==null||0>=S||0>=C)return 2;if($!=null){if($.Da){var H=$.cd,J=$.bd,Q=-2&$.v,re=-2&$.j;if(0>Q||0>re||0>=H||0>=J||Q+H>S||re+J>C)return 2;S=H,C=J}if($.da){if(!ht(S,C,H=[$.ib],J=[$.hb]))return 2;S=H[0],C=J[0]}}F.width=S,F.height=C;e:{var le=F.width,fe=F.height;if(S=F.S,0>=le||0>=fe||!(S>=Vd&&13>S))S=2;else{if(0>=F.Rd&&F.sd==null){Q=J=H=C=0;var Se=(re=le*Zd[S])*fe;if(11>S||(J=(fe+1)/2*(C=(le+1)/2),S==12&&(Q=(H=le)*fe)),(fe=a(Se+2*J+Q))==null){S=1;break e}F.sd=fe,11>S?((le=F.f.RGBA).eb=fe,le.fb=0,le.A=re,le.size=Se):((le=F.f.kb).y=fe,le.O=0,le.fa=re,le.Fd=Se,le.f=fe,le.N=0+Se,le.Ab=C,le.Cd=J,le.ea=fe,le.W=0+Se+J,le.Db=C,le.Ed=J,S==12&&(le.F=fe,le.J=0+Se+2*J),le.Tc=Q,le.lb=H)}if(C=1,H=F.S,J=F.width,Q=F.height,H>=Vd&&13>H)if(11>H)S=F.f.RGBA,C&=(re=Math.abs(S.A))*(Q-1)+J<=S.size,C&=re>=J*Zd[H],C&=S.eb!=null;else{S=F.f.kb,re=(J+1)/2,Se=(Q+1)/2,le=Math.abs(S.fa),fe=Math.abs(S.Ab);var Fe=Math.abs(S.Db),he=Math.abs(S.lb),Ae=he*(Q-1)+J;C&=le*(Q-1)+J<=S.Fd,C&=fe*(Se-1)+re<=S.Cd,C=(C&=Fe*(Se-1)+re<=S.Ed)&le>=J&fe>=re&Fe>=re,C&=S.y!=null,C&=S.f!=null,C&=S.ea!=null,H==12&&(C&=he>=J,C&=Ae<=S.Tc,C&=S.F!=null)}else C=0;S=C?0:2}}return S!=0||$!=null&&$.fd&&(S=ff(F)),S}var Yl=64,_a=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],va=24,Co=32,To=8,cl=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];ft("Predictor0","PredictorAdd0"),D.Predictor0=function(){return 4278190080},D.Predictor1=function(S){return S},D.Predictor2=function(S,C,$){return C[$+0]},D.Predictor3=function(S,C,$){return C[$+1]},D.Predictor4=function(S,C,$){return C[$-1]},D.Predictor5=function(S,C,$){return Tt(Tt(S,C[$+1]),C[$+0])},D.Predictor6=function(S,C,$){return Tt(S,C[$-1])},D.Predictor7=function(S,C,$){return Tt(S,C[$+0])},D.Predictor8=function(S,C,$){return Tt(C[$-1],C[$+0])},D.Predictor9=function(S,C,$){return Tt(C[$+0],C[$+1])},D.Predictor10=function(S,C,$){return Tt(Tt(S,C[$-1]),Tt(C[$+0],C[$+1]))},D.Predictor11=function(S,C,$){var F=C[$+0];return 0>=Ut(F>>24&255,S>>24&255,(C=C[$-1])>>24&255)+Ut(F>>16&255,S>>16&255,C>>16&255)+Ut(F>>8&255,S>>8&255,C>>8&255)+Ut(255&F,255&S,255&C)?F:S},D.Predictor12=function(S,C,$){var F=C[$+0];return(zt((S>>24&255)+(F>>24&255)-((C=C[$-1])>>24&255))<<24|zt((S>>16&255)+(F>>16&255)-(C>>16&255))<<16|zt((S>>8&255)+(F>>8&255)-(C>>8&255))<<8|zt((255&S)+(255&F)-(255&C)))>>>0},D.Predictor13=function(S,C,$){var F=C[$-1];return(tn((S=Tt(S,C[$+0]))>>24&255,F>>24&255)<<24|tn(S>>16&255,F>>16&255)<<16|tn(S>>8&255,F>>8&255)<<8|tn(255&S,255&F))>>>0};var Bc=D.PredictorAdd0;D.PredictorAdd1=sn,ft("Predictor2","PredictorAdd2"),ft("Predictor3","PredictorAdd3"),ft("Predictor4","PredictorAdd4"),ft("Predictor5","PredictorAdd5"),ft("Predictor6","PredictorAdd6"),ft("Predictor7","PredictorAdd7"),ft("Predictor8","PredictorAdd8"),ft("Predictor9","PredictorAdd9"),ft("Predictor10","PredictorAdd10"),ft("Predictor11","PredictorAdd11"),ft("Predictor12","PredictorAdd12"),ft("Predictor13","PredictorAdd13");var Uc=D.PredictorAdd2;_t("ColorIndexInverseTransform","MapARGB","32b",function(S){return S>>8&255},function(S){return S}),_t("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(S){return S},function(S){return S>>8&255});var qs,Pd=D.ColorIndexInverseTransform,Ao=D.MapARGB,Io=D.VP8LColorIndexInverseTransformAlpha,zr=D.MapAlpha,hl=D.VP8LPredictorsAdd=[];hl.length=16,(D.VP8LPredictors=[]).length=16,(D.VP8LPredictorsAdd_C=[]).length=16,(D.VP8LPredictors_C=[]).length=16;var Vc,jc,fl,dl,Eo,Vu,Qa,pl,ea,gi,Wn,Fn,cs,Hs,_o,eo,ju,df,mg,Ty,Ay,Iy,gg,yg,Wu,yi,pf,ei,Gu=a(511),Bd=a(2041),mf=a(225),gf=a(767),Ud=0,ml=Bd,yf=mf,ta=gf,Pr=Gu,Vd=0,na=1,jd=2,bi=3,bf=4,Wc=5,Zl=6,xf=7,Wd=8,Gc=9,Gd=10,xi=[2,3,7],qc=[3,3,11],qu=[280,256,256,256,40],qd=[0,1,1,1,0],vf=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],vi=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],wi=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Jl=8,Si=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Ni=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],ti=null,Ey=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],bg=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Hd=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],_y=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Br=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],gs=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],In=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],wa=[],Os=[],to=[],Ql=1,xg=2,gl=[],Ur=[];il("UpsampleRgbLinePair",ol,3),il("UpsampleBgrLinePair",Tr,3),il("UpsampleRgbaLinePair",xa,4),il("UpsampleBgraLinePair",ko,4),il("UpsampleArgbLinePair",zc,4),il("UpsampleRgba4444LinePair",Xl,2),il("UpsampleRgb565LinePair",Kl,2);var Hu=D.UpsampleRgbLinePair,vg=D.UpsampleBgrLinePair,Hc=D.UpsampleRgbaLinePair,Kd=D.UpsampleBgraLinePair,eu=D.UpsampleArgbLinePair,$o=D.UpsampleRgba4444LinePair,tu=D.UpsampleRgb565LinePair,ki=16,Kc=1<<ki-1,Ku=-227,nu=482,Xd=6,su=0,Vr=a(256),Yd=a(256),$y=a(256),cw=a(256),hw=a(nu-Ku),fw=a(nu-Ku);ll("YuvToRgbRow",ol,3),ll("YuvToBgrRow",Tr,3),ll("YuvToRgbaRow",xa,4),ll("YuvToBgraRow",ko,4),ll("YuvToArgbRow",zc,4),ll("YuvToRgba4444Row",Xl,2),ll("YuvToRgb565Row",Kl,2);var Ks=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Xc=[0,2,8],wf=[8,7,6,4,4,2,2,2,1,1,1,1],Sf=1;this.WebPDecodeRGBA=function(S,C,$,F,H){var J=na,Q=new Ke,re=new dn;Q.ba=re,re.S=J,re.width=[re.width],re.height=[re.height];var le=re.width,fe=re.height,Se=new Lt;if(Se==null||S==null)var Fe=2;else e(Se!=null),Fe=Ji(S,C,$,Se.width,Se.height,Se.Pd,Se.Qd,Se.format,null);if(Fe!=0?le=0:(le!=null&&(le[0]=Se.width[0]),fe!=null&&(fe[0]=Se.height[0]),le=1),le){re.width=re.width[0],re.height=re.height[0],F!=null&&(F[0]=re.width),H!=null&&(H[0]=re.height);e:{if(F=new Zo,(H=new nt).data=S,H.w=C,H.ha=$,H.kd=1,C=[0],e(H!=null),((S=Ji(H.data,H.w,H.ha,null,null,null,C,null,H))==0||S==7)&&C[0]&&(S=4),(C=S)==0){if(e(Q!=null),F.data=H.data,F.w=H.w+H.offset,F.ha=H.ha-H.offset,F.put=Pt,F.ac=fi,F.bc=Xo,F.ma=Q,H.xa){if((S=Du())==null){Q=1;break e}if((function(he,Ae){var Re=[0],qe=[0],Oe=[0];t:for(;;){if(he==null)return 0;if(Ae==null)return he.a=2,0;if(he.l=Ae,he.a=0,ce(he.m,Ae.data,Ae.w,Ae.ha),!bo(he.m,Re,qe,Oe)){he.a=3;break t}if(he.xb=xg,Ae.width=Re[0],Ae.height=qe[0],!Vi(Re[0],qe[0],1,he,null))break t;return 1}return e(he.a!=0),0})(S,F)){if(F=(C=Qi(F.width,F.height,Q.Oa,Q.ba))==0){t:{F=S;n:for(;;){if(F==null){F=0;break t}if(e(F.s.yc!=null),e(F.s.Ya!=null),e(0<F.s.Wb),e(($=F.l)!=null),e((H=$.ma)!=null),F.xb!=0){if(F.ca=H.ba,F.tb=H.tb,e(F.ca!=null),!ul(H.Oa,$,bi)){F.a=2;break n}if(!ji(F,$.width)||$.da)break n;if(($.da||Kt(F.ca.S))&&Yi(),11>F.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),F.ca.f.kb.F!=null&&Yi()),F.Pb&&0<F.s.ua&&F.s.vb.X==null&&!oe(F.s.vb,F.s.Wa.Xa)){F.a=1;break n}F.xb=0}if(!Ha(F,F.V,F.Ba,F.c,F.i,$.o,ga))break n;H.Dc=F.Ma,F=1;break t}e(F.a!=0),F=0}F=!F}F&&(C=S.a)}else C=S.a}else{if((S=new Hi)==null){Q=1;break e}if(S.Fa=H.na,S.P=H.P,S.qc=H.Sa,vo(S,F)){if((C=Qi(F.width,F.height,Q.Oa,Q.ba))==0){if(S.Aa=0,$=Q.Oa,e((H=S)!=null),$!=null){if(0<(le=0>(le=$.Md)?0:100<le?255:255*le/100)){for(fe=Se=0;4>fe;++fe)12>(Fe=H.pb[fe]).lc&&(Fe.ia=le*wf[0>Fe.lc?0:Fe.lc]>>3),Se|=Fe.ia;Se&&(alert("todo:VP8InitRandom"),H.ia=1)}H.Ga=$.Id,100<H.Ga?H.Ga=100:0>H.Ga&&(H.Ga=0)}(function(he,Ae){if(he==null)return 0;if(Ae==null)return jn(he,2,"NULL VP8Io parameter in VP8Decode().");if(!he.cb&&!vo(he,Ae))return 0;if(e(he.cb),Ae.ac==null||Ae.ac(Ae)){Ae.ob&&(he.L=0);var Re=Xc[he.L];if(he.L==2?(he.yb=0,he.zb=0):(he.yb=Ae.v-Re>>4,he.zb=Ae.j-Re>>4,0>he.yb&&(he.yb=0),0>he.zb&&(he.zb=0)),he.Va=Ae.o+15+Re>>4,he.Hb=Ae.va+15+Re>>4,he.Hb>he.za&&(he.Hb=he.za),he.Va>he.Ub&&(he.Va=he.Ub),0<he.L){var qe=he.ed;for(Re=0;4>Re;++Re){var Oe;if(he.Qa.Cb){var Ge=he.Qa.Lb[Re];he.Qa.Fb||(Ge+=qe.Tb)}else Ge=qe.Tb;for(Oe=0;1>=Oe;++Oe){var Xe=he.gd[Re][Oe],it=Ge;if(qe.Pc&&(it+=qe.vd[0],Oe&&(it+=qe.od[0])),0<(it=0>it?0:63<it?63:it)){var Qe=it;0<qe.wb&&(Qe=4<qe.wb?Qe>>2:Qe>>1)>9-qe.wb&&(Qe=9-qe.wb),1>Qe&&(Qe=1),Xe.dd=Qe,Xe.tc=2*it+Qe,Xe.ld=40<=it?2:15<=it?1:0}else Xe.tc=0;Xe.La=Oe}}}Re=0}else jn(he,6,"Frame setup failed"),Re=he.a;if(Re=Re==0){if(Re){he.$c=0,0<he.Aa||(he.Ic=Sf);t:{Re=he.Ic,qe=4*(Qe=he.za);var At=32*Qe,gt=Qe+1,rn=0<he.L?Qe*(0<he.Aa?2:1):0,wt=(he.Aa==2?2:1)*Qe;if((Xe=qe+832+(Oe=3*(16*Re+Xc[he.L])/2*At)+(Ge=he.Fa!=null&&0<he.Fa.length?he.Kc.c*he.Kc.i:0))!=Xe)Re=0;else{if(Xe>he.Vb){if(he.Vb=0,he.Ec=a(Xe),he.Fc=0,he.Ec==null){Re=jn(he,1,"no memory during frame initialization.");break t}he.Vb=Xe}Xe=he.Ec,it=he.Fc,he.Ac=Xe,he.Bc=it,it+=qe,he.Gd=i(At,Jh),he.Hd=0,he.rb=i(gt+1,qi),he.sb=1,he.wa=rn?i(rn,Ka):null,he.Y=0,he.D.Nb=0,he.D.wa=he.wa,he.D.Y=he.Y,0<he.Aa&&(he.D.Y+=Qe),e(!0),he.oc=Xe,he.pc=it,it+=832,he.ya=i(wt,Yh),he.aa=0,he.D.ya=he.ya,he.D.aa=he.aa,he.Aa==2&&(he.D.aa+=Qe),he.R=16*Qe,he.B=8*Qe,Qe=(At=Xc[he.L])*he.R,At=At/2*he.B,he.sa=Xe,he.ta=it+Qe,he.qa=he.sa,he.ra=he.ta+16*Re*he.R+At,he.Ha=he.qa,he.Ia=he.ra+8*Re*he.B+At,he.$c=0,it+=Oe,he.mb=Ge?Xe:null,he.nb=Ge?it:null,e(it+Ge<=he.Fc+he.Vb),ef(he),r(he.Ac,he.Bc,0,qe),Re=1}}if(Re){if(Ae.ka=0,Ae.y=he.sa,Ae.O=he.ta,Ae.f=he.qa,Ae.N=he.ra,Ae.ea=he.Ha,Ae.Vd=he.Ia,Ae.fa=he.R,Ae.Rc=he.B,Ae.F=null,Ae.J=0,!Ud){for(Re=-255;255>=Re;++Re)Gu[255+Re]=0>Re?-Re:Re;for(Re=-1020;1020>=Re;++Re)Bd[1020+Re]=-128>Re?-128:127<Re?127:Re;for(Re=-112;112>=Re;++Re)mf[112+Re]=-16>Re?-16:15<Re?15:Re;for(Re=-255;510>=Re;++Re)gf[255+Re]=0>Re?0:255<Re?255:Re;Ud=1}Qa=Ki,pl=tf,gi=ba,Wn=nf,Fn=sf,ea=_d,cs=Md,Hs=rl,_o=q,eo=de,ju=zd,df=_,mg=ve,Ty=Ie,Ay=el,Iy=tl,gg=Bu,yg=uf,Os[0]=Ld,Os[1]=$d,Os[2]=Od,Os[3]=of,Os[4]=Ya,Os[5]=lf,Os[6]=Fr,Os[7]=Mu,Os[8]=zu,Os[9]=Za,wa[0]=Xi,wa[1]=rf,wa[2]=af,wa[3]=Dd,wa[4]=Jo,wa[5]=Fu,wa[6]=Hl,to[0]=Oc,to[1]=Rd,to[2]=wo,to[3]=Fd,to[4]=Cr,to[5]=Lc,to[6]=So,Re=1}else Re=0}Re&&(Re=(function(Cn,ys){for(Cn.M=0;Cn.M<Cn.Va;++Cn.M){var cn,yt=Cn.Jc[Cn.M&Cn.Xb],ut=Cn.m,As=Cn;for(cn=0;cn<As.za;++cn){var Ht=ut,pn=As,Xn=pn.Ac,gr=pn.Bc+4*cn,jr=pn.zc,hs=pn.ya[pn.aa+cn];if(pn.Qa.Bb?hs.$b=Le(Ht,pn.Pa.jb[0])?2+Le(Ht,pn.Pa.jb[2]):Le(Ht,pn.Pa.jb[1]):hs.$b=0,pn.kc&&(hs.Ad=Le(Ht,pn.Bd)),hs.Za=!Le(Ht,145)+0,hs.Za){var tr=hs.Ob,sa=0;for(pn=0;4>pn;++pn){var nr,wn=jr[0+pn];for(nr=0;4>nr;++nr){wn=Br[Xn[gr+nr]][wn];for(var Pn=Hd[Le(Ht,wn[0])];0<Pn;)Pn=Hd[2*Pn+Le(Ht,wn[Pn])];wn=-Pn,Xn[gr+nr]=wn}s(tr,sa,Xn,gr,4),sa+=4,jr[0+pn]=wn}}else wn=Le(Ht,156)?Le(Ht,128)?1:3:Le(Ht,163)?2:0,hs.Ob[0]=wn,r(Xn,gr,wn,4),r(jr,0,wn,4);hs.Dd=Le(Ht,142)?Le(Ht,114)?Le(Ht,183)?1:3:2:0}if(As.m.Ka)return jn(Cn,7,"Premature end-of-partition0 encountered.");for(;Cn.ja<Cn.za;++Cn.ja){if(As=yt,Ht=(ut=Cn).rb[ut.sb-1],Xn=ut.rb[ut.sb+ut.ja],cn=ut.ya[ut.aa+ut.ja],gr=ut.kc?cn.Ad:0)Ht.la=Xn.la=0,cn.Za||(Ht.Na=Xn.Na=0),cn.Hc=0,cn.Gc=0,cn.ia=0;else{var Is,Gn;if(Ht=Xn,Xn=As,gr=ut.Pa.Xc,jr=ut.ya[ut.aa+ut.ja],hs=ut.pb[jr.$b],pn=jr.ad,tr=0,sa=ut.rb[ut.sb-1],wn=nr=0,r(pn,tr,0,384),jr.Za)var yr=0,Es=gr[3];else{Pn=a(16);var Bn=Ht.Na+sa.Na;if(Bn=ti(Xn,gr[1],Bn,hs.Eb,0,Pn,0),Ht.Na=sa.Na=(0<Bn)+0,1<Bn)Qa(Pn,0,pn,tr);else{var Xs=Pn[0]+3>>3;for(Pn=0;256>Pn;Pn+=16)pn[tr+Pn]=Xs}yr=1,Es=gr[0]}var Yn=15&Ht.la,sr=15&sa.la;for(Pn=0;4>Pn;++Pn){var rr=1&sr;for(Xs=Gn=0;4>Xs;++Xs)Yn=Yn>>1|(rr=(Bn=ti(Xn,Es,Bn=rr+(1&Yn),hs.Sc,yr,pn,tr))>yr)<<7,Gn=Gn<<2|(3<Bn?3:1<Bn?2:pn[tr+0]!=0),tr+=16;Yn>>=4,sr=sr>>1|rr<<7,nr=(nr<<8|Gn)>>>0}for(Es=Yn,yr=sr>>4,Is=0;4>Is;Is+=2){for(Gn=0,Yn=Ht.la>>4+Is,sr=sa.la>>4+Is,Pn=0;2>Pn;++Pn){for(rr=1&sr,Xs=0;2>Xs;++Xs)Bn=rr+(1&Yn),Yn=Yn>>1|(rr=0<(Bn=ti(Xn,gr[2],Bn,hs.Qc,0,pn,tr)))<<3,Gn=Gn<<2|(3<Bn?3:1<Bn?2:pn[tr+0]!=0),tr+=16;Yn>>=2,sr=sr>>1|rr<<5}wn|=Gn<<4*Is,Es|=Yn<<4<<Is,yr|=(240&sr)<<Is}Ht.la=Es,sa.la=yr,jr.Hc=nr,jr.Gc=wn,jr.ia=43690&wn?0:hs.ia,gr=!(nr|wn)}if(0<ut.L&&(ut.wa[ut.Y+ut.ja]=ut.gd[cn.$b][cn.Za],ut.wa[ut.Y+ut.ja].La|=!gr),As.Ka)return jn(Cn,7,"Premature end-of-file encountered.")}if(ef(Cn),ut=ys,As=1,cn=(yt=Cn).D,Ht=0<yt.L&&yt.M>=yt.zb&&yt.M<=yt.Va,yt.Aa==0)t:{if(cn.M=yt.M,cn.uc=Ht,Ja(yt,cn),As=1,cn=(Gn=yt.D).Nb,Ht=(wn=Xc[yt.L])*yt.R,Xn=wn/2*yt.B,Pn=16*cn*yt.R,Xs=8*cn*yt.B,gr=yt.sa,jr=yt.ta-Ht+Pn,hs=yt.qa,pn=yt.ra-Xn+Xs,tr=yt.Ha,sa=yt.Ia-Xn+Xs,sr=(Yn=Gn.M)==0,nr=Yn>=yt.Va-1,yt.Aa==2&&Ja(yt,Gn),Gn.uc)for(rr=(Bn=yt).D.M,e(Bn.D.uc),Gn=Bn.yb;Gn<Bn.Hb;++Gn){yr=Gn,Es=rr;var ns=(Mn=(ar=Bn).D).Nb;Is=ar.R;var Mn=Mn.wa[Mn.Y+yr],ra=ar.sa,Ls=ar.ta+16*ns*Is+16*yr,Bt=Mn.dd,Wt=Mn.tc;if(Wt!=0)if(e(3<=Wt),ar.L==1)0<yr&&Iy(ra,Ls,Is,Wt+4),Mn.La&&yg(ra,Ls,Is,Wt),0<Es&&Ay(ra,Ls,Is,Wt+4),Mn.La&&gg(ra,Ls,Is,Wt);else{var Un=ar.B,$a=ar.qa,Ci=ar.ra+8*ns*Un+8*yr,Sa=ar.Ha,ar=ar.Ia+8*ns*Un+8*yr;ns=Mn.ld,0<yr&&(Hs(ra,Ls,Is,Wt+4,Bt,ns),eo($a,Ci,Sa,ar,Un,Wt+4,Bt,ns)),Mn.La&&(df(ra,Ls,Is,Wt,Bt,ns),Ty($a,Ci,Sa,ar,Un,Wt,Bt,ns)),0<Es&&(cs(ra,Ls,Is,Wt+4,Bt,ns),_o($a,Ci,Sa,ar,Un,Wt+4,Bt,ns)),Mn.La&&(ju(ra,Ls,Is,Wt,Bt,ns),mg($a,Ci,Sa,ar,Un,Wt,Bt,ns))}}if(yt.ia&&alert("todo:DitherRow"),ut.put!=null){if(Gn=16*Yn,Yn=16*(Yn+1),sr?(ut.y=yt.sa,ut.O=yt.ta+Pn,ut.f=yt.qa,ut.N=yt.ra+Xs,ut.ea=yt.Ha,ut.W=yt.Ia+Xs):(Gn-=wn,ut.y=gr,ut.O=jr,ut.f=hs,ut.N=pn,ut.ea=tr,ut.W=sa),nr||(Yn-=wn),Yn>ut.o&&(Yn=ut.o),ut.F=null,ut.J=null,yt.Fa!=null&&0<yt.Fa.length&&Gn<Yn&&(ut.J=us(yt,ut,Gn,Yn-Gn),ut.F=yt.mb,ut.F==null&&ut.F.length==0)){As=jn(yt,3,"Could not decode alpha data.");break t}Gn<ut.j&&(wn=ut.j-Gn,Gn=ut.j,e(!(1&wn)),ut.O+=yt.R*wn,ut.N+=yt.B*(wn>>1),ut.W+=yt.B*(wn>>1),ut.F!=null&&(ut.J+=ut.width*wn)),Gn<Yn&&(ut.O+=ut.v,ut.N+=ut.v>>1,ut.W+=ut.v>>1,ut.F!=null&&(ut.J+=ut.v),ut.ka=Gn-ut.j,ut.U=ut.va-ut.v,ut.T=Yn-Gn,As=ut.put(ut))}cn+1!=yt.Ic||nr||(s(yt.sa,yt.ta-Ht,gr,jr+16*yt.R,Ht),s(yt.qa,yt.ra-Xn,hs,pn+8*yt.B,Xn),s(yt.Ha,yt.Ia-Xn,tr,sa+8*yt.B,Xn))}if(!As)return jn(Cn,6,"Output aborted.")}return 1})(he,Ae)),Ae.bc!=null&&Ae.bc(Ae),Re&=1}return Re?(he.cb=0,Re):0})(S,F)||(C=S.a)}}else C=S.a}C==0&&Q.Oa!=null&&Q.Oa.fd&&(C=ff(Q.ba))}Q=C}J=Q!=0?null:11>J?re.f.RGBA.eb:re.f.kb.y}else J=null;return J};var Zd=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function c(D,B){for(var E="",M=0;M<4;M++)E+=String.fromCharCode(D[B++]);return E}function f(D,B){return D[B+0]|D[B+1]<<8}function d(D,B){return(D[B+0]|D[B+1]<<8|D[B+2]<<16)>>>0}function m(D,B){return(D[B+0]|D[B+1]<<8|D[B+2]<<16|D[B+3]<<24)>>>0}new l;var g=[0],b=[0],x=[],v=new l,w=n,k=(function(D,B){var E={},M=0,K=!1,X=0,ae=0;if(E.frames=[],!(function(O,j){for(var Y=0;Y<4;Y++)if(O[j+Y]!="RIFF".charCodeAt(Y))return!0;return!1})(D,B)){for(m(D,B+=4),B+=8;B<D.length;){var W=c(D,B),se=m(D,B+=4);B+=4;var ee=se+(1&se);switch(W){case"VP8 ":case"VP8L":E.frames[M]===void 0&&(E.frames[M]={}),(G=E.frames[M]).src_off=K?ae:B-8,G.src_size=X+se+8,M++,K&&(K=!1,X=0,ae=0);break;case"VP8X":(G=E.header={}).feature_flags=D[B];var ce=B+4;G.canvas_width=1+d(D,ce),ce+=3,G.canvas_height=1+d(D,ce),ce+=3;break;case"ALPH":K=!0,X=ee+8,ae=B-8;break;case"ANIM":(G=E.header).bgcolor=m(D,B),ce=B+4,G.loop_count=f(D,ce),ce+=2;break;case"ANMF":var ye,G;(G=E.frames[M]={}).offset_x=2*d(D,B),B+=3,G.offset_y=2*d(D,B),B+=3,G.width=1+d(D,B),B+=3,G.height=1+d(D,B),B+=3,G.duration=d(D,B),B+=3,ye=D[B++],G.dispose=1&ye,G.blend=ye>>1&1}W!="ANMF"&&(B+=ee)}return E}})(w,0);k.response=w,k.rgbaoutput=!0,k.dataurl=!1;var I=k.header?k.header:null,A=k.frames?k.frames:null;if(I){I.loop_counter=I.loop_count,g=[I.canvas_height],b=[I.canvas_width];for(var R=0;R<A.length&&A[R].blend!=0;R++);}var U=A[0],V=v.WebPDecodeRGBA(w,U.src_off,U.src_size,b,g);U.rgba=V,U.imgwidth=b[0],U.imgheight=g[0];for(var P=0;P<b[0]*g[0]*4;P++)x[P]=V[P];return this.width=b,this.height=g,this.data=x,this}(function(n){var e,t,s,r,a,i,o,l,c,f=function(O){return O=O||{},this.isStrokeTransparent=O.isStrokeTransparent||!1,this.strokeOpacity=O.strokeOpacity||1,this.strokeStyle=O.strokeStyle||"#000000",this.fillStyle=O.fillStyle||"#000000",this.isFillTransparent=O.isFillTransparent||!1,this.fillOpacity=O.fillOpacity||1,this.font=O.font||"10px sans-serif",this.textBaseline=O.textBaseline||"alphabetic",this.textAlign=O.textAlign||"left",this.lineWidth=O.lineWidth||1,this.lineJoin=O.lineJoin||"miter",this.lineCap=O.lineCap||"butt",this.path=O.path||[],this.transform=O.transform!==void 0?O.transform.clone():new l,this.globalCompositeOperation=O.globalCompositeOperation||"normal",this.globalAlpha=O.globalAlpha||1,this.clip_path=O.clip_path||[],this.currentPoint=O.currentPoint||new i,this.miterLimit=O.miterLimit||10,this.lastPoint=O.lastPoint||new i,this.lineDashOffset=O.lineDashOffset||0,this.lineDash=O.lineDash||[],this.margin=O.margin||[0,0,0,0],this.prevPageLastElemOffset=O.prevPageLastElemOffset||0,this.ignoreClearRect=typeof O.ignoreClearRect!="boolean"||O.ignoreClearRect,this};n.events.push(["initialized",function(){this.context2d=new d(this),e=this.internal.f2,t=this.internal.getCoordinateString,s=this.internal.getVerticalCoordinateString,r=this.internal.getHorizontalCoordinate,a=this.internal.getVerticalCoordinate,i=this.internal.Point,o=this.internal.Rectangle,l=this.internal.Matrix,c=new f}]);var d=function(O){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var j=O;Object.defineProperty(this,"pdf",{get:function(){return j}});var Y=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return Y},set:function(oe){Y=!!oe}});var ie=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return ie},set:function(oe){ie=!!oe}});var ue=0;Object.defineProperty(this,"posX",{get:function(){return ue},set:function(oe){isNaN(oe)||(ue=oe)}});var pe=0;Object.defineProperty(this,"posY",{get:function(){return pe},set:function(oe){isNaN(oe)||(pe=oe)}}),Object.defineProperty(this,"margin",{get:function(){return c.margin},set:function(oe){var tt;typeof oe=="number"?tt=[oe,oe,oe,oe]:((tt=new Array(4))[0]=oe[0],tt[1]=oe.length>=2?oe[1]:tt[0],tt[2]=oe.length>=3?oe[2]:tt[0],tt[3]=oe.length>=4?oe[3]:tt[1]),c.margin=tt}});var Ce=!1;Object.defineProperty(this,"autoPaging",{get:function(){return Ce},set:function(oe){Ce=oe}});var Ne=0;Object.defineProperty(this,"lastBreak",{get:function(){return Ne},set:function(oe){Ne=oe}});var Le=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Le},set:function(oe){Le=oe}}),Object.defineProperty(this,"ctx",{get:function(){return c},set:function(oe){oe instanceof f&&(c=oe)}}),Object.defineProperty(this,"path",{get:function(){return c.path},set:function(oe){c.path=oe}});var Ve=[];Object.defineProperty(this,"ctxStack",{get:function(){return Ve},set:function(oe){Ve=oe}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(oe){var tt;tt=m(oe),this.ctx.fillStyle=tt.style,this.ctx.isFillTransparent=tt.a===0,this.ctx.fillOpacity=tt.a,this.pdf.setFillColor(tt.r,tt.g,tt.b,{a:tt.a}),this.pdf.setTextColor(tt.r,tt.g,tt.b,{a:tt.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(oe){var tt=m(oe);this.ctx.strokeStyle=tt.style,this.ctx.isStrokeTransparent=tt.a===0,this.ctx.strokeOpacity=tt.a,tt.a===0?this.pdf.setDrawColor(255,255,255):(tt.a,this.pdf.setDrawColor(tt.r,tt.g,tt.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(oe){["butt","round","square"].indexOf(oe)!==-1&&(this.ctx.lineCap=oe,this.pdf.setLineCap(oe))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(oe){isNaN(oe)||(this.ctx.lineWidth=oe,this.pdf.setLineWidth(oe))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(oe){["bevel","round","miter"].indexOf(oe)!==-1&&(this.ctx.lineJoin=oe,this.pdf.setLineJoin(oe))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(oe){isNaN(oe)||(this.ctx.miterLimit=oe,this.pdf.setMiterLimit(oe))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(oe){this.ctx.textBaseline=oe}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(oe){["right","end","center","left","start"].indexOf(oe)!==-1&&(this.ctx.textAlign=oe)}});var rt=null,at=null,ot=null;Object.defineProperty(this,"fontFaces",{get:function(){return ot},set:function(oe){rt=null,at=null,ot=oe}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(oe){var tt;if(this.ctx.font=oe,(tt=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(oe))!==null){var xt=tt[1];tt[2];var ht=tt[3],Je=tt[4];tt[5];var dt=tt[6],ft=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Je)[2];Je=Math.floor(ft==="px"?parseFloat(Je)*this.pdf.internal.scaleFactor:ft==="em"?parseFloat(Je)*this.pdf.getFontSize():parseFloat(Je)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Je);var bt=(function(_t){var ks,ln,Vt=[],Zt=_t.trim();if(Zt==="")return gS;if(Zt in H4)return[H4[Zt]];for(;Zt!=="";){switch(ln=null,ks=(Zt=X4(Zt)).charAt(0)){case'"':case"'":ln=I0e(Zt.substring(1),ks);break;default:ln=E0e(Zt)}if(ln===null||(Vt.push(ln[0]),(Zt=X4(ln[1]))!==""&&Zt.charAt(0)!==","))return gS;Zt=Zt.replace(/^,/,"")}return Vt})(dt);if(this.fontFaces){var Tt=(function(_t,ks){var ln=_t.getFontList(),Vt=JSON.stringify(ln);if(rt===null||at!==Vt){var Zt=(function(kn){var jt=[];return Object.keys(kn).forEach(function(ls){kn[ls].forEach(function(Kt){var nn=null;switch(Kt){case"bold":nn={family:ls,weight:"bold"};break;case"italic":nn={family:ls,style:"italic"};break;case"bolditalic":nn={family:ls,weight:"bold",style:"italic"};break;case"":case"normal":nn={family:ls}}nn!==null&&(nn.ref={name:ls,style:Kt},jt.push(nn))})}),jt})(ln);rt=(function(kn){for(var jt={},ls=0;ls<kn.length;++ls){var Kt=mS(kn[ls]),nn=Kt.family,es=Kt.stretch,dn=Kt.style,Lt=Kt.weight;jt[nn]=jt[nn]||{},jt[nn][es]=jt[nn][es]||{},jt[nn][es][dn]=jt[nn][es][dn]||{},jt[nn][es][dn][Lt]=Kt}return jt})(Zt.concat(ks)),at=Vt}return rt})(this.pdf,this.fontFaces),zt=bt.map(function(_t){return{family:_t,stretch:"normal",weight:ht,style:xt}}),tn=(function(_t,ks,ln){for(var Vt=(ln=ln||{}).defaultFontFamily||"times",Zt=Object.assign({},A0e,ln.genericFontFamilies||{}),kn=null,jt=null,ls=0;ls<ks.length;++ls)if(Zt[(kn=mS(ks[ls])).family]&&(kn.family=Zt[kn.family]),_t.hasOwnProperty(kn.family)){jt=_t[kn.family];break}if(!(jt=jt||_t[Vt]))throw new Error("Could not find a font-family for the rule '"+K4(kn)+"' and default family '"+Vt+"'.");if(jt=(function(Kt,nn){if(nn[Kt])return nn[Kt];var es=TN[Kt],dn=es<=TN.normal?-1:1,Lt=q4(nn,v8,es,dn);if(!Lt)throw new Error("Could not find a matching font-stretch value for "+Kt);return Lt})(kn.stretch,jt),jt=(function(Kt,nn){if(nn[Kt])return nn[Kt];for(var es=x8[Kt],dn=0;dn<es.length;++dn)if(nn[es[dn]])return nn[es[dn]];throw new Error("Could not find a matching font-style for "+Kt)})(kn.style,jt),!(jt=(function(Kt,nn){if(nn[Kt])return nn[Kt];if(Kt===400&&nn[500])return nn[500];if(Kt===500&&nn[400])return nn[400];var es=T0e[Kt],dn=q4(nn,w8,es,Kt<400?-1:1);if(!dn)throw new Error("Could not find a matching font-weight for value "+Kt);return dn})(kn.weight,jt)))throw new Error("Failed to resolve a font for the rule '"+K4(kn)+"'.");return jt})(Tt,zt);this.pdf.setFont(tn.ref.name,tn.ref.style)}else{var Ut="";(ht==="bold"||parseInt(ht,10)>=700||xt==="bold")&&(Ut="bold"),xt==="italic"&&(Ut+="italic"),Ut.length===0&&(Ut="normal");for(var sn="",Yt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},vt=0;vt<bt.length;vt++){if(this.pdf.internal.getFont(bt[vt],Ut,{noFallback:!0,disableWarning:!0})!==void 0){sn=bt[vt];break}if(Ut==="bolditalic"&&this.pdf.internal.getFont(bt[vt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)sn=bt[vt],Ut="bold";else if(this.pdf.internal.getFont(bt[vt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){sn=bt[vt],Ut="normal";break}}if(sn===""){for(var en=0;en<bt.length;en++)if(Yt[bt[en]]){sn=Yt[bt[en]];break}}sn=sn===""?"Times":sn,this.pdf.setFont(sn,Ut)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(oe){this.ctx.globalCompositeOperation=oe}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(oe){this.ctx.globalAlpha=oe}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(oe){this.ctx.lineDashOffset=oe,G.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(oe){this.ctx.lineDash=oe,G.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(oe){this.ctx.ignoreClearRect=!!oe}})};d.prototype.setLineDash=function(O){this.lineDash=O},d.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},d.prototype.fill=function(){A.call(this,"fill",!1)},d.prototype.stroke=function(){A.call(this,"stroke",!1)},d.prototype.beginPath=function(){this.path=[{type:"begin"}]},d.prototype.moveTo=function(O,j){if(isNaN(O)||isNaN(j))throw xs.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var Y=this.ctx.transform.applyToPoint(new i(O,j));this.path.push({type:"mt",x:Y.x,y:Y.y}),this.ctx.lastPoint=new i(O,j)},d.prototype.closePath=function(){var O=new i(0,0),j=0;for(j=this.path.length-1;j!==-1;j--)if(this.path[j].type==="begin"&&as(this.path[j+1])==="object"&&typeof this.path[j+1].x=="number"){O=new i(this.path[j+1].x,this.path[j+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new i(O.x,O.y)},d.prototype.lineTo=function(O,j){if(isNaN(O)||isNaN(j))throw xs.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var Y=this.ctx.transform.applyToPoint(new i(O,j));this.path.push({type:"lt",x:Y.x,y:Y.y}),this.ctx.lastPoint=new i(Y.x,Y.y)},d.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),A.call(this,null,!0)},d.prototype.quadraticCurveTo=function(O,j,Y,ie){if(isNaN(Y)||isNaN(ie)||isNaN(O)||isNaN(j))throw xs.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var ue=this.ctx.transform.applyToPoint(new i(Y,ie)),pe=this.ctx.transform.applyToPoint(new i(O,j));this.path.push({type:"qct",x1:pe.x,y1:pe.y,x:ue.x,y:ue.y}),this.ctx.lastPoint=new i(ue.x,ue.y)},d.prototype.bezierCurveTo=function(O,j,Y,ie,ue,pe){if(isNaN(ue)||isNaN(pe)||isNaN(O)||isNaN(j)||isNaN(Y)||isNaN(ie))throw xs.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var Ce=this.ctx.transform.applyToPoint(new i(ue,pe)),Ne=this.ctx.transform.applyToPoint(new i(O,j)),Le=this.ctx.transform.applyToPoint(new i(Y,ie));this.path.push({type:"bct",x1:Ne.x,y1:Ne.y,x2:Le.x,y2:Le.y,x:Ce.x,y:Ce.y}),this.ctx.lastPoint=new i(Ce.x,Ce.y)},d.prototype.arc=function(O,j,Y,ie,ue,pe){if(isNaN(O)||isNaN(j)||isNaN(Y)||isNaN(ie)||isNaN(ue))throw xs.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(pe=!!pe,!this.ctx.transform.isIdentity){var Ce=this.ctx.transform.applyToPoint(new i(O,j));O=Ce.x,j=Ce.y;var Ne=this.ctx.transform.applyToPoint(new i(0,Y)),Le=this.ctx.transform.applyToPoint(new i(0,0));Y=Math.sqrt(Math.pow(Ne.x-Le.x,2)+Math.pow(Ne.y-Le.y,2))}Math.abs(ue-ie)>=2*Math.PI&&(ie=0,ue=2*Math.PI),this.path.push({type:"arc",x:O,y:j,radius:Y,startAngle:ie,endAngle:ue,counterclockwise:pe})},d.prototype.arcTo=function(O,j,Y,ie,ue){throw new Error("arcTo not implemented.")},d.prototype.rect=function(O,j,Y,ie){if(isNaN(O)||isNaN(j)||isNaN(Y)||isNaN(ie))throw xs.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(O,j),this.lineTo(O+Y,j),this.lineTo(O+Y,j+ie),this.lineTo(O,j+ie),this.lineTo(O,j),this.lineTo(O+Y,j),this.lineTo(O,j)},d.prototype.fillRect=function(O,j,Y,ie){if(isNaN(O)||isNaN(j)||isNaN(Y)||isNaN(ie))throw xs.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!g.call(this)){var ue={};this.lineCap!=="butt"&&(ue.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(ue.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(O,j,Y,ie),this.fill(),ue.hasOwnProperty("lineCap")&&(this.lineCap=ue.lineCap),ue.hasOwnProperty("lineJoin")&&(this.lineJoin=ue.lineJoin)}},d.prototype.strokeRect=function(O,j,Y,ie){if(isNaN(O)||isNaN(j)||isNaN(Y)||isNaN(ie))throw xs.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");b.call(this)||(this.beginPath(),this.rect(O,j,Y,ie),this.stroke())},d.prototype.clearRect=function(O,j,Y,ie){if(isNaN(O)||isNaN(j)||isNaN(Y)||isNaN(ie))throw xs.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(O,j,Y,ie))},d.prototype.save=function(O){O=typeof O!="boolean"||O;for(var j=this.pdf.internal.getCurrentPageInfo().pageNumber,Y=0;Y<this.pdf.internal.getNumberOfPages();Y++)this.pdf.setPage(Y+1),this.pdf.internal.out("q");if(this.pdf.setPage(j),O){this.ctx.fontSize=this.pdf.internal.getFontSize();var ie=new f(this.ctx);this.ctxStack.push(this.ctx),this.ctx=ie}},d.prototype.restore=function(O){O=typeof O!="boolean"||O;for(var j=this.pdf.internal.getCurrentPageInfo().pageNumber,Y=0;Y<this.pdf.internal.getNumberOfPages();Y++)this.pdf.setPage(Y+1),this.pdf.internal.out("Q");this.pdf.setPage(j),O&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},d.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var m=function(O){var j,Y,ie,ue;if(O.isCanvasGradient===!0&&(O=O.getColor()),!O)return{r:0,g:0,b:0,a:0,style:O};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(O))j=0,Y=0,ie=0,ue=0;else{var pe=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(O);if(pe!==null)j=parseInt(pe[1]),Y=parseInt(pe[2]),ie=parseInt(pe[3]),ue=1;else if((pe=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(O))!==null)j=parseInt(pe[1]),Y=parseInt(pe[2]),ie=parseInt(pe[3]),ue=parseFloat(pe[4]);else{if(ue=1,typeof O=="string"&&O.charAt(0)!=="#"){var Ce=new f8(O);O=Ce.ok?Ce.toHex():"#000000"}O.length===4?(j=O.substring(1,2),j+=j,Y=O.substring(2,3),Y+=Y,ie=O.substring(3,4),ie+=ie):(j=O.substring(1,3),Y=O.substring(3,5),ie=O.substring(5,7)),j=parseInt(j,16),Y=parseInt(Y,16),ie=parseInt(ie,16)}}return{r:j,g:Y,b:ie,a:ue,style:O}},g=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},b=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};d.prototype.fillText=function(O,j,Y,ie){if(isNaN(j)||isNaN(Y)||typeof O!="string")throw xs.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(ie=isNaN(ie)?void 0:ie,!g.call(this)){var ue=ee(this.ctx.transform.rotation),pe=this.ctx.transform.scaleX;M.call(this,{text:O,x:j,y:Y,scale:pe,angle:ue,align:this.textAlign,maxWidth:ie})}},d.prototype.strokeText=function(O,j,Y,ie){if(isNaN(j)||isNaN(Y)||typeof O!="string")throw xs.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!b.call(this)){ie=isNaN(ie)?void 0:ie;var ue=ee(this.ctx.transform.rotation),pe=this.ctx.transform.scaleX;M.call(this,{text:O,x:j,y:Y,scale:pe,renderingMode:"stroke",angle:ue,align:this.textAlign,maxWidth:ie})}},d.prototype.measureText=function(O){if(typeof O!="string")throw xs.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var j=this.pdf,Y=this.pdf.internal.scaleFactor,ie=j.internal.getFontSize(),ue=j.getStringUnitWidth(O)*ie/j.internal.scaleFactor;return new function(pe){var Ce=(pe=pe||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return Ce}}),this}({width:ue*=Math.round(96*Y/72*1e4)/1e4})},d.prototype.scale=function(O,j){if(isNaN(O)||isNaN(j))throw xs.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var Y=new l(O,0,0,j,0,0);this.ctx.transform=this.ctx.transform.multiply(Y)},d.prototype.rotate=function(O){if(isNaN(O))throw xs.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var j=new l(Math.cos(O),Math.sin(O),-Math.sin(O),Math.cos(O),0,0);this.ctx.transform=this.ctx.transform.multiply(j)},d.prototype.translate=function(O,j){if(isNaN(O)||isNaN(j))throw xs.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var Y=new l(1,0,0,1,O,j);this.ctx.transform=this.ctx.transform.multiply(Y)},d.prototype.transform=function(O,j,Y,ie,ue,pe){if(isNaN(O)||isNaN(j)||isNaN(Y)||isNaN(ie)||isNaN(ue)||isNaN(pe))throw xs.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var Ce=new l(O,j,Y,ie,ue,pe);this.ctx.transform=this.ctx.transform.multiply(Ce)},d.prototype.setTransform=function(O,j,Y,ie,ue,pe){O=isNaN(O)?1:O,j=isNaN(j)?0:j,Y=isNaN(Y)?0:Y,ie=isNaN(ie)?1:ie,ue=isNaN(ue)?0:ue,pe=isNaN(pe)?0:pe,this.ctx.transform=new l(O,j,Y,ie,ue,pe)};var x=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};d.prototype.drawImage=function(O,j,Y,ie,ue,pe,Ce,Ne,Le){var Ve=this.pdf.getImageProperties(O),rt=1,at=1,ot=1,oe=1;ie!==void 0&&Ne!==void 0&&(ot=Ne/ie,oe=Le/ue,rt=Ve.width/ie*Ne/ie,at=Ve.height/ue*Le/ue),pe===void 0&&(pe=j,Ce=Y,j=0,Y=0),ie!==void 0&&Ne===void 0&&(Ne=ie,Le=ue),ie===void 0&&Ne===void 0&&(Ne=Ve.width,Le=Ve.height);var tt=this.ctx.transform.decompose(),xt=ee(tt.rotate.shx),ht=new l,Je=(ht=(ht=(ht=ht.multiply(tt.translate)).multiply(tt.skew)).multiply(tt.scale)).applyToRectangle(new o(pe-j*ot,Ce-Y*oe,ie*rt,ue*at));if(this.autoPaging){for(var dt,ft=v.call(this,Je),bt=[],Tt=0;Tt<ft.length;Tt+=1)bt.indexOf(ft[Tt])===-1&&bt.push(ft[Tt]);I(bt);for(var zt=bt[0],tn=bt[bt.length-1],Ut=zt;Ut<tn+1;Ut++){this.pdf.setPage(Ut);var sn=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Yt=Ut===1?this.posY+this.margin[0]:this.margin[0],vt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],en=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],_t=Ut===1?0:vt+(Ut-2)*en;if(this.ctx.clip_path.length!==0){var ks=this.path;dt=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=k(dt,this.posX+this.margin[3],-_t+Yt+this.ctx.prevPageLastElemOffset),R.call(this,"fill",!0),this.path=ks}var ln=JSON.parse(JSON.stringify(Je));ln=k([ln],this.posX+this.margin[3],-_t+Yt+this.ctx.prevPageLastElemOffset)[0];var Vt=(Ut>zt||Ut<tn)&&x.call(this);Vt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],sn,en,null).clip().discardPath()),this.pdf.addImage(O,"JPEG",ln.x,ln.y,ln.w,ln.h,null,null,xt),Vt&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(O,"JPEG",Je.x,Je.y,Je.w,Je.h,null,null,xt)};var v=function(O,j,Y){var ie=[];j=j||this.pdf.internal.pageSize.width,Y=Y||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var ue=this.posY+this.ctx.prevPageLastElemOffset;switch(O.type){default:case"mt":case"lt":ie.push(Math.floor((O.y+ue)/Y)+1);break;case"arc":ie.push(Math.floor((O.y+ue-O.radius)/Y)+1),ie.push(Math.floor((O.y+ue+O.radius)/Y)+1);break;case"qct":var pe=ce(this.ctx.lastPoint.x,this.ctx.lastPoint.y,O.x1,O.y1,O.x,O.y);ie.push(Math.floor((pe.y+ue)/Y)+1),ie.push(Math.floor((pe.y+pe.h+ue)/Y)+1);break;case"bct":var Ce=ye(this.ctx.lastPoint.x,this.ctx.lastPoint.y,O.x1,O.y1,O.x2,O.y2,O.x,O.y);ie.push(Math.floor((Ce.y+ue)/Y)+1),ie.push(Math.floor((Ce.y+Ce.h+ue)/Y)+1);break;case"rect":ie.push(Math.floor((O.y+ue)/Y)+1),ie.push(Math.floor((O.y+O.h+ue)/Y)+1)}for(var Ne=0;Ne<ie.length;Ne+=1)for(;this.pdf.internal.getNumberOfPages()<ie[Ne];)w.call(this);return ie},w=function(){var O=this.fillStyle,j=this.strokeStyle,Y=this.font,ie=this.lineCap,ue=this.lineWidth,pe=this.lineJoin;this.pdf.addPage(),this.fillStyle=O,this.strokeStyle=j,this.font=Y,this.lineCap=ie,this.lineWidth=ue,this.lineJoin=pe},k=function(O,j,Y){for(var ie=0;ie<O.length;ie++)switch(O[ie].type){case"bct":O[ie].x2+=j,O[ie].y2+=Y;case"qct":O[ie].x1+=j,O[ie].y1+=Y;default:O[ie].x+=j,O[ie].y+=Y}return O},I=function(O){return O.sort(function(j,Y){return j-Y})},A=function(O,j){var Y=this.fillStyle,ie=this.strokeStyle,ue=this.lineCap,pe=this.lineWidth,Ce=Math.abs(pe*this.ctx.transform.scaleX),Ne=this.lineJoin;if(this.autoPaging){for(var Le,Ve,rt=JSON.parse(JSON.stringify(this.path)),at=JSON.parse(JSON.stringify(this.path)),ot=[],oe=0;oe<at.length;oe++)if(at[oe].x!==void 0)for(var tt=v.call(this,at[oe]),xt=0;xt<tt.length;xt+=1)ot.indexOf(tt[xt])===-1&&ot.push(tt[xt]);for(var ht=0;ht<ot.length;ht++)for(;this.pdf.internal.getNumberOfPages()<ot[ht];)w.call(this);I(ot);for(var Je=ot[0],dt=ot[ot.length-1],ft=Je;ft<dt+1;ft++){this.pdf.setPage(ft),this.fillStyle=Y,this.strokeStyle=ie,this.lineCap=ue,this.lineWidth=Ce,this.lineJoin=Ne;var bt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Tt=ft===1?this.posY+this.margin[0]:this.margin[0],zt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],tn=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ut=ft===1?0:zt+(ft-2)*tn;if(this.ctx.clip_path.length!==0){var sn=this.path;Le=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=k(Le,this.posX+this.margin[3],-Ut+Tt+this.ctx.prevPageLastElemOffset),R.call(this,O,!0),this.path=sn}if(Ve=JSON.parse(JSON.stringify(rt)),this.path=k(Ve,this.posX+this.margin[3],-Ut+Tt+this.ctx.prevPageLastElemOffset),j===!1||ft===0){var Yt=(ft>Je||ft<dt)&&x.call(this);Yt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],bt,tn,null).clip().discardPath()),R.call(this,O,j),Yt&&this.pdf.restoreGraphicsState()}this.lineWidth=pe}this.path=rt}else this.lineWidth=Ce,R.call(this,O,j),this.lineWidth=pe},R=function(O,j){if((O!=="stroke"||j||!b.call(this))&&(O==="stroke"||j||!g.call(this))){for(var Y,ie,ue=[],pe=this.path,Ce=0;Ce<pe.length;Ce++){var Ne=pe[Ce];switch(Ne.type){case"begin":ue.push({begin:!0});break;case"close":ue.push({close:!0});break;case"mt":ue.push({start:Ne,deltas:[],abs:[]});break;case"lt":var Le=ue.length;if(pe[Ce-1]&&!isNaN(pe[Ce-1].x)&&(Y=[Ne.x-pe[Ce-1].x,Ne.y-pe[Ce-1].y],Le>0)){for(;Le>=0;Le--)if(ue[Le-1].close!==!0&&ue[Le-1].begin!==!0){ue[Le-1].deltas.push(Y),ue[Le-1].abs.push(Ne);break}}break;case"bct":Y=[Ne.x1-pe[Ce-1].x,Ne.y1-pe[Ce-1].y,Ne.x2-pe[Ce-1].x,Ne.y2-pe[Ce-1].y,Ne.x-pe[Ce-1].x,Ne.y-pe[Ce-1].y],ue[ue.length-1].deltas.push(Y);break;case"qct":var Ve=pe[Ce-1].x+2/3*(Ne.x1-pe[Ce-1].x),rt=pe[Ce-1].y+2/3*(Ne.y1-pe[Ce-1].y),at=Ne.x+2/3*(Ne.x1-Ne.x),ot=Ne.y+2/3*(Ne.y1-Ne.y),oe=Ne.x,tt=Ne.y;Y=[Ve-pe[Ce-1].x,rt-pe[Ce-1].y,at-pe[Ce-1].x,ot-pe[Ce-1].y,oe-pe[Ce-1].x,tt-pe[Ce-1].y],ue[ue.length-1].deltas.push(Y);break;case"arc":ue.push({deltas:[],abs:[],arc:!0}),Array.isArray(ue[ue.length-1].abs)&&ue[ue.length-1].abs.push(Ne)}}ie=j?null:O==="stroke"?"stroke":"fill";for(var xt=!1,ht=0;ht<ue.length;ht++)if(ue[ht].arc)for(var Je=ue[ht].abs,dt=0;dt<Je.length;dt++){var ft=Je[dt];ft.type==="arc"?P.call(this,ft.x,ft.y,ft.radius,ft.startAngle,ft.endAngle,ft.counterclockwise,void 0,j,!xt):K.call(this,ft.x,ft.y),xt=!0}else if(ue[ht].close===!0)this.pdf.internal.out("h"),xt=!1;else if(ue[ht].begin!==!0){var bt=ue[ht].start.x,Tt=ue[ht].start.y;X.call(this,ue[ht].deltas,bt,Tt),xt=!0}ie&&D.call(this,ie),j&&B.call(this)}},U=function(O){var j=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,Y=j*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return O-Y;case"top":return O+j-Y;case"hanging":return O+j-2*Y;case"middle":return O+j/2-Y;default:return O}},V=function(O){return O+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};d.prototype.createLinearGradient=function(){var O=function(){};return O.colorStops=[],O.addColorStop=function(j,Y){this.colorStops.push([j,Y])},O.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},O.isCanvasGradient=!0,O},d.prototype.createPattern=function(){return this.createLinearGradient()},d.prototype.createRadialGradient=function(){return this.createLinearGradient()};var P=function(O,j,Y,ie,ue,pe,Ce,Ne,Le){for(var Ve=W.call(this,Y,ie,ue,pe),rt=0;rt<Ve.length;rt++){var at=Ve[rt];rt===0&&(Le?E.call(this,at.x1+O,at.y1+j):K.call(this,at.x1+O,at.y1+j)),ae.call(this,O,j,at.x2,at.y2,at.x3,at.y3,at.x4,at.y4)}Ne?B.call(this):D.call(this,Ce)},D=function(O){switch(O){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},B=function(){this.pdf.clip(),this.pdf.discardPath()},E=function(O,j){this.pdf.internal.out(t(O)+" "+s(j)+" m")},M=function(O){var j;switch(O.align){case"right":case"end":j="right";break;case"center":j="center";break;default:j="left"}var Y,ie,ue,pe=this.pdf.getTextDimensions(O.text),Ce=U.call(this,O.y),Ne=V.call(this,Ce)-pe.h,Le=this.ctx.transform.applyToPoint(new i(O.x,Ce));if(this.autoPaging){var Ve=this.ctx.transform.decompose(),rt=new l;rt=(rt=(rt=rt.multiply(Ve.translate)).multiply(Ve.skew)).multiply(Ve.scale);for(var at=this.ctx.transform.applyToRectangle(new o(O.x,Ce,pe.w,pe.h)),ot=rt.applyToRectangle(new o(O.x,Ne,pe.w,pe.h)),oe=v.call(this,ot),tt=[],xt=0;xt<oe.length;xt+=1)tt.indexOf(oe[xt])===-1&&tt.push(oe[xt]);I(tt);for(var ht=tt[0],Je=tt[tt.length-1],dt=ht;dt<Je+1;dt++){this.pdf.setPage(dt);var ft=dt===1?this.posY+this.margin[0]:this.margin[0],bt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Tt=this.pdf.internal.pageSize.height-this.margin[2],zt=Tt-this.margin[0],tn=this.pdf.internal.pageSize.width-this.margin[1],Ut=tn-this.margin[3],sn=dt===1?0:bt+(dt-2)*zt;if(this.ctx.clip_path.length!==0){var Yt=this.path;Y=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=k(Y,this.posX+this.margin[3],-1*sn+ft),R.call(this,"fill",!0),this.path=Yt}var vt=k([JSON.parse(JSON.stringify(ot))],this.posX+this.margin[3],-sn+ft+this.ctx.prevPageLastElemOffset)[0];O.scale>=.01&&(ie=this.pdf.internal.getFontSize(),this.pdf.setFontSize(ie*O.scale),ue=this.lineWidth,this.lineWidth=ue*O.scale);var en=this.autoPaging!=="text";if(en||vt.y+vt.h<=Tt){if(en||vt.y>=ft&&vt.x<=tn){var _t=en?O.text:this.pdf.splitTextToSize(O.text,O.maxWidth||tn-vt.x)[0],ks=k([JSON.parse(JSON.stringify(at))],this.posX+this.margin[3],-sn+ft+this.ctx.prevPageLastElemOffset)[0],ln=en&&(dt>ht||dt<Je)&&x.call(this);ln&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ut,zt,null).clip().discardPath()),this.pdf.text(_t,ks.x,ks.y,{angle:O.angle,align:j,renderingMode:O.renderingMode}),ln&&this.pdf.restoreGraphicsState()}}else vt.y<Tt&&(this.ctx.prevPageLastElemOffset+=Tt-vt.y);O.scale>=.01&&(this.pdf.setFontSize(ie),this.lineWidth=ue)}}else O.scale>=.01&&(ie=this.pdf.internal.getFontSize(),this.pdf.setFontSize(ie*O.scale),ue=this.lineWidth,this.lineWidth=ue*O.scale),this.pdf.text(O.text,Le.x+this.posX,Le.y+this.posY,{angle:O.angle,align:j,renderingMode:O.renderingMode,maxWidth:O.maxWidth}),O.scale>=.01&&(this.pdf.setFontSize(ie),this.lineWidth=ue)},K=function(O,j,Y,ie){Y=Y||0,ie=ie||0,this.pdf.internal.out(t(O+Y)+" "+s(j+ie)+" l")},X=function(O,j,Y){return this.pdf.lines(O,j,Y,null,null)},ae=function(O,j,Y,ie,ue,pe,Ce,Ne){this.pdf.internal.out([e(r(Y+O)),e(a(ie+j)),e(r(ue+O)),e(a(pe+j)),e(r(Ce+O)),e(a(Ne+j)),"c"].join(" "))},W=function(O,j,Y,ie){for(var ue=2*Math.PI,pe=Math.PI/2;j>Y;)j-=ue;var Ce=Math.abs(Y-j);Ce<ue&&ie&&(Ce=ue-Ce);for(var Ne=[],Le=ie?-1:1,Ve=j;Ce>1e-5;){var rt=Ve+Le*Math.min(Ce,pe);Ne.push(se.call(this,O,Ve,rt)),Ce-=Math.abs(rt-Ve),Ve=rt}return Ne},se=function(O,j,Y){var ie=(Y-j)/2,ue=O*Math.cos(ie),pe=O*Math.sin(ie),Ce=ue,Ne=-pe,Le=Ce*Ce+Ne*Ne,Ve=Le+Ce*ue+Ne*pe,rt=4/3*(Math.sqrt(2*Le*Ve)-Ve)/(Ce*pe-Ne*ue),at=Ce-rt*Ne,ot=Ne+rt*Ce,oe=at,tt=-ot,xt=ie+j,ht=Math.cos(xt),Je=Math.sin(xt);return{x1:O*Math.cos(j),y1:O*Math.sin(j),x2:at*ht-ot*Je,y2:at*Je+ot*ht,x3:oe*ht-tt*Je,y3:oe*Je+tt*ht,x4:O*Math.cos(Y),y4:O*Math.sin(Y)}},ee=function(O){return 180*O/Math.PI},ce=function(O,j,Y,ie,ue,pe){var Ce=O+.5*(Y-O),Ne=j+.5*(ie-j),Le=ue+.5*(Y-ue),Ve=pe+.5*(ie-pe),rt=Math.min(O,ue,Ce,Le),at=Math.max(O,ue,Ce,Le),ot=Math.min(j,pe,Ne,Ve),oe=Math.max(j,pe,Ne,Ve);return new o(rt,ot,at-rt,oe-ot)},ye=function(O,j,Y,ie,ue,pe,Ce,Ne){var Le,Ve,rt,at,ot,oe,tt,xt,ht,Je,dt,ft,bt,Tt,zt=Y-O,tn=ie-j,Ut=ue-Y,sn=pe-ie,Yt=Ce-ue,vt=Ne-pe;for(Ve=0;Ve<41;Ve++)ht=(tt=(rt=O+(Le=Ve/40)*zt)+Le*((ot=Y+Le*Ut)-rt))+Le*(ot+Le*(ue+Le*Yt-ot)-tt),Je=(xt=(at=j+Le*tn)+Le*((oe=ie+Le*sn)-at))+Le*(oe+Le*(pe+Le*vt-oe)-xt),Ve==0?(dt=ht,ft=Je,bt=ht,Tt=Je):(dt=Math.min(dt,ht),ft=Math.min(ft,Je),bt=Math.max(bt,ht),Tt=Math.max(Tt,Je));return new o(Math.round(dt),Math.round(ft),Math.round(bt-dt),Math.round(Tt-ft))},G=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var O,j,Y=(O=this.ctx.lineDash,j=this.ctx.lineDashOffset,JSON.stringify({lineDash:O,lineDashOffset:j}));this.prevLineDash!==Y&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=Y)}}})(Ft.API),(function(n){var e=function(i){var o,l,c,f,d,m,g,b,x,v;for(l=[],c=0,f=(i+=o="\0\0\0\0".slice(i.length%4||4)).length;f>c;c+=4)(d=(i.charCodeAt(c)<<24)+(i.charCodeAt(c+1)<<16)+(i.charCodeAt(c+2)<<8)+i.charCodeAt(c+3))!==0?(m=(d=((d=((d=((d=(d-(v=d%85))/85)-(x=d%85))/85)-(b=d%85))/85)-(g=d%85))/85)%85,l.push(m+33,g+33,b+33,x+33,v+33)):l.push(122);return(function(w,k){for(var I=k;I>0;I--)w.pop()})(l,o.length),String.fromCharCode.apply(String,l)+"~>"},t=function(i){var o,l,c,f,d,m=String,g="length",b=255,x="charCodeAt",v="slice",w="replace";for(i[v](-2),i=i[v](0,-2)[w](/\s/g,"")[w]("z","!!!!!"),c=[],f=0,d=(i+=o="uuuuu"[v](i[g]%5||5))[g];d>f;f+=5)l=52200625*(i[x](f)-33)+614125*(i[x](f+1)-33)+7225*(i[x](f+2)-33)+85*(i[x](f+3)-33)+(i[x](f+4)-33),c.push(b&l>>24,b&l>>16,b&l>>8,b&l);return(function(k,I){for(var A=I;A>0;A--)k.pop()})(c,o[g]),m.fromCharCode.apply(m,c)},s=function(i){return i.split("").map(function(o){return("0"+o.charCodeAt().toString(16)).slice(-2)}).join("")+">"},r=function(i){var o=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((i=i.replace(/\s/g,"")).indexOf(">")!==-1&&(i=i.substr(0,i.indexOf(">"))),i.length%2&&(i+="0"),o.test(i)===!1)return"";for(var l="",c=0;c<i.length;c+=2)l+=String.fromCharCode("0x"+(i[c]+i[c+1]));return l},a=function(i){for(var o=new Uint8Array(i.length),l=i.length;l--;)o[l]=i.charCodeAt(l);return(o=xN(o)).reduce(function(c,f){return c+String.fromCharCode(f)},"")};n.processDataByFilters=function(i,o){var l=0,c=i||"",f=[];for(typeof(o=o||[])=="string"&&(o=[o]),l=0;l<o.length;l+=1)switch(o[l]){case"ASCII85Decode":case"/ASCII85Decode":c=t(c),f.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":c=e(c),f.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":c=r(c),f.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":c=s(c),f.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":c=a(c),f.push("/FlateDecode");break;default:throw new Error('The filter: "'+o[l]+'" is not implemented')}return{data:c,reverseChain:f.reverse().join(" ")}}})(Ft.API),(function(n){n.loadFile=function(e,t,s){return(function(r,a,i){a=a!==!1,i=typeof i=="function"?i:function(){};var o=void 0;try{o=(function(l,c,f){var d=new XMLHttpRequest,m=0,g=function(b){var x=b.length,v=[],w=String.fromCharCode;for(m=0;m<x;m+=1)v.push(w(255&b.charCodeAt(m)));return v.join("")};if(d.open("GET",l,!c),d.overrideMimeType("text/plain; charset=x-user-defined"),c===!1&&(d.onload=function(){d.status===200?f(g(this.responseText)):f(void 0)}),d.send(null),c&&d.status===200)return g(d.responseText)})(r,a,i)}catch{}return o})(e,t,s)},n.loadImageFile=n.loadFile})(Ft.API),(function(n){function e(){return(an.html2canvas?Promise.resolve(an.html2canvas):Z5(()=>import("./html2canvas.esm-Ge7aVWlp.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load html2canvas: "+o))}).then(function(o){return o.default?o.default:o})}function t(){return(an.DOMPurify?Promise.resolve(an.DOMPurify):Z5(()=>import("./purify.es-C65SP4u9.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load dompurify: "+o))}).then(function(o){return o.default?o.default:o})}var s=function(o){var l=as(o);return l==="undefined"?"undefined":l==="string"||o instanceof String?"string":l==="number"||o instanceof Number?"number":l==="function"||o instanceof Function?"function":o&&o.constructor===Array?"array":o&&o.nodeType===1?"element":l==="object"?"object":"unknown"},r=function(o,l){var c=document.createElement(o);for(var f in l.className&&(c.className=l.className),l.innerHTML&&l.dompurify&&(c.innerHTML=l.dompurify.sanitize(l.innerHTML)),l.style)c.style[f]=l.style[f];return c},a=function o(l,c){for(var f=l.nodeType===3?document.createTextNode(l.nodeValue):l.cloneNode(!1),d=l.firstChild;d;d=d.nextSibling)c!==!0&&d.nodeType===1&&d.nodeName==="SCRIPT"||f.appendChild(o(d,c));return l.nodeType===1&&(l.nodeName==="CANVAS"?(f.width=l.width,f.height=l.height,f.getContext("2d").drawImage(l,0,0)):l.nodeName!=="TEXTAREA"&&l.nodeName!=="SELECT"||(f.value=l.value),f.addEventListener("load",function(){f.scrollTop=l.scrollTop,f.scrollLeft=l.scrollLeft},!0)),f},i=function o(l){var c=Object.assign(o.convert(Promise.resolve()),JSON.parse(JSON.stringify(o.template))),f=o.convert(Promise.resolve(),c);return(f=f.setProgress(1,o,1,[o])).set(l)};(i.prototype=Object.create(Promise.prototype)).constructor=i,i.convert=function(o,l){return o.__proto__=l||i.prototype,o},i.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},i.prototype.from=function(o,l){return this.then(function(){switch(l=l||(function(c){switch(s(c)){case"string":return"string";case"element":return c.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(o),l){case"string":return this.then(t).then(function(c){return this.set({src:r("div",{innerHTML:o,dompurify:c})})});case"element":return this.set({src:o});case"canvas":return this.set({canvas:o});case"img":return this.set({img:o});default:return this.error("Unknown source type.")}})},i.prototype.to=function(o){switch(o){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},i.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var o={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},l=a(this.prop.src,this.opt.html2canvas.javascriptEnabled);l.tagName==="BODY"&&(o.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=r("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=r("div",{className:"html2pdf__container",style:o}),this.prop.container.appendChild(l),this.prop.container.firstChild.appendChild(r("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},i.prototype.toCanvas=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(e).then(function(l){var c=Object.assign({},this.opt.html2canvas);return delete c.onrendered,l(this.prop.container,c)}).then(function(l){(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},i.prototype.toContext2d=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(e).then(function(l){var c=this.opt.jsPDF,f=this.opt.fontFaces,d=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,m=Object.assign({async:!0,allowTaint:!0,scale:d,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete m.onrendered,c.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,c.context2d.posX=this.opt.x,c.context2d.posY=this.opt.y,c.context2d.margin=this.opt.margin,c.context2d.fontFaces=f,f)for(var g=0;g<f.length;++g){var b=f[g],x=b.src.find(function(v){return v.format==="truetype"});x&&c.addFont(x.url,b.ref.name,b.ref.style)}return m.windowHeight=m.windowHeight||0,m.windowHeight=m.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):m.windowHeight,c.context2d.save(!0),l(this.prop.container,m)}).then(function(l){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},i.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var o=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=o})},i.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},i.prototype.output=function(o,l,c){return(c=c||"pdf").toLowerCase()==="img"||c.toLowerCase()==="image"?this.outputImg(o,l):this.outputPdf(o,l)},i.prototype.outputPdf=function(o,l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(o,l)})},i.prototype.outputImg=function(o){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(o){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+o+'" is not supported.'}})},i.prototype.save=function(o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(o?{filename:o}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},i.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},i.prototype.set=function(o){if(s(o)!=="object")return this;var l=Object.keys(o||{}).map(function(c){if(c in i.template.prop)return function(){this.prop[c]=o[c]};switch(c){case"margin":return this.setMargin.bind(this,o.margin);case"jsPDF":return function(){return this.opt.jsPDF=o.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,o.pageSize);default:return function(){this.opt[c]=o[c]}}},this);return this.then(function(){return this.thenList(l)})},i.prototype.get=function(o,l){return this.then(function(){var c=o in i.template.prop?this.prop[o]:this.opt[o];return l?l(c):c})},i.prototype.setMargin=function(o){return this.then(function(){switch(s(o)){case"number":o=[o,o,o,o];case"array":if(o.length===2&&(o=[o[0],o[1],o[0],o[1]]),o.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=o}).then(this.setPageSize)},i.prototype.setPageSize=function(o){function l(c,f){return Math.floor(c*f/72*96)}return this.then(function(){(o=o||Ft.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(o.inner={width:o.width-this.opt.margin[1]-this.opt.margin[3],height:o.height-this.opt.margin[0]-this.opt.margin[2]},o.inner.px={width:l(o.inner.width,o.k),height:l(o.inner.height,o.k)},o.inner.ratio=o.inner.height/o.inner.width),this.prop.pageSize=o})},i.prototype.setProgress=function(o,l,c,f){return o!=null&&(this.progress.val=o),l!=null&&(this.progress.state=l),c!=null&&(this.progress.n=c),f!=null&&(this.progress.stack=f),this.progress.ratio=this.progress.val/this.progress.state,this},i.prototype.updateProgress=function(o,l,c,f){return this.setProgress(o?this.progress.val+o:null,l||null,c?this.progress.n+c:null,f?this.progress.stack.concat(f):null)},i.prototype.then=function(o,l){var c=this;return this.thenCore(o,l,function(f,d){return c.updateProgress(null,null,1,[f]),Promise.prototype.then.call(this,function(m){return c.updateProgress(null,f),m}).then(f,d).then(function(m){return c.updateProgress(1),m})})},i.prototype.thenCore=function(o,l,c){c=c||Promise.prototype.then;var f=this;o&&(o=o.bind(f)),l&&(l=l.bind(f));var d=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?f:i.convert(Object.assign({},f),Promise.prototype),m=c.call(d,o,l);return i.convert(m,f.__proto__)},i.prototype.thenExternal=function(o,l){return Promise.prototype.then.call(this,o,l)},i.prototype.thenList=function(o){var l=this;return o.forEach(function(c){l=l.thenCore(c)}),l},i.prototype.catch=function(o){o&&(o=o.bind(this));var l=Promise.prototype.catch.call(this,o);return i.convert(l,this)},i.prototype.catchExternal=function(o){return Promise.prototype.catch.call(this,o)},i.prototype.error=function(o){return this.then(function(){throw new Error(o)})},i.prototype.using=i.prototype.set,i.prototype.saveAs=i.prototype.save,i.prototype.export=i.prototype.output,i.prototype.run=i.prototype.then,Ft.getPageSize=function(o,l,c){if(as(o)==="object"){var f=o;o=f.orientation,l=f.unit||l,c=f.format||c}l=l||"mm",c=c||"a4",o=(""+(o||"P")).toLowerCase();var d,m=(""+c).toLowerCase(),g={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(l){case"pt":d=1;break;case"mm":d=72/25.4;break;case"cm":d=72/2.54;break;case"in":d=72;break;case"px":d=.75;break;case"pc":case"em":d=12;break;case"ex":d=6;break;default:throw"Invalid unit: "+l}var b,x=0,v=0;if(g.hasOwnProperty(m))x=g[m][1]/d,v=g[m][0]/d;else try{x=c[1],v=c[0]}catch{throw new Error("Invalid format: "+c)}if(o==="p"||o==="portrait")o="p",v>x&&(b=v,v=x,x=b);else{if(o!=="l"&&o!=="landscape")throw"Invalid orientation: "+o;o="l",x>v&&(b=v,v=x,x=b)}return{width:v,height:x,unit:l,k:d,orientation:o}},n.html=function(o,l){(l=l||{}).callback=l.callback||function(){},l.html2canvas=l.html2canvas||{},l.html2canvas.canvas=l.html2canvas.canvas||this.canvas,l.jsPDF=l.jsPDF||this,l.fontFaces=l.fontFaces?l.fontFaces.map(mS):null;var c=new i(l);return l.worker?c:c.from(o).doCallback()}})(Ft.API),Ft.API.addJS=function(n){return Z4=n,this.internal.events.subscribe("postPutResources",function(){U2=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(U2+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),Y4=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+Z4+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){U2!==void 0&&Y4!==void 0&&this.internal.out("/Names <</JavaScript "+U2+" 0 R>>")}),this},(function(n){var e;n.events.push(["postPutResources",function(){var t=this,s=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var r=t.outline.render().split(/\r\n/),a=0;a<r.length;a++){var i=r[a],o=s.exec(i);if(o!=null){var l=o[1];t.internal.newObjectDeferredBegin(l,!1)}t.internal.write(i)}if(this.outline.createNamedDestinations){var c=this.internal.pages.length,f=[];for(a=0;a<c;a++){var d=t.internal.newObject();f.push(d);var m=t.internal.getPageInfo(a+1);t.internal.write("<< /D["+m.objId+" 0 R /XYZ null null null]>> endobj")}var g=t.internal.newObject();for(t.internal.write("<< /Names [ "),a=0;a<f.length;a++)t.internal.write("(page_"+(a+1)+")"+f[a]+" 0 R");t.internal.write(" ] >>","endobj"),e=t.internal.newObject(),t.internal.write("<< /Dests "+g+" 0 R"),t.internal.write(">>","endobj")}}]),n.events.push(["putCatalog",function(){var t=this;t.outline.root.children.length>0&&(t.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&t.internal.write("/Names "+e+" 0 R"))}]),n.events.push(["initialized",function(){var t=this;t.outline={createNamedDestinations:!1,root:{children:[]}},t.outline.add=function(s,r,a){var i={title:r,options:a,children:[]};return s==null&&(s=this.root),s.children.push(i),i},t.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=t,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},t.outline.genIds_r=function(s){s.id=t.internal.newObjectDeferred();for(var r=0;r<s.children.length;r++)this.genIds_r(s.children[r])},t.outline.renderRoot=function(s){this.objStart(s),this.line("/Type /Outlines"),s.children.length>0&&(this.line("/First "+this.makeRef(s.children[0])),this.line("/Last "+this.makeRef(s.children[s.children.length-1]))),this.line("/Count "+this.count_r({count:0},s)),this.objEnd()},t.outline.renderItems=function(s){for(var r=this.ctx.pdf.internal.getVerticalCoordinateString,a=0;a<s.children.length;a++){var i=s.children[a];this.objStart(i),this.line("/Title "+this.makeString(i.title)),this.line("/Parent "+this.makeRef(s)),a>0&&this.line("/Prev "+this.makeRef(s.children[a-1])),a<s.children.length-1&&this.line("/Next "+this.makeRef(s.children[a+1])),i.children.length>0&&(this.line("/First "+this.makeRef(i.children[0])),this.line("/Last "+this.makeRef(i.children[i.children.length-1])));var o=this.count=this.count_r({count:0},i);if(o>0&&this.line("/Count "+o),i.options&&i.options.pageNumber){var l=t.internal.getPageInfo(i.options.pageNumber);this.line("/Dest ["+l.objId+" 0 R /XYZ 0 "+r(0)+" 0]")}this.objEnd()}for(var c=0;c<s.children.length;c++)this.renderItems(s.children[c])},t.outline.line=function(s){this.ctx.val+=s+`\r
`},t.outline.makeRef=function(s){return s.id+" 0 R"},t.outline.makeString=function(s){return"("+t.internal.pdfEscape(s)+")"},t.outline.objStart=function(s){this.ctx.val+=`\r
`+s.id+` 0 obj\r
<<\r
`},t.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},t.outline.count_r=function(s,r){for(var a=0;a<r.children.length;a++)s.count++,this.count_r(s,r.children[a]);return s.count}}])})(Ft.API),(function(n){var e=[192,193,194,195,196,197,198,199];n.processJPEG=function(t,s,r,a,i,o){var l,c=this.decode.DCT_DECODE,f=null;if(typeof t=="string"||this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t)){switch(t=i||t,t=this.__addimage__.isArrayBuffer(t)?new Uint8Array(t):t,l=(function(d){for(var m,g=256*d.charCodeAt(4)+d.charCodeAt(5),b=d.length,x={width:0,height:0,numcomponents:1},v=4;v<b;v+=2){if(v+=g,e.indexOf(d.charCodeAt(v+1))!==-1){m=256*d.charCodeAt(v+5)+d.charCodeAt(v+6),x={width:256*d.charCodeAt(v+7)+d.charCodeAt(v+8),height:m,numcomponents:d.charCodeAt(v+9)};break}g=256*d.charCodeAt(v+2)+d.charCodeAt(v+3)}return x})(t=this.__addimage__.isArrayBufferView(t)?this.__addimage__.arrayBufferToBinaryString(t):t),l.numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}f={data:t,width:l.width,height:l.height,colorSpace:o,bitsPerComponent:8,filter:c,index:s,alias:r}}return f}})(Ft.API),Ft.API.processPNG=function(n,e,t,s){if(this.__addimage__.isArrayBuffer(n)&&(n=new Uint8Array(n)),this.__addimage__.isArrayBufferView(n)){var r,a=f0e(n,{checkCrc:!0}),i=a.width,o=a.height,l=a.channels,c=a.palette,f=a.depth;r=c&&l===1?(function(P){for(var D=P.width,B=P.height,E=P.data,M=P.palette,K=P.depth,X=!1,ae=[],W=[],se=void 0,ee=!1,ce=0,ye=0;ye<M.length;ye++){var G=t4(M[ye],4),O=G[0],j=G[1],Y=G[2],ie=G[3];ae.push(O,j,Y),ie!=null&&(ie===0?(ce++,W.length<1&&W.push(ye)):ie<255&&(ee=!0))}if(ee||ce>1){X=!0,W=void 0;var ue=D*B;se=new Uint8Array(ue);for(var pe=new DataView(E.buffer),Ce=0;Ce<ue;Ce++){var Ne=yS(pe,Ce,K),Le=t4(M[Ne],4)[3];se[Ce]=Le}}else ce===0&&(W=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:X?8:void 0,colorBytes:E,alphaBytes:se,needSMask:X,palette:ae,mask:W}})(a):l===2||l===4?(function(P){for(var D=P.data,B=P.width,E=P.height,M=P.channels,K=P.depth,X=M===2?"DeviceGray":"DeviceRGB",ae=M-1,W=B*E,se=ae,ee=W*se,ce=1*W,ye=Math.ceil(ee*K/8),G=Math.ceil(ce*K/8),O=new Uint8Array(ye),j=new Uint8Array(G),Y=new DataView(D.buffer),ie=new DataView(O.buffer),ue=new DataView(j.buffer),pe=!1,Ce=0;Ce<W;Ce++){for(var Ne=Ce*M,Le=0;Le<se;Le++)i_(ie,yS(Y,Ne+Le,K),Ce*se+Le,K);var Ve=yS(Y,Ne+se,K);Ve<(1<<K)-1&&(pe=!0),i_(ue,Ve,1*Ce,K)}return{colorSpace:X,colorsPerPixel:ae,sMaskBitsPerComponent:pe?K:void 0,colorBytes:O,alphaBytes:j,needSMask:pe}})(a):(function(P){var D=P.data,B=P.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:B,colorsPerPixel:B==="DeviceGray"?1:3,colorBytes:D instanceof Uint16Array?(function(E){for(var M=E.length,K=new Uint8Array(2*M),X=new DataView(K.buffer,K.byteOffset,K.byteLength),ae=0;ae<M;ae++)X.setUint16(2*ae,E[ae],!1);return K})(D):D,needSMask:!1}})(a);var d,m,g,b=r,x=b.colorSpace,v=b.colorsPerPixel,w=b.sMaskBitsPerComponent,k=b.colorBytes,I=b.alphaBytes,A=b.needSMask,R=b.palette,U=b.mask,V=null;return s!==Ft.API.image_compression.NONE&&typeof xN=="function"?(V=(function(P){var D;switch(P){case Ft.API.image_compression.FAST:D=11;break;case Ft.API.image_compression.MEDIUM:D=13;break;case Ft.API.image_compression.SLOW:D=14;break;default:D=12}return D})(s),d=this.decode.FLATE_DECODE,m="/Predictor ".concat(V," /Colors ").concat(v," /BitsPerComponent ").concat(f," /Columns ").concat(i),n=t_(k,Math.ceil(i*v*f/8),v,f,s),A&&(g=t_(I,Math.ceil(i*w/8),1,w,s))):(d=void 0,m=void 0,n=k,A&&(g=I)),(this.__addimage__.isArrayBuffer(n)||this.__addimage__.isArrayBufferView(n))&&(n=this.__addimage__.arrayBufferToBinaryString(n)),(g&&this.__addimage__.isArrayBuffer(g)||this.__addimage__.isArrayBufferView(g))&&(g=this.__addimage__.arrayBufferToBinaryString(g)),{alias:t,data:n,index:e,filter:d,decodeParameters:m,transparency:U,palette:R,sMask:g,predictor:V,width:i,height:o,bitsPerComponent:f,sMaskBitsPerComponent:w,colorSpace:x}}},(function(n){n.processGIF89A=function(e,t,s,r){var a=new D0e(e),i=a.width,o=a.height,l=[];a.decodeAndBlitFrameRGBA(0,l);var c={data:l,width:i,height:o},f=new bS(100).encode(c,100);return n.processJPEG.call(this,f,t,s,r)},n.processGIF87A=n.processGIF89A})(Ft.API),kl.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var n=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(n);for(var e=0;e<n;e++){var t=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:r,green:s,blue:t,quad:a}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},kl.prototype.parseBGR=function(){this.pos=this.offset;try{var n="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[n]()}catch(t){xs.log("bit decode error:"+t)}},kl.prototype.bit1=function(){var n,e=Math.ceil(this.width/8),t=e%4;for(n=this.height-1;n>=0;n--){for(var s=this.bottom_up?n:this.height-1-n,r=0;r<e;r++)for(var a=this.datav.getUint8(this.pos++,!0),i=s*this.width*4+8*r*4,o=0;o<8&&8*r+o<this.width;o++){var l=this.palette[a>>7-o&1];this.data[i+4*o]=l.blue,this.data[i+4*o+1]=l.green,this.data[i+4*o+2]=l.red,this.data[i+4*o+3]=255}t!==0&&(this.pos+=4-t)}},kl.prototype.bit4=function(){for(var n=Math.ceil(this.width/2),e=n%4,t=this.height-1;t>=0;t--){for(var s=this.bottom_up?t:this.height-1-t,r=0;r<n;r++){var a=this.datav.getUint8(this.pos++,!0),i=s*this.width*4+2*r*4,o=a>>4,l=15&a,c=this.palette[o];if(this.data[i]=c.blue,this.data[i+1]=c.green,this.data[i+2]=c.red,this.data[i+3]=255,2*r+1>=this.width)break;c=this.palette[l],this.data[i+4]=c.blue,this.data[i+4+1]=c.green,this.data[i+4+2]=c.red,this.data[i+4+3]=255}e!==0&&(this.pos+=4-e)}},kl.prototype.bit8=function(){for(var n=this.width%4,e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,s=0;s<this.width;s++){var r=this.datav.getUint8(this.pos++,!0),a=t*this.width*4+4*s;if(r<this.palette.length){var i=this.palette[r];this.data[a]=i.red,this.data[a+1]=i.green,this.data[a+2]=i.blue,this.data[a+3]=255}else this.data[a]=255,this.data[a+1]=255,this.data[a+2]=255,this.data[a+3]=255}n!==0&&(this.pos+=4-n)}},kl.prototype.bit15=function(){for(var n=this.width%3,e=parseInt("11111",2),t=this.height-1;t>=0;t--){for(var s=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var i=(a&e)/e*255|0,o=(a>>5&e)/e*255|0,l=(a>>10&e)/e*255|0,c=a>>15?255:0,f=s*this.width*4+4*r;this.data[f]=l,this.data[f+1]=o,this.data[f+2]=i,this.data[f+3]=c}this.pos+=n}},kl.prototype.bit16=function(){for(var n=this.width%3,e=parseInt("11111",2),t=parseInt("111111",2),s=this.height-1;s>=0;s--){for(var r=this.bottom_up?s:this.height-1-s,a=0;a<this.width;a++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(i&e)/e*255|0,l=(i>>5&t)/t*255|0,c=(i>>11)/e*255|0,f=r*this.width*4+4*a;this.data[f]=c,this.data[f+1]=l,this.data[f+2]=o,this.data[f+3]=255}this.pos+=n}},kl.prototype.bit24=function(){for(var n=this.height-1;n>=0;n--){for(var e=this.bottom_up?n:this.height-1-n,t=0;t<this.width;t++){var s=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=e*this.width*4+4*t;this.data[i]=a,this.data[i+1]=r,this.data[i+2]=s,this.data[i+3]=255}this.pos+=this.width%4}},kl.prototype.bit32=function(){for(var n=this.height-1;n>=0;n--)for(var e=this.bottom_up?n:this.height-1-n,t=0;t<this.width;t++){var s=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*t;this.data[o]=a,this.data[o+1]=r,this.data[o+2]=s,this.data[o+3]=i}},kl.prototype.getData=function(){return this.data},(function(n){n.processBMP=function(e,t,s,r){var a=new kl(e,!1),i=a.width,o=a.height,l={data:a.getData(),width:i,height:o},c=new bS(100).encode(l,100);return n.processJPEG.call(this,c,t,s,r)}})(Ft.API),l_.prototype.getData=function(){return this.data},(function(n){n.processWEBP=function(e,t,s,r){var a=new l_(e),i=a.width,o=a.height,l={data:a.getData(),width:i,height:o},c=new bS(100).encode(l,100);return n.processJPEG.call(this,c,t,s,r)}})(Ft.API),Ft.API.processRGBA=function(n,e,t){for(var s=n.data,r=s.length,a=new Uint8Array(r/4*3),i=new Uint8Array(r/4),o=0,l=0,c=0;c<r;c+=4){var f=s[c],d=s[c+1],m=s[c+2],g=s[c+3];a[o++]=f,a[o++]=d,a[o++]=m,i[l++]=g}var b=this.__addimage__.arrayBufferToBinaryString(a);return{alpha:this.__addimage__.arrayBufferToBinaryString(i),data:b,index:e,alias:t,colorSpace:"DeviceRGB",bitsPerComponent:8,width:n.width,height:n.height}},Ft.API.setLanguage=function(n){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[n]!==void 0&&(this.internal.languageSettings.languageCode=n,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Np=Ft.API,V2=Np.getCharWidthsArray=function(n,e){var t,s,r=(e=e||{}).font||this.internal.getFont(),a=e.fontSize||this.internal.getFontSize(),i=e.charSpace||this.internal.getCharSpace(),o=e.widths?e.widths:r.metadata.Unicode.widths,l=o.fof?o.fof:1,c=e.kerning?e.kerning:r.metadata.Unicode.kerning,f=c.fof?c.fof:1,d=e.doKerning!==!1,m=0,g=n.length,b=0,x=o[0]||l,v=[];for(t=0;t<g;t++)s=n.charCodeAt(t),typeof r.metadata.widthOfString=="function"?v.push((r.metadata.widthOfGlyph(r.metadata.characterToGlyph(s))+i*(1e3/a)||0)/1e3):(m=d&&as(c[s])==="object"&&!isNaN(parseInt(c[s][b],10))?c[s][b]/f:0,v.push((o[s]||x)/l+m)),b=s;return v},J4=Np.getStringUnitWidth=function(n,e){var t=(e=e||{}).fontSize||this.internal.getFontSize(),s=e.font||this.internal.getFont(),r=e.charSpace||this.internal.getCharSpace();return Np.processArabic&&(n=Np.processArabic(n)),typeof s.metadata.widthOfString=="function"?s.metadata.widthOfString(n,t,r)/t:V2.apply(this,arguments).reduce(function(a,i){return a+i},0)},Q4=function(n,e,t,s){for(var r=[],a=0,i=n.length,o=0;a!==i&&o+e[a]<t;)o+=e[a],a++;r.push(n.slice(0,a));var l=a;for(o=0;a!==i;)o+e[a]>s&&(r.push(n.slice(l,a)),o=0,l=a),o+=e[a],a++;return l!==a&&r.push(n.slice(l,a)),r},e_=function(n,e,t){t||(t={});var s,r,a,i,o,l,c,f=[],d=[f],m=t.textIndent||0,g=0,b=0,x=n.split(" "),v=V2.apply(this,[" ",t])[0];if(l=t.lineIndent===-1?x[0].length+2:t.lineIndent||0){var w=Array(l).join(" "),k=[];x.map(function(A){(A=A.split(/\s*\n/)).length>1?k=k.concat(A.map(function(R,U){return(U&&R.length?`
`:"")+R})):k.push(A[0])}),x=k,l=J4.apply(this,[w,t])}for(a=0,i=x.length;a<i;a++){var I=0;if(s=x[a],l&&s[0]==`
`&&(s=s.substr(1),I=1),m+g+(b=(r=V2.apply(this,[s,t])).reduce(function(A,R){return A+R},0))>e||I){if(b>e){for(o=Q4.apply(this,[s,r,e-(m+g),e]),f.push(o.shift()),f=[o.pop()];o.length;)d.push([o.shift()]);b=r.slice(s.length-(f[0]?f[0].length:0)).reduce(function(A,R){return A+R},0)}else f=[s];d.push(f),m=b+l,g=v}else f.push(s),m+=g+b,g=v}return c=l?function(A,R){return(R?w:"")+A.join(" ")}:function(A){return A.join(" ")},d.map(c)},Np.splitTextToSize=function(n,e,t){var s,r=(t=t||{}).fontSize||this.internal.getFontSize(),a=(function(f){if(f.widths&&f.kerning)return{widths:f.widths,kerning:f.kerning};var d=this.internal.getFont(f.fontName,f.fontStyle),m="Unicode";return d.metadata[m]?{widths:d.metadata[m].widths||{0:1},kerning:d.metadata[m].kerning||{}}:{font:d.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,t);s=Array.isArray(n)?n:String(n).split(/\r?\n/);var i=1*this.internal.scaleFactor*e/r;a.textIndent=t.textIndent?1*t.textIndent*this.internal.scaleFactor/r:0,a.lineIndent=t.lineIndent;var o,l,c=[];for(o=0,l=s.length;o<l;o++)c=c.concat(e_.apply(this,[s[o],i,a]));return c},(function(n){n.__fontmetrics__=n.__fontmetrics__||{};for(var e="0123456789abcdef",t="klmnopqrstuvwxyz",s={},r={},a=0;a<16;a++)s[t[a]]=e[a],r[e[a]]=t[a];var i=function(m){return"0x"+parseInt(m,10).toString(16)},o=n.__fontmetrics__.compress=function(m){var g,b,x,v,w=["{"];for(var k in m){if(g=m[k],isNaN(parseInt(k,10))?b="'"+k+"'":(k=parseInt(k,10),b=(b=i(k).slice(2)).slice(0,-1)+r[b.slice(-1)]),typeof g=="number")g<0?(x=i(g).slice(3),v="-"):(x=i(g).slice(2),v=""),x=v+x.slice(0,-1)+r[x.slice(-1)];else{if(as(g)!=="object")throw new Error("Don't know what to do with value type "+as(g)+".");x=o(g)}w.push(b+x)}return w.push("}"),w.join("")},l=n.__fontmetrics__.uncompress=function(m){if(typeof m!="string")throw new Error("Invalid argument passed to uncompress.");for(var g,b,x,v,w={},k=1,I=w,A=[],R="",U="",V=m.length-1,P=1;P<V;P+=1)(v=m[P])=="'"?g?(x=g.join(""),g=void 0):g=[]:g?g.push(v):v=="{"?(A.push([I,x]),I={},x=void 0):v=="}"?((b=A.pop())[0][b[1]]=I,x=void 0,I=b[0]):v=="-"?k=-1:x===void 0?s.hasOwnProperty(v)?(R+=s[v],x=parseInt(R,16)*k,k=1,R=""):R+=v:s.hasOwnProperty(v)?(U+=s[v],I[x]=parseInt(U,16)*k,k=1,x=void 0,U=""):U+=v;return w},c={codePages:["WinAnsiEncoding"],WinAnsiEncoding:l("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},f={Unicode:{Courier:c,"Courier-Bold":c,"Courier-BoldOblique":c,"Courier-Oblique":c,Helvetica:c,"Helvetica-Bold":c,"Helvetica-BoldOblique":c,"Helvetica-Oblique":c,"Times-Roman":c,"Times-Bold":c,"Times-BoldItalic":c,"Times-Italic":c}},d={Unicode:{"Courier-Oblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":l("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":l("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:l("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:l("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":l("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":l("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};n.events.push(["addFont",function(m){var g=m.font,b=d.Unicode[g.postScriptName];b&&(g.metadata.Unicode={},g.metadata.Unicode.widths=b.widths,g.metadata.Unicode.kerning=b.kerning);var x=f.Unicode[g.postScriptName];x&&(g.metadata.Unicode.encoding=x,g.encoding=x.codePages[0])}])})(Ft.API),(function(n){var e=function(t){for(var s=t.length,r=new Uint8Array(s),a=0;a<s;a++)r[a]=t.charCodeAt(a);return r};n.API.events.push(["addFont",function(t){var s=void 0,r=t.font,a=t.instance;if(!r.isStandardFont){if(a===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+r.postScriptName+"').");if(typeof(s=a.existsFileInVFS(r.postScriptName)===!1?a.loadFile(r.postScriptName):a.getFileFromVFS(r.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+r.postScriptName+"').");(function(i,o){o=/^\x00\x01\x00\x00/.test(o)?e(o):e(sb(o)),i.metadata=n.API.TTFFont.open(o),i.metadata.Unicode=i.metadata.Unicode||{encoding:{},kerning:{},widths:[]},i.metadata.glyIdsUsed=[0]})(r,s)}}])})(Ft),Ft.API.addSvgAsImage=function(n,e,t,s,r,a,i,o){if(isNaN(e)||isNaN(t))throw xs.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(s)||isNaN(r))throw xs.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var l=document.createElement("canvas");l.width=s,l.height=r;var c=l.getContext("2d");c.fillStyle="#fff",c.fillRect(0,0,l.width,l.height);var f={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},d=this;return(an.canvg?Promise.resolve(an.canvg):Z5(()=>import("./index.es-BR0xIv0G.js"),[])).catch(function(m){return Promise.reject(new Error("Could not load canvg: "+m))}).then(function(m){return m.default?m.default:m}).then(function(m){return m.fromString(c,n,f)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(m){return m.render(f)}).then(function(){d.addImage(l.toDataURL("image/jpeg",1),e,t,s,r,i,o)})},Ft.API.putTotalPages=function(n){var e,t=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(n,"g"),t=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(n,this.internal.getFont()),"g"),t=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var s=1;s<=this.internal.getNumberOfPages();s++)for(var r=0;r<this.internal.pages[s].length;r++)this.internal.pages[s][r]=this.internal.pages[s][r].replace(e,t);return this},Ft.API.viewerPreferences=function(n,e){var t;n=n||{},e=e||!1;var s,r,a,i={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(i),l=[],c=0,f=0,d=0;function m(b,x){var v,w=!1;for(v=0;v<b.length;v+=1)b[v]===x&&(w=!0);return w}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(i)),this.internal.viewerpreferences.isSubscribed=!1),t=this.internal.viewerpreferences.configuration,n==="reset"||e===!0){var g=o.length;for(d=0;d<g;d+=1)t[o[d]].value=t[o[d]].defaultValue,t[o[d]].explicitSet=!1}if(as(n)==="object"){for(r in n)if(a=n[r],m(o,r)&&a!==void 0){if(t[r].type==="boolean"&&typeof a=="boolean")t[r].value=a;else if(t[r].type==="name"&&m(t[r].valueSet,a))t[r].value=a;else if(t[r].type==="integer"&&Number.isInteger(a))t[r].value=a;else if(t[r].type==="array"){for(c=0;c<a.length;c+=1)if(s=!0,a[c].length===1&&typeof a[c][0]=="number")l.push(String(a[c]-1));else if(a[c].length>1){for(f=0;f<a[c].length;f+=1)typeof a[c][f]!="number"&&(s=!1);s===!0&&l.push([a[c][0]-1,a[c][1]-1].join(" "))}t[r].value="["+l.join(" ")+"]"}else t[r].value=t[r].defaultValue;t[r].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var b,x=[];for(b in t)t[b].explicitSet===!0&&(t[b].type==="name"?x.push("/"+b+" /"+t[b].value):x.push("/"+b+" "+t[b].value));x.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+x.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=t,this},(function(n){var e=function(){var s='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',r=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),a=unescape(encodeURIComponent(s)),i=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),l=unescape(encodeURIComponent("</x:xmpmeta>")),c=a.length+i.length+o.length+r.length+l.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+c+" >>"),this.internal.write("stream"),this.internal.write(r+a+i+o+l),this.internal.write("endstream"),this.internal.write("endobj")},t=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};n.addMetadata=function(s,r){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:s,namespaceuri:r||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",t),this.internal.events.subscribe("postPutResources",e)),this}})(Ft.API),(function(n){var e=n.API,t=e.pdfEscape16=function(a,i){for(var o,l=i.metadata.Unicode.widths,c=["","0","00","000","0000"],f=[""],d=0,m=a.length;d<m;++d){if(o=i.metadata.characterToGlyph(a.charCodeAt(d)),i.metadata.glyIdsUsed.push(o),i.metadata.toUnicode[o]=a.charCodeAt(d),l.indexOf(o)==-1&&(l.push(o),l.push([parseInt(i.metadata.widthOfGlyph(o),10)])),o=="0")return f.join("");o=o.toString(16),f.push(c[4-o.length],o)}return f.join("")},s=function(a){var i,o,l,c,f,d,m;for(f=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,l=[],d=0,m=(o=Object.keys(a).sort(function(g,b){return g-b})).length;d<m;d++)i=o[d],l.length>=100&&(f+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar`,l=[]),a[i]!==void 0&&a[i]!==null&&typeof a[i].toString=="function"&&(c=("0000"+a[i].toString(16)).slice(-4),i=("0000"+(+i).toString(16)).slice(-4),l.push("<"+i+"><"+c+">"));return l.length&&(f+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar
`),f+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(a){(function(i){var o=i.font,l=i.out,c=i.newObject,f=i.putStream;if(o.metadata instanceof n.API.TTFFont&&o.encoding==="Identity-H"){for(var d=o.metadata.Unicode.widths,m=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),g="",b=0;b<m.length;b++)g+=String.fromCharCode(m[b]);var x=c();f({data:g,addLength1:!0,objectId:x}),l("endobj");var v=c();f({data:s(o.metadata.toUnicode),addLength1:!0,objectId:v}),l("endobj");var w=c();l("<<"),l("/Type /FontDescriptor"),l("/FontName /"+Ip(o.fontName)),l("/FontFile2 "+x+" 0 R"),l("/FontBBox "+n.API.PDFObject.convert(o.metadata.bbox)),l("/Flags "+o.metadata.flags),l("/StemV "+o.metadata.stemV),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l(">>"),l("endobj");var k=c();l("<<"),l("/Type /Font"),l("/BaseFont /"+Ip(o.fontName)),l("/FontDescriptor "+w+" 0 R"),l("/W "+n.API.PDFObject.convert(d)),l("/CIDToGIDMap /Identity"),l("/DW 1000"),l("/Subtype /CIDFontType2"),l("/CIDSystemInfo"),l("<<"),l("/Supplement 0"),l("/Registry (Adobe)"),l("/Ordering ("+o.encoding+")"),l(">>"),l(">>"),l("endobj"),o.objectNumber=c(),l("<<"),l("/Type /Font"),l("/Subtype /Type0"),l("/ToUnicode "+v+" 0 R"),l("/BaseFont /"+Ip(o.fontName)),l("/Encoding /"+o.encoding),l("/DescendantFonts ["+k+" 0 R]"),l(">>"),l("endobj"),o.isAlreadyPutted=!0}})(a)}]),e.events.push(["putFont",function(a){(function(i){var o=i.font,l=i.out,c=i.newObject,f=i.putStream;if(o.metadata instanceof n.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var d=o.metadata.rawData,m="",g=0;g<d.length;g++)m+=String.fromCharCode(d[g]);var b=c();f({data:m,addLength1:!0,objectId:b}),l("endobj");var x=c();f({data:s(o.metadata.toUnicode),addLength1:!0,objectId:x}),l("endobj");var v=c();l("<<"),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l("/StemV "+o.metadata.stemV),l("/Type /FontDescriptor"),l("/FontFile2 "+b+" 0 R"),l("/Flags 96"),l("/FontBBox "+n.API.PDFObject.convert(o.metadata.bbox)),l("/FontName /"+Ip(o.fontName)),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l(">>"),l("endobj"),o.objectNumber=c();for(var w=0;w<o.metadata.hmtx.widths.length;w++)o.metadata.hmtx.widths[w]=parseInt(o.metadata.hmtx.widths[w]*(1e3/o.metadata.head.unitsPerEm));l("<</Subtype/TrueType/Type/Font/ToUnicode "+x+" 0 R/BaseFont/"+Ip(o.fontName)+"/FontDescriptor "+v+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+n.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),l("endobj"),o.isAlreadyPutted=!0}})(a)}]);var r=function(a){var i,o=a.text||"",l=a.x,c=a.y,f=a.options||{},d=a.mutex||{},m=d.pdfEscape,g=d.activeFontKey,b=d.fonts,x=g,v="",w=0,k="",I=b[x].encoding;if(b[x].encoding!=="Identity-H")return{text:o,x:l,y:c,options:f,mutex:d};for(k=o,x=g,Array.isArray(o)&&(k=o[0]),w=0;w<k.length;w+=1)b[x].metadata.hasOwnProperty("cmap")&&(i=b[x].metadata.cmap.unicode.codeMap[k[w].charCodeAt(0)]),i||k[w].charCodeAt(0)<256&&b[x].metadata.hasOwnProperty("Unicode")?v+=k[w]:v+="";var A="";return parseInt(x.slice(1))<14||I==="WinAnsiEncoding"?A=m(v,x).split("").map(function(R){return R.charCodeAt(0).toString(16)}).join(""):I==="Identity-H"&&(A=t(v,b[x])),d.isHex=!0,{text:A,x:l,y:c,options:f,mutex:d}};e.events.push(["postProcessText",function(a){var i=a.text||"",o=[],l={text:i,x:a.x,y:a.y,options:a.options,mutex:a.mutex};if(Array.isArray(i)){var c=0;for(c=0;c<i.length;c+=1)Array.isArray(i[c])&&i[c].length===3?o.push([r(Object.assign({},l,{text:i[c][0]})).text,i[c][1],i[c][2]]):o.push(r(Object.assign({},l,{text:i[c]})).text);a.text=o}else a.text=r(Object.assign({},l,{text:i})).text}])})(Ft),(function(n){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};n.existsFileInVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0},n.addFileToVFS=function(t,s){return e.call(this),this.internal.vFS[t]=s,this},n.getFileFromVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0?this.internal.vFS[t]:null}})(Ft.API),(function(n){n.__bidiEngine__=n.prototype.__bidiEngine__=function(s){var r,a,i,o,l,c,f,d=e,m=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],g=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],b={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},x={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},v=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],w=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),k=!1,I=0;this.__bidiEngine__={};var A=function(E){var M=E.charCodeAt(),K=M>>8,X=x[K];return X!==void 0?d[256*X+(255&M)]:K===252||K===253?"AL":w.test(K)?"L":K===8?"R":"N"},R=function(E){for(var M,K=0;K<E.length;K++){if((M=A(E.charAt(K)))==="L")return!1;if(M==="R")return!0}return!1},U=function(E,M,K,X){var ae,W,se,ee,ce=M[X];switch(ce){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":k=!1;break;case"N":case"AN":break;case"EN":k&&(ce="AN");break;case"AL":k=!0,ce="R";break;case"WS":case"BN":ce="N";break;case"CS":X<1||X+1>=M.length||(ae=K[X-1])!=="EN"&&ae!=="AN"||(W=M[X+1])!=="EN"&&W!=="AN"?ce="N":k&&(W="AN"),ce=W===ae?W:"N";break;case"ES":ce=(ae=X>0?K[X-1]:"B")==="EN"&&X+1<M.length&&M[X+1]==="EN"?"EN":"N";break;case"ET":if(X>0&&K[X-1]==="EN"){ce="EN";break}if(k){ce="N";break}for(se=X+1,ee=M.length;se<ee&&M[se]==="ET";)se++;ce=se<ee&&M[se]==="EN"?"EN":"N";break;case"NSM":if(i&&!o){for(ee=M.length,se=X+1;se<ee&&M[se]==="NSM";)se++;if(se<ee){var ye=E[X],G=ye>=1425&&ye<=2303||ye===64286;if(ae=M[se],G&&(ae==="R"||ae==="AL")){ce="R";break}}}ce=X<1||(ae=M[X-1])==="B"?"N":K[X-1];break;case"B":k=!1,r=!0,ce=I;break;case"S":a=!0,ce="N"}return ce},V=function(E,M,K){var X=E.split("");return K&&P(X,K,{hiLevel:I}),X.reverse(),M&&M.reverse(),X.join("")},P=function(E,M,K){var X,ae,W,se,ee,ce=-1,ye=E.length,G=0,O=[],j=I?g:m,Y=[];for(k=!1,r=!1,a=!1,ae=0;ae<ye;ae++)Y[ae]=A(E[ae]);for(W=0;W<ye;W++){if(ee=G,O[W]=U(E,Y,O,W),X=240&(G=j[ee][b[O[W]]]),G&=15,M[W]=se=j[G][5],X>0)if(X===16){for(ae=ce;ae<W;ae++)M[ae]=1;ce=-1}else ce=-1;if(j[G][6])ce===-1&&(ce=W);else if(ce>-1){for(ae=ce;ae<W;ae++)M[ae]=se;ce=-1}Y[W]==="B"&&(M[W]=0),K.hiLevel|=se}a&&(function(ie,ue,pe){for(var Ce=0;Ce<pe;Ce++)if(ie[Ce]==="S"){ue[Ce]=I;for(var Ne=Ce-1;Ne>=0&&ie[Ne]==="WS";Ne--)ue[Ne]=I}})(Y,M,ye)},D=function(E,M,K,X,ae){if(!(ae.hiLevel<E)){if(E===1&&I===1&&!r)return M.reverse(),void(K&&K.reverse());for(var W,se,ee,ce,ye=M.length,G=0;G<ye;){if(X[G]>=E){for(ee=G+1;ee<ye&&X[ee]>=E;)ee++;for(ce=G,se=ee-1;ce<se;ce++,se--)W=M[ce],M[ce]=M[se],M[se]=W,K&&(W=K[ce],K[ce]=K[se],K[se]=W);G=ee}G++}}},B=function(E,M,K){var X=E.split(""),ae={hiLevel:I};return K||(K=[]),P(X,K,ae),(function(W,se,ee){if(ee.hiLevel!==0&&f)for(var ce,ye=0;ye<W.length;ye++)se[ye]===1&&(ce=v.indexOf(W[ye]))>=0&&(W[ye]=v[ce+1])})(X,K,ae),D(2,X,M,K,ae),D(1,X,M,K,ae),X.join("")};return this.__bidiEngine__.doBidiReorder=function(E,M,K){if((function(ae,W){if(W)for(var se=0;se<ae.length;se++)W[se]=se;o===void 0&&(o=R(ae)),c===void 0&&(c=R(ae))})(E,M),i||!l||c)if(i&&l&&o^c)I=o?1:0,E=V(E,M,K);else if(!i&&l&&c)I=o?1:0,E=B(E,M,K),E=V(E,M);else if(!i||o||l||c){if(i&&!l&&o^c)E=V(E,M),o?(I=0,E=B(E,M,K)):(I=1,E=B(E,M,K),E=V(E,M));else if(i&&o&&!l&&c)I=1,E=B(E,M,K),E=V(E,M);else if(!i&&!l&&o^c){var X=f;o?(I=1,E=B(E,M,K),I=0,f=!1,E=B(E,M,K),f=X):(I=0,E=B(E,M,K),E=V(E,M),I=1,f=!1,E=B(E,M,K),f=X,E=V(E,M))}}else I=0,E=B(E,M,K);else I=o?1:0,E=B(E,M,K);return E},this.__bidiEngine__.setOptions=function(E){E&&(i=E.isInputVisual,l=E.isOutputVisual,o=E.isInputRtl,c=E.isOutputRtl,f=E.isSymmetricSwapping)},this.__bidiEngine__.setOptions(s),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],t=new n.__bidiEngine__({isInputVisual:!0});n.API.events.push(["postProcessText",function(s){var r=s.text;s.x,s.y;var a=s.options||{};s.mutex,a.lang;var i=[];if(a.isInputVisual=typeof a.isInputVisual!="boolean"||a.isInputVisual,t.setOptions(a),Object.prototype.toString.call(r)==="[object Array]"){var o=0;for(i=[],o=0;o<r.length;o+=1)Object.prototype.toString.call(r[o])==="[object Array]"?i.push([t.doBidiReorder(r[o][0]),r[o][1],r[o][2]]):i.push([t.doBidiReorder(r[o])]);s.text=i}else s.text=t.doBidiReorder(r);t.setOptions({isInputVisual:!0})}])})(Ft),Ft.API.TTFFont=(function(){function n(e){var t;if(this.rawData=e,t=this.contents=new Mh(e),this.contents.pos=4,t.readString(4)==="ttcf")throw new Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new K0e(this),this.registerTTF()}return n.open=function(e){return new n(e)},n.prototype.parse=function(){return this.directory=new O0e(this.contents),this.head=new F0e(this),this.name=new U0e(this),this.cmap=new N8(this),this.toUnicode={},this.hhea=new M0e(this),this.maxp=new V0e(this),this.hmtx=new j0e(this),this.post=new P0e(this),this.os2=new z0e(this),this.loca=new H0e(this),this.glyf=new W0e(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},n.prototype.registerTTF=function(){var e,t,s,r,a;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var i,o,l,c;for(c=[],i=0,o=(l=this.bbox).length;i<o;i++)e=l[i],c.push(Math.round(e*this.scaleFactor));return c}).call(this),this.stemV=0,this.post.exists?(s=255&(r=this.post.italic_angle),32768&(t=r>>16)&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+s)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(a=this.familyClass)===1||a===2||a===3||a===4||a===5||a===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},n.prototype.characterToGlyph=function(e){var t;return((t=this.cmap.unicode)!=null?t.codeMap[e]:void 0)||0},n.prototype.widthOfGlyph=function(e){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*t},n.prototype.widthOfString=function(e,t,s){var r,a,i,o;for(i=0,a=0,o=(e=""+e).length;0<=o?a<o:a>o;a=0<=o?++a:--a)r=e.charCodeAt(a),i+=this.widthOfGlyph(this.characterToGlyph(r))+s*(1e3/t)||0;return i*(t/1e3)},n.prototype.lineHeight=function(e,t){var s;return t==null&&(t=!1),s=t?this.lineGap:0,(this.ascender+s-this.decender)/1e3*e},n})();var jl,Mh=(function(){function n(e){this.data=e??[],this.pos=0,this.length=this.data.length}return n.prototype.readByte=function(){return this.data[this.pos++]},n.prototype.writeByte=function(e){return this.data[this.pos++]=e},n.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},n.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},n.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},n.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},n.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},n.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},n.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},n.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},n.prototype.readString=function(e){var t,s;for(s=[],t=0;0<=e?t<e:t>e;t=0<=e?++t:--t)s[t]=String.fromCharCode(this.readByte());return s.join("")},n.prototype.writeString=function(e){var t,s,r;for(r=[],t=0,s=e.length;0<=s?t<s:t>s;t=0<=s?++t:--t)r.push(this.writeByte(e.charCodeAt(t)));return r},n.prototype.readShort=function(){return this.readInt16()},n.prototype.writeShort=function(e){return this.writeInt16(e)},n.prototype.readLongLong=function(){var e,t,s,r,a,i,o,l;return e=this.readByte(),t=this.readByte(),s=this.readByte(),r=this.readByte(),a=this.readByte(),i=this.readByte(),o=this.readByte(),l=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^t)+1099511627776*(255^s)+4294967296*(255^r)+16777216*(255^a)+65536*(255^i)+256*(255^o)+(255^l)+1):72057594037927940*e+281474976710656*t+1099511627776*s+4294967296*r+16777216*a+65536*i+256*o+l},n.prototype.writeLongLong=function(e){var t,s;return t=Math.floor(e/4294967296),s=4294967295&e,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(s>>24&255),this.writeByte(s>>16&255),this.writeByte(s>>8&255),this.writeByte(255&s)},n.prototype.readInt=function(){return this.readInt32()},n.prototype.writeInt=function(e){return this.writeInt32(e)},n.prototype.read=function(e){var t,s;for(t=[],s=0;0<=e?s<e:s>e;s=0<=e?++s:--s)t.push(this.readByte());return t},n.prototype.write=function(e){var t,s,r,a;for(a=[],s=0,r=e.length;s<r;s++)t=e[s],a.push(this.writeByte(t));return a},n})(),O0e=(function(){var n;function e(t){var s,r,a;for(this.scalarType=t.readInt(),this.tableCount=t.readShort(),this.searchRange=t.readShort(),this.entrySelector=t.readShort(),this.rangeShift=t.readShort(),this.tables={},r=0,a=this.tableCount;0<=a?r<a:r>a;r=0<=a?++r:--r)s={tag:t.readString(4),checksum:t.readInt(),offset:t.readInt(),length:t.readInt()},this.tables[s.tag]=s}return e.prototype.encode=function(t){var s,r,a,i,o,l,c,f,d,m,g,b,x;for(x in g=Object.keys(t).length,l=Math.log(2),d=16*Math.floor(Math.log(g)/l),i=Math.floor(d/l),f=16*g-d,(r=new Mh).writeInt(this.scalarType),r.writeShort(g),r.writeShort(d),r.writeShort(i),r.writeShort(f),a=16*g,c=r.pos+a,o=null,b=[],t)for(m=t[x],r.writeString(x),r.writeInt(n(m)),r.writeInt(c),r.writeInt(m.length),b=b.concat(m),x==="head"&&(o=c),c+=m.length;c%4;)b.push(0),c++;return r.write(b),s=2981146554-n(r.data),r.pos=o+8,r.writeUInt32(s),r.data},n=function(t){var s,r,a,i;for(t=k8.call(t);t.length%4;)t.push(0);for(a=new Mh(t),r=0,s=0,i=t.length;s<i;s=s+=4)r+=a.readUInt32();return 4294967295&r},e})(),L0e={}.hasOwnProperty,Ru=function(n,e){for(var t in e)L0e.call(e,t)&&(n[t]=e[t]);function s(){this.constructor=n}return s.prototype=e.prototype,n.prototype=new s,n.__super__=e.prototype,n};jl=(function(){function n(e){var t;this.file=e,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return n.prototype.parse=function(){},n.prototype.encode=function(){},n.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},n})();var F0e=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Ru(n,jl),n.prototype.tag="head",n.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},n.prototype.encode=function(e){var t;return(t=new Mh).writeInt(this.version),t.writeInt(this.revision),t.writeInt(this.checkSumAdjustment),t.writeInt(this.magicNumber),t.writeShort(this.flags),t.writeShort(this.unitsPerEm),t.writeLongLong(this.created),t.writeLongLong(this.modified),t.writeShort(this.xMin),t.writeShort(this.yMin),t.writeShort(this.xMax),t.writeShort(this.yMax),t.writeShort(this.macStyle),t.writeShort(this.lowestRecPPEM),t.writeShort(this.fontDirectionHint),t.writeShort(e),t.writeShort(this.glyphDataFormat),t.data},n})(),u_=(function(){function n(e,t){var s,r,a,i,o,l,c,f,d,m,g,b,x,v,w,k,I;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=t+e.readInt(),d=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(l=0;l<256;++l)this.codeMap[l]=e.readByte();break;case 4:for(g=e.readUInt16(),m=g/2,e.pos+=6,a=(function(){var A,R;for(R=[],l=A=0;0<=m?A<m:A>m;l=0<=m?++A:--A)R.push(e.readUInt16());return R})(),e.pos+=2,x=(function(){var A,R;for(R=[],l=A=0;0<=m?A<m:A>m;l=0<=m?++A:--A)R.push(e.readUInt16());return R})(),c=(function(){var A,R;for(R=[],l=A=0;0<=m?A<m:A>m;l=0<=m?++A:--A)R.push(e.readUInt16());return R})(),f=(function(){var A,R;for(R=[],l=A=0;0<=m?A<m:A>m;l=0<=m?++A:--A)R.push(e.readUInt16());return R})(),r=(this.length-e.pos+this.offset)/2,o=(function(){var A,R;for(R=[],l=A=0;0<=r?A<r:A>r;l=0<=r?++A:--A)R.push(e.readUInt16());return R})(),l=w=0,I=a.length;w<I;l=++w)for(v=a[l],s=k=b=x[l];b<=v?k<=v:k>=v;s=b<=v?++k:--k)f[l]===0?i=s+c[l]:(i=o[f[l]/2+(s-b)-(m-l)]||0)!==0&&(i+=c[l]),this.codeMap[s]=65535&i}e.pos=d}return n.encode=function(e,t){var s,r,a,i,o,l,c,f,d,m,g,b,x,v,w,k,I,A,R,U,V,P,D,B,E,M,K,X,ae,W,se,ee,ce,ye,G,O,j,Y,ie,ue,pe,Ce,Ne,Le,Ve,rt;switch(X=new Mh,i=Object.keys(e).sort(function(at,ot){return at-ot}),t){case"macroman":for(x=0,v=(function(){var at=[];for(b=0;b<256;++b)at.push(0);return at})(),k={0:0},a={},ae=0,ce=i.length;ae<ce;ae++)k[Ne=e[r=i[ae]]]==null&&(k[Ne]=++x),a[r]={old:e[r],new:k[e[r]]},v[r]=k[e[r]];return X.writeUInt16(1),X.writeUInt16(0),X.writeUInt32(12),X.writeUInt16(0),X.writeUInt16(262),X.writeUInt16(0),X.write(v),{charMap:a,subtable:X.data,maxGlyphID:x+1};case"unicode":for(M=[],d=[],I=0,k={},s={},w=c=null,W=0,ye=i.length;W<ye;W++)k[R=e[r=i[W]]]==null&&(k[R]=++I),s[r]={old:R,new:k[R]},o=k[R]-r,w!=null&&o===c||(w&&d.push(w),M.push(r),c=o),w=r;for(w&&d.push(w),d.push(65535),M.push(65535),B=2*(D=M.length),P=2*Math.pow(Math.log(D)/Math.LN2,2),m=Math.log(P/2)/Math.LN2,V=2*D-P,l=[],U=[],g=[],b=se=0,G=M.length;se<G;b=++se){if(E=M[b],f=d[b],E===65535){l.push(0),U.push(0);break}if(E-(K=s[E].new)>=32768)for(l.push(0),U.push(2*(g.length+D-b)),r=ee=E;E<=f?ee<=f:ee>=f;r=E<=f?++ee:--ee)g.push(s[r].new);else l.push(K-E),U.push(0)}for(X.writeUInt16(3),X.writeUInt16(1),X.writeUInt32(12),X.writeUInt16(4),X.writeUInt16(16+8*D+2*g.length),X.writeUInt16(0),X.writeUInt16(B),X.writeUInt16(P),X.writeUInt16(m),X.writeUInt16(V),pe=0,O=d.length;pe<O;pe++)r=d[pe],X.writeUInt16(r);for(X.writeUInt16(0),Ce=0,j=M.length;Ce<j;Ce++)r=M[Ce],X.writeUInt16(r);for(Le=0,Y=l.length;Le<Y;Le++)o=l[Le],X.writeUInt16(o);for(Ve=0,ie=U.length;Ve<ie;Ve++)A=U[Ve],X.writeUInt16(A);for(rt=0,ue=g.length;rt<ue;rt++)x=g[rt],X.writeUInt16(x);return{charMap:s,subtable:X.data,maxGlyphID:I+1}}},n})(),N8=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Ru(n,jl),n.prototype.tag="cmap",n.prototype.parse=function(e){var t,s,r;for(e.pos=this.offset,this.version=e.readUInt16(),r=e.readUInt16(),this.tables=[],this.unicode=null,s=0;0<=r?s<r:s>r;s=0<=r?++s:--s)t=new u_(e,this.offset),this.tables.push(t),t.isUnicode&&this.unicode==null&&(this.unicode=t);return!0},n.encode=function(e,t){var s,r;return t==null&&(t="macroman"),s=u_.encode(e,t),(r=new Mh).writeUInt16(0),r.writeUInt16(1),s.table=r.data.concat(s.subtable),s},n})(),M0e=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Ru(n,jl),n.prototype.tag="hhea",n.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},n})(),z0e=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Ru(n,jl),n.prototype.tag="OS/2",n.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=(function(){var t,s;for(s=[],t=0;t<10;++t)s.push(e.readByte());return s})(),this.charRange=(function(){var t,s;for(s=[],t=0;t<4;++t)s.push(e.readInt());return s})(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=(function(){var t,s;for(s=[],t=0;t<2;t=++t)s.push(e.readInt());return s})(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},n})(),P0e=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Ru(n,jl),n.prototype.tag="post",n.prototype.parse=function(e){var t,s,r;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var a;for(s=e.readUInt16(),this.glyphNameIndex=[],a=0;0<=s?a<s:a>s;a=0<=s?++a:--a)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],r=[];e.pos<this.offset+this.length;)t=e.readByte(),r.push(this.names.push(e.readString(t)));return r;case 151552:return s=e.readUInt16(),this.offsets=e.read(s);case 262144:return this.map=(function(){var i,o,l;for(l=[],a=i=0,o=this.file.maxp.numGlyphs;0<=o?i<o:i>o;a=0<=o?++i:--i)l.push(e.readUInt32());return l}).call(this)}},n})(),B0e=function(n,e){this.raw=n,this.length=n.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},U0e=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Ru(n,jl),n.prototype.tag="name",n.prototype.parse=function(e){var t,s,r,a,i,o,l,c,f,d,m;for(e.pos=this.offset,e.readShort(),t=e.readShort(),o=e.readShort(),s=[],a=0;0<=t?a<t:a>t;a=0<=t?++a:--a)s.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+o+e.readShort()});for(l={},a=f=0,d=s.length;f<d;a=++f)r=s[a],e.pos=r.offset,c=e.readString(r.length),i=new B0e(c,r),l[m=r.nameID]==null&&(l[m]=[]),l[r.nameID].push(i);this.strings=l,this.copyright=l[0],this.fontFamily=l[1],this.fontSubfamily=l[2],this.uniqueSubfamily=l[3],this.fontName=l[4],this.version=l[5];try{this.postscriptName=l[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=l[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=l[7],this.manufacturer=l[8],this.designer=l[9],this.description=l[10],this.vendorUrl=l[11],this.designerUrl=l[12],this.license=l[13],this.licenseUrl=l[14],this.preferredFamily=l[15],this.preferredSubfamily=l[17],this.compatibleFull=l[18],this.sampleText=l[19]},n})(),V0e=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Ru(n,jl),n.prototype.tag="maxp",n.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},n})(),j0e=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Ru(n,jl),n.prototype.tag="hmtx",n.prototype.parse=function(e){var t,s,r,a,i,o,l;for(e.pos=this.offset,this.metrics=[],t=0,o=this.file.hhea.numberOfMetrics;0<=o?t<o:t>o;t=0<=o?++t:--t)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(r=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var c,f;for(f=[],t=c=0;0<=r?c<r:c>r;t=0<=r?++c:--c)f.push(e.readInt16());return f})(),this.widths=(function(){var c,f,d,m;for(m=[],c=0,f=(d=this.metrics).length;c<f;c++)a=d[c],m.push(a.advance);return m}).call(this),s=this.widths[this.widths.length-1],l=[],t=i=0;0<=r?i<r:i>r;t=0<=r?++i:--i)l.push(this.widths.push(s));return l},n.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},n})(),k8=[].slice,W0e=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Ru(n,jl),n.prototype.tag="glyf",n.prototype.parse=function(){return this.cache={}},n.prototype.glyphFor=function(e){var t,s,r,a,i,o,l,c,f,d;return e in this.cache?this.cache[e]:(a=this.file.loca,t=this.file.contents,s=a.indexOf(e),(r=a.lengthOf(e))===0?this.cache[e]=null:(t.pos=this.offset+s,i=(o=new Mh(t.read(r))).readShort(),c=o.readShort(),d=o.readShort(),l=o.readShort(),f=o.readShort(),this.cache[e]=i===-1?new q0e(o,c,d,l,f):new G0e(o,i,c,d,l,f),this.cache[e]))},n.prototype.encode=function(e,t,s){var r,a,i,o,l;for(i=[],a=[],o=0,l=t.length;o<l;o++)r=e[t[o]],a.push(i.length),r&&(i=i.concat(r.encode(s)));return a.push(i.length),{table:i,offsets:a}},n})(),G0e=(function(){function n(e,t,s,r,a,i){this.raw=e,this.numberOfContours=t,this.xMin=s,this.yMin=r,this.xMax=a,this.yMax=i,this.compound=!1}return n.prototype.encode=function(){return this.raw.data},n})(),q0e=(function(){function n(e,t,s,r,a){var i,o;for(this.raw=e,this.xMin=t,this.yMin=s,this.xMax=r,this.yMax=a,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],i=this.raw;o=i.readShort(),this.glyphOffsets.push(i.pos),this.glyphIDs.push(i.readUInt16()),32&o;)i.pos+=1&o?4:2,128&o?i.pos+=8:64&o?i.pos+=4:8&o&&(i.pos+=2)}return n.prototype.encode=function(){var e,t,s;for(t=new Mh(k8.call(this.raw.data)),e=0,s=this.glyphIDs.length;e<s;++e)t.pos=this.glyphOffsets[e];return t.data},n})(),H0e=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Ru(n,jl),n.prototype.tag="loca",n.prototype.parse=function(e){var t,s;return e.pos=this.offset,t=this.file.head.indexToLocFormat,this.offsets=t===0?(function(){var r,a;for(a=[],s=0,r=this.length;s<r;s+=2)a.push(2*e.readUInt16());return a}).call(this):(function(){var r,a;for(a=[],s=0,r=this.length;s<r;s+=4)a.push(e.readUInt32());return a}).call(this)},n.prototype.indexOf=function(e){return this.offsets[e]},n.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},n.prototype.encode=function(e,t){for(var s=new Uint32Array(this.offsets.length),r=0,a=0,i=0;i<s.length;++i)if(s[i]=r,a<t.length&&t[a]==i){++a,s[i]=r;var o=this.offsets[i],l=this.offsets[i+1]-o;l>0&&(r+=l)}for(var c=new Array(4*s.length),f=0;f<s.length;++f)c[4*f+3]=255&s[f],c[4*f+2]=(65280&s[f])>>8,c[4*f+1]=(16711680&s[f])>>16,c[4*f]=(4278190080&s[f])>>24;return c},n})(),K0e=(function(){function n(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return n.prototype.generateCmap=function(){var e,t,s,r,a;for(t in r=this.font.cmap.tables[0].codeMap,e={},a=this.subset)s=a[t],e[t]=r[s];return e},n.prototype.glyphsFor=function(e){var t,s,r,a,i,o,l;for(r={},i=0,o=e.length;i<o;i++)r[a=e[i]]=this.font.glyf.glyphFor(a);for(a in t=[],r)(s=r[a])!=null&&s.compound&&t.push.apply(t,s.glyphIDs);if(t.length>0)for(a in l=this.glyphsFor(t))s=l[a],r[a]=s;return r},n.prototype.encode=function(e,t){var s,r,a,i,o,l,c,f,d,m,g,b,x,v,w;for(r in s=N8.encode(this.generateCmap(),"unicode"),i=this.glyphsFor(e),g={0:0},w=s.charMap)g[(l=w[r]).old]=l.new;for(b in m=s.maxGlyphID,i)b in g||(g[b]=m++);return f=(function(k){var I,A;for(I in A={},k)A[k[I]]=I;return A})(g),d=Object.keys(f).sort(function(k,I){return k-I}),x=(function(){var k,I,A;for(A=[],k=0,I=d.length;k<I;k++)o=d[k],A.push(f[o]);return A})(),a=this.font.glyf.encode(i,x,g),c=this.font.loca.encode(a.offsets,x),v={cmap:this.font.cmap.raw(),glyf:a.table,loca:c,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(v["OS/2"]=this.font.os2.raw()),this.font.directory.encode(v)},n})();Ft.API.PDFObject=(function(){var n;function e(){}return n=function(t,s){return(Array(s+1).join("0")+t).slice(-s)},e.convert=function(t){var s,r,a,i;if(Array.isArray(t))return"["+(function(){var o,l,c;for(c=[],o=0,l=t.length;o<l;o++)s=t[o],c.push(e.convert(s));return c})().join(" ")+"]";if(typeof t=="string")return"/"+t;if(t?.isString)return"("+t+")";if(t instanceof Date)return"(D:"+n(t.getUTCFullYear(),4)+n(t.getUTCMonth(),2)+n(t.getUTCDate(),2)+n(t.getUTCHours(),2)+n(t.getUTCMinutes(),2)+n(t.getUTCSeconds(),2)+"Z)";if({}.toString.call(t)==="[object Object]"){for(r in a=["<<"],t)i=t[r],a.push("/"+r+" "+e.convert(i));return a.push(">>"),a.join(`
`)}return""+t},e})();function X0e(){const{id:n}=Dz(),[e,t]=We.useState(null),[s,r]=We.useState(!1),{theme:a}=We.useContext(zh),i=a==="dark",o="/mnt/data/c95da042-e03f-49b5-b678-ea9f517293f5.png";if(We.useEffect(()=>{async function d(){const g=await(await fetch(`undefined/recipe/${n}`)).json();t(g.recipe)}d()},[n]),!e)return $e.jsx("div",{className:"min-h-screen flex items-center justify-center px-6",children:$e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[$e.jsx("div",{className:"w-12 h-12 rounded-full border-4 border-blue-400 border-t-transparent animate-spin"}),$e.jsx("p",{className:`text-lg font-medium ${i?"text-blue-200":"text-blue-700"}`,children:"Fetching recipe details..."})]})});const l=e.extendedIngredients.map(d=>d.original);function c(){const d=l.join(`
`),m=new Blob([d],{type:"text/plain"}),g=URL.createObjectURL(m),b=document.createElement("a");b.href=g,b.download=`${e.title}-shopping-list.txt`,b.click()}function f(){const d=new Ft;d.setFontSize(16),d.text(e.title+" - Shopping List",10,10),d.setFontSize(12),l.forEach((m,g)=>{d.text(`${g+1}. ${m}`,10,20+g*7)}),d.save(`${e.title}-shopping-list.pdf`)}return $e.jsxs("div",{className:`min-h-screen px-6 py-10 transition-colors duration-300 ${i?"text-blue-100":"text-slate-800"}`,children:[$e.jsxs("div",{className:`max-w-4xl mx-auto p-8 rounded-3xl shadow-xl backdrop-blur-xl
          ${i?"glass-panel border border-white/10":"bg-white/50 border border-blue-100"}
        `,children:[$e.jsx("h1",{className:`text-3xl md:text-4xl font-extrabold mb-6 drop-shadow ${i?"text-blue-200":"text-blue-700"}`,children:e.title}),$e.jsx("div",{className:"w-full overflow-hidden rounded-2xl mb-6",children:$e.jsx("img",{src:e.image||o,onError:d=>{d.currentTarget.onerror=null,d.currentTarget.src=o},alt:e.title,className:"w-full h-64 md:h-80 object-cover rounded-xl shadow-md"})}),$e.jsx("h2",{className:`text-2xl font-semibold mb-3 ${i?"text-blue-200":"text-blue-700"}`,children:"Ingredients"}),$e.jsx("ul",{className:`list-disc ml-6 space-y-1 ${i?"text-blue-100/90":"text-slate-700"}`,children:l.map((d,m)=>$e.jsx("li",{children:d},m))}),$e.jsx("h2",{className:`text-2xl font-semibold mt-8 mb-3 ${i?"text-blue-200":"text-blue-700"}`,children:"Instructions"}),$e.jsx("div",{className:`${i?"text-blue-100/90":"text-slate-700"}`,children:e.analyzedInstructions?.length>0?$e.jsx("ol",{className:"list-decimal ml-6 space-y-2",children:e.analyzedInstructions[0].steps.map(d=>$e.jsx("li",{children:d.step},d.number))}):$e.jsx("p",{children:"No instructions available."})}),$e.jsx("h2",{className:`text-2xl font-semibold mt-8 mb-2 ${i?"text-blue-200":"text-blue-700"}`,children:"Nutrition Facts"}),$e.jsxs("p",{className:`${i?"text-blue-100/90":"text-slate-700"}`,children:[$e.jsx("strong",{children:"Calories:"})," ",e.nutrition.nutrients[0]?.amount," ","kcal"]}),$e.jsx("button",{className:`
            mt-8 px-6 py-3 rounded-xl font-semibold transition-transform shadow-lg
            hover:scale-[1.03]
            bg-blue-600 hover:bg-blue-700
            text-white
          `,onClick:()=>r(!0),children:"Generate Shopping List"})]}),s&&$e.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4",children:$e.jsxs("div",{className:`p-6 rounded-2xl max-w-md w-full shadow-xl backdrop-blur-xl ${i?"glass-panel border border-white/10":"bg-white/70 border border-blue-100"}`,children:[$e.jsxs("h2",{className:`text-2xl font-bold mb-4 ${i?"text-blue-200":"text-blue-700"}`,children:[e.title,"  Shopping List"]}),$e.jsx("ul",{className:`list-disc ml-6 mb-6 space-y-1 ${i?"text-blue-100/90":"text-slate-700"}`,children:l.map((d,m)=>$e.jsx("li",{children:d},m))}),$e.jsxs("div",{className:"flex gap-3",children:[$e.jsx("button",{className:`px-4 py-2 rounded-lg font-semibold shadow transition hover:scale-105 
                  bg-blue-600 hover:bg-blue-700
                  text-white
                `,onClick:c,children:"Download TXT"}),$e.jsx("button",{className:`px-4 py-2 rounded-lg font-semibold shadow transition hover:scale-105 
                  bg-red-600 hover:bg-red-700 text-white
                `,onClick:f,children:"Download PDF"})]}),$e.jsx("button",{className:`mt-5 px-4 py-2 w-full rounded-lg font-semibold transition
                ${i?"bg-gray-600/40 hover:bg-gray-600/60 text-blue-100":"bg-gray-300 hover:bg-gray-400 text-slate-800"}
              `,onClick:()=>r(!1),children:"Close"})]})})]})}function C8(){return $e.jsx("footer",{className:`w-full py-6 mt-10 flex items-center justify-center \r
      bg-[#0f1629] \r
      glass-panel \r
      border-t border-blue-500/20 \r
      text-blue-300 text-sm \r
      backdrop-blur-xl`,children:$e.jsxs("p",{className:"tracking-wide drop-shadow-sm",children:[" ",new Date().getFullYear()," Smart Recipe Generator ",$e.jsx("span",{className:"text-blue-400 font-semibold",children:" Assignment"})]})})}function Y0e(){const{theme:n}=We.useContext(zh);return $e.jsxs("div",{className:`h-screen w-screen flex flex-col overflow-hidden transition-bg
        ${n==="dark"?"full-bg-dark":"full-bg"}
      `,children:[$e.jsx($_,{}),$e.jsx("main",{className:"flex-1 overflow-y-auto",children:$e.jsx(Hz,{})}),$e.jsx(C8,{})]})}function Z0e(){const[n,e]=We.useState([]);return $e.jsx($e.Fragment,{children:$e.jsxs(Xz,{children:[$e.jsx(gh,{path:"*",element:$e.jsx($_,{})}),$e.jsx(gh,{path:"*",element:$e.jsx(C8,{})}),$e.jsxs(gh,{element:$e.jsx(Y0e,{}),children:[$e.jsx(gh,{path:"/",element:$e.jsx(EP,{})}),$e.jsx(gh,{path:"/input",element:$e.jsx(sge,{setRecipes:e})}),$e.jsx(gh,{path:"/recipes",element:$e.jsx(rge,{recipes:n})}),$e.jsx(gh,{path:"/recipe/:id",element:$e.jsx(X0e,{})})]})]})})}WM.createRoot(document.getElementById("root")).render($e.jsx(We.StrictMode,{children:$e.jsx(bP,{children:$e.jsx(GM,{children:$e.jsx(Z0e,{})})})}));export{as as _,J0e as c,c_ as g};
